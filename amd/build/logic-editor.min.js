(()=>{var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__name=(target2,value)=>__defProp(target2,"name",{value:value,configurable:!0}),__commonJS=(cb,mod)=>function(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports},__toESM=(mod,isNodeMode,target2)=>(target2=null!=mod?__create(__getProtoOf(mod)):{},((to,from,except,desc)=>{if(from&&"object"==typeof from||"function"==typeof from)for(let key of __getOwnPropNames(from))__hasOwnProp.call(to,key)||key===except||__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to})(!isNodeMode&&mod&&mod.__esModule?target2:__defProp(target2,"default",{value:mod,enumerable:!0}),mod)),require_FileSaver_min=__commonJS({"node_modules/file-saver/dist/FileSaver.min.js"(exports,module){var a2,b2;a2=exports,b2=function(){function b2(a3,b3){return void 0===b3?b3={autoBom:!1}:"object"!=typeof b3&&(console.warn("Deprecated: Expected third argument to be a object"),b3={autoBom:!b3}),b3.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a3.type)?new Blob(["\ufeff",a3],{type:a3.type}):a3}function c(a3,b3,c2){var d2=new XMLHttpRequest;d2.open("GET",a3),d2.responseType="blob",d2.onload=function(){g(d2.response,b3,c2)},d2.onerror=function(){console.error("could not download file")},d2.send()}function d(a3){var b3=new XMLHttpRequest;b3.open("HEAD",a3,!1);try{b3.send()}catch(a4){}return 200<=b3.status&&299>=b3.status}function e(a3){try{a3.dispatchEvent(new MouseEvent("click"))}catch(c2){var b3=document.createEvent("MouseEvents");b3.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a3.dispatchEvent(b3)}}__name(b2,"b"),__name(c,"c"),__name(d,"d"),__name(e,"e");var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a2=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a2?function(b3,g2,h){var i2=f.URL||f.webkitURL,j=document.createElement("a");g2=g2||b3.name||"download",j.download=g2,j.rel="noopener","string"==typeof b3?(j.href=b3,j.origin===location.origin?e(j):d(j.href)?c(b3,g2,h):e(j,j.target="_blank")):(j.href=i2.createObjectURL(b3),setTimeout((function(){i2.revokeObjectURL(j.href)}),4e4),setTimeout((function(){e(j)}),0))}:"msSaveOrOpenBlob"in navigator?function(f2,g2,h){if(g2=g2||f2.name||"download","string"!=typeof f2)navigator.msSaveOrOpenBlob(b2(f2,h),g2);else if(d(f2))c(f2,g2,h);else{var i2=document.createElement("a");i2.href=f2,i2.target="_blank",setTimeout((function(){e(i2)}))}}:function(b3,d2,e2,g2){if((g2=g2||open("","_blank"))&&(g2.document.title=g2.document.body.innerText="downloading..."),"string"==typeof b3)return c(b3,d2,e2);var h="application/octet-stream"===b3.type,i2=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i2||a2)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a3=k.result;a3=j?a3:a3.replace(/^data:[^;]*;/,"data:attachment/file;"),g2?g2.location.href=a3:location=a3,g2=null},k.readAsDataURL(b3)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b3);g2?g2.location=m:location.href=m,g2=null,setTimeout((function(){l.revokeObjectURL(m)}),4e4)}});f.saveAs=g.saveAs=g,void 0!==module&&(module.exports=g)},"function"==typeof define&&define.amd?define("qtype_logiccircuit/logic-editor",[],b2):void 0!==exports?b2():(b2(),a2.FileSaver={})}}),require_dist=__commonJS({"node_modules/json5/dist/index.js"(exports,module){var global2,factory;global2=exports,factory=function(){function createCommonjsModule(fn2,module2){return fn2(module2={exports:{}},module2.exports),module2.exports}__name(createCommonjsModule,"createCommonjsModule");var _global=createCommonjsModule((function(module2){var global2=module2.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global2)})),_core=createCommonjsModule((function(module2){var core=module2.exports={version:"2.6.5"};"number"==typeof __e&&(__e=core)})),_isObject=(_core.version,__name((function(it){return"object"==typeof it?null!==it:"function"==typeof it}),"_isObject")),_anObject=__name((function(it){if(!_isObject(it))throw TypeError(it+" is not an object!");return it}),"_anObject"),_fails=__name((function(exec){try{return!!exec()}catch(e){return!0}}),"_fails"),_descriptors=!_fails((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),document2=_global.document,is=_isObject(document2)&&_isObject(document2.createElement),_domCreate=__name((function(it){return is?document2.createElement(it):{}}),"_domCreate"),_ie8DomDefine=!_descriptors&&!_fails((function(){return 7!=Object.defineProperty(_domCreate("div"),"a",{get:function(){return 7}}).a})),_toPrimitive=__name((function(it,S2){if(!_isObject(it))return it;var fn2,val;if(S2&&"function"==typeof(fn2=it.toString)&&!_isObject(val=fn2.call(it)))return val;if("function"==typeof(fn2=it.valueOf)&&!_isObject(val=fn2.call(it)))return val;if(!S2&&"function"==typeof(fn2=it.toString)&&!_isObject(val=fn2.call(it)))return val;throw TypeError("Can't convert object to primitive value")}),"_toPrimitive"),dP=Object.defineProperty,_objectDp={f:_descriptors?Object.defineProperty:__name((function(O,P,Attributes){if(_anObject(O),P=_toPrimitive(P,!0),_anObject(Attributes),_ie8DomDefine)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");return"value"in Attributes&&(O[P]=Attributes.value),O}),"defineProperty")},_propertyDesc=__name((function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}),"_propertyDesc"),_hide=_descriptors?function(object,key2,value){return _objectDp.f(object,key2,_propertyDesc(1,value))}:function(object,key2,value){return object[key2]=value,object},hasOwnProperty={}.hasOwnProperty,_has=__name((function(it,key2){return hasOwnProperty.call(it,key2)}),"_has"),id=0,px=Math.random(),_uid=__name((function(key2){return"Symbol(".concat(void 0===key2?"":key2,")_",(++id+px).toString(36))}),"_uid"),_functionToString=createCommonjsModule((function(module2){var store=_global["__core-js_shared__"]||(_global["__core-js_shared__"]={});(module2.exports=function(key2,value){return store[key2]||(store[key2]=void 0!==value?value:{})})("versions",[]).push({version:_core.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}))("native-function-to-string",Function.toString),_redefine=createCommonjsModule((function(module2){var SRC=_uid("src"),TPL=(""+_functionToString).split("toString");_core.inspectSource=function(it){return _functionToString.call(it)},(module2.exports=function(O,key2,val,safe){var isFunction="function"==typeof val;isFunction&&(_has(val,"name")||_hide(val,"name",key2)),O[key2]!==val&&(isFunction&&(_has(val,SRC)||_hide(val,SRC,O[key2]?""+O[key2]:TPL.join(String(key2)))),O===_global?O[key2]=val:safe?O[key2]?O[key2]=val:_hide(O,key2,val):(delete O[key2],_hide(O,key2,val)))})(Function.prototype,"toString",__name((function(){return"function"==typeof this&&this[SRC]||_functionToString.call(this)}),"toString"))})),_aFunction=__name((function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it}),"_aFunction"),_ctx=__name((function(fn2,that,length){if(_aFunction(fn2),void 0===that)return fn2;switch(length){case 1:return function(a2){return fn2.call(that,a2)};case 2:return function(a2,b2){return fn2.call(that,a2,b2)};case 3:return function(a2,b2,c2){return fn2.call(that,a2,b2,c2)}}return function(){return fn2.apply(that,arguments)}}),"_ctx"),$export=__name((function(type7,name2,source2){var key2,own,out,exp,IS_FORCED=type7&$export.F,IS_GLOBAL=type7&$export.G,IS_STATIC=type7&$export.S,IS_PROTO=type7&$export.P,IS_BIND=type7&$export.B,target2=IS_GLOBAL?_global:IS_STATIC?_global[name2]||(_global[name2]={}):(_global[name2]||{}).prototype,exports2=IS_GLOBAL?_core:_core[name2]||(_core[name2]={}),expProto=exports2.prototype||(exports2.prototype={});for(key2 in IS_GLOBAL&&(source2=name2),source2)out=((own=!IS_FORCED&&target2&&void 0!==target2[key2])?target2:source2)[key2],exp=IS_BIND&&own?_ctx(out,_global):IS_PROTO&&"function"==typeof out?_ctx(Function.call,out):out,target2&&_redefine(target2,key2,out,type7&$export.U),exports2[key2]!=out&&_hide(exports2,key2,exp),IS_PROTO&&expProto[key2]!=out&&(expProto[key2]=out)}),"$export");_global.core=_core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,ceil=Math.ceil,floor=Math.floor,_toInteger=__name((function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}),"_toInteger"),_defined=__name((function(it){if(null==it)throw TypeError("Can't call method on  "+it);return it}),"_defined"),$at=__name((function(TO_STRING){return function(that,pos2){var a2,b2,s=String(_defined(that)),i2=_toInteger(pos2),l=s.length;return i2<0||i2>=l?TO_STRING?"":void 0:(a2=s.charCodeAt(i2))<55296||a2>56319||i2+1===l||(b2=s.charCodeAt(i2+1))<56320||b2>57343?TO_STRING?s.charAt(i2):a2:TO_STRING?s.slice(i2,i2+2):b2-56320+(a2-55296<<10)+65536}}),"_stringAt")(!1);_export(_export.P,"String",{codePointAt:__name((function(pos2){return $at(this,pos2)}),"codePointAt")}),_core.String.codePointAt;var max3=Math.max,min3=Math.min,_toAbsoluteIndex=__name((function(index,length){return(index=_toInteger(index))<0?max3(index+length,0):min3(index,length)}),"_toAbsoluteIndex"),fromCharCode=String.fromCharCode,$fromCodePoint=String.fromCodePoint;_export(_export.S+_export.F*(!!$fromCodePoint&&1!=$fromCodePoint.length),"String",{fromCodePoint:__name((function(x){for(var code,arguments$1=arguments,res=[],aLen=arguments.length,i2=0;aLen>i2;){if(code=+arguments$1[i2++],_toAbsoluteIndex(code,1114111)!==code)throw RangeError(code+" is not a valid code point");res.push(code<65536?fromCharCode(code):fromCharCode(55296+((code-=65536)>>10),code%1024+56320))}return res.join("")}),"fromCodePoint")}),_core.String.fromCodePoint;var source,parseState,stack,pos,line,column,token,key,root,lexState,buffer,doubleQuote,sign,c,unicode={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},util={isSpaceSeparator:__name((function(c2){return"string"==typeof c2&&unicode.Space_Separator.test(c2)}),"isSpaceSeparator"),isIdStartChar:__name((function(c2){return"string"==typeof c2&&(c2>="a"&&c2<="z"||c2>="A"&&c2<="Z"||"$"===c2||"_"===c2||unicode.ID_Start.test(c2))}),"isIdStartChar"),isIdContinueChar:__name((function(c2){return"string"==typeof c2&&(c2>="a"&&c2<="z"||c2>="A"&&c2<="Z"||c2>="0"&&c2<="9"||"$"===c2||"_"===c2||"‌"===c2||"‍"===c2||unicode.ID_Continue.test(c2))}),"isIdContinueChar"),isDigit:__name((function(c2){return"string"==typeof c2&&/[0-9]/.test(c2)}),"isDigit"),isHexDigit:__name((function(c2){return"string"==typeof c2&&/[0-9A-Fa-f]/.test(c2)}),"isHexDigit")},parse=__name((function(text,reviver){source=String(text),parseState="start",stack=[],pos=0,line=1,column=0,token=void 0,key=void 0,root=void 0;do{token=lex(),parseStates[parseState]()}while("eof"!==token.type);return"function"==typeof reviver?internalize({"":root},"",reviver):root}),"parse");function internalize(holder,name2,reviver){var value=holder[name2];if(null!=value&&"object"==typeof value)if(Array.isArray(value))for(var i2=0;i2<value.length;i2++){var key2=String(i2),replacement=internalize(value,key2,reviver);void 0===replacement?delete value[key2]:Object.defineProperty(value,key2,{value:replacement,writable:!0,enumerable:!0,configurable:!0})}else for(var key$1 in value){var replacement$1=internalize(value,key$1,reviver);void 0===replacement$1?delete value[key$1]:Object.defineProperty(value,key$1,{value:replacement$1,writable:!0,enumerable:!0,configurable:!0})}return reviver.call(holder,name2,value)}function lex(){for(lexState="default",buffer="",doubleQuote=!1,sign=1;;){c=peek();var token2=lexStates[lexState]();if(token2)return token2}}function peek(){if(source[pos])return String.fromCodePoint(source.codePointAt(pos))}function read2(){var c2=peek();return"\n"===c2?(line++,column=0):c2?column+=c2.length:column++,c2&&(pos+=c2.length),c2}__name(internalize,"internalize"),__name(lex,"lex"),__name(peek,"peek"),__name(read2,"read");var lexStates={default:__name((function(){switch(c){case"\t":case"\v":case"\f":case" ":case" ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void read2();case"/":return read2(),void(lexState="comment");case void 0:return read2(),newToken("eof")}if(!util.isSpaceSeparator(c))return lexStates[parseState]();read2()}),"default$1"),comment:__name((function(){switch(c){case"*":return read2(),void(lexState="multiLineComment");case"/":return read2(),void(lexState="singleLineComment")}throw invalidChar(read2())}),"comment"),multiLineComment:__name((function(){switch(c){case"*":return read2(),void(lexState="multiLineCommentAsterisk");case void 0:throw invalidChar(read2())}read2()}),"multiLineComment"),multiLineCommentAsterisk:__name((function(){switch(c){case"*":return void read2();case"/":return read2(),void(lexState="default");case void 0:throw invalidChar(read2())}read2(),lexState="multiLineComment"}),"multiLineCommentAsterisk"),singleLineComment:__name((function(){switch(c){case"\n":case"\r":case"\u2028":case"\u2029":return read2(),void(lexState="default");case void 0:return read2(),newToken("eof")}read2()}),"singleLineComment"),value:__name((function(){switch(c){case"{":case"[":return newToken("punctuator",read2());case"n":return read2(),literal("ull"),newToken("null",null);case"t":return read2(),literal("rue"),newToken("boolean",!0);case"f":return read2(),literal("alse"),newToken("boolean",!1);case"-":case"+":return"-"===read2()&&(sign=-1),void(lexState="sign");case".":return buffer=read2(),void(lexState="decimalPointLeading");case"0":return buffer=read2(),void(lexState="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return buffer=read2(),void(lexState="decimalInteger");case"I":return read2(),literal("nfinity"),newToken("numeric",1/0);case"N":return read2(),literal("aN"),newToken("numeric",NaN);case'"':case"'":return doubleQuote='"'===read2(),buffer="",void(lexState="string")}throw invalidChar(read2())}),"value"),identifierNameStartEscape:__name((function(){if("u"!==c)throw invalidChar(read2());read2();var u=unicodeEscape();switch(u){case"$":case"_":break;default:if(!util.isIdStartChar(u))throw invalidIdentifier()}buffer+=u,lexState="identifierName"}),"identifierNameStartEscape"),identifierName:__name((function(){switch(c){case"$":case"_":case"‌":case"‍":return void(buffer+=read2());case"\\":return read2(),void(lexState="identifierNameEscape")}if(!util.isIdContinueChar(c))return newToken("identifier",buffer);buffer+=read2()}),"identifierName"),identifierNameEscape:__name((function(){if("u"!==c)throw invalidChar(read2());read2();var u=unicodeEscape();switch(u){case"$":case"_":case"‌":case"‍":break;default:if(!util.isIdContinueChar(u))throw invalidIdentifier()}buffer+=u,lexState="identifierName"}),"identifierNameEscape"),sign:__name((function(){switch(c){case".":return buffer=read2(),void(lexState="decimalPointLeading");case"0":return buffer=read2(),void(lexState="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return buffer=read2(),void(lexState="decimalInteger");case"I":return read2(),literal("nfinity"),newToken("numeric",sign*(1/0));case"N":return read2(),literal("aN"),newToken("numeric",NaN)}throw invalidChar(read2())}),"sign$1"),zero:__name((function(){switch(c){case".":return buffer+=read2(),void(lexState="decimalPoint");case"e":case"E":return buffer+=read2(),void(lexState="decimalExponent");case"x":case"X":return buffer+=read2(),void(lexState="hexadecimal")}return newToken("numeric",0*sign)}),"zero"),decimalInteger:__name((function(){switch(c){case".":return buffer+=read2(),void(lexState="decimalPoint");case"e":case"E":return buffer+=read2(),void(lexState="decimalExponent")}if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read2()}),"decimalInteger"),decimalPointLeading:__name((function(){if(util.isDigit(c))return buffer+=read2(),void(lexState="decimalFraction");throw invalidChar(read2())}),"decimalPointLeading"),decimalPoint:__name((function(){switch(c){case"e":case"E":return buffer+=read2(),void(lexState="decimalExponent")}return util.isDigit(c)?(buffer+=read2(),void(lexState="decimalFraction")):newToken("numeric",sign*Number(buffer))}),"decimalPoint"),decimalFraction:__name((function(){switch(c){case"e":case"E":return buffer+=read2(),void(lexState="decimalExponent")}if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read2()}),"decimalFraction"),decimalExponent:__name((function(){switch(c){case"+":case"-":return buffer+=read2(),void(lexState="decimalExponentSign")}if(util.isDigit(c))return buffer+=read2(),void(lexState="decimalExponentInteger");throw invalidChar(read2())}),"decimalExponent"),decimalExponentSign:__name((function(){if(util.isDigit(c))return buffer+=read2(),void(lexState="decimalExponentInteger");throw invalidChar(read2())}),"decimalExponentSign"),decimalExponentInteger:__name((function(){if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read2()}),"decimalExponentInteger"),hexadecimal:__name((function(){if(util.isHexDigit(c))return buffer+=read2(),void(lexState="hexadecimalInteger");throw invalidChar(read2())}),"hexadecimal"),hexadecimalInteger:__name((function(){if(!util.isHexDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read2()}),"hexadecimalInteger"),string:__name((function(){switch(c){case"\\":return read2(),void(buffer+=escape());case'"':return doubleQuote?(read2(),newToken("string",buffer)):void(buffer+=read2());case"'":return doubleQuote?void(buffer+=read2()):(read2(),newToken("string",buffer));case"\n":case"\r":throw invalidChar(read2());case"\u2028":case"\u2029":separatorChar(c);break;case void 0:throw invalidChar(read2())}buffer+=read2()}),"string"),start:__name((function(){switch(c){case"{":case"[":return newToken("punctuator",read2())}lexState="value"}),"start"),beforePropertyName:__name((function(){switch(c){case"$":case"_":return buffer=read2(),void(lexState="identifierName");case"\\":return read2(),void(lexState="identifierNameStartEscape");case"}":return newToken("punctuator",read2());case'"':case"'":return doubleQuote='"'===read2(),void(lexState="string")}if(util.isIdStartChar(c))return buffer+=read2(),void(lexState="identifierName");throw invalidChar(read2())}),"beforePropertyName"),afterPropertyName:__name((function(){if(":"===c)return newToken("punctuator",read2());throw invalidChar(read2())}),"afterPropertyName"),beforePropertyValue:__name((function(){lexState="value"}),"beforePropertyValue"),afterPropertyValue:__name((function(){switch(c){case",":case"}":return newToken("punctuator",read2())}throw invalidChar(read2())}),"afterPropertyValue"),beforeArrayValue:__name((function(){if("]"===c)return newToken("punctuator",read2());lexState="value"}),"beforeArrayValue"),afterArrayValue:__name((function(){switch(c){case",":case"]":return newToken("punctuator",read2())}throw invalidChar(read2())}),"afterArrayValue"),end:__name((function(){throw invalidChar(read2())}),"end")};function newToken(type7,value){return{type:type7,value:value,line:line,column:column}}function literal(s){for(var i2=0,list=s;i2<list.length;i2+=1){var c2=list[i2];if(peek()!==c2)throw invalidChar(read2());read2()}}function escape(){switch(peek()){case"b":return read2(),"\b";case"f":return read2(),"\f";case"n":return read2(),"\n";case"r":return read2(),"\r";case"t":return read2(),"\t";case"v":return read2(),"\v";case"0":if(read2(),util.isDigit(peek()))throw invalidChar(read2());return"\0";case"x":return read2(),hexEscape();case"u":return read2(),unicodeEscape();case"\n":case"\u2028":case"\u2029":return read2(),"";case"\r":return read2(),"\n"===peek()&&read2(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw invalidChar(read2())}return read2()}function hexEscape(){var buffer2="",c2=peek();if(!util.isHexDigit(c2))throw invalidChar(read2());if(buffer2+=read2(),c2=peek(),!util.isHexDigit(c2))throw invalidChar(read2());return buffer2+=read2(),String.fromCodePoint(parseInt(buffer2,16))}function unicodeEscape(){for(var buffer2="",count=4;count-- >0;){var c2=peek();if(!util.isHexDigit(c2))throw invalidChar(read2());buffer2+=read2()}return String.fromCodePoint(parseInt(buffer2,16))}__name(newToken,"newToken"),__name(literal,"literal"),__name(escape,"escape"),__name(hexEscape,"hexEscape"),__name(unicodeEscape,"unicodeEscape");var parseStates={start:__name((function(){if("eof"===token.type)throw invalidEOF();push()}),"start"),beforePropertyName:__name((function(){switch(token.type){case"identifier":case"string":return key=token.value,void(parseState="afterPropertyName");case"punctuator":return void pop();case"eof":throw invalidEOF()}}),"beforePropertyName"),afterPropertyName:__name((function(){if("eof"===token.type)throw invalidEOF();parseState="beforePropertyValue"}),"afterPropertyName"),beforePropertyValue:__name((function(){if("eof"===token.type)throw invalidEOF();push()}),"beforePropertyValue"),beforeArrayValue:__name((function(){if("eof"===token.type)throw invalidEOF();"punctuator"!==token.type||"]"!==token.value?push():pop()}),"beforeArrayValue"),afterPropertyValue:__name((function(){if("eof"===token.type)throw invalidEOF();switch(token.value){case",":return void(parseState="beforePropertyName");case"}":pop()}}),"afterPropertyValue"),afterArrayValue:__name((function(){if("eof"===token.type)throw invalidEOF();switch(token.value){case",":return void(parseState="beforeArrayValue");case"]":pop()}}),"afterArrayValue"),end:__name((function(){}),"end")};function push(){var value;switch(token.type){case"punctuator":switch(token.value){case"{":value={};break;case"[":value=[]}break;case"null":case"boolean":case"numeric":case"string":value=token.value}if(void 0===root)root=value;else{var parent=stack[stack.length-1];Array.isArray(parent)?parent.push(value):Object.defineProperty(parent,key,{value:value,writable:!0,enumerable:!0,configurable:!0})}if(null!==value&&"object"==typeof value)stack.push(value),parseState=Array.isArray(value)?"beforeArrayValue":"beforePropertyName";else{var current=stack[stack.length-1];parseState=null==current?"end":Array.isArray(current)?"afterArrayValue":"afterPropertyValue"}}function pop(){stack.pop();var current=stack[stack.length-1];parseState=null==current?"end":Array.isArray(current)?"afterArrayValue":"afterPropertyValue"}function invalidChar(c2){return syntaxError(void 0===c2?"JSON5: invalid end of input at "+line+":"+column:"JSON5: invalid character '"+formatChar(c2)+"' at "+line+":"+column)}function invalidEOF(){return syntaxError("JSON5: invalid end of input at "+line+":"+column)}function invalidIdentifier(){return syntaxError("JSON5: invalid identifier character at "+line+":"+(column-=5))}function separatorChar(c2){console.warn("JSON5: '"+formatChar(c2)+"' in strings is not valid ECMAScript; consider escaping")}function formatChar(c2){var replacements2={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(replacements2[c2])return replacements2[c2];if(c2<" "){var hexString=c2.charCodeAt(0).toString(16);return"\\x"+("00"+hexString).substring(hexString.length)}return c2}function syntaxError(message){var err=new SyntaxError(message);return err.lineNumber=line,err.columnNumber=column,err}return __name(push,"push"),__name(pop,"pop"),__name(invalidChar,"invalidChar"),__name(invalidEOF,"invalidEOF"),__name(invalidIdentifier,"invalidIdentifier"),__name(separatorChar,"separatorChar"),__name(formatChar,"formatChar"),__name(syntaxError,"syntaxError"),{parse:parse,stringify:__name((function(value,replacer,space){var propertyList,replacerFunc,quote,stack2=[],indent="",gap="";if(null==replacer||"object"!=typeof replacer||Array.isArray(replacer)||(space=replacer.space,quote=replacer.quote,replacer=replacer.replacer),"function"==typeof replacer)replacerFunc=replacer;else if(Array.isArray(replacer)){propertyList=[];for(var i2=0,list=replacer;i2<list.length;i2+=1){var v=list[i2],item=void 0;"string"==typeof v?item=v:("number"==typeof v||v instanceof String||v instanceof Number)&&(item=String(v)),void 0!==item&&propertyList.indexOf(item)<0&&propertyList.push(item)}}return space instanceof Number?space=Number(space):space instanceof String&&(space=String(space)),"number"==typeof space?space>0&&(space=Math.min(10,Math.floor(space)),gap="          ".substr(0,space)):"string"==typeof space&&(gap=space.substr(0,10)),serializeProperty("",{"":value});function serializeProperty(key2,holder){var value2=holder[key2];switch(null!=value2&&("function"==typeof value2.toJSON5?value2=value2.toJSON5(key2):"function"==typeof value2.toJSON&&(value2=value2.toJSON(key2))),replacerFunc&&(value2=replacerFunc.call(holder,key2,value2)),value2 instanceof Number?value2=Number(value2):value2 instanceof String?value2=String(value2):value2 instanceof Boolean&&(value2=value2.valueOf()),value2){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof value2?quoteString2(value2):"number"==typeof value2?String(value2):"object"==typeof value2?Array.isArray(value2)?serializeArray(value2):serializeObject(value2):void 0}function quoteString2(value2){for(var quotes={"'":.1,'"':.2},replacements2={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},product="",i3=0;i3<value2.length;i3++){var c2=value2[i3];switch(c2){case"'":case'"':quotes[c2]++,product+=c2;continue;case"\0":if(util.isDigit(value2[i3+1])){product+="\\x00";continue}}if(replacements2[c2])product+=replacements2[c2];else if(c2<" "){var hexString=c2.charCodeAt(0).toString(16);product+="\\x"+("00"+hexString).substring(hexString.length)}else product+=c2}var quoteChar=quote||Object.keys(quotes).reduce((function(a2,b2){return quotes[a2]<quotes[b2]?a2:b2}));return quoteChar+(product=product.replace(new RegExp(quoteChar,"g"),replacements2[quoteChar]))+quoteChar}function serializeObject(value2){if(stack2.indexOf(value2)>=0)throw TypeError("Converting circular structure to JSON5");stack2.push(value2);var stepback=indent;indent+=gap;for(var final,properties,partial4=[],i3=0,list2=propertyList||Object.keys(value2);i3<list2.length;i3+=1){var key2=list2[i3],propertyString=serializeProperty(key2,value2);if(void 0!==propertyString){var member=serializeKey(key2)+":";""!==gap&&(member+=" "),member+=propertyString,partial4.push(member)}}if(0===partial4.length)final="{}";else if(""===gap)final="{"+(properties=partial4.join(","))+"}";else{var separator=",\n"+indent;properties=partial4.join(separator),final="{\n"+indent+properties+",\n"+stepback+"}"}return stack2.pop(),indent=stepback,final}function serializeKey(key2){if(0===key2.length)return quoteString2(key2);var firstChar=String.fromCodePoint(key2.codePointAt(0));if(!util.isIdStartChar(firstChar))return quoteString2(key2);for(var i3=firstChar.length;i3<key2.length;i3++)if(!util.isIdContinueChar(String.fromCodePoint(key2.codePointAt(i3))))return quoteString2(key2);return key2}function serializeArray(value2){if(stack2.indexOf(value2)>=0)throw TypeError("Converting circular structure to JSON5");stack2.push(value2);var stepback=indent;indent+=gap;for(var final,partial4=[],i3=0;i3<value2.length;i3++){var propertyString=serializeProperty(String(i3),value2);partial4.push(void 0!==propertyString?propertyString:"null")}if(0===partial4.length)final="[]";else if(""===gap)final="["+partial4.join(",")+"]";else{var separator=",\n"+indent,properties$1=partial4.join(separator);final="[\n"+indent+properties$1+",\n"+stepback+"]"}return stack2.pop(),indent=stepback,final}}),"stringify")}},"object"==typeof exports&&void 0!==module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global2.JSON5=factory()}}),require_lz_string=__commonJS({"node_modules/lz-string/libs/lz-string.js"(exports,module){var LZString2=function(){var f=String.fromCharCode,keyStrBase64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",keyStrUriSafe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",baseReverseDic={};function getBaseValue(alphabet,character){if(!baseReverseDic[alphabet]){baseReverseDic[alphabet]={};for(var i2=0;i2<alphabet.length;i2++)baseReverseDic[alphabet][alphabet.charAt(i2)]=i2}return baseReverseDic[alphabet][character]}__name(getBaseValue,"getBaseValue");var LZString3={compressToBase64:function(input2){if(null==input2)return"";var res=LZString3._compress(input2,6,(function(a2){return keyStrBase64.charAt(a2)}));switch(res.length%4){default:case 0:return res;case 1:return res+"===";case 2:return res+"==";case 3:return res+"="}},decompressFromBase64:function(input2){return null==input2?"":""==input2?null:LZString3._decompress(input2.length,32,(function(index){return getBaseValue(keyStrBase64,input2.charAt(index))}))},compressToUTF16:function(input2){return null==input2?"":LZString3._compress(input2,15,(function(a2){return f(a2+32)}))+" "},decompressFromUTF16:function(compressed){return null==compressed?"":""==compressed?null:LZString3._decompress(compressed.length,16384,(function(index){return compressed.charCodeAt(index)-32}))},compressToUint8Array:function(uncompressed){for(var compressed=LZString3.compress(uncompressed),buf=new Uint8Array(2*compressed.length),i2=0,TotalLen=compressed.length;i2<TotalLen;i2++){var current_value=compressed.charCodeAt(i2);buf[2*i2]=current_value>>>8,buf[2*i2+1]=current_value%256}return buf},decompressFromUint8Array:function(compressed){if(null==compressed)return LZString3.decompress(compressed);for(var buf=new Array(compressed.length/2),i2=0,TotalLen=buf.length;i2<TotalLen;i2++)buf[i2]=256*compressed[2*i2]+compressed[2*i2+1];var result=[];return buf.forEach((function(c){result.push(f(c))})),LZString3.decompress(result.join(""))},compressToEncodedURIComponent:function(input2){return null==input2?"":LZString3._compress(input2,6,(function(a2){return keyStrUriSafe.charAt(a2)}))},decompressFromEncodedURIComponent:function(input2){return null==input2?"":""==input2?null:(input2=input2.replace(/ /g,"+"),LZString3._decompress(input2.length,32,(function(index){return getBaseValue(keyStrUriSafe,input2.charAt(index))})))},compress:function(uncompressed){return LZString3._compress(uncompressed,16,(function(a2){return f(a2)}))},_compress:function(uncompressed,bitsPerChar,getCharFromInt){if(null==uncompressed)return"";var i2,value,ii,context_dictionary={},context_dictionaryToCreate={},context_c="",context_wc="",context_w="",context_enlargeIn=2,context_dictSize=3,context_numBits=2,context_data=[],context_data_val=0,context_data_position=0;for(ii=0;ii<uncompressed.length;ii+=1)if(context_c=uncompressed.charAt(ii),Object.prototype.hasOwnProperty.call(context_dictionary,context_c)||(context_dictionary[context_c]=context_dictSize++,context_dictionaryToCreate[context_c]=!0),context_wc=context_w+context_c,Object.prototype.hasOwnProperty.call(context_dictionary,context_wc))context_w=context_wc;else{if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i2=0;i2<context_numBits;i2++)context_data_val<<=1,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++;for(value=context_w.charCodeAt(0),i2=0;i2<8;i2++)context_data_val=context_data_val<<1|1&value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value>>=1}else{for(value=1,i2=0;i2<context_numBits;i2++)context_data_val=context_data_val<<1|value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value=0;for(value=context_w.charCodeAt(0),i2=0;i2<16;i2++)context_data_val=context_data_val<<1|1&value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value>>=1}0==--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++),delete context_dictionaryToCreate[context_w]}else for(value=context_dictionary[context_w],i2=0;i2<context_numBits;i2++)context_data_val=context_data_val<<1|1&value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value>>=1;0==--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++),context_dictionary[context_wc]=context_dictSize++,context_w=String(context_c)}if(""!==context_w){if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i2=0;i2<context_numBits;i2++)context_data_val<<=1,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++;for(value=context_w.charCodeAt(0),i2=0;i2<8;i2++)context_data_val=context_data_val<<1|1&value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value>>=1}else{for(value=1,i2=0;i2<context_numBits;i2++)context_data_val=context_data_val<<1|value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value=0;for(value=context_w.charCodeAt(0),i2=0;i2<16;i2++)context_data_val=context_data_val<<1|1&value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value>>=1}0==--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++),delete context_dictionaryToCreate[context_w]}else for(value=context_dictionary[context_w],i2=0;i2<context_numBits;i2++)context_data_val=context_data_val<<1|1&value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value>>=1;0==--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++)}for(value=2,i2=0;i2<context_numBits;i2++)context_data_val=context_data_val<<1|1&value,context_data_position==bitsPerChar-1?(context_data_position=0,context_data.push(getCharFromInt(context_data_val)),context_data_val=0):context_data_position++,value>>=1;for(;;){if(context_data_val<<=1,context_data_position==bitsPerChar-1){context_data.push(getCharFromInt(context_data_val));break}context_data_position++}return context_data.join("")},decompress:function(compressed){return null==compressed?"":""==compressed?null:LZString3._decompress(compressed.length,32768,(function(index){return compressed.charCodeAt(index)}))},_decompress:function(length,resetValue,getNextValue){var i2,w,bits,resb,maxpower,power,c,dictionary=[],enlargeIn=4,dictSize=4,numBits=3,entry="",result=[],data2={val:getNextValue(0),position:resetValue,index:1};for(i2=0;i2<3;i2+=1)dictionary[i2]=i2;for(bits=0,maxpower=Math.pow(2,2),power=1;power!=maxpower;)resb=data2.val&data2.position,data2.position>>=1,0==data2.position&&(data2.position=resetValue,data2.val=getNextValue(data2.index++)),bits|=(resb>0?1:0)*power,power<<=1;switch(bits){case 0:for(bits=0,maxpower=Math.pow(2,8),power=1;power!=maxpower;)resb=data2.val&data2.position,data2.position>>=1,0==data2.position&&(data2.position=resetValue,data2.val=getNextValue(data2.index++)),bits|=(resb>0?1:0)*power,power<<=1;c=f(bits);break;case 1:for(bits=0,maxpower=Math.pow(2,16),power=1;power!=maxpower;)resb=data2.val&data2.position,data2.position>>=1,0==data2.position&&(data2.position=resetValue,data2.val=getNextValue(data2.index++)),bits|=(resb>0?1:0)*power,power<<=1;c=f(bits);break;case 2:return""}for(dictionary[3]=c,w=c,result.push(c);;){if(data2.index>length)return"";for(bits=0,maxpower=Math.pow(2,numBits),power=1;power!=maxpower;)resb=data2.val&data2.position,data2.position>>=1,0==data2.position&&(data2.position=resetValue,data2.val=getNextValue(data2.index++)),bits|=(resb>0?1:0)*power,power<<=1;switch(c=bits){case 0:for(bits=0,maxpower=Math.pow(2,8),power=1;power!=maxpower;)resb=data2.val&data2.position,data2.position>>=1,0==data2.position&&(data2.position=resetValue,data2.val=getNextValue(data2.index++)),bits|=(resb>0?1:0)*power,power<<=1;dictionary[dictSize++]=f(bits),c=dictSize-1,enlargeIn--;break;case 1:for(bits=0,maxpower=Math.pow(2,16),power=1;power!=maxpower;)resb=data2.val&data2.position,data2.position>>=1,0==data2.position&&(data2.position=resetValue,data2.val=getNextValue(data2.index++)),bits|=(resb>0?1:0)*power,power<<=1;dictionary[dictSize++]=f(bits),c=dictSize-1,enlargeIn--;break;case 2:return result.join("")}if(0==enlargeIn&&(enlargeIn=Math.pow(2,numBits),numBits++),dictionary[c])entry=dictionary[c];else{if(c!==dictSize)return null;entry=w+w.charAt(0)}result.push(entry),dictionary[dictSize++]=w+entry.charAt(0),w=entry,0==--enlargeIn&&(enlargeIn=Math.pow(2,numBits),numBits++)}}};return LZString3}();"function"==typeof define&&define.amd?define((function(){return LZString2})):void 0!==module&&null!=module&&(module.exports=LZString2)}}),require_crc32=__commonJS({"node_modules/png-metadata-writer/crc32.js"(exports){var factory;factory=function(CRC32){function signed_crc_table(){for(var c=0,table2=new Array(256),n=0;256!=n;++n)c=1&(c=1&(c=1&(c=1&(c=1&(c=1&(c=1&(c=1&(c=n)?-306674912^c>>>1:c>>>1)?-306674912^c>>>1:c>>>1)?-306674912^c>>>1:c>>>1)?-306674912^c>>>1:c>>>1)?-306674912^c>>>1:c>>>1)?-306674912^c>>>1:c>>>1)?-306674912^c>>>1:c>>>1)?-306674912^c>>>1:c>>>1,table2[n]=c;return"undefined"!=typeof Int32Array?new Int32Array(table2):table2}CRC32.version="1.2.0",__name(signed_crc_table,"signed_crc_table");var T=signed_crc_table();function crc32_bstr(bstr,seed){for(var C=-1^seed,L=bstr.length-1,i2=0;i2<L;)C=(C=C>>>8^T[255&(C^bstr.charCodeAt(i2++))])>>>8^T[255&(C^bstr.charCodeAt(i2++))];return i2===L&&(C=C>>>8^T[255&(C^bstr.charCodeAt(i2))]),-1^C}function crc32_buf(buf,seed){if(buf.length>1e4)return crc32_buf_8(buf,seed);for(var C=-1^seed,L=buf.length-3,i2=0;i2<L;)C=(C=(C=(C=C>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])];for(;i2<L+3;)C=C>>>8^T[255&(C^buf[i2++])];return-1^C}function crc32_buf_8(buf,seed){for(var C=-1^seed,L=buf.length-7,i2=0;i2<L;)C=(C=(C=(C=(C=(C=(C=(C=C>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])])>>>8^T[255&(C^buf[i2++])];for(;i2<L+7;)C=C>>>8^T[255&(C^buf[i2++])];return-1^C}function crc32_str(str,seed){for(var c,d,C=-1^seed,i2=0,L=str.length;i2<L;)(c=str.charCodeAt(i2++))<128?C=C>>>8^T[255&(C^c)]:c<2048?C=(C=C>>>8^T[255&(C^(192|c>>6&31))])>>>8^T[255&(C^(128|63&c))]:c>=55296&&c<57344?(c=64+(1023&c),d=1023&str.charCodeAt(i2++),C=(C=(C=(C=C>>>8^T[255&(C^(240|c>>8&7))])>>>8^T[255&(C^(128|c>>2&63))])>>>8^T[255&(C^(128|d>>6&15|(3&c)<<4))])>>>8^T[255&(C^(128|63&d))]):C=(C=(C=C>>>8^T[255&(C^(224|c>>12&15))])>>>8^T[255&(C^(128|c>>6&63))])>>>8^T[255&(C^(128|63&c))];return-1^C}__name(crc32_bstr,"crc32_bstr"),__name(crc32_buf,"crc32_buf"),__name(crc32_buf_8,"crc32_buf_8"),__name(crc32_str,"crc32_str"),CRC32.table=T,CRC32.bstr=crc32_bstr,CRC32.buf=crc32_buf,CRC32.str=crc32_str},"undefined"==typeof DO_NOT_EXPORT_CRC?"object"==typeof exports?factory(exports):"function"==typeof define&&define.amd?define((function(){var module2={};return factory(module2),module2})):factory({}):factory({})}}),require_png_metadata_writer=__commonJS({"node_modules/png-metadata-writer/index.js"(exports,module){var crc32=require_crc32(),uint8=new Uint8Array(4),int32=new Int32Array(uint8.buffer),uint32=new Uint32Array(uint8.buffer);function sliced(args,slice,sliceEnd){var ret=[],len=args.length;if(0===len)return ret;var start2=slice<0?Math.max(0,slice+len):slice||0;for(void 0!==sliceEnd&&(len=sliceEnd<0?sliceEnd+len:sliceEnd);len-- >start2;)ret[len-start2]=args[len];return ret}function textEncode(keyword,content){let chunkName=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"tEXt";if(keyword=String(keyword),(content=String(content)).length&&(!/^[\x00-\xFF]+$/.test(keyword)||!/^[\x00-\xFF]+$/.test(content)))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(keyword.length>=80)throw new Error('Keyword "'+keyword+'" is longer than the 79-character limit imposed by the PNG specification');let code,totalSize=keyword.length+content.length+1,output=new Uint8Array(totalSize),idx=0;for(let i2=0;i2<keyword.length;i2++){if(!(code=keyword.charCodeAt(i2)))throw new Error("0x00 character is not permitted in tEXt keywords");output[idx++]=code}output[idx++]=0;for(let j=0;j<content.length;j++){if(!(code=content.charCodeAt(j)))throw new Error("0x00 character is not permitted in tEXt content");output[idx++]=code}return{name:chunkName,data:output}}function textDecode(data2){data2.data&&data2.name&&(data2=data2.data);let naming=!0,text="",name2="";for(let i2=0;i2<data2.length;i2++){let code=data2[i2];if(naming)code?name2+=String.fromCharCode(code):naming=!1;else{if(!code)throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content");text+=String.fromCharCode(code)}}return{keyword:name2,text:text}}function extractChunks2(data2){if(137!==data2[0])throw new Error("Invalid .png file header");if(80!==data2[1])throw new Error("Invalid .png file header");if(78!==data2[2])throw new Error("Invalid .png file header");if(71!==data2[3])throw new Error("Invalid .png file header");if(13!==data2[4])throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(10!==data2[5])throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(26!==data2[6])throw new Error("Invalid .png file header");if(10!==data2[7])throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");let ended=!1,chunks=[],idx=8;for(;idx<data2.length;){uint8[3]=data2[idx++],uint8[2]=data2[idx++],uint8[1]=data2[idx++],uint8[0]=data2[idx++];let length=uint32[0]+4,chunk=new Uint8Array(length);chunk[0]=data2[idx++],chunk[1]=data2[idx++],chunk[2]=data2[idx++],chunk[3]=data2[idx++];let name2=String.fromCharCode(chunk[0])+String.fromCharCode(chunk[1])+String.fromCharCode(chunk[2])+String.fromCharCode(chunk[3]);if(!chunks.length&&"IHDR"!==name2)throw new Error("IHDR header missing");if("IEND"===name2){ended=!0,chunks.push({name:name2,data:new Uint8Array(0)});break}for(let i2=4;i2<length;i2++)chunk[i2]=data2[idx++];uint8[3]=data2[idx++],uint8[2]=data2[idx++],uint8[1]=data2[idx++],uint8[0]=data2[idx++];let crcActual=int32[0];if(crc32.buf(chunk)!==crcActual)throw new Error("CRC values for "+name2+" header do not match, PNG file is likely corrupted");let chunkData=new Uint8Array(chunk.buffer.slice(4));chunks.push({name:name2,data:chunkData})}if(!ended)throw new Error(".png file ended prematurely: no IEND header was found");return chunks}function encodeChunks2(chunks){let i2,totalSize=8,idx=totalSize;for(i2=0;i2<chunks.length;i2++)totalSize+=chunks[i2].data.length,totalSize+=12;let output=new Uint8Array(totalSize);for(output[0]=137,output[1]=80,output[2]=78,output[3]=71,output[4]=13,output[5]=10,output[6]=26,output[7]=10,i2=0;i2<chunks.length;i2++){let chunk=chunks[i2],name2=chunk.name,data2=chunk.data,size=data2.length,nameChars=[name2.charCodeAt(0),name2.charCodeAt(1),name2.charCodeAt(2),name2.charCodeAt(3)];uint32[0]=size,output[idx++]=uint8[3],output[idx++]=uint8[2],output[idx++]=uint8[1],output[idx++]=uint8[0],output[idx++]=nameChars[0],output[idx++]=nameChars[1],output[idx++]=nameChars[2],output[idx++]=nameChars[3];for(let j=0;j<size;)output[idx++]=data2[j++];let crcCheck=nameChars.concat(sliced(data2));int32[0]=crc32.buf(crcCheck),output[idx++]=uint8[3],output[idx++]=uint8[2],output[idx++]=uint8[1],output[idx++]=uint8[0]}return output}function readUint32(uint8array,offset2){let byte1,byte2,byte3,byte4;return byte1=uint8array[offset2++],byte2=uint8array[offset2++],byte3=uint8array[offset2++],byte4=uint8array[offset2],0|byte1<<24|byte2<<16|byte3<<8|byte4}function writeUInt32(uint8array,num,offset2){uint8array[offset2]=(4278190080&num)>>24,uint8array[offset2+1]=(16711680&num)>>16,uint8array[offset2+2]=(65280&num)>>8,uint8array[offset2+3]=255&num}function readMetadata2(buffer){let result={};return extractChunks2(buffer).forEach((chunk=>{switch(chunk.name){case"tEXt":result.tEXt||(result.tEXt={});let textChunk=textDecode(chunk.data);result.tEXt[textChunk.keyword]=textChunk.text;break;case"pHYs":result.pHYs={x:readUint32(chunk.data,0),y:readUint32(chunk.data,4),unit:chunk.data[8]};break;default:result[chunk.name]=!0}})),result}function writeMetadata(buffer,metadata){const chunks=extractChunks2(buffer);return insertMetadata2(chunks,metadata),new Buffer.from(encodeChunks2(chunks))}function insertMetadata2(chunks,metadata){if(metadata.clear)for(let i2=chunks.length-1;i2--;)switch(chunks[i2].name){case"IHDR":case"IDAT":case"IEND":break;default:chunks.splice(i2,1)}if(metadata.tEXt)for(var keyword in metadata.tEXt)chunks.splice(-1,0,textEncode(keyword,metadata.tEXt[keyword]));if(metadata.pHYs){const data2=new Uint8Array(9);writeUInt32(data2,metadata.pHYs.x,0),writeUInt32(data2,metadata.pHYs.y,4),data2[8]=metadata.pHYs.units;let pHYs=chunks.find((chunk=>"pHYs"===chunk.name));pHYs?pHYs.data=data2:chunks.splice(1,0,{name:"pHYs",data:data2})}}__name(sliced,"sliced"),__name(textEncode,"textEncode"),__name(textDecode,"textDecode"),__name(extractChunks2,"extractChunks"),__name(encodeChunks2,"encodeChunks"),__name(readUint32,"readUint32"),__name(writeUInt32,"writeUInt32"),__name(readMetadata2,"readMetadata"),__name(writeMetadata,"writeMetadata"),__name(insertMetadata2,"insertMetadata"),module.exports={RESOLUTION_UNITS:{UNDEFINED:0,METERS:1,INCHES:2},insertMetadata:insertMetadata2,readMetadata:readMetadata2,writeMetadata:writeMetadata,textEncode:textEncode,textDecode:textDecode,extractChunks:extractChunks2,encodeChunks:encodeChunks2}}}),require_function=__commonJS({"node_modules/fp-ts/lib/function.js"(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEndomorphismMonoid=exports.not=exports.SK=exports.hole=exports.pipe=exports.untupled=exports.tupled=exports.absurd=exports.decrement=exports.increment=exports.tuple=exports.flow=exports.flip=exports.constVoid=exports.constUndefined=exports.constNull=exports.constFalse=exports.constTrue=exports.constant=exports.unsafeCoerce=exports.identity=exports.apply=exports.getRing=exports.getSemiring=exports.getMonoid=exports.getSemigroup=exports.getBooleanAlgebra=void 0;var getBooleanAlgebra=__name((function(B){return function(){return{meet:function(x,y){return function(a2){return B.meet(x(a2),y(a2))}},join:function(x,y){return function(a2){return B.join(x(a2),y(a2))}},zero:function(){return B.zero},one:function(){return B.one},implies:function(x,y){return function(a2){return B.implies(x(a2),y(a2))}},not:function(x){return function(a2){return B.not(x(a2))}}}}}),"getBooleanAlgebra");exports.getBooleanAlgebra=getBooleanAlgebra;var getSemigroup=__name((function(S2){return function(){return{concat:function(f,g){return function(a2){return S2.concat(f(a2),g(a2))}}}}}),"getSemigroup");exports.getSemigroup=getSemigroup;var getMonoid=__name((function(M){var getSemigroupM=(0,exports.getSemigroup)(M);return function(){return{concat:getSemigroupM().concat,empty:function(){return M.empty}}}}),"getMonoid");exports.getMonoid=getMonoid;var getSemiring=__name((function(S2){return{add:function(f,g){return function(x){return S2.add(f(x),g(x))}},zero:function(){return S2.zero},mul:function(f,g){return function(x){return S2.mul(f(x),g(x))}},one:function(){return S2.one}}}),"getSemiring");exports.getSemiring=getSemiring;var getRing=__name((function(R){var S2=(0,exports.getSemiring)(R);return{add:S2.add,mul:S2.mul,one:S2.one,zero:S2.zero,sub:function(f,g){return function(x){return R.sub(f(x),g(x))}}}}),"getRing");exports.getRing=getRing;var apply=__name((function(a2){return function(f){return f(a2)}}),"apply");function identity2(a2){return a2}function constant(a2){return function(){return a2}}function flip2(f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return args.length>1?f(args[1],args[0]):function(a2){return f(a2)(args[0])}}}function flow(ab,bc,cd,de,ef,fg,gh,hi,ij){switch(arguments.length){case 1:return ab;case 2:return function(){return bc(ab.apply(this,arguments))};case 3:return function(){return cd(bc(ab.apply(this,arguments)))};case 4:return function(){return de(cd(bc(ab.apply(this,arguments))))};case 5:return function(){return ef(de(cd(bc(ab.apply(this,arguments)))))};case 6:return function(){return fg(ef(de(cd(bc(ab.apply(this,arguments))))))};case 7:return function(){return gh(fg(ef(de(cd(bc(ab.apply(this,arguments)))))))};case 8:return function(){return hi(gh(fg(ef(de(cd(bc(ab.apply(this,arguments))))))))};case 9:return function(){return ij(hi(gh(fg(ef(de(cd(bc(ab.apply(this,arguments)))))))))}}}function tuple4(){for(var t38=[],_i=0;_i<arguments.length;_i++)t38[_i]=arguments[_i];return t38}function increment(n){return n+1}function decrement(n){return n-1}function absurd(_){throw new Error("Called `absurd` function which should be uncallable")}function tupled(f){return function(a2){return f.apply(void 0,a2)}}function untupled(f){return function(){for(var a2=[],_i=0;_i<arguments.length;_i++)a2[_i]=arguments[_i];return f(a2)}}function pipe(a2,ab,bc,cd,de,ef,fg,gh,hi){switch(arguments.length){case 1:return a2;case 2:return ab(a2);case 3:return bc(ab(a2));case 4:return cd(bc(ab(a2)));case 5:return de(cd(bc(ab(a2))));case 6:return ef(de(cd(bc(ab(a2)))));case 7:return fg(ef(de(cd(bc(ab(a2))))));case 8:return gh(fg(ef(de(cd(bc(ab(a2)))))));case 9:return hi(gh(fg(ef(de(cd(bc(ab(a2))))))));default:for(var ret=arguments[0],i2=1;i2<arguments.length;i2++)ret=arguments[i2](ret);return ret}}exports.apply=apply,__name(identity2,"identity"),exports.identity=identity2,exports.unsafeCoerce=identity2,__name(constant,"constant"),exports.constant=constant,exports.constTrue=constant(!0),exports.constFalse=constant(!1),exports.constNull=constant(null),exports.constUndefined=constant(void 0),exports.constVoid=exports.constUndefined,__name(flip2,"flip"),exports.flip=flip2,__name(flow,"flow"),exports.flow=flow,__name(tuple4,"tuple"),exports.tuple=tuple4,__name(increment,"increment"),exports.increment=increment,__name(decrement,"decrement"),exports.decrement=decrement,__name(absurd,"absurd"),exports.absurd=absurd,__name(tupled,"tupled"),exports.tupled=tupled,__name(untupled,"untupled"),exports.untupled=untupled,__name(pipe,"pipe"),exports.pipe=pipe,exports.hole=absurd;var SK=__name((function(_,b2){return b2}),"SK");function not(predicate){return function(a2){return!predicate(a2)}}exports.SK=SK,__name(not,"not"),exports.not=not;var getEndomorphismMonoid=__name((function(){return{concat:function(first,second){return flow(first,second)},empty:identity2}}),"getEndomorphismMonoid");exports.getEndomorphismMonoid=getEndomorphismMonoid}}),require_internal=__commonJS({"node_modules/fp-ts/lib/internal.js"(exports){var __spreadArray=exports&&exports.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i2=0,l=from.length;i2<l;i2++)!ar&&i2 in from||(ar||(ar=Array.prototype.slice.call(from,0,i2)),ar[i2]=from[i2]);return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromReadonlyNonEmptyArray=exports.has=exports.emptyRecord=exports.emptyReadonlyArray=exports.tail=exports.head=exports.isNonEmpty=exports.singleton=exports.right=exports.left=exports.isRight=exports.isLeft=exports.some=exports.none=exports.isSome=exports.isNone=void 0;var isNone=__name((function(fa){return"None"===fa._tag}),"isNone");exports.isNone=isNone;var isSome=__name((function(fa){return"Some"===fa._tag}),"isSome");exports.isSome=isSome,exports.none={_tag:"None"};var some=__name((function(a2){return{_tag:"Some",value:a2}}),"some");exports.some=some;var isLeft2=__name((function(ma){return"Left"===ma._tag}),"isLeft");exports.isLeft=isLeft2;var isRight=__name((function(ma){return"Right"===ma._tag}),"isRight");exports.isRight=isRight;var left2=__name((function(e){return{_tag:"Left",left:e}}),"left");exports.left=left2;var right2=__name((function(a2){return{_tag:"Right",right:a2}}),"right");exports.right=right2;var singleton=__name((function(a2){return[a2]}),"singleton");exports.singleton=singleton;var isNonEmpty=__name((function(as){return as.length>0}),"isNonEmpty");exports.isNonEmpty=isNonEmpty;var head=__name((function(as){return as[0]}),"head");exports.head=head;var tail=__name((function(as){return as.slice(1)}),"tail");exports.tail=tail,exports.emptyReadonlyArray=[],exports.emptyRecord={},exports.has=Object.prototype.hasOwnProperty;var fromReadonlyNonEmptyArray=__name((function(as){return __spreadArray([as[0]],as.slice(1),!0)}),"fromReadonlyNonEmptyArray");exports.fromReadonlyNonEmptyArray=fromReadonlyNonEmptyArray}}),require_Apply=__commonJS({"node_modules/fp-ts/lib/Apply.js"(exports){var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.sequenceS=exports.sequenceT=exports.getApplySemigroup=exports.apS=exports.apSecond=exports.apFirst=exports.ap=void 0;var function_1=require_function(),_=__importStar(require_internal());function ap(F,G){return function(fa){return function(fab){return F.ap(F.map(fab,(function(gab){return function(ga){return G.ap(gab,ga)}})),fa)}}}function apFirst(A){return function(second){return function(first){return A.ap(A.map(first,(function(a2){return function(){return a2}})),second)}}}function apSecond(A){return function(second){return function(first){return A.ap(A.map(first,(function(){return function(b2){return b2}})),second)}}}function apS(F){return function(name2,fb){return function(fa){return F.ap(F.map(fa,(function(a2){return function(b2){var _a;return Object.assign({},a2,((_a={})[name2]=b2,_a))}})),fb)}}}function getApplySemigroup(F){return function(S2){return{concat:function(first,second){return F.ap(F.map(first,(function(x){return function(y){return S2.concat(x,y)}})),second)}}}}function curried(f,n,acc){return function(x){for(var combined=Array(acc.length+1),i2=0;i2<acc.length;i2++)combined[i2]=acc[i2];return combined[acc.length]=x,0===n?f.apply(null,combined):curried(f,n-1,combined)}}__name(ap,"ap"),exports.ap=ap,__name(apFirst,"apFirst"),exports.apFirst=apFirst,__name(apSecond,"apSecond"),exports.apSecond=apSecond,__name(apS,"apS"),exports.apS=apS,__name(getApplySemigroup,"getApplySemigroup"),exports.getApplySemigroup=getApplySemigroup,__name(curried,"curried");var tupleConstructors={1:function(a2){return[a2]},2:function(a2){return function(b2){return[a2,b2]}},3:function(a2){return function(b2){return function(c){return[a2,b2,c]}}},4:function(a2){return function(b2){return function(c){return function(d){return[a2,b2,c,d]}}}},5:function(a2){return function(b2){return function(c){return function(d){return function(e){return[a2,b2,c,d,e]}}}}}};function getTupleConstructor(len){return _.has.call(tupleConstructors,len)||(tupleConstructors[len]=curried(function_1.tuple,len-1,[])),tupleConstructors[len]}function sequenceT(F){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];for(var len=args.length,f=getTupleConstructor(len),fas=F.map(args[0],f),i2=1;i2<len;i2++)fas=F.ap(fas,args[i2]);return fas}}function getRecordConstructor(keys){var len=keys.length;switch(len){case 1:return function(a2){var _a;return(_a={})[keys[0]]=a2,_a};case 2:return function(a2){return function(b2){var _a;return(_a={})[keys[0]]=a2,_a[keys[1]]=b2,_a}};case 3:return function(a2){return function(b2){return function(c){var _a;return(_a={})[keys[0]]=a2,_a[keys[1]]=b2,_a[keys[2]]=c,_a}}};case 4:return function(a2){return function(b2){return function(c){return function(d){var _a;return(_a={})[keys[0]]=a2,_a[keys[1]]=b2,_a[keys[2]]=c,_a[keys[3]]=d,_a}}}};case 5:return function(a2){return function(b2){return function(c){return function(d){return function(e){var _a;return(_a={})[keys[0]]=a2,_a[keys[1]]=b2,_a[keys[2]]=c,_a[keys[3]]=d,_a[keys[4]]=e,_a}}}}};default:return curried((function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];for(var r={},i2=0;i2<len;i2++)r[keys[i2]]=args[i2];return r}),len-1,[])}}function sequenceS(F){return function(r){for(var keys=Object.keys(r),len=keys.length,f=getRecordConstructor(keys),fr=F.map(r[keys[0]],f),i2=1;i2<len;i2++)fr=F.ap(fr,r[keys[i2]]);return fr}}__name(getTupleConstructor,"getTupleConstructor"),__name(sequenceT,"sequenceT"),exports.sequenceT=sequenceT,__name(getRecordConstructor,"getRecordConstructor"),__name(sequenceS,"sequenceS"),exports.sequenceS=sequenceS}}),require_Functor=__commonJS({"node_modules/fp-ts/lib/Functor.js"(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFunctorComposition=exports.let=exports.bindTo=exports.flap=exports.map=void 0;var function_1=require_function();function map(F,G){return function(f){return function(fa){return F.map(fa,(function(ga){return G.map(ga,f)}))}}}function flap(F){return function(a2){return function(fab){return F.map(fab,(function(f){return f(a2)}))}}}function bindTo(F){return function(name2){return function(fa){return F.map(fa,(function(a2){var _a;return(_a={})[name2]=a2,_a}))}}}function let_(F){return function(name2,f){return function(fa){return F.map(fa,(function(a2){var _a;return Object.assign({},a2,((_a={})[name2]=f(a2),_a))}))}}}function getFunctorComposition(F,G){var _map=map(F,G);return{map:function(fga,f){return(0,function_1.pipe)(fga,_map(f))}}}__name(map,"map"),exports.map=map,__name(flap,"flap"),exports.flap=flap,__name(bindTo,"bindTo"),exports.bindTo=bindTo,__name(let_,"let_"),exports.let=let_,__name(getFunctorComposition,"getFunctorComposition"),exports.getFunctorComposition=getFunctorComposition}}),require_Applicative=__commonJS({"node_modules/fp-ts/lib/Applicative.js"(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.getApplicativeComposition=exports.getApplicativeMonoid=void 0;var Apply_1=require_Apply(),function_1=require_function(),Functor_1=require_Functor();function getApplicativeMonoid(F){var f=(0,Apply_1.getApplySemigroup)(F);return function(M){return{concat:f(M).concat,empty:F.of(M.empty)}}}function getApplicativeComposition(F,G){var map=(0,Functor_1.getFunctorComposition)(F,G).map,_ap=(0,Apply_1.ap)(F,G);return{map:map,of:function(a2){return F.of(G.of(a2))},ap:function(fgab,fga){return(0,function_1.pipe)(fgab,_ap(fga))}}}__name(getApplicativeMonoid,"getApplicativeMonoid"),exports.getApplicativeMonoid=getApplicativeMonoid,__name(getApplicativeComposition,"getApplicativeComposition"),exports.getApplicativeComposition=getApplicativeComposition}}),require_Chain=__commonJS({"node_modules/fp-ts/lib/Chain.js"(exports){function chainFirst(M){return function(f){return function(first){return M.chain(first,(function(a2){return M.map(f(a2),(function(){return a2}))}))}}}function bind(M){return function(name2,f){return function(ma){return M.chain(ma,(function(a2){return M.map(f(a2),(function(b2){var _a;return Object.assign({},a2,((_a={})[name2]=b2,_a))}))}))}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.bind=exports.chainFirst=void 0,__name(chainFirst,"chainFirst"),exports.chainFirst=chainFirst,__name(bind,"bind"),exports.bind=bind}}),require_ChainRec=__commonJS({"node_modules/fp-ts/lib/ChainRec.js"(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.tailRec=void 0;var tailRec=__name((function(startWith,f){for(var ab=f(startWith);"Left"===ab._tag;)ab=f(ab.left);return ab.right}),"tailRec");exports.tailRec=tailRec}}),require_FromEither=__commonJS({"node_modules/fp-ts/lib/FromEither.js"(exports){var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.filterOrElse=exports.chainFirstEitherK=exports.chainEitherK=exports.fromEitherK=exports.chainOptionK=exports.fromOptionK=exports.fromPredicate=exports.fromOption=void 0;var Chain_1=require_Chain(),function_1=require_function(),_=__importStar(require_internal());function fromOption(F){return function(onNone){return function(ma){return F.fromEither(_.isNone(ma)?_.left(onNone()):_.right(ma.value))}}}function fromPredicate(F){return function(predicate,onFalse){return function(a2){return F.fromEither(predicate(a2)?_.right(a2):_.left(onFalse(a2)))}}}function fromOptionK(F){var fromOptionF=fromOption(F);return function(onNone){var from=fromOptionF(onNone);return function(f){return(0,function_1.flow)(f,from)}}}function chainOptionK(F,M){var fromOptionKF=fromOptionK(F);return function(onNone){var from=fromOptionKF(onNone);return function(f){return function(ma){return M.chain(ma,from(f))}}}}function fromEitherK(F){return function(f){return(0,function_1.flow)(f,F.fromEither)}}function chainEitherK(F,M){var fromEitherKF=fromEitherK(F);return function(f){return function(ma){return M.chain(ma,fromEitherKF(f))}}}function chainFirstEitherK(F,M){return(0,function_1.flow)(fromEitherK(F),(0,Chain_1.chainFirst)(M))}function filterOrElse(F,M){return function(predicate,onFalse){return function(ma){return M.chain(ma,(function(a2){return F.fromEither(predicate(a2)?_.right(a2):_.left(onFalse(a2)))}))}}}__name(fromOption,"fromOption"),exports.fromOption=fromOption,__name(fromPredicate,"fromPredicate"),exports.fromPredicate=fromPredicate,__name(fromOptionK,"fromOptionK"),exports.fromOptionK=fromOptionK,__name(chainOptionK,"chainOptionK"),exports.chainOptionK=chainOptionK,__name(fromEitherK,"fromEitherK"),exports.fromEitherK=fromEitherK,__name(chainEitherK,"chainEitherK"),exports.chainEitherK=chainEitherK,__name(chainFirstEitherK,"chainFirstEitherK"),exports.chainFirstEitherK=chainFirstEitherK,__name(filterOrElse,"filterOrElse"),exports.filterOrElse=filterOrElse}}),require_Separated=__commonJS({"node_modules/fp-ts/lib/Separated.js"(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.right=exports.left=exports.flap=exports.Functor=exports.Bifunctor=exports.URI=exports.bimap=exports.mapLeft=exports.map=exports.separated=void 0;var function_1=require_function(),Functor_1=require_Functor(),separated=__name((function(left3,right3){return{left:left3,right:right3}}),"separated");exports.separated=separated;var _map=__name((function(fa,f){return(0,function_1.pipe)(fa,(0,exports.map)(f))}),"_map"),_mapLeft=__name((function(fa,f){return(0,function_1.pipe)(fa,(0,exports.mapLeft)(f))}),"_mapLeft"),_bimap=__name((function(fa,g,f){return(0,function_1.pipe)(fa,(0,exports.bimap)(g,f))}),"_bimap"),map=__name((function(f){return function(fa){return(0,exports.separated)((0,exports.left)(fa),f((0,exports.right)(fa)))}}),"map");exports.map=map;var mapLeft=__name((function(f){return function(fa){return(0,exports.separated)(f((0,exports.left)(fa)),(0,exports.right)(fa))}}),"mapLeft");exports.mapLeft=mapLeft;var bimap=__name((function(f,g){return function(fa){return(0,exports.separated)(f((0,exports.left)(fa)),g((0,exports.right)(fa)))}}),"bimap");exports.bimap=bimap,exports.URI="Separated",exports.Bifunctor={URI:exports.URI,mapLeft:_mapLeft,bimap:_bimap},exports.Functor={URI:exports.URI,map:_map},exports.flap=(0,Functor_1.flap)(exports.Functor);var left2=__name((function(s){return s.left}),"left");exports.left=left2;var right2=__name((function(s){return s.right}),"right");exports.right=right2}}),require_Witherable=__commonJS({"node_modules/fp-ts/lib/Witherable.js"(exports){var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.filterE=exports.witherDefault=exports.wiltDefault=void 0;var _=__importStar(require_internal());function wiltDefault(T,C){return function(F){var traverseF=T.traverse(F);return function(wa,f){return F.map(traverseF(wa,f),C.separate)}}}function witherDefault(T,C){return function(F){var traverseF=T.traverse(F);return function(wa,f){return F.map(traverseF(wa,f),C.compact)}}}function filterE(W){return function(F){var witherF=W.wither(F);return function(predicate){return function(ga){return witherF(ga,(function(a2){return F.map(predicate(a2),(function(b2){return b2?_.some(a2):_.none}))}))}}}}__name(wiltDefault,"wiltDefault"),exports.wiltDefault=wiltDefault,__name(witherDefault,"witherDefault"),exports.witherDefault=witherDefault,__name(filterE,"filterE"),exports.filterE=filterE}}),require_Either=__commonJS({"node_modules/fp-ts/lib/Either.js"(exports){var __createBinding=exports&&exports.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=exports&&exports.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=exports&&exports.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.fold=exports.match=exports.foldW=exports.matchW=exports.isRight=exports.isLeft=exports.fromOption=exports.fromPredicate=exports.FromEither=exports.MonadThrow=exports.throwError=exports.ChainRec=exports.Extend=exports.extend=exports.Alt=exports.alt=exports.altW=exports.Bifunctor=exports.mapLeft=exports.bimap=exports.Traversable=exports.sequence=exports.traverse=exports.Foldable=exports.reduceRight=exports.foldMap=exports.reduce=exports.Monad=exports.Chain=exports.chain=exports.chainW=exports.Applicative=exports.Apply=exports.ap=exports.apW=exports.Pointed=exports.of=exports.Functor=exports.map=exports.getAltValidation=exports.getApplicativeValidation=exports.getWitherable=exports.getFilterable=exports.getCompactable=exports.getSemigroup=exports.getEq=exports.getShow=exports.URI=exports.right=exports.left=void 0,exports.getValidation=exports.getValidationMonoid=exports.getValidationSemigroup=exports.getApplyMonoid=exports.getApplySemigroup=exports.either=exports.stringifyJSON=exports.parseJSON=exports.sequenceArray=exports.traverseArray=exports.traverseArrayWithIndex=exports.traverseReadonlyArrayWithIndex=exports.traverseReadonlyNonEmptyArrayWithIndex=exports.ApT=exports.apSW=exports.apS=exports.bindW=exports.bind=exports.let=exports.bindTo=exports.Do=exports.exists=exports.elem=exports.toError=exports.toUnion=exports.chainNullableK=exports.fromNullableK=exports.tryCatchK=exports.tryCatch=exports.fromNullable=exports.orElse=exports.orElseW=exports.swap=exports.filterOrElseW=exports.filterOrElse=exports.chainOptionK=exports.fromOptionK=exports.duplicate=exports.flatten=exports.flattenW=exports.chainFirstW=exports.chainFirst=exports.apSecondW=exports.apSecond=exports.apFirstW=exports.apFirst=exports.flap=exports.getOrElse=exports.getOrElseW=void 0;var Applicative_1=require_Applicative(),Apply_1=require_Apply(),Chain_1=require_Chain(),ChainRec_1=require_ChainRec(),FromEither_1=require_FromEither(),function_1=require_function(),Functor_1=require_Functor(),_=__importStar(require_internal()),Separated_1=require_Separated(),Witherable_1=require_Witherable();exports.left=_.left,exports.right=_.right;var _map=__name((function(fa,f){return(0,function_1.pipe)(fa,(0,exports.map)(f))}),"_map"),_ap=__name((function(fab,fa){return(0,function_1.pipe)(fab,(0,exports.ap)(fa))}),"_ap"),_chain=__name((function(ma,f){return(0,function_1.pipe)(ma,(0,exports.chain)(f))}),"_chain"),_reduce=__name((function(fa,b2,f){return(0,function_1.pipe)(fa,(0,exports.reduce)(b2,f))}),"_reduce"),_foldMap=__name((function(M){return function(fa,f){var foldMapM=(0,exports.foldMap)(M);return(0,function_1.pipe)(fa,foldMapM(f))}}),"_foldMap"),_reduceRight=__name((function(fa,b2,f){return(0,function_1.pipe)(fa,(0,exports.reduceRight)(b2,f))}),"_reduceRight"),_traverse=__name((function(F){var traverseF=(0,exports.traverse)(F);return function(ta,f){return(0,function_1.pipe)(ta,traverseF(f))}}),"_traverse"),_bimap=__name((function(fa,f,g){return(0,function_1.pipe)(fa,(0,exports.bimap)(f,g))}),"_bimap"),_mapLeft=__name((function(fa,f){return(0,function_1.pipe)(fa,(0,exports.mapLeft)(f))}),"_mapLeft"),_alt=__name((function(fa,that){return(0,function_1.pipe)(fa,(0,exports.alt)(that))}),"_alt"),_extend=__name((function(wa,f){return(0,function_1.pipe)(wa,(0,exports.extend)(f))}),"_extend"),_chainRec=__name((function(a2,f){return(0,ChainRec_1.tailRec)(f(a2),(function(e){return(0,exports.isLeft)(e)?(0,exports.right)((0,exports.left)(e.left)):(0,exports.isLeft)(e.right)?(0,exports.left)(f(e.right.left)):(0,exports.right)((0,exports.right)(e.right.right))}))}),"_chainRec");exports.URI="Either";var getShow=__name((function(SE,SA){return{show:function(ma){return(0,exports.isLeft)(ma)?"left(".concat(SE.show(ma.left),")"):"right(".concat(SA.show(ma.right),")")}}}),"getShow");exports.getShow=getShow;var getEq=__name((function(EL,EA){return{equals:function(x,y){return x===y||((0,exports.isLeft)(x)?(0,exports.isLeft)(y)&&EL.equals(x.left,y.left):(0,exports.isRight)(y)&&EA.equals(x.right,y.right))}}}),"getEq");exports.getEq=getEq;var getSemigroup=__name((function(S2){return{concat:function(x,y){return(0,exports.isLeft)(y)?x:(0,exports.isLeft)(x)?y:(0,exports.right)(S2.concat(x.right,y.right))}}}),"getSemigroup");exports.getSemigroup=getSemigroup;var getCompactable=__name((function(M){var empty=(0,exports.left)(M.empty);return{URI:exports.URI,_E:void 0,compact:function(ma){return(0,exports.isLeft)(ma)?ma:"None"===ma.right._tag?empty:(0,exports.right)(ma.right.value)},separate:function(ma){return(0,exports.isLeft)(ma)?(0,Separated_1.separated)(ma,ma):(0,exports.isLeft)(ma.right)?(0,Separated_1.separated)((0,exports.right)(ma.right.left),empty):(0,Separated_1.separated)(empty,(0,exports.right)(ma.right.right))}}}),"getCompactable");exports.getCompactable=getCompactable;var getFilterable=__name((function(M){var empty=(0,exports.left)(M.empty),_a=(0,exports.getCompactable)(M),compact=_a.compact,separate=_a.separate,filter=__name((function(ma,predicate){return(0,exports.isLeft)(ma)||predicate(ma.right)?ma:empty}),"filter"),partition=__name((function(ma,p){return(0,exports.isLeft)(ma)?(0,Separated_1.separated)(ma,ma):p(ma.right)?(0,Separated_1.separated)(empty,(0,exports.right)(ma.right)):(0,Separated_1.separated)((0,exports.right)(ma.right),empty)}),"partition");return{URI:exports.URI,_E:void 0,map:_map,compact:compact,separate:separate,filter:filter,filterMap:function(ma,f){if((0,exports.isLeft)(ma))return ma;var ob=f(ma.right);return"None"===ob._tag?empty:(0,exports.right)(ob.value)},partition:partition,partitionMap:function(ma,f){if((0,exports.isLeft)(ma))return(0,Separated_1.separated)(ma,ma);var e=f(ma.right);return(0,exports.isLeft)(e)?(0,Separated_1.separated)((0,exports.right)(e.left),empty):(0,Separated_1.separated)(empty,(0,exports.right)(e.right))}}}),"getFilterable");exports.getFilterable=getFilterable;var getWitherable=__name((function(M){var F_=(0,exports.getFilterable)(M),C=(0,exports.getCompactable)(M);return{URI:exports.URI,_E:void 0,map:_map,compact:F_.compact,separate:F_.separate,filter:F_.filter,filterMap:F_.filterMap,partition:F_.partition,partitionMap:F_.partitionMap,traverse:_traverse,sequence:exports.sequence,reduce:_reduce,foldMap:_foldMap,reduceRight:_reduceRight,wither:(0,Witherable_1.witherDefault)(exports.Traversable,C),wilt:(0,Witherable_1.wiltDefault)(exports.Traversable,C)}}),"getWitherable");exports.getWitherable=getWitherable;var getApplicativeValidation=__name((function(SE){return{URI:exports.URI,_E:void 0,map:_map,ap:function(fab,fa){return(0,exports.isLeft)(fab)?(0,exports.isLeft)(fa)?(0,exports.left)(SE.concat(fab.left,fa.left)):fab:(0,exports.isLeft)(fa)?fa:(0,exports.right)(fab.right(fa.right))},of:exports.of}}),"getApplicativeValidation");exports.getApplicativeValidation=getApplicativeValidation;var getAltValidation=__name((function(SE){return{URI:exports.URI,_E:void 0,map:_map,alt:function(me,that){if((0,exports.isRight)(me))return me;var ea=that();return(0,exports.isLeft)(ea)?(0,exports.left)(SE.concat(me.left,ea.left)):ea}}}),"getAltValidation");exports.getAltValidation=getAltValidation;var map=__name((function(f){return function(fa){return(0,exports.isLeft)(fa)?fa:(0,exports.right)(f(fa.right))}}),"map");exports.map=map,exports.Functor={URI:exports.URI,map:_map},exports.of=exports.right,exports.Pointed={URI:exports.URI,of:exports.of};var apW=__name((function(fa){return function(fab){return(0,exports.isLeft)(fab)?fab:(0,exports.isLeft)(fa)?fa:(0,exports.right)(fab.right(fa.right))}}),"apW");exports.apW=apW,exports.ap=exports.apW,exports.Apply={URI:exports.URI,map:_map,ap:_ap},exports.Applicative={URI:exports.URI,map:_map,ap:_ap,of:exports.of};var chainW=__name((function(f){return function(ma){return(0,exports.isLeft)(ma)?ma:f(ma.right)}}),"chainW");exports.chainW=chainW,exports.chain=exports.chainW,exports.Chain={URI:exports.URI,map:_map,ap:_ap,chain:_chain},exports.Monad={URI:exports.URI,map:_map,ap:_ap,of:exports.of,chain:_chain};var reduce=__name((function(b2,f){return function(fa){return(0,exports.isLeft)(fa)?b2:f(b2,fa.right)}}),"reduce");exports.reduce=reduce;var foldMap=__name((function(M){return function(f){return function(fa){return(0,exports.isLeft)(fa)?M.empty:f(fa.right)}}}),"foldMap");exports.foldMap=foldMap;var reduceRight=__name((function(b2,f){return function(fa){return(0,exports.isLeft)(fa)?b2:f(fa.right,b2)}}),"reduceRight");exports.reduceRight=reduceRight,exports.Foldable={URI:exports.URI,reduce:_reduce,foldMap:_foldMap,reduceRight:_reduceRight};var traverse=__name((function(F){return function(f){return function(ta){return(0,exports.isLeft)(ta)?F.of((0,exports.left)(ta.left)):F.map(f(ta.right),exports.right)}}}),"traverse");exports.traverse=traverse;var sequence=__name((function(F){return function(ma){return(0,exports.isLeft)(ma)?F.of((0,exports.left)(ma.left)):F.map(ma.right,exports.right)}}),"sequence");exports.sequence=sequence,exports.Traversable={URI:exports.URI,map:_map,reduce:_reduce,foldMap:_foldMap,reduceRight:_reduceRight,traverse:_traverse,sequence:exports.sequence};var bimap=__name((function(f,g){return function(fa){return(0,exports.isLeft)(fa)?(0,exports.left)(f(fa.left)):(0,exports.right)(g(fa.right))}}),"bimap");exports.bimap=bimap;var mapLeft=__name((function(f){return function(fa){return(0,exports.isLeft)(fa)?(0,exports.left)(f(fa.left)):fa}}),"mapLeft");exports.mapLeft=mapLeft,exports.Bifunctor={URI:exports.URI,bimap:_bimap,mapLeft:_mapLeft};var altW=__name((function(that){return function(fa){return(0,exports.isLeft)(fa)?that():fa}}),"altW");exports.altW=altW,exports.alt=exports.altW,exports.Alt={URI:exports.URI,map:_map,alt:_alt};var extend=__name((function(f){return function(wa){return(0,exports.isLeft)(wa)?wa:(0,exports.right)(f(wa))}}),"extend");exports.extend=extend,exports.Extend={URI:exports.URI,map:_map,extend:_extend},exports.ChainRec={URI:exports.URI,map:_map,ap:_ap,chain:_chain,chainRec:_chainRec},exports.throwError=exports.left,exports.MonadThrow={URI:exports.URI,map:_map,ap:_ap,of:exports.of,chain:_chain,throwError:exports.throwError},exports.FromEither={URI:exports.URI,fromEither:function_1.identity},exports.fromPredicate=(0,FromEither_1.fromPredicate)(exports.FromEither),exports.fromOption=(0,FromEither_1.fromOption)(exports.FromEither),exports.isLeft=_.isLeft,exports.isRight=_.isRight;var matchW=__name((function(onLeft,onRight){return function(ma){return(0,exports.isLeft)(ma)?onLeft(ma.left):onRight(ma.right)}}),"matchW");exports.matchW=matchW,exports.foldW=exports.matchW,exports.match=exports.matchW,exports.fold=exports.match;var getOrElseW=__name((function(onLeft){return function(ma){return(0,exports.isLeft)(ma)?onLeft(ma.left):ma.right}}),"getOrElseW");exports.getOrElseW=getOrElseW,exports.getOrElse=exports.getOrElseW,exports.flap=(0,Functor_1.flap)(exports.Functor),exports.apFirst=(0,Apply_1.apFirst)(exports.Apply),exports.apFirstW=exports.apFirst,exports.apSecond=(0,Apply_1.apSecond)(exports.Apply),exports.apSecondW=exports.apSecond,exports.chainFirst=(0,Chain_1.chainFirst)(exports.Chain),exports.chainFirstW=exports.chainFirst,exports.flattenW=(0,exports.chainW)(function_1.identity),exports.flatten=exports.flattenW,exports.duplicate=(0,exports.extend)(function_1.identity),exports.fromOptionK=(0,FromEither_1.fromOptionK)(exports.FromEither),exports.chainOptionK=(0,FromEither_1.chainOptionK)(exports.FromEither,exports.Chain),exports.filterOrElse=(0,FromEither_1.filterOrElse)(exports.FromEither,exports.Chain),exports.filterOrElseW=exports.filterOrElse;var swap=__name((function(ma){return(0,exports.isLeft)(ma)?(0,exports.right)(ma.left):(0,exports.left)(ma.right)}),"swap");exports.swap=swap;var orElseW=__name((function(onLeft){return function(ma){return(0,exports.isLeft)(ma)?onLeft(ma.left):ma}}),"orElseW");exports.orElseW=orElseW,exports.orElse=exports.orElseW;var fromNullable=__name((function(e){return function(a2){return null==a2?(0,exports.left)(e):(0,exports.right)(a2)}}),"fromNullable");exports.fromNullable=fromNullable;var tryCatch=__name((function(f,onThrow){try{return(0,exports.right)(f())}catch(e){return(0,exports.left)(onThrow(e))}}),"tryCatch");exports.tryCatch=tryCatch;var tryCatchK=__name((function(f,onThrow){return function(){for(var a2=[],_i=0;_i<arguments.length;_i++)a2[_i]=arguments[_i];return(0,exports.tryCatch)((function(){return f.apply(void 0,a2)}),onThrow)}}),"tryCatchK");exports.tryCatchK=tryCatchK;var fromNullableK=__name((function(e){var from=(0,exports.fromNullable)(e);return function(f){return(0,function_1.flow)(f,from)}}),"fromNullableK");exports.fromNullableK=fromNullableK;var chainNullableK=__name((function(e){var from=(0,exports.fromNullableK)(e);return function(f){return(0,exports.chain)(from(f))}}),"chainNullableK");function toError(e){return e instanceof Error?e:new Error(String(e))}function elem(E){return function(a2,ma){if(void 0===ma){var elemE_1=elem(E);return function(ma2){return elemE_1(a2,ma2)}}return!(0,exports.isLeft)(ma)&&E.equals(a2,ma.right)}}exports.chainNullableK=chainNullableK,exports.toUnion=(0,exports.foldW)(function_1.identity,function_1.identity),__name(toError,"toError"),exports.toError=toError,__name(elem,"elem"),exports.elem=elem;var exists=__name((function(predicate){return function(ma){return!(0,exports.isLeft)(ma)&&predicate(ma.right)}}),"exists");exports.exists=exists,exports.Do=(0,exports.of)(_.emptyRecord),exports.bindTo=(0,Functor_1.bindTo)(exports.Functor);var let_=(0,Functor_1.let)(exports.Functor);exports.let=let_,exports.bind=(0,Chain_1.bind)(exports.Chain),exports.bindW=exports.bind,exports.apS=(0,Apply_1.apS)(exports.Apply),exports.apSW=exports.apS,exports.ApT=(0,exports.of)(_.emptyReadonlyArray);var traverseReadonlyNonEmptyArrayWithIndex=__name((function(f){return function(as){var e=f(0,_.head(as));if((0,exports.isLeft)(e))return e;for(var out=[e.right],i2=1;i2<as.length;i2++){var e_1=f(i2,as[i2]);if((0,exports.isLeft)(e_1))return e_1;out.push(e_1.right)}return(0,exports.right)(out)}}),"traverseReadonlyNonEmptyArrayWithIndex");exports.traverseReadonlyNonEmptyArrayWithIndex=traverseReadonlyNonEmptyArrayWithIndex;var traverseReadonlyArrayWithIndex=__name((function(f){var g=(0,exports.traverseReadonlyNonEmptyArrayWithIndex)(f);return function(as){return _.isNonEmpty(as)?g(as):exports.ApT}}),"traverseReadonlyArrayWithIndex");exports.traverseReadonlyArrayWithIndex=traverseReadonlyArrayWithIndex,exports.traverseArrayWithIndex=exports.traverseReadonlyArrayWithIndex;var traverseArray=__name((function(f){return(0,exports.traverseReadonlyArrayWithIndex)((function(_2,a2){return f(a2)}))}),"traverseArray");function parseJSON(s,onError){return(0,exports.tryCatch)((function(){return JSON.parse(s)}),onError)}exports.traverseArray=traverseArray,exports.sequenceArray=(0,exports.traverseArray)(function_1.identity),__name(parseJSON,"parseJSON"),exports.parseJSON=parseJSON;var stringifyJSON=__name((function(u,onError){return(0,exports.tryCatch)((function(){var s=JSON.stringify(u);if("string"!=typeof s)throw new Error("Converting unsupported structure to JSON");return s}),onError)}),"stringifyJSON");exports.stringifyJSON=stringifyJSON,exports.either={URI:exports.URI,map:_map,of:exports.of,ap:_ap,chain:_chain,reduce:_reduce,foldMap:_foldMap,reduceRight:_reduceRight,traverse:_traverse,sequence:exports.sequence,bimap:_bimap,mapLeft:_mapLeft,alt:_alt,extend:_extend,chainRec:_chainRec,throwError:exports.throwError},exports.getApplySemigroup=(0,Apply_1.getApplySemigroup)(exports.Apply),exports.getApplyMonoid=(0,Applicative_1.getApplicativeMonoid)(exports.Applicative);var getValidationSemigroup=__name((function(SE,SA){return(0,Apply_1.getApplySemigroup)((0,exports.getApplicativeValidation)(SE))(SA)}),"getValidationSemigroup");exports.getValidationSemigroup=getValidationSemigroup;var getValidationMonoid=__name((function(SE,MA){return(0,Applicative_1.getApplicativeMonoid)((0,exports.getApplicativeValidation)(SE))(MA)}),"getValidationMonoid");function getValidation(SE){var ap=(0,exports.getApplicativeValidation)(SE).ap,alt=(0,exports.getAltValidation)(SE).alt;return{URI:exports.URI,_E:void 0,map:_map,of:exports.of,chain:_chain,bimap:_bimap,mapLeft:_mapLeft,reduce:_reduce,foldMap:_foldMap,reduceRight:_reduceRight,extend:_extend,traverse:_traverse,sequence:exports.sequence,chainRec:_chainRec,throwError:exports.throwError,ap:ap,alt:alt}}exports.getValidationMonoid=getValidationMonoid,__name(getValidation,"getValidation"),exports.getValidation=getValidation}}),require_lib=__commonJS({"node_modules/io-ts/lib/index.js"(exports){var extendStatics,__extends=exports&&exports.__extends||(extendStatics=__name((function(d,b2){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d2,b3){d2.__proto__=b3}||function(d2,b3){for(var p in b3)Object.prototype.hasOwnProperty.call(b3,p)&&(d2[p]=b3[p])})(d,b2)}),"extendStatics"),function(d,b2){function __(){this.constructor=d}extendStatics(d,b2),__name(__,"__"),d.prototype=null===b2?Object.create(b2):(__.prototype=b2.prototype,new __)}),__assign=exports&&exports.__assign||function(){return __assign=Object.assign||function(t38){for(var s,i2=1,n=arguments.length;i2<n;i2++)for(var p in s=arguments[i2])Object.prototype.hasOwnProperty.call(s,p)&&(t38[p]=s[p]);return t38},__assign.apply(this,arguments)},__spreadArrays=exports&&exports.__spreadArrays||function(){for(var s=0,i2=0,il=arguments.length;i2<il;i2++)s+=arguments[i2].length;var r=Array(s),k=0;for(i2=0;i2<il;i2++)for(var a2=arguments[i2],j=0,jl=a2.length;j<jl;j++,k++)r[k]=a2[j];return r};Object.defineProperty(exports,"__esModule",{value:!0}),exports.partial=exports.PartialType=exports.type=exports.InterfaceType=exports.array=exports.ArrayType=exports.recursion=exports.RecursiveType=exports.Int=exports.brand=exports.RefinementType=exports.keyof=exports.KeyofType=exports.literal=exports.LiteralType=exports.void=exports.undefined=exports.null=exports.UnknownRecord=exports.AnyDictionaryType=exports.UnknownArray=exports.AnyArrayType=exports.boolean=exports.BooleanType=exports.bigint=exports.BigIntType=exports.number=exports.NumberType=exports.string=exports.StringType=exports.unknown=exports.UnknownType=exports.voidType=exports.VoidType=exports.UndefinedType=exports.nullType=exports.NullType=exports.getIndex=exports.getTags=exports.emptyTags=exports.mergeAll=exports.getDomainKeys=exports.appendContext=exports.getContextEntry=exports.getFunctionName=exports.identity=exports.Type=exports.success=exports.failure=exports.failures=void 0,exports.alias=exports.clean=exports.StrictType=exports.dictionary=exports.Integer=exports.refinement=exports.object=exports.ObjectType=exports.Dictionary=exports.any=exports.AnyType=exports.never=exports.NeverType=exports.getDefaultContext=exports.getValidationError=exports.interface=exports.Array=exports.taggedUnion=exports.TaggedUnionType=exports.Function=exports.FunctionType=exports.exact=exports.ExactType=exports.strict=exports.readonlyArray=exports.ReadonlyArrayType=exports.readonly=exports.ReadonlyType=exports.tuple=exports.TupleType=exports.intersection=exports.IntersectionType=exports.union=exports.UnionType=exports.record=exports.DictionaryType=void 0;var Either_1=require_Either();exports.failures=Either_1.left;var failure2=__name((function(value,context,message){return exports.failures([{value:value,context:context,message:message}])}),"failure");exports.failure=failure2,exports.success=Either_1.right;var Type2=function(){function Type3(name2,is,validate,encode){this.name=name2,this.is=is,this.validate=validate,this.encode=encode,this.decode=this.decode.bind(this)}return __name(Type3,"Type"),Type3.prototype.pipe=function(ab,name2){var _this=this;return void 0===name2&&(name2="pipe("+this.name+", "+ab.name+")"),new Type3(name2,ab.is,(function(i2,c){var e=_this.validate(i2,c);return Either_1.isLeft(e)?e:ab.validate(e.right,c)}),this.encode===exports.identity&&ab.encode===exports.identity?exports.identity:function(b2){return _this.encode(ab.encode(b2))})},Type3.prototype.asDecoder=function(){return this},Type3.prototype.asEncoder=function(){return this},Type3.prototype.decode=function(i2){return this.validate(i2,[{key:"",type:this,actual:i2}])},Type3}();exports.Type=Type2;var identity2=__name((function(a2){return a2}),"identity");function getFunctionName(f){return f.displayName||f.name||"<function"+f.length+">"}function getContextEntry(key,decoder){return{key:key,type:decoder}}function appendContext(c,key,decoder,actual){for(var len=c.length,r=Array(len+1),i2=0;i2<len;i2++)r[i2]=c[i2];return r[len]={key:key,type:decoder,actual:actual},r}function pushAll(xs,ys){for(var l=ys.length,i2=0;i2<l;i2++)xs.push(ys[i2])}exports.identity=identity2,__name(getFunctionName,"getFunctionName"),exports.getFunctionName=getFunctionName,__name(getContextEntry,"getContextEntry"),exports.getContextEntry=getContextEntry,__name(appendContext,"appendContext"),exports.appendContext=appendContext,__name(pushAll,"pushAll");var hasOwnProperty=Object.prototype.hasOwnProperty;function getNameFromProps(props){return Object.keys(props).map((function(k){return k+": "+props[k].name})).join(", ")}function useIdentity(codecs){for(var i2=0;i2<codecs.length;i2++)if(codecs[i2].encode!==exports.identity)return!1;return!0}function getInterfaceTypeName(props){return"{ "+getNameFromProps(props)+" }"}function getPartialTypeName(inner){return"Partial<"+inner+">"}function enumerableRecord(keys,domain,codomain,name2){void 0===name2&&(name2="{ [K in "+domain.name+"]: "+codomain.name+" }");var len=keys.length;return new DictionaryType(name2,(function(u){return exports.UnknownRecord.is(u)&&keys.every((function(k){return codomain.is(u[k])}))}),(function(u,c){var e=exports.UnknownRecord.validate(u,c);if(Either_1.isLeft(e))return e;for(var o=e.right,a2={},errors=[],changed=!1,i2=0;i2<len;i2++){var k=keys[i2],ok=o[k],codomainResult=codomain.validate(ok,appendContext(c,k,codomain,ok));if(Either_1.isLeft(codomainResult))pushAll(errors,codomainResult.left);else{var vok=codomainResult.right;changed=changed||vok!==ok,a2[k]=vok}}return errors.length>0?exports.failures(errors):exports.success(changed||Object.keys(o).length!==len?a2:o)}),codomain.encode===exports.identity?exports.identity:function(a2){for(var s={},i2=0;i2<len;i2++){var k=keys[i2];s[k]=codomain.encode(a2[k])}return s},domain,codomain)}function getDomainKeys(domain){var _a;if(isLiteralC(domain)){var literal_1=domain.value;if(exports.string.is(literal_1))return(_a={})[literal_1]=null,_a}else{if(isKeyofC(domain))return domain.keys;if(isUnionC(domain)){var keys=domain.types.map((function(type8){return getDomainKeys(type8)}));return keys.some(undefinedType.is)?void 0:Object.assign.apply(Object,__spreadArrays([{}],keys))}}}function nonEnumerableRecord(domain,codomain,name2){return void 0===name2&&(name2="{ [K in "+domain.name+"]: "+codomain.name+" }"),new DictionaryType(name2,(function(u){return exports.UnknownRecord.is(u)?Object.keys(u).every((function(k){return domain.is(k)&&codomain.is(u[k])})):isAnyC(codomain)&&Array.isArray(u)}),(function(u,c){if(exports.UnknownRecord.is(u)){for(var a2={},errors=[],keys=Object.keys(u),len=keys.length,changed=!1,i2=0;i2<len;i2++){var k=keys[i2],ok=u[k],domainResult=domain.validate(k,appendContext(c,k,domain,k));if(Either_1.isLeft(domainResult))pushAll(errors,domainResult.left);else{var vk=domainResult.right;changed=changed||vk!==k,k=vk;var codomainResult=codomain.validate(ok,appendContext(c,k,codomain,ok));if(Either_1.isLeft(codomainResult))pushAll(errors,codomainResult.left);else{var vok=codomainResult.right;changed=changed||vok!==ok,a2[k]=vok}}}return errors.length>0?exports.failures(errors):exports.success(changed?a2:u)}return isAnyC(codomain)&&Array.isArray(u)?exports.success(u):exports.failure(u,c)}),domain.encode===exports.identity&&codomain.encode===exports.identity?exports.identity:function(a2){for(var s={},keys=Object.keys(a2),len=keys.length,i2=0;i2<len;i2++){var k=keys[i2];s[String(domain.encode(k))]=codomain.encode(a2[k])}return s},domain,codomain)}function getUnionName(codecs){return"("+codecs.map((function(type8){return type8.name})).join(" | ")+")"}function mergeAll(base,us){for(var equal=!0,primitive=!0,baseIsNotADictionary=!exports.UnknownRecord.is(base),_i=0,us_1=us;_i<us_1.length;_i++){(u=us_1[_i])!==base&&(equal=!1),exports.UnknownRecord.is(u)&&(primitive=!1)}if(equal)return base;if(primitive)return us[us.length-1];for(var r={},_a=0,us_2=us;_a<us_2.length;_a++){var u=us_2[_a];for(var k in u)r.hasOwnProperty(k)&&!baseIsNotADictionary&&u[k]===base[k]||(r[k]=u[k])}return r}function getProps(codec){switch(codec._tag){case"RefinementType":case"ReadonlyType":return getProps(codec.type);case"InterfaceType":case"StrictType":case"PartialType":return codec.props;case"IntersectionType":return codec.types.reduce((function(props,type8){return Object.assign(props,getProps(type8))}),{})}}function stripKeys(o,props){for(var keys=Object.getOwnPropertyNames(o),shouldStrip=!1,r={},i2=0;i2<keys.length;i2++){var key=keys[i2];hasOwnProperty.call(props,key)?r[key]=o[key]:shouldStrip=!0}return shouldStrip?r:o}function getExactTypeName(codec){return isTypeC(codec)?"{| "+getNameFromProps(codec.props)+" |}":isPartialC(codec)?getPartialTypeName("{| "+getNameFromProps(codec.props)+" |}"):"Exact<"+codec.name+">"}function isNonEmpty(as){return as.length>0}function intersect(a2,b2){for(var r=[],_i=0,a_1=a2;_i<a_1.length;_i++){var v=a_1[_i];-1!==b2.indexOf(v)&&r.push(v)}return r}function mergeTags(a2,b2){if(a2===exports.emptyTags)return b2;if(b2===exports.emptyTags)return a2;var r=Object.assign({},a2);for(var k in b2)if(a2.hasOwnProperty(k)){var intersection_1=intersect(a2[k],b2[k]);if(!isNonEmpty(intersection_1)){r=exports.emptyTags;break}r[k]=intersection_1}else r[k]=b2[k];return r}function intersectTags(a2,b2){if(a2===exports.emptyTags||b2===exports.emptyTags)return exports.emptyTags;var r=exports.emptyTags;for(var k in a2){if(b2.hasOwnProperty(k))0===intersect(a2[k],b2[k]).length&&(r===exports.emptyTags&&(r={}),r[k]=a2[k].concat(b2[k]))}return r}function isAnyC(codec){return"AnyType"===codec._tag}function isLiteralC(codec){return"LiteralType"===codec._tag}function isKeyofC(codec){return"KeyofType"===codec._tag}function isTypeC(codec){return"InterfaceType"===codec._tag}function isPartialC(codec){return"PartialType"===codec._tag}function isStrictC(codec){return"StrictType"===codec._tag}function isExactC(codec){return"ExactType"===codec._tag}function isRefinementC(codec){return"RefinementType"===codec._tag}function isIntersectionC(codec){return"IntersectionType"===codec._tag}function isUnionC(codec){return"UnionType"===codec._tag}function isRecursiveC(codec){return"RecursiveType"===codec._tag}__name(getNameFromProps,"getNameFromProps"),__name(useIdentity,"useIdentity"),__name(getInterfaceTypeName,"getInterfaceTypeName"),__name(getPartialTypeName,"getPartialTypeName"),__name(enumerableRecord,"enumerableRecord"),__name(getDomainKeys,"getDomainKeys"),exports.getDomainKeys=getDomainKeys,__name(nonEnumerableRecord,"nonEnumerableRecord"),__name(getUnionName,"getUnionName"),__name(mergeAll,"mergeAll"),exports.mergeAll=mergeAll,__name(getProps,"getProps"),__name(stripKeys,"stripKeys"),__name(getExactTypeName,"getExactTypeName"),__name(isNonEmpty,"isNonEmpty"),exports.emptyTags={},__name(intersect,"intersect"),__name(mergeTags,"mergeTags"),__name(intersectTags,"intersectTags"),__name(isAnyC,"isAnyC"),__name(isLiteralC,"isLiteralC"),__name(isKeyofC,"isKeyofC"),__name(isTypeC,"isTypeC"),__name(isPartialC,"isPartialC"),__name(isStrictC,"isStrictC"),__name(isExactC,"isExactC"),__name(isRefinementC,"isRefinementC"),__name(isIntersectionC,"isIntersectionC"),__name(isUnionC,"isUnionC"),__name(isRecursiveC,"isRecursiveC");var lazyCodecs=[];function getTags(codec){if(-1!==lazyCodecs.indexOf(codec))return exports.emptyTags;if(isTypeC(codec)||isStrictC(codec)){var index=exports.emptyTags;for(var k in codec.props){var prop=codec.props[k];isLiteralC(prop)&&(index===exports.emptyTags&&(index={}),index[k]=[prop.value])}return index}if(isExactC(codec)||isRefinementC(codec))return getTags(codec.type);if(isIntersectionC(codec))return codec.types.reduce((function(tags2,codec2){return mergeTags(tags2,getTags(codec2))}),exports.emptyTags);if(isUnionC(codec))return codec.types.slice(1).reduce((function(tags2,codec2){return intersectTags(tags2,getTags(codec2))}),getTags(codec.types[0]));if(isRecursiveC(codec)){lazyCodecs.push(codec);var tags=getTags(codec.type);return lazyCodecs.pop(),tags}return exports.emptyTags}function getIndex(codecs){for(var tags=getTags(codecs[0]),keys=Object.keys(tags),len=codecs.length,_loop_1=__name((function(k2){for(var all=tags[k2].slice(),index=[tags[k2]],i2=1;i2<len;i2++){var values=getTags(codecs[i2])[k2];if(void 0===values)return"continue-keys";if(values.some((function(v){return-1!==all.indexOf(v)})))return"continue-keys";all.push.apply(all,values),index.push(values)}return{value:[k2,index]}}),"_loop_1"),_i=0,keys_1=keys;_i<keys_1.length;_i++){var state_1=_loop_1(keys_1[_i]);if("object"==typeof state_1)return state_1.value}}__name(getTags,"getTags"),exports.getTags=getTags,__name(getIndex,"getIndex"),exports.getIndex=getIndex;var NullType=function(_super){function NullType2(){var _this=_super.call(this,"null",(function(u){return null===u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="NullType",_this}return __extends(NullType2,_super),__name(NullType2,"NullType"),NullType2}(Type2);exports.NullType=NullType,exports.nullType=new NullType,exports.null=exports.nullType;var UndefinedType=function(_super){function UndefinedType2(){var _this=_super.call(this,"undefined",(function(u){return void 0===u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="UndefinedType",_this}return __extends(UndefinedType2,_super),__name(UndefinedType2,"UndefinedType"),UndefinedType2}(Type2);exports.UndefinedType=UndefinedType;var undefinedType=new UndefinedType;exports.undefined=undefinedType;var VoidType=function(_super){function VoidType2(){var _this=_super.call(this,"void",undefinedType.is,undefinedType.validate,exports.identity)||this;return _this._tag="VoidType",_this}return __extends(VoidType2,_super),__name(VoidType2,"VoidType"),VoidType2}(Type2);exports.VoidType=VoidType,exports.voidType=new VoidType,exports.void=exports.voidType;var UnknownType=function(_super){function UnknownType2(){var _this=_super.call(this,"unknown",(function(_){return!0}),exports.success,exports.identity)||this;return _this._tag="UnknownType",_this}return __extends(UnknownType2,_super),__name(UnknownType2,"UnknownType"),UnknownType2}(Type2);exports.UnknownType=UnknownType,exports.unknown=new UnknownType;var StringType=function(_super){function StringType2(){var _this=_super.call(this,"string",(function(u){return"string"==typeof u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="StringType",_this}return __extends(StringType2,_super),__name(StringType2,"StringType"),StringType2}(Type2);exports.StringType=StringType,exports.string=new StringType;var NumberType=function(_super){function NumberType2(){var _this=_super.call(this,"number",(function(u){return"number"==typeof u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="NumberType",_this}return __extends(NumberType2,_super),__name(NumberType2,"NumberType"),NumberType2}(Type2);exports.NumberType=NumberType,exports.number=new NumberType;var BigIntType=function(_super){function BigIntType2(){var _this=_super.call(this,"bigint",(function(u){return"bigint"==typeof u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="BigIntType",_this}return __extends(BigIntType2,_super),__name(BigIntType2,"BigIntType"),BigIntType2}(Type2);exports.BigIntType=BigIntType,exports.bigint=new BigIntType;var BooleanType=function(_super){function BooleanType2(){var _this=_super.call(this,"boolean",(function(u){return"boolean"==typeof u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="BooleanType",_this}return __extends(BooleanType2,_super),__name(BooleanType2,"BooleanType"),BooleanType2}(Type2);exports.BooleanType=BooleanType,exports.boolean=new BooleanType;var AnyArrayType=function(_super){function AnyArrayType2(){var _this=_super.call(this,"UnknownArray",Array.isArray,(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="AnyArrayType",_this}return __extends(AnyArrayType2,_super),__name(AnyArrayType2,"AnyArrayType"),AnyArrayType2}(Type2);exports.AnyArrayType=AnyArrayType,exports.UnknownArray=new AnyArrayType,exports.Array=exports.UnknownArray;var AnyDictionaryType=function(_super){function AnyDictionaryType2(){var _this=_super.call(this,"UnknownRecord",(function(u){var s=Object.prototype.toString.call(u);return"[object Object]"===s||"[object Window]"===s}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="AnyDictionaryType",_this}return __extends(AnyDictionaryType2,_super),__name(AnyDictionaryType2,"AnyDictionaryType"),AnyDictionaryType2}(Type2);exports.AnyDictionaryType=AnyDictionaryType,exports.UnknownRecord=new AnyDictionaryType;var LiteralType=function(_super){function LiteralType2(name2,is,validate,encode,value){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.value=value,_this._tag="LiteralType",_this}return __extends(LiteralType2,_super),__name(LiteralType2,"LiteralType"),LiteralType2}(Type2);function literal(value,name2){void 0===name2&&(name2=JSON.stringify(value));var is=__name((function(u){return u===value}),"is");return new LiteralType(name2,is,(function(u,c){return is(u)?exports.success(value):exports.failure(u,c)}),exports.identity,value)}exports.LiteralType=LiteralType,__name(literal,"literal"),exports.literal=literal;var KeyofType=function(_super){function KeyofType2(name2,is,validate,encode,keys){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.keys=keys,_this._tag="KeyofType",_this}return __extends(KeyofType2,_super),__name(KeyofType2,"KeyofType"),KeyofType2}(Type2);function keyof16(keys,name2){void 0===name2&&(name2=Object.keys(keys).map((function(k){return JSON.stringify(k)})).join(" | "));var is=__name((function(u){return exports.string.is(u)&&hasOwnProperty.call(keys,u)}),"is");return new KeyofType(name2,is,(function(u,c){return is(u)?exports.success(u):exports.failure(u,c)}),exports.identity,keys)}exports.KeyofType=KeyofType,__name(keyof16,"keyof"),exports.keyof=keyof16;var RefinementType2=function(_super){function RefinementType3(name2,is,validate,encode,type8,predicate){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.type=type8,_this.predicate=predicate,_this._tag="RefinementType",_this}return __extends(RefinementType3,_super),__name(RefinementType3,"RefinementType"),RefinementType3}(Type2);function brand2(codec,predicate,name2){return refinement(codec,predicate,name2)}exports.RefinementType=RefinementType2,__name(brand2,"brand"),exports.brand=brand2,exports.Int=brand2(exports.number,(function(n){return Number.isInteger(n)}),"Int");var RecursiveType=function(_super){function RecursiveType2(name2,is,validate,encode,runDefinition){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.runDefinition=runDefinition,_this._tag="RecursiveType",_this}return __extends(RecursiveType2,_super),__name(RecursiveType2,"RecursiveType"),RecursiveType2}(Type2);function recursion(name2,definition){var cache,runDefinition=__name((function(){return cache||((cache=definition(Self)).name=name2),cache}),"runDefinition"),Self=new RecursiveType(name2,(function(u){return runDefinition().is(u)}),(function(u,c){return runDefinition().validate(u,c)}),(function(a2){return runDefinition().encode(a2)}),runDefinition);return Self}exports.RecursiveType=RecursiveType,Object.defineProperty(RecursiveType.prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0}),__name(recursion,"recursion"),exports.recursion=recursion;var ArrayType=function(_super){function ArrayType2(name2,is,validate,encode,type8){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.type=type8,_this._tag="ArrayType",_this}return __extends(ArrayType2,_super),__name(ArrayType2,"ArrayType"),ArrayType2}(Type2);function array8(item,name2){return void 0===name2&&(name2="Array<"+item.name+">"),new ArrayType(name2,(function(u){return exports.UnknownArray.is(u)&&u.every(item.is)}),(function(u,c){var e=exports.UnknownArray.validate(u,c);if(Either_1.isLeft(e))return e;for(var us=e.right,len=us.length,as=us,errors=[],i2=0;i2<len;i2++){var ui=us[i2],result=item.validate(ui,appendContext(c,String(i2),item,ui));if(Either_1.isLeft(result))pushAll(errors,result.left);else{var ai=result.right;ai!==ui&&(as===us&&(as=us.slice()),as[i2]=ai)}}return errors.length>0?exports.failures(errors):exports.success(as)}),item.encode===exports.identity?exports.identity:function(a2){return a2.map(item.encode)},item)}exports.ArrayType=ArrayType,__name(array8,"array"),exports.array=array8;var InterfaceType=function(_super){function InterfaceType2(name2,is,validate,encode,props){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.props=props,_this._tag="InterfaceType",_this}return __extends(InterfaceType2,_super),__name(InterfaceType2,"InterfaceType"),InterfaceType2}(Type2);function type7(props,name2){void 0===name2&&(name2=getInterfaceTypeName(props));var keys=Object.keys(props),types=keys.map((function(key){return props[key]})),len=keys.length;return new InterfaceType(name2,(function(u){if(exports.UnknownRecord.is(u)){for(var i2=0;i2<len;i2++){var k=keys[i2],uk=u[k];if(void 0===uk&&!hasOwnProperty.call(u,k)||!types[i2].is(uk))return!1}return!0}return!1}),(function(u,c){var e=exports.UnknownRecord.validate(u,c);if(Either_1.isLeft(e))return e;for(var o=e.right,a2=o,errors=[],i2=0;i2<len;i2++){var k=keys[i2],ak=a2[k],type_1=types[i2],result=type_1.validate(ak,appendContext(c,k,type_1,ak));if(Either_1.isLeft(result))pushAll(errors,result.left);else{var vak=result.right;(vak!==ak||void 0===vak&&!hasOwnProperty.call(a2,k))&&(a2===o&&(a2=__assign({},o)),a2[k]=vak)}}return errors.length>0?exports.failures(errors):exports.success(a2)}),useIdentity(types)?exports.identity:function(a2){for(var s=__assign({},a2),i2=0;i2<len;i2++){var k=keys[i2],encode=types[i2].encode;encode!==exports.identity&&(s[k]=encode(a2[k]))}return s},props)}exports.InterfaceType=InterfaceType,__name(type7,"type"),exports.type=type7,exports.interface=type7;var PartialType=function(_super){function PartialType2(name2,is,validate,encode,props){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.props=props,_this._tag="PartialType",_this}return __extends(PartialType2,_super),__name(PartialType2,"PartialType"),PartialType2}(Type2);function partial4(props,name2){void 0===name2&&(name2=getPartialTypeName(getInterfaceTypeName(props)));var keys=Object.keys(props),types=keys.map((function(key){return props[key]})),len=keys.length;return new PartialType(name2,(function(u){if(exports.UnknownRecord.is(u)){for(var i2=0;i2<len;i2++){var k=keys[i2],uk=u[k];if(void 0!==uk&&!props[k].is(uk))return!1}return!0}return!1}),(function(u,c){var e=exports.UnknownRecord.validate(u,c);if(Either_1.isLeft(e))return e;for(var o=e.right,a2=o,errors=[],i2=0;i2<len;i2++){var k=keys[i2],ak=a2[k],type_2=props[k],result=type_2.validate(ak,appendContext(c,k,type_2,ak));if(Either_1.isLeft(result))void 0!==ak&&pushAll(errors,result.left);else{var vak=result.right;vak!==ak&&(a2===o&&(a2=__assign({},o)),a2[k]=vak)}}return errors.length>0?exports.failures(errors):exports.success(a2)}),useIdentity(types)?exports.identity:function(a2){for(var s=__assign({},a2),i2=0;i2<len;i2++){var k=keys[i2],ak=a2[k];void 0!==ak&&(s[k]=types[i2].encode(ak))}return s},props)}exports.PartialType=PartialType,__name(partial4,"partial"),exports.partial=partial4;var DictionaryType=function(_super){function DictionaryType2(name2,is,validate,encode,domain,codomain){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.domain=domain,_this.codomain=codomain,_this._tag="DictionaryType",_this}return __extends(DictionaryType2,_super),__name(DictionaryType2,"DictionaryType"),DictionaryType2}(Type2);function record4(domain,codomain,name2){var keys=getDomainKeys(domain);return keys?enumerableRecord(Object.keys(keys),domain,codomain,name2):nonEnumerableRecord(domain,codomain,name2)}exports.DictionaryType=DictionaryType,__name(record4,"record"),exports.record=record4;var UnionType=function(_super){function UnionType2(name2,is,validate,encode,types){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.types=types,_this._tag="UnionType",_this}return __extends(UnionType2,_super),__name(UnionType2,"UnionType"),UnionType2}(Type2);function union6(codecs,name2){void 0===name2&&(name2=getUnionName(codecs));var index=getIndex(codecs);if(void 0!==index&&codecs.length>0){var tag_1=index[0],groups_1=index[1],len_1=groups_1.length,find_1=__name((function(value){for(var i2=0;i2<len_1;i2++)if(-1!==groups_1[i2].indexOf(value))return i2}),"find_1");return new TaggedUnionType(name2,(function(u){if(exports.UnknownRecord.is(u)){var i2=find_1(u[tag_1]);return void 0!==i2&&codecs[i2].is(u)}return!1}),(function(u,c){var e=exports.UnknownRecord.validate(u,c);if(Either_1.isLeft(e))return e;var r=e.right,i2=find_1(r[tag_1]);if(void 0===i2)return exports.failure(u,c);var codec=codecs[i2];return codec.validate(r,appendContext(c,String(i2),codec,r))}),useIdentity(codecs)?exports.identity:function(a2){var i2=find_1(a2[tag_1]);if(void 0===i2)throw new Error("no codec found to encode value in union codec "+name2);return codecs[i2].encode(a2)},codecs,tag_1)}return new UnionType(name2,(function(u){return codecs.some((function(type8){return type8.is(u)}))}),(function(u,c){for(var errors=[],i2=0;i2<codecs.length;i2++){var codec=codecs[i2],result=codec.validate(u,appendContext(c,String(i2),codec,u));if(!Either_1.isLeft(result))return exports.success(result.right);pushAll(errors,result.left)}return exports.failures(errors)}),useIdentity(codecs)?exports.identity:function(a2){for(var _i=0,codecs_1=codecs;_i<codecs_1.length;_i++){var codec=codecs_1[_i];if(codec.is(a2))return codec.encode(a2)}throw new Error("no codec found to encode value in union type "+name2)},codecs)}exports.UnionType=UnionType,__name(union6,"union"),exports.union=union6;var IntersectionType=function(_super){function IntersectionType2(name2,is,validate,encode,types){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.types=types,_this._tag="IntersectionType",_this}return __extends(IntersectionType2,_super),__name(IntersectionType2,"IntersectionType"),IntersectionType2}(Type2);function intersection3(codecs,name2){void 0===name2&&(name2="("+codecs.map((function(type8){return type8.name})).join(" & ")+")");var len=codecs.length;return new IntersectionType(name2,(function(u){return codecs.every((function(type8){return type8.is(u)}))}),0===codecs.length?exports.success:function(u,c){for(var us=[],errors=[],i2=0;i2<len;i2++){var codec=codecs[i2],result=codec.validate(u,appendContext(c,String(i2),codec,u));Either_1.isLeft(result)?pushAll(errors,result.left):us.push(result.right)}return errors.length>0?exports.failures(errors):exports.success(mergeAll(u,us))},0===codecs.length?exports.identity:function(a2){return mergeAll(a2,codecs.map((function(codec){return codec.encode(a2)})))},codecs)}exports.IntersectionType=IntersectionType,__name(intersection3,"intersection"),exports.intersection=intersection3;var TupleType=function(_super){function TupleType2(name2,is,validate,encode,types){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.types=types,_this._tag="TupleType",_this}return __extends(TupleType2,_super),__name(TupleType2,"TupleType"),TupleType2}(Type2);function tuple4(codecs,name2){void 0===name2&&(name2="["+codecs.map((function(type8){return type8.name})).join(", ")+"]");var len=codecs.length;return new TupleType(name2,(function(u){return exports.UnknownArray.is(u)&&u.length===len&&codecs.every((function(type8,i2){return type8.is(u[i2])}))}),(function(u,c){var e=exports.UnknownArray.validate(u,c);if(Either_1.isLeft(e))return e;for(var us=e.right,as=us.length>len?us.slice(0,len):us,errors=[],i2=0;i2<len;i2++){var a2=us[i2],type_3=codecs[i2],result=type_3.validate(a2,appendContext(c,String(i2),type_3,a2));if(Either_1.isLeft(result))pushAll(errors,result.left);else{var va=result.right;va!==a2&&(as===us&&(as=us.slice()),as[i2]=va)}}return errors.length>0?exports.failures(errors):exports.success(as)}),useIdentity(codecs)?exports.identity:function(a2){return codecs.map((function(type8,i2){return type8.encode(a2[i2])}))},codecs)}exports.TupleType=TupleType,__name(tuple4,"tuple"),exports.tuple=tuple4;var ReadonlyType=function(_super){function ReadonlyType2(name2,is,validate,encode,type8){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.type=type8,_this._tag="ReadonlyType",_this}return __extends(ReadonlyType2,_super),__name(ReadonlyType2,"ReadonlyType"),ReadonlyType2}(Type2);function readonly2(codec,name2){return void 0===name2&&(name2="Readonly<"+codec.name+">"),new ReadonlyType(name2,codec.is,codec.validate,codec.encode,codec)}exports.ReadonlyType=ReadonlyType,__name(readonly2,"readonly"),exports.readonly=readonly2;var ReadonlyArrayType=function(_super){function ReadonlyArrayType2(name2,is,validate,encode,type8){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.type=type8,_this._tag="ReadonlyArrayType",_this}return __extends(ReadonlyArrayType2,_super),__name(ReadonlyArrayType2,"ReadonlyArrayType"),ReadonlyArrayType2}(Type2);function readonlyArray(item,name2){void 0===name2&&(name2="ReadonlyArray<"+item.name+">");var codec=array8(item);return new ReadonlyArrayType(name2,codec.is,codec.validate,codec.encode,item)}exports.ReadonlyArrayType=ReadonlyArrayType,__name(readonlyArray,"readonlyArray"),exports.readonlyArray=readonlyArray;var strict=__name((function(props,name2){return exact(type7(props),name2)}),"strict");exports.strict=strict;var ExactType=function(_super){function ExactType2(name2,is,validate,encode,type8){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.type=type8,_this._tag="ExactType",_this}return __extends(ExactType2,_super),__name(ExactType2,"ExactType"),ExactType2}(Type2);function exact(codec,name2){void 0===name2&&(name2=getExactTypeName(codec));var props=getProps(codec);return new ExactType(name2,codec.is,(function(u,c){var e=exports.UnknownRecord.validate(u,c);if(Either_1.isLeft(e))return e;var ce=codec.validate(u,c);return Either_1.isLeft(ce)?ce:Either_1.right(stripKeys(ce.right,props))}),(function(a2){return codec.encode(stripKeys(a2,props))}),codec)}exports.ExactType=ExactType,__name(exact,"exact"),exports.exact=exact;var FunctionType=function(_super){function FunctionType2(){var _this=_super.call(this,"Function",(function(u){return"function"==typeof u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="FunctionType",_this}return __extends(FunctionType2,_super),__name(FunctionType2,"FunctionType"),FunctionType2}(Type2);exports.FunctionType=FunctionType,exports.Function=new FunctionType;var TaggedUnionType=function(_super){function TaggedUnionType2(name2,is,validate,encode,codecs,tag){var _this=_super.call(this,name2,is,validate,encode,codecs)||this;return _this.tag=tag,_this}return __extends(TaggedUnionType2,_super),__name(TaggedUnionType2,"TaggedUnionType"),TaggedUnionType2}(UnionType);exports.TaggedUnionType=TaggedUnionType;var taggedUnion=__name((function(tag,codecs,name2){void 0===name2&&(name2=getUnionName(codecs));var U=union6(codecs,name2);return U instanceof TaggedUnionType?U:(console.warn("[io-ts] Cannot build a tagged union for "+name2+", returning a de-optimized union"),new TaggedUnionType(name2,U.is,U.validate,U.encode,codecs,tag))}),"taggedUnion");exports.taggedUnion=taggedUnion;var getValidationError=__name((function(value,context){return{value:value,context:context}}),"getValidationError");exports.getValidationError=getValidationError;var getDefaultContext=__name((function(decoder){return[{key:"",type:decoder}]}),"getDefaultContext");exports.getDefaultContext=getDefaultContext;var NeverType=function(_super){function NeverType2(){var _this=_super.call(this,"never",(function(_){return!1}),(function(u,c){return exports.failure(u,c)}),(function(){throw new Error("cannot encode never")}))||this;return _this._tag="NeverType",_this}return __extends(NeverType2,_super),__name(NeverType2,"NeverType"),NeverType2}(Type2);exports.NeverType=NeverType,exports.never=new NeverType;var AnyType=function(_super){function AnyType2(){var _this=_super.call(this,"any",(function(_){return!0}),exports.success,exports.identity)||this;return _this._tag="AnyType",_this}return __extends(AnyType2,_super),__name(AnyType2,"AnyType"),AnyType2}(Type2);exports.AnyType=AnyType,exports.any=new AnyType,exports.Dictionary=exports.UnknownRecord;var ObjectType=function(_super){function ObjectType2(){var _this=_super.call(this,"object",(function(u){return null!==u&&"object"==typeof u}),(function(u,c){return _this.is(u)?exports.success(u):exports.failure(u,c)}),exports.identity)||this;return _this._tag="ObjectType",_this}return __extends(ObjectType2,_super),__name(ObjectType2,"ObjectType"),ObjectType2}(Type2);function refinement(codec,predicate,name2){return void 0===name2&&(name2="("+codec.name+" | "+getFunctionName(predicate)+")"),new RefinementType2(name2,(function(u){return codec.is(u)&&predicate(u)}),(function(i2,c){var e=codec.validate(i2,c);if(Either_1.isLeft(e))return e;var a2=e.right;return predicate(a2)?exports.success(a2):exports.failure(a2,c)}),codec.encode,codec,predicate)}exports.ObjectType=ObjectType,exports.object=new ObjectType,__name(refinement,"refinement"),exports.refinement=refinement,exports.Integer=refinement(exports.number,Number.isInteger,"Integer"),exports.dictionary=record4;var StrictType=function(_super){function StrictType2(name2,is,validate,encode,props){var _this=_super.call(this,name2,is,validate,encode)||this;return _this.props=props,_this._tag="StrictType",_this}return __extends(StrictType2,_super),__name(StrictType2,"StrictType"),StrictType2}(Type2);function clean(codec){return codec}function alias(codec){return function(){return codec}}exports.StrictType=StrictType,__name(clean,"clean"),exports.clean=clean,__name(alias,"alias"),exports.alias=alias}}),require_unicode=__commonJS({"node_modules/json5/lib/unicode.js"(exports,module){module.exports.Space_Separator=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,module.exports.ID_Start=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,module.exports.ID_Continue=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/}}),require_util=__commonJS({"node_modules/json5/lib/util.js"(exports,module){var unicode=require_unicode();module.exports={isSpaceSeparator:c=>"string"==typeof c&&unicode.Space_Separator.test(c),isIdStartChar:c=>"string"==typeof c&&(c>="a"&&c<="z"||c>="A"&&c<="Z"||"$"===c||"_"===c||unicode.ID_Start.test(c)),isIdContinueChar:c=>"string"==typeof c&&(c>="a"&&c<="z"||c>="A"&&c<="Z"||c>="0"&&c<="9"||"$"===c||"_"===c||"‌"===c||"‍"===c||unicode.ID_Continue.test(c)),isDigit:c=>"string"==typeof c&&/[0-9]/.test(c),isHexDigit:c=>"string"==typeof c&&/[0-9A-Fa-f]/.test(c)}}}),require_PathReporter=__commonJS({"node_modules/io-ts/lib/PathReporter.js"(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.PathReporter=exports.success=exports.failure=void 0;var _1=require_lib(),Either_1=require_Either();function stringify(v){return"function"==typeof v?_1.getFunctionName(v):"number"!=typeof v||isFinite(v)?JSON.stringify(v):isNaN(v)?"NaN":v>0?"Infinity":"-Infinity"}function getContextPath(context){return context.map((function(_a){return _a.key+": "+_a.type.name})).join("/")}function getMessage(e){return void 0!==e.message?e.message:"Invalid value "+stringify(e.value)+" supplied to "+getContextPath(e.context)}function failure2(es){return es.map(getMessage)}function success2(){return["No errors!"]}__name(stringify,"stringify"),__name(getContextPath,"getContextPath"),__name(getMessage,"getMessage"),__name(failure2,"failure"),exports.failure=failure2,__name(success2,"success"),exports.success=success2,exports.PathReporter={report:Either_1.fold(failure2,success2)}}}),supportCustomEvent=window.CustomEvent;function safeDispatchEvent(target2,event){var check="on"+event.type.toLowerCase();return"function"==typeof target2[check]&&target2[check](event),target2.dispatchEvent(event)}function createsStackingContext(el){for(;el&&el!==document.body;){var s=window.getComputedStyle(el),invalid=__name((function(k,ok){return!(void 0===s[k]||s[k]===ok)}),"invalid");if(s.opacity<1||invalid("zIndex","auto")||invalid("transform","none")||invalid("mixBlendMode","normal")||invalid("filter","none")||invalid("perspective","none")||"isolate"===s.isolation||"fixed"===s.position||"touch"===s.webkitOverflowScrolling)return!0;el=el.parentElement}return!1}function findNearestDialog(el){for(;el;){if("dialog"===el.localName)return el;el=el.parentElement?el.parentElement:el.parentNode?el.parentNode.host:null}return null}function safeBlur(el){for(;el&&el.shadowRoot&&el.shadowRoot.activeElement;)el=el.shadowRoot.activeElement;el&&el.blur&&el!==document.body&&el.blur()}function inNodeList(nodeList,node){for(var i2=0;i2<nodeList.length;++i2)if(nodeList[i2]===node)return!0;return!1}function isFormMethodDialog(el){return!(!el||!el.hasAttribute("method"))&&"dialog"===el.getAttribute("method").toLowerCase()}function findFocusableElementWithin(hostElement){var query=["button","input","keygen","select","textarea"].map((function(el){return el+":not([disabled])"}));query.push('[tabindex]:not([disabled]):not([tabindex=""])');var target2=hostElement.querySelector(query.join(", "));if(!target2&&"attachShadow"in Element.prototype)for(var elems=hostElement.querySelectorAll("*"),i2=0;i2<elems.length&&!(elems[i2].tagName&&elems[i2].shadowRoot&&(target2=findFocusableElementWithin(elems[i2].shadowRoot)));i2++);return target2}function isConnected(element){return element.isConnected||document.body.contains(element)}function findFormSubmitter(event){if(event.submitter)return event.submitter;var form=event.target;if(!(form instanceof HTMLFormElement))return null;var submitter=dialogPolyfill.formSubmitter;if(!submitter){var target2=event.target;submitter=("getRootNode"in target2&&target2.getRootNode()||document).activeElement}return submitter&&submitter.form===form?submitter:null}function maybeHandleSubmit(event){if(!event.defaultPrevented){var form=event.target,value=dialogPolyfill.imagemapUseValue,submitter=findFormSubmitter(event);null===value&&submitter&&(value=submitter.value);var dialog=findNearestDialog(form);if(dialog)"dialog"===(submitter&&submitter.getAttribute("formmethod")||form.getAttribute("method"))&&(event.preventDefault(),null!=value?dialog.close(value):dialog.close())}}function dialogPolyfillInfo(dialog){if(this.dialog_=dialog,this.replacedStyleTop_=!1,this.openAsModal_=!1,dialog.hasAttribute("role")||dialog.setAttribute("role","dialog"),dialog.show=this.show.bind(this),dialog.showModal=this.showModal.bind(this),dialog.close=this.close.bind(this),dialog.addEventListener("submit",maybeHandleSubmit,!1),"returnValue"in dialog||(dialog.returnValue=""),"MutationObserver"in window){new MutationObserver(this.maybeHideModal.bind(this)).observe(dialog,{attributes:!0,attributeFilter:["open"]})}else{var timeout,removed=!1,cb=function(){removed?this.downgradeModal():this.maybeHideModal(),removed=!1}.bind(this),delayModel=__name((function(ev){if(ev.target===dialog){var cand="DOMNodeRemoved";removed|=ev.type.substr(0,cand.length)===cand,window.clearTimeout(timeout),timeout=window.setTimeout(cb,0)}}),"delayModel");["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(name2){dialog.addEventListener(name2,delayModel)}))}Object.defineProperty(dialog,"open",{set:this.setOpen.bind(this),get:dialog.hasAttribute.bind(dialog,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}supportCustomEvent&&"object"!=typeof supportCustomEvent||((supportCustomEvent=__name((function(event,x){x=x||{};var ev=document.createEvent("CustomEvent");return ev.initCustomEvent(event,!!x.bubbles,!!x.cancelable,x.detail||null),ev}),"CustomEvent")).prototype=window.Event.prototype),__name(safeDispatchEvent,"safeDispatchEvent"),__name(createsStackingContext,"createsStackingContext"),__name(findNearestDialog,"findNearestDialog"),__name(safeBlur,"safeBlur"),__name(inNodeList,"inNodeList"),__name(isFormMethodDialog,"isFormMethodDialog"),__name(findFocusableElementWithin,"findFocusableElementWithin"),__name(isConnected,"isConnected"),__name(findFormSubmitter,"findFormSubmitter"),__name(maybeHandleSubmit,"maybeHandleSubmit"),__name(dialogPolyfillInfo,"dialogPolyfillInfo"),dialogPolyfillInfo.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&isConnected(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),dialogPolyfill.dm.removeDialog(this))},setOpen:function(value){value?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var fake=document.createElement("div");this.dialog_.insertBefore(fake,this.dialog_.firstChild),fake.tabIndex=-1,fake.focus(),this.dialog_.removeChild(fake)}var redirectedEvent=document.createEvent("MouseEvents");redirectedEvent.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(redirectedEvent),e.stopPropagation()},focus_:function(){var target2=this.dialog_.querySelector("[autofocus]:not([disabled])");!target2&&this.dialog_.tabIndex>=0&&(target2=this.dialog_),target2||(target2=findFocusableElementWithin(this.dialog_)),safeBlur(document.activeElement),target2&&target2.focus()},updateZIndex:function(dialogZ,backdropZ){if(dialogZ<backdropZ)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=dialogZ,this.backdrop_.style.zIndex=backdropZ},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!isConnected(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!dialogPolyfill.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");createsStackingContext(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,dialogPolyfill.needsCentering(this.dialog_)?(dialogPolyfill.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(opt_returnValue){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==opt_returnValue&&(this.dialog_.returnValue=opt_returnValue);var closeEvent=new supportCustomEvent("close",{bubbles:!1,cancelable:!1});safeDispatchEvent(this.dialog_,closeEvent)}};var testForm,methodDescriptor,realGet,realSet,nativeFormSubmit,replacementFormSubmit,dialogPolyfill={};dialogPolyfill.reposition=function(element){var scrollTop=document.body.scrollTop||document.documentElement.scrollTop,topValue=scrollTop+(window.innerHeight-element.offsetHeight)/2;element.style.top=Math.max(scrollTop,topValue)+"px"},dialogPolyfill.isInlinePositionSetByStylesheet=function(element){for(var i2=0;i2<document.styleSheets.length;++i2){var styleSheet=document.styleSheets[i2],cssRules=null;try{cssRules=styleSheet.cssRules}catch(e){}if(cssRules)for(var j=0;j<cssRules.length;++j){var rule=cssRules[j],selectedNodes=null;try{selectedNodes=document.querySelectorAll(rule.selectorText)}catch(e){}if(selectedNodes&&inNodeList(selectedNodes,element)){var cssTop=rule.style.getPropertyValue("top"),cssBottom=rule.style.getPropertyValue("bottom");if(cssTop&&"auto"!==cssTop||cssBottom&&"auto"!==cssBottom)return!0}}}return!1},dialogPolyfill.needsCentering=function(dialog){return"absolute"===window.getComputedStyle(dialog).position&&(!("auto"!==dialog.style.top&&""!==dialog.style.top||"auto"!==dialog.style.bottom&&""!==dialog.style.bottom)&&!dialogPolyfill.isInlinePositionSetByStylesheet(dialog))},dialogPolyfill.forceRegisterDialog=function(element){if((window.HTMLDialogElement||element.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",element),"dialog"!==element.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new dialogPolyfillInfo(element)},dialogPolyfill.registerDialog=function(element){element.showModal||dialogPolyfill.forceRegisterDialog(element)},dialogPolyfill.DialogManager=function(){this.pendingDialogStack=[];var checkDOM=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(e){this.forwardTab_=void 0,e.stopPropagation(),checkDOM([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(records){var removed=[];records.forEach((function(rec){for(var c,i2=0;c=rec.removedNodes[i2];++i2)c instanceof Element&&("dialog"===c.localName&&removed.push(c),removed=removed.concat(c.querySelectorAll("dialog")))})),removed.length&&checkDOM(removed)})))},dialogPolyfill.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},dialogPolyfill.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},dialogPolyfill.DialogManager.prototype.updateStacking=function(){for(var dpi,zIndex=this.zIndexHigh_,i2=0;dpi=this.pendingDialogStack[i2];++i2)dpi.updateZIndex(--zIndex,--zIndex),0===i2&&(this.overlay.style.zIndex=--zIndex);var last=this.pendingDialogStack[0];last?(last.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},dialogPolyfill.DialogManager.prototype.containedByTopDialog_=function(candidate){for(;candidate=findNearestDialog(candidate);){for(var dpi,i2=0;dpi=this.pendingDialogStack[i2];++i2)if(dpi.dialog===candidate)return 0===i2;candidate=candidate.parentElement}return!1},dialogPolyfill.DialogManager.prototype.handleFocus_=function(event){var target2=event.composedPath?event.composedPath()[0]:event.target;if(!this.containedByTopDialog_(target2)&&document.activeElement!==document.documentElement&&(event.preventDefault(),event.stopPropagation(),safeBlur(target2),void 0!==this.forwardTab_)){var dpi=this.pendingDialogStack[0];return dpi.dialog.compareDocumentPosition(target2)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?dpi.focus_():target2!==document.documentElement&&document.documentElement.focus()),!1}},dialogPolyfill.DialogManager.prototype.handleKey_=function(event){if(this.forwardTab_=void 0,27===event.keyCode){event.preventDefault(),event.stopPropagation();var cancelEvent=new supportCustomEvent("cancel",{bubbles:!1,cancelable:!0}),dpi=this.pendingDialogStack[0];dpi&&safeDispatchEvent(dpi.dialog,cancelEvent)&&dpi.dialog.close()}else 9===event.keyCode&&(this.forwardTab_=!event.shiftKey)},dialogPolyfill.DialogManager.prototype.checkDOM_=function(removed){this.pendingDialogStack.slice().forEach((function(dpi){-1!==removed.indexOf(dpi.dialog)?dpi.downgradeModal():dpi.maybeHideModal()}))},dialogPolyfill.DialogManager.prototype.pushDialog=function(dpi){var allowed=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=allowed)&&(1===this.pendingDialogStack.unshift(dpi)&&this.blockDocument(),this.updateStacking(),!0)},dialogPolyfill.DialogManager.prototype.removeDialog=function(dpi){var index=this.pendingDialogStack.indexOf(dpi);-1!==index&&(this.pendingDialogStack.splice(index,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},dialogPolyfill.dm=new dialogPolyfill.DialogManager,dialogPolyfill.formSubmitter=null,dialogPolyfill.imagemapUseValue=null,void 0===window.HTMLDialogElement&&((testForm=document.createElement("form")).setAttribute("method","dialog"),"dialog"!==testForm.method&&(methodDescriptor=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method"))&&(realGet=methodDescriptor.get,methodDescriptor.get=function(){return isFormMethodDialog(this)?"dialog":realGet.call(this)},realSet=methodDescriptor.set,methodDescriptor.set=function(v){return"string"==typeof v&&"dialog"===v.toLowerCase()?this.setAttribute("method",v):realSet.call(this,v)},Object.defineProperty(HTMLFormElement.prototype,"method",methodDescriptor)),document.addEventListener("click",(function(ev){if(dialogPolyfill.formSubmitter=null,dialogPolyfill.imagemapUseValue=null,!ev.defaultPrevented){var target2=ev.target;if("composedPath"in ev)target2=ev.composedPath().shift()||target2;if(target2&&isFormMethodDialog(target2.form)){if(!("submit"===target2.type&&["button","input"].indexOf(target2.localName)>-1)){if("input"!==target2.localName||"image"!==target2.type)return;dialogPolyfill.imagemapUseValue=ev.offsetX+","+ev.offsetY}findNearestDialog(target2)&&(dialogPolyfill.formSubmitter=target2)}}}),!1),document.addEventListener("submit",(function(ev){var form=ev.target;if(!findNearestDialog(form)){var submitter=findFormSubmitter(ev);"dialog"===(submitter&&submitter.getAttribute("formmethod")||form.getAttribute("method"))&&ev.preventDefault()}})),nativeFormSubmit=HTMLFormElement.prototype.submit,replacementFormSubmit=__name((function(){if(!isFormMethodDialog(this))return nativeFormSubmit.call(this);var dialog=findNearestDialog(this);dialog&&dialog.close()}),"replacementFormSubmit"),HTMLFormElement.prototype.submit=replacementFormSubmit);var dialog_polyfill_esm_default=dialogPolyfill,import_file_saver3=__toESM(require_FileSaver_min()),import_json57=__toESM(require_dist()),LZString=__toESM(require_lz_string()),pngMeta=__toESM(require_png_metadata_writer()),t37=__toESM(require_lib()),import_json55=__toESM(require_dist()),import_file_saver=__toESM(require_FileSaver_min()),import_json53=__toESM(require_dist()),json5util=__toESM(require_util()),import_Either=__toESM(require_Either()),t2=__toESM(require_lib()),import_PathReporter=__toESM(require_PathReporter()),import_json5=__toESM(require_dist()),InBrowser="undefined"!=typeof window;function keysOf(o){return Object.keys(o)}__name(keysOf,"keysOf");var RichStringEnum=class{constructor(props){this.props=props,this._values=keysOf(props);for(let i2=0;i2<this._values.length;i2++)this[i2]=this._values[i2]}static withProps(){return function(defs){return new RichStringEnum(defs)}}get type(){throw new Error}get values(){return this._values}get length(){return this._values.length}get definitions(){const defs=[];for(const i2 of this._values)defs.push([i2,this.props[i2]]);return defs}includes(val){return this.values.includes(val)}indexOf(val){return this.values.indexOf(val)}*[Symbol.iterator](){for(const i2 of this._values)yield i2}};function tuple(){for(var _len2=arguments.length,items=new Array(_len2),_key2=0;_key2<_len2;_key2++)items[_key2]=arguments[_key2];return items}function mergeWhereDefined(a2,b2){const obj={...a2};for(const[k,v]of Object.entries(b2))void 0!==v&&(obj[k]=v);return obj}function randomString(n){const chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let str="";for(let i2=0;i2<n;i2++)str+=chars[Math.floor(Math.random()*chars.length)];return str}function brand(){return val=>val}function defineADTStatics(cases,statics){return{...statics,...cases}}function isString(v){return"string"==typeof v}function isArray(arg){return Array.isArray(arg)}function isNumber(arg){return"number"==typeof arg}function isBoolean(arg){return"boolean"==typeof arg}function isRecord(arg){return"object"==typeof arg&&null!==arg}function ArrayFillWith(val,n){return Array(n).fill(val)}function ArrayFillUsing(val,n){const arr=Array(n);for(let i2=0;i2<n;i2++)arr[i2]=val(i2);return arr}function ArrayClampOrPad(arr,len,padValue){const missing=len-arr.length;if(0===missing)return arr;if(missing>0)for(let i2=0;i2<missing;i2++)arr.push(padValue);else arr.splice(len,-missing);return arr}function FixedArrayFillWith(val,n){return ArrayFillWith(val,n)}function FixedArrayMap(items,fn2){return items.map(fn2)}function FixedArrayAssert(arr,n){if(arr.length!==n)throw new Error("FixedArrayAssert: expected length ".concat(n,", got ").concat(arr.length));return arr}function JSONParseObject(str){const parsed=import_json5.default.parse(str);if(isRecord(parsed))return parsed;throw new Error("JSONParseObject: not an object")}function isTruthyString(str){return null!=str&&("1"===str||"true"===str.toLowerCase())}function isFalsyString(str){return null!=str&&("0"===str||"false"===str.toLowerCase())}function getURLParameter(sParam,defaultValue){const sURLVariables=window.location.search.substring(1).split("&");for(const sURLVariable of sURLVariables){const sParameterName=sURLVariable.split("=");if(sParameterName[0]===sParam)return sParameterName[1]}return defaultValue}function isEmbeddedInIframe(){try{return window.self!==window.top}catch(e){return!0}}function onVisible(element,callback){new IntersectionObserver(((entries,observer)=>{entries.forEach((entry=>{if(entry.intersectionRatio>0)return callback(),void observer.disconnect()}))})).observe(element)}function setEnabled(elem,enabled){enabled?elem.removeAttribute("disabled"):elem.setAttribute("disabled","disabled")}function setVisible(elem,visible){if(visible){const prevDisplay=elem.getAttribute("data-prev-display");null===prevDisplay?"none"===elem.style.display&&elem.style.removeProperty("display"):(elem.removeAttribute("data-prev-display"),elem.style.display=prevDisplay)}else{const currentDisplay=elem.style.display;0!==currentDisplay.length&&"none"!==currentDisplay&&elem.setAttribute("data-prev-display",currentDisplay),elem.style.display="none"}}function toggleVisible(elem){setVisible(elem,"none"===elem.style.display)}function setHidden(elem,hidden){hidden?elem.style.visibility="hidden":elem.style.removeProperty("visibility")}function setDisplay(elem,display){setVisible(elem,"hide"!==display),setHidden(elem,"inactive"===display)}function setActive(elem,active){elem.classList.toggle("active",active)}function showModal(dlog){if("function"==typeof dlog.showModal){dlog.style.display="initial",dlog.showModal();const listener=__name((()=>{dlog.style.display="none",dlog.removeEventListener("close",listener)}),"listener");return dlog.addEventListener("close",listener),!0}return!1}__name(RichStringEnum,"RichStringEnum"),__name(tuple,"tuple"),__name(mergeWhereDefined,"mergeWhereDefined"),__name(randomString,"randomString"),__name(brand,"brand"),__name(defineADTStatics,"defineADTStatics"),__name(isString,"isString"),__name(isArray,"isArray"),__name(isNumber,"isNumber"),__name(isBoolean,"isBoolean"),__name(isRecord,"isRecord"),__name(ArrayFillWith,"ArrayFillWith"),__name(ArrayFillUsing,"ArrayFillUsing"),__name(ArrayClampOrPad,"ArrayClampOrPad"),__name(FixedArrayFillWith,"FixedArrayFillWith"),__name(FixedArrayMap,"FixedArrayMap"),__name(FixedArrayAssert,"FixedArrayAssert"),__name(JSONParseObject,"JSONParseObject"),__name(isTruthyString,"isTruthyString"),__name(isFalsyString,"isFalsyString"),__name(getURLParameter,"getURLParameter"),__name(isEmbeddedInIframe,"isEmbeddedInIframe"),__name(onVisible,"onVisible"),__name(setEnabled,"setEnabled"),__name(setVisible,"setVisible"),__name(toggleVisible,"toggleVisible"),__name(setHidden,"setHidden"),__name(setDisplay,"setDisplay"),__name(setActive,"setActive"),__name(showModal,"showModal");var InteractionResult=defineADTStatics({NoChange:{_tag:"NoChange",isChange:!1},SimpleChange:{_tag:"SimpleChange",isChange:!0},RepeatableChange:repeat=>({_tag:"RepeatableChange",isChange:!0,repeat:repeat})},{fromBoolean:changed=>changed?InteractionResult.SimpleChange:InteractionResult.NoChange,merge:(r0,r1)=>"NoChange"===r0._tag?r1:"RepeatableChange"===r0._tag?r0:"RepeatableChange"===r1._tag?r1:r0}),EdgeTrigger={rising:"rising",falling:"falling"};function repeatString(c,n){return Array(n+1).join(c)}function formatString(str){for(var _len3=arguments.length,varargs=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)varargs[_key3-1]=arguments[_key3];if(varargs.length){const t38=typeof varargs[0],args="string"===t38||"number"===t38?Array.prototype.slice.call(varargs):varargs[0];for(const key in args)str=str.replace(new RegExp("\\{"+key+"\\}","gi"),args[key])}return str}function deepObjectEquals(v1,v2){const keys1=Object.keys(v1),keys2=Object.keys(v2);if(keys1.length!==keys2.length)return!1;for(const key of keys1)if(!deepArrayEquals(v1[key],v2[key]))return!1;return!0}function deepArrayEquals(v1,v2){if(isArray(v1)&&isArray(v2)){if(v1.length!==v2.length)return!1;for(let i2=0;i2<v1.length;i2++)if(v1[i2]!==v2[i2])return!1;return!0}return v1===v2}__name(repeatString,"repeatString"),__name(formatString,"formatString"),__name(deepObjectEquals,"deepObjectEquals"),__name(deepArrayEquals,"deepArrayEquals");var typeOrUndefined=__name((tpe=>t2.union([tpe,t2.undefined],tpe.name+" | undefined")),"typeOrUndefined"),typeOrNull=__name((tpe=>t2.union([tpe,t2.null],tpe.name+" | null")),"typeOrNull");function validateJson(obj,repr,what){const validated=repr.decode(obj);if(!(0,import_Either.isLeft)(validated))return validated.right;console.warn("ERROR while parsing ".concat(what," from %o -> %s: "),obj,import_PathReporter.PathReporter.report(validated).join("; "))}__name(validateJson,"validateJson");var HighImpedance="Z";function isHighImpedance(v){return v===HighImpedance}__name(isHighImpedance,"isHighImpedance");var Unknown="?";function isUnknown(v){return v===Unknown}__name(isUnknown,"isUnknown");new t2.Type("Unknown",isUnknown,((input2,context)=>isUnknown(input2)?t2.success(input2):t2.failure(input2,context)),t2.identity);var LogicValue={invert:v=>isUnknown(v)||isHighImpedance(v)?v:!v,filterHighZ:v=>isHighImpedance(v)?Unknown:v},LogicValueRepr=new t2.Type("0|1|?|Z",(v=>isUnknown(v)||isHighImpedance(v)||1===v||0===v),((input2,context)=>isUnknown(input2)||isHighImpedance(input2)?t2.success(input2):1===input2?t2.success(1):0===input2?t2.success(0):t2.failure(input2,context)),t2.identity);function toLogicValueRepr(v){switch(v){case!0:return 1;case!1:return 0;case Unknown:return Unknown;case HighImpedance:return HighImpedance;case void 0:return}}function toLogicValue(v){switch(v){case 1:return!0;case 0:return!1;case Unknown:return Unknown;case HighImpedance:return HighImpedance;case void 0:return}}function toLogicValueFromChar(char){switch(char){case"1":return!0;case"0":return!1;case Unknown:return Unknown;case HighImpedance:return HighImpedance;default:return Unknown}}__name(toLogicValueRepr,"toLogicValueRepr"),__name(toLogicValue,"toLogicValue"),__name(toLogicValueFromChar,"toLogicValueFromChar");var InputOutputValueRepr=t2.union([LogicValueRepr,t2.string,t2.array(LogicValueRepr)]);function allBooleans(values){for(const v of values)if(!0!==v&&!1!==v)return!1;return!0}function isAllZeros(s){for(const c of s)if("0"!==c)return!1;return!0}function binaryStringRepr(values){return values.map(toLogicValueRepr).reverse().join("")}function valuesReprForTest(values){return 1===values.length?toLogicValueRepr(values[0]):binaryStringRepr(values)}function hexStringRepr(values,hexWidth){const binStr=binaryStringRepr(values);return parseInt(binStr,2).toString(16).toUpperCase().padStart(hexWidth,"0")}function valuesFromBinaryOrHexRepr(wordRepr,numBits){const binaryRepr=wordRepr.length===numBits?wordRepr:parseInt(wordRepr,16).toString(2).padStart(numBits,"0"),row=Array(numBits);for(let i2=0;i2<numBits;i2++)row[i2]=toLogicValueFromChar(binaryRepr[numBits-i2-1]);return row}function valuesFromReprForInput(repr,numBits){return void 0===repr||isString(repr)&&0===repr.length?ArrayFillWith(!1,numBits):isArray(repr)?ArrayClampOrPad(repr.map((v=>toLogicValue(v))),numBits,!1):isNumber(repr)?ArrayFillWith(toLogicValue(repr),numBits):ArrayClampOrPad(Array.from(repr).reverse().map((v=>toLogicValueFromChar(v))),numBits,!1)}function reprForLogicValues(values,undefinedIfTrivial){const numBits=values.length;if(1===numBits){const value=values[0];return undefinedIfTrivial&&!1===value?void 0:toLogicValueRepr(value)}if(undefinedIfTrivial){let nontrivial=!1;for(let i2=0;i2<numBits;i2++)if(!1!==values[i2]){nontrivial=!0;break}if(!nontrivial)return}return values.map(toLogicValueRepr).reverse().join("")}async function copyToClipboard(textToCopy){try{return await navigator.clipboard.writeText(textToCopy),console.log("Text copied to clipboard with new API"),!0}catch(e){}function isOS(){return navigator.userAgent.match(/ipad|iphone/i)}__name(isOS,"isOS");const textArea=document.createElement("textarea");if(textArea.readOnly=!0,textArea.contentEditable="true",textArea.value=textToCopy,document.body.appendChild(textArea),isOS()){const range=document.createRange();range.selectNodeContents(textArea);const selection=window.getSelection();null!==selection&&(selection.removeAllRanges(),selection.addRange(range),textArea.setSelectionRange(0,999999))}else textArea.select();const ok=document.execCommand("copy");return document.body.removeChild(textArea),ok}async function pasteFromClipboard(){try{const text=await navigator.clipboard.readText();return console.log("Text pasted from clipboard with new API"),text}catch(e){}const textArea=document.createElement("textarea");let result;textArea.readOnly=!1,textArea.contentEditable="true",document.body.appendChild(textArea),textArea.focus();return document.execCommand("paste")&&textArea.value.length>0&&(result=textArea.value),document.body.removeChild(textArea),result}function targetIsFieldOrOtherInput(e){const targets=e.composedPath();let elem,tagName;return 0!==targets.length&&(elem=targets[0])instanceof HTMLElement&&("INPUT"===(tagName=elem.tagName)||"SELECT"===tagName)}function getScrollParent(element){let style2=getComputedStyle(element);const excludeStaticParent="absolute"===style2.position,overflowRegex=/(auto|scroll)/;if("fixed"===style2.position)return document;let parent;for(parent=element;parent=parent.parentElement;)if(style2=getComputedStyle(parent),(!excludeStaticParent||"static"!==style2.position)&&overflowRegex.test(style2.overflow+style2.overflowY+style2.overflowX))return parent;return document}__name(allBooleans,"allBooleans"),__name(isAllZeros,"isAllZeros"),__name(binaryStringRepr,"binaryStringRepr"),__name(valuesReprForTest,"valuesReprForTest"),__name(hexStringRepr,"hexStringRepr"),__name(valuesFromBinaryOrHexRepr,"valuesFromBinaryOrHexRepr"),__name(valuesFromReprForInput,"valuesFromReprForInput"),__name(reprForLogicValues,"reprForLogicValues"),__name(copyToClipboard,"copyToClipboard"),__name(pasteFromClipboard,"pasteFromClipboard"),__name(targetIsFieldOrOtherInput,"targetIsFieldOrOtherInput"),__name(getScrollParent,"getScrollParent");var unique;unique=0;function migrateData(data2,editorId){var _a;let jsonVersion=Number(null!=(_a=data2.v)?_a:0);const savedVersion=jsonVersion;if(savedVersion>6)throw new Error("Data format v".concat(savedVersion," is newer than what this editor can load (v ≤ ").concat(6));for(;jsonVersion<6;){const migrationFunc=migrateTo[++jsonVersion];migrationFunc(data2);const defs=data2.defs;if(isArray(defs))for(const def of defs){const circuit=def.circuit;isRecord(circuit)&&migrationFunc(circuit)}data2.v=jsonVersion}if(jsonVersion!==savedVersion){const newRepr=Serialization.stringifyObject(data2,!1),editorIdStr=void 0!==editorId?" for editor '".concat(editorId,"'"):"";console.log("LogicEditor".concat(editorIdStr," migrated data format from v").concat(savedVersion," to v").concat(jsonVersion,", consider upgrading its source to this:\n").concat(newRepr))}}__name(migrateData,"migrateData");var migrateTo={6:container=>{const compFieldsAndCategories={in:"in",out:"out",gates:"gate",ic:"ic",labels:"label",layout:"layout"},oldToNewId={in:"in","in.clock":"clock","in.random":"rand",out:"out","out.display":"display","out.7seg":"7seg","out.16seg":"16seg","out.ascii":"ascii","out.bar":"bar","out.shift-buffer":"shift-display","out.shift-register":"shift-reg","ic.switched-inverter":"cnot-array","ic.gate-array":"{gatetype}-array","ic.tristate-array":"tristate-array",label:"label","label.rect":"rect","layout.pass":"pass","ic.halfadder":"halfadder","ic.adder":"adder","ic.comparator":"comp","ic.adder-array":"adder-array","ic.alu":"alu","ic.mux":"mux","ic.demux":"demux","ic.latch-sr":"latch-sr","ic.flipflop-jk":"ff-jk","ic.flipflop-t":"ff-t","ic.flipflop-d":"ff-d","ic.register":"reg","ic.shift-register":"shift-reg","ic.counter":"counter","ic.ram":"ram","ic.rom":"rom","ic.decoder":"dec","ic.decoder-7seg":"dec-7seg","ic.decoder-16seg":"dec-16seg","ic.decoder-bcd4":"dec-bcd4"};function newTypeFor(category,item){if("gate"===category){if(!isString(item.type))return console.warn("Gate with no type found, assuming AND",item),"and";const gateType=item.type.toLowerCase();return"tri"===gateType?"tristate":gateType}{const id=isString(item.type)?"".concat(category,".").concat(item.type):category;if("ic.gate-array"===id){let gateType;return isString(item.subtype)?gateType=item.subtype.toLowerCase():(console.warn("Gate array with no subtype found, assuming AND",item),gateType="and"),delete item.subtype,"".concat(gateType,"-array")}return id in oldToNewId?oldToNewId[id]:id.startsWith("ic.custom-")?id.substring(3):(console.error("Unknown component type: ".concat(id)),id)}}__name(newTypeFor,"newTypeFor");const components=[];for(const[field,category]of Object.entries(compFieldsAndCategories)){const list=container[field];if(isArray(list))for(const compRepr of list)if(isRecord(compRepr)){const newType=newTypeFor(category,compRepr);compRepr.type=newType,"gate"===category&&isString(compRepr.poseAs)&&(compRepr.poseAs=compRepr.poseAs.toLowerCase()),components.push(compRepr)}delete container[field]}container.components=components},5:container=>{var _a,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l,_m,_n;let type7,match;const ins=container.in;if(isArray(ins))for(const in_ of ins)isString(type7=in_.type)&&("nibble"===type7?(delete in_.type,in_.bits=4):"byte"===type7&&(delete in_.type,in_.bits=8));const outs=container.out;if(isArray(outs))for(const out of outs)isString(type7=out.type)&&("nibble"===type7?(delete out.type,out.bits=4):"byte"===type7?(delete out.type,out.bits=8):"nibble-display"===type7?(out.type="display",out.bits=4):"byte-display"===type7?(out.type="display",out.bits=8):"shiftbuffer"===type7&&(out.type="shift-buffer"));const gates=container.gates;if(isArray(gates))for(const gate of gates)if(isString(type7=gate.type)){const lastChar=type7[type7.length-1],maybeBit=parseInt(lastChar);isNaN(maybeBit)||(gate.bits=maybeBit,gate.type=type7.slice(0,-1))}const components=container.components;if(isArray(components)){const ramRegex=/^ram-(?<lines>\d+)x(?<bits>\d+)$/,muxRegex=/^mux-(?<from>\d+)to(?<to>\d+)$/,demuxRegex=/^demux-(?<from>\d+)to(?<to>\d+)$/;for(const comp of components)if(isString(type7=comp.type))if("register"===type7){let state;if(isArray(state=comp.state)){const binStr=binaryStringRepr(state.map(toLogicValue));isAllZeros(binStr)||(comp.content=binStr),delete comp.state}}else"quad-gate"===type7?comp.type="gate-array":"quad-tristate"===type7?comp.type="tristate-array":null!==(match=ramRegex.exec(type7))?(comp.type="ram",comp.bits=parseInt(null!=(_b=null==(_a=match.groups)?void 0:_a.bits)?_b:"4"),comp.lines=parseInt(null!=(_d=null==(_c=match.groups)?void 0:_c.lines)?_d:"16")):null!==(match=muxRegex.exec(type7))?(comp.type="mux",comp.from=parseInt(null!=(_f=null==(_e=match.groups)?void 0:_e.from)?_f:"8"),comp.to=parseInt(null!=(_h=null==(_g=match.groups)?void 0:_g.to)?_h:"4")):null!==(match=demuxRegex.exec(type7))&&(comp.type="demux",comp.from=parseInt(null!=(_j=null==(_i=match.groups)?void 0:_i.from)?_j:"4"),comp.to=parseInt(null!=(_l=null==(_k=match.groups)?void 0:_k.to)?_l:"8"));container.ic=components,delete container.components}const layouts=container.layout;if(isArray(layouts)){const passthroughRegex=/^pass-(?<bits>\d+)$/;for(const layout of layouts)isString(type7=layout.type)&&null!==(match=passthroughRegex.exec(type7))&&(layout.type="pass",layout.bits=parseInt(null!=(_n=null==(_m=match.groups)?void 0:_m.bits)?_n:"1"))}},4:container=>{let nextNewId=findFirstFreeId(container);const outs=container.out;if(isArray(outs))for(const out of outs)"nibble"===out.type&&(out.type="nibble-display");const components=container.components;if(isArray(components))for(const comp of components)if("alu"===comp.type&&isArray(comp.out)){comp.out.push(nextNewId++);const t38=comp.out[4];comp.out[4]=comp.out[6],comp.out[6]=t38}},3:container=>{let nextNewId=findFirstFreeId(container);const components=container.components;if(isArray(components))for(const comp of components)"alu"===comp.type&&isArray(comp.in)&&comp.in.push(nextNewId++)},2:container=>{const wires=container.wires;if(isArray(wires))for(const wire of wires)if(isArray(wire)&&3===wire.length){const wireOptions=wire[2];"waypoints"in wireOptions&&(wireOptions.via=wireOptions.waypoints,delete wireOptions.waypoints)}},1:container=>{if("displays"in container){const displays=container.displays;if(delete container.displays,"out"in container||(container.out=[]),isArray(displays)&&isArray(container.out))for(const display of displays)container.out.push(display)}if("clocks"in container){const clocks=container.clocks;if(delete container.clocks,"in"in container||(container.in=[]),isArray(clocks)&&isArray(container.in))for(const clock of clocks)clock.type="clock",container.in.push(clock)}const components=container.components;if(isArray(components))for(const comp of components){let type7;if(isString(type7=comp.type)&&type7.startsWith("flipflop")){const inputs=comp.in,lastThree=inputs.splice(-3);comp.in=[...lastThree,...inputs]}}}};function findFirstFreeId(parsedContents){let maxId=-1;function inspectComponentDef(compDef){for(const fieldName of["id","in","out"])inspectValue(compDef[fieldName])}function inspectValue(value){if(void 0!==value)if("number"==typeof value)!isNaN(value)&&isFinite(value)&&(maxId=Math.max(maxId,value));else if("string"==typeof value)for(const val of value.split("-"))inspectValue(parseInt(val));else if(isArray(value))for(const item of value)inspectValue(item);else"object"==typeof value&&null!==value&&inspectValue(value.id)}__name(inspectComponentDef,"inspectComponentDef"),__name(inspectValue,"inspectValue");for(const jsonField of Object.keys(parsedContents)){const arr=parsedContents[jsonField];if(void 0!==arr&&isArray(arr))for(const comp of arr)inspectComponentDef(comp)}return maxId+1}__name(findFirstFreeId,"findFirstFreeId");var t3=__toESM(require_lib()),ref_icon_default='<svg viewBox="0 0 20 20"><path d="M10 19.125Q9.646 19.125 9.385 18.865Q9.125 18.604 9.125 18.25V17.438Q6.583 17.146 4.719 15.281Q2.854 13.417 2.562 10.875H1.75Q1.396 10.875 1.135 10.615Q0.875 10.354 0.875 10Q0.875 9.646 1.135 9.385Q1.396 9.125 1.75 9.125H2.562Q2.854 6.583 4.719 4.719Q6.583 2.854 9.125 2.562V1.75Q9.125 1.396 9.385 1.135Q9.646 0.875 10 0.875Q10.354 0.875 10.615 1.135Q10.875 1.396 10.875 1.75V2.562Q13.417 2.854 15.281 4.719Q17.146 6.583 17.438 9.125H18.25Q18.604 9.125 18.865 9.385Q19.125 9.646 19.125 10Q19.125 10.354 18.865 10.615Q18.604 10.875 18.25 10.875H17.438Q17.146 13.417 15.281 15.281Q13.417 17.146 10.875 17.438V18.25Q10.875 18.604 10.615 18.865Q10.354 19.125 10 19.125ZM10 15.729Q12.396 15.729 14.062 14.062Q15.729 12.396 15.729 10Q15.729 7.604 14.062 5.938Q12.396 4.271 10 4.271Q7.604 4.271 5.938 5.938Q4.271 7.604 4.271 10Q4.271 12.396 5.938 14.062Q7.604 15.729 10 15.729Z"/></svg>',icons={add:'<svg viewBox="0 0 20 20"><path d="M10 14.167Q10.354 14.167 10.615 13.906Q10.875 13.646 10.875 13.292V10.875H13.312Q13.667 10.875 13.917 10.625Q14.167 10.375 14.167 10Q14.167 9.646 13.906 9.385Q13.646 9.125 13.292 9.125H10.875V6.688Q10.875 6.333 10.625 6.083Q10.375 5.833 10 5.833Q9.646 5.833 9.385 6.094Q9.125 6.354 9.125 6.708V9.125H6.688Q6.333 9.125 6.083 9.375Q5.833 9.625 5.833 10Q5.833 10.354 6.094 10.615Q6.354 10.875 6.708 10.875H9.125V13.312Q9.125 13.667 9.375 13.917Q9.625 14.167 10 14.167ZM10 18.333Q8.271 18.333 6.75 17.677Q5.229 17.021 4.104 15.896Q2.979 14.771 2.323 13.25Q1.667 11.729 1.667 10Q1.667 8.271 2.323 6.75Q2.979 5.229 4.104 4.104Q5.229 2.979 6.75 2.323Q8.271 1.667 10 1.667Q11.729 1.667 13.25 2.323Q14.771 2.979 15.896 4.104Q17.021 5.229 17.677 6.75Q18.333 8.271 18.333 10Q18.333 11.729 17.677 13.25Q17.021 14.771 15.896 15.896Q14.771 17.021 13.25 17.677Q11.729 18.333 10 18.333Z"/></svg>',bordercolor:'<svg viewBox="0 0 20 20"><path d="M3.417 20q-.729 0-1.24-.51-.51-.511-.51-1.24t.51-1.24q.511-.51 1.24-.51h13.166q.729 0 1.24.51.51.511.51 1.24t-.51 1.24q-.511.51-1.24.51Zm1.125-5.021q-.354 0-.615-.26-.26-.261-.26-.615v-2.042q0-.166.062-.322.063-.157.188-.282l7.021-7.02 3.27 3.27-7.02 7.021q-.126.125-.282.188-.156.062-.323.062Zm10.729-8.333L12 3.375l1.458-1.458q.25-.25.646-.25t.646.25L16.833 4q.229.229.177.594-.052.364-.281.594Z"/></svg>',browserload:'<svg viewBox="0 0 20 20"><path d="M10,.6h.3c0,0,.2,0,.3.2l2.6,2.6c.2.2.3.3.3.5s0,.3-.3.5-.3.3-.5.3-.3,0-.5-.3l-1.3-1.3v4.9c0,.2,0,.3-.3.5-.2.2-.3.3-.5.3s-.3,0-.5-.3c-.2-.2-.3-.3-.3-.5V3.1l-1.3,1.3c-.2.2-.3.3-.5.3s-.3,0-.5-.3-.3-.3-.3-.5,0-.3.3-.5l2.6-2.6s.2-.2.3-.2.2,0,.3,0Z"/><path d="M18.1,6.2c-.3-.3-.8-.5-1.2-.5h-3.6v3.5h3.6v8.7H3v-8.7h3.6v-3.5h-3.6c-.4,0-.9.2-1.2.5s-.5.8-.5,1.2v10.4c0,.4.2.9.5,1.2s.8.5,1.2.5h13.9c.4,0,.9-.2,1.2-.5s.5-.8.5-1.2V7.4c0-.4-.2-.9-.5-1.2Z"/></svg>',check:'<svg viewBox="0 0 20 20"><path d="M7.979 14.646Q7.812 14.646 7.656 14.583Q7.5 14.521 7.354 14.375L3.833 10.854Q3.583 10.604 3.594 10.219Q3.604 9.833 3.854 9.583Q4.104 9.333 4.479 9.333Q4.854 9.333 5.104 9.583L8.021 12.5L14.917 5.604Q15.167 5.354 15.531 5.354Q15.896 5.354 16.146 5.604Q16.396 5.854 16.396 6.219Q16.396 6.583 16.146 6.833L8.604 14.375Q8.458 14.521 8.302 14.583Q8.146 14.646 7.979 14.646Z"/></svg>',close:'<svg viewBox="0 0 20 20"><path d="M10 11.229 5.979 15.25q-.25.25-.604.24-.354-.011-.604-.261t-.25-.614q0-.365.25-.615l4-4L4.75 5.979q-.25-.25-.24-.614.011-.365.261-.615t.614-.25q.365 0 .615.25l4 4.021 4.021-4.021q.25-.25.614-.25.365 0 .615.25t.25.615q0 .364-.25.614L11.229 10l4.021 4.021q.25.25.25.604t-.25.604q-.25.25-.615.25-.364 0-.614-.25Z"/></svg>',connect:'<svg viewBox="0 96 960 960"><path d="M744 912q-41 0-72-24t-42-60H396q-55 0-93.5-38.5T264 696q0-55 38.5-93.5T396 564h120q34.65 0 59.325-24.748Q600 514.504 600 479.752 600 445 575.325 420.5T516 396H330q-11 36-42 60t-72 24q-50 0-85-35t-35-85q0-50 35-85t85-35q41 0 72 24t42 60h186q65 0 110.5 45.5T672 480q0 65-45.5 110.5T516 636H396q-24.75 0-42.375 17.677T336 696.177Q336 721 353.625 738.5T396 756h234q11-36 42-60t72-24q50 0 85 35t35 85q0 50-35 85t-85 35ZM216 408q20.4 0 34.2-13.8Q264 380.4 264 360q0-20.4-13.8-34.2Q236.4 312 216 312q-20.4 0-34.2 13.8Q168 339.6 168 360q0 20.4 13.8 34.2Q195.6 408 216 408Z" transform="rotate(180 480 590)"/></svg>',dimensions:'<svg viewBox="0 0 20 20"><path d="M10 8.396q-.354 0-.615-.261-.26-.26-.26-.614V5.125l-.792.792q-.271.271-.635.26-.365-.01-.636-.281-.27-.271-.27-.646t.27-.646l2.313-2.312q.146-.146.302-.209.156-.062.323-.062t.323.062q.156.063.302.209l2.333 2.333q.271.271.261.635-.011.365-.281.636-.271.271-.646.271t-.646-.271l-.771-.771v2.396q0 .354-.26.614-.261.261-.615.261Zm0 9.583q-.167 0-.323-.062-.156-.063-.302-.209l-2.333-2.333q-.271-.271-.261-.635.011-.365.281-.636.271-.271.646-.271t.646.271l.771.771v-2.396q0-.354.26-.614.261-.261.615-.261t.615.261q.26.26.26.614v2.396l.792-.792q.271-.271.635-.26.365.01.636.281.27.271.27.646t-.27.646l-2.313 2.312q-.146.146-.302.209-.156.062-.323.062Zm4.104-5.041q-.271-.271-.271-.646t.271-.646l.771-.771h-2.396q-.354 0-.614-.26-.261-.261-.261-.615t.261-.615q.26-.26.614-.26h2.396l-.792-.792q-.271-.271-.26-.635.01-.365.281-.636.271-.27.646-.27t.646.27l2.312 2.313q.146.146.209.302.062.156.062.323t-.062.323q-.063.156-.209.302l-2.333 2.333q-.271.271-.635.261-.365-.011-.636-.281Zm-9.5 0-2.312-2.313q-.146-.146-.209-.302-.062-.156-.062-.323t.062-.323q.063-.156.209-.302l2.333-2.333q.271-.271.635-.261.365.011.636.281.271.271.271.646t-.271.646l-.771.771h2.396q.354 0 .614.26.261.261.261.615t-.261.615q-.26.26-.614.26H5.125l.792.792q.271.271.26.635-.01.365-.281.636-.271.27-.646.27t-.646-.27Z"/></svg>\n',direction:'<svg viewBox="0 0 20 20"><path d="M10.625 12.771 12.771 10.625Q13.042 10.354 13.042 10Q13.042 9.646 12.771 9.375L10.604 7.208Q10.354 6.958 10 6.958Q9.646 6.958 9.396 7.208Q9.125 7.479 9.125 7.833Q9.125 8.188 9.396 8.438L10.062 9.125H7.479Q7.125 9.125 6.875 9.385Q6.625 9.646 6.625 10Q6.625 10.354 6.885 10.615Q7.146 10.875 7.5 10.875H10.062L9.375 11.562Q9.125 11.812 9.125 12.167Q9.125 12.521 9.396 12.771Q9.646 13.042 10 13.042Q10.354 13.042 10.625 12.771ZM10 18.333Q8.271 18.333 6.75 17.677Q5.229 17.021 4.104 15.896Q2.979 14.771 2.323 13.25Q1.667 11.729 1.667 10Q1.667 8.271 2.323 6.75Q2.979 5.229 4.104 4.104Q5.229 2.979 6.75 2.323Q8.271 1.667 10 1.667Q11.729 1.667 13.25 2.323Q14.771 2.979 15.896 4.104Q17.021 5.229 17.677 6.75Q18.333 8.271 18.333 10Q18.333 11.729 17.677 13.25Q17.021 14.771 15.896 15.896Q14.771 17.021 13.25 17.677Q11.729 18.333 10 18.333Z"/></svg>',download:'<svg viewBox="0 0 20 20"><path d="M10 12.917q-.167 0-.323-.063-.156-.062-.302-.208L6.333 9.604q-.271-.271-.271-.625t.271-.625q.271-.271.625-.271t.625.271l1.542 1.542V4.208q0-.354.26-.614.261-.261.615-.261t.615.261q.26.26.26.614v5.688l1.542-1.542q.271-.271.625-.271t.625.271q.271.271.271.625t-.271.625l-3.042 3.042q-.146.146-.302.208-.156.063-.323.063Zm-4.917 3.75q-.729 0-1.239-.511-.511-.51-.511-1.239v-1.542q0-.354.261-.615.26-.26.614-.26t.615.26q.26.261.26.615v1.542h9.834v-1.542q0-.354.26-.615.261-.26.615-.26t.614.26q.261.261.261.615v1.542q0 .729-.511 1.239-.51.511-1.239.511Z"/></svg>',edit:'<svg viewBox="0 0 20 20"><path d="m16.188 7.542-3.73-3.73 1.021-1.02q.521-.521 1.24-.521t1.239.521l1.25 1.25q.5.5.5 1.239 0 .74-.5 1.24ZM3.375 17.5q-.354 0-.615-.26-.26-.261-.26-.615v-2.5q0-.167.062-.323.063-.156.188-.281l8.479-8.479 3.729 3.729-8.479 8.479q-.125.125-.281.188-.156.062-.323.062Z"/></svg>',eye:'<svg viewBox="0 0 20 20"><path d="M10.021 13.375Q11.604 13.375 12.708 12.25Q13.812 11.125 13.812 9.542Q13.812 7.958 12.708 6.854Q11.604 5.75 10.021 5.75Q8.438 5.75 7.312 6.854Q6.188 7.958 6.188 9.542Q6.188 11.146 7.302 12.26Q8.417 13.375 10.021 13.375ZM10.021 11.812Q9.083 11.812 8.417 11.146Q7.75 10.479 7.75 9.542Q7.75 8.604 8.417 7.958Q9.083 7.312 10.021 7.312Q10.958 7.312 11.604 7.958Q12.25 8.604 12.25 9.542Q12.25 10.479 11.604 11.146Q10.958 11.812 10.021 11.812ZM10 15.833Q7.083 15.833 4.688 14.292Q2.292 12.75 1.083 10.146Q1.042 10.042 1.01 9.885Q0.979 9.729 0.979 9.562Q0.979 9.396 1.01 9.24Q1.042 9.083 1.083 8.979Q2.292 6.375 4.698 4.844Q7.104 3.312 10 3.312Q12.896 3.312 15.302 4.844Q17.708 6.375 18.917 8.979Q18.958 9.083 18.99 9.24Q19.021 9.396 19.021 9.562Q19.021 9.729 18.99 9.885Q18.958 10.042 18.917 10.146Q17.708 12.75 15.312 14.292Q12.917 15.833 10 15.833Z"/></svg>',font:'<svg viewBox="0 0 20 20"><path d="M7.083 16.667q-.541 0-.916-.375t-.375-.917V5.917H2.958q-.541 0-.916-.375t-.375-.917q0-.542.375-.917t.916-.375h8.25q.542 0 .917.375t.375.917q0 .542-.375.917t-.917.375H8.375v9.458q0 .542-.375.917t-.917.375Zm7.5 0q-.541 0-.916-.375t-.375-.917v-5.292h-1.167q-.542 0-.917-.375t-.375-.916q0-.542.375-.917t.917-.375h4.917q.541 0 .916.375t.375.917q0 .541-.375.916t-.916.375h-1.167v5.292q0 .542-.375.917t-.917.375Z"/></svg>',force:'<svg viewBox="0 0 20 20"><path d="M10 17.5Q9.292 17.5 8.792 17Q8.292 16.5 8.292 15.792Q8.292 15.083 8.792 14.583Q9.292 14.083 10 14.083Q10.708 14.083 11.208 14.583Q11.708 15.083 11.708 15.792Q11.708 16.5 11.208 17Q10.708 17.5 10 17.5ZM10 12.5Q9.292 12.5 8.792 12Q8.292 11.5 8.292 10.792V4.208Q8.292 3.5 8.792 3Q9.292 2.5 10 2.5Q10.708 2.5 11.208 3Q11.708 3.5 11.708 4.208V10.792Q11.708 11.5 11.208 12Q10.708 12.5 10 12.5Z"/></svg>',inputs:'<svg viewBox="0 0 20 20"><path d="M3,7.6c0.3,0.3,0.6,0.5,0.9,0.6c0.4,0.2,0.7,0.2,1.1,0.2s0.8-0.1,1.1-0.2c0.4-0.2,0.7-0.4,0.9-0.6C7.4,7.3,7.6,7,7.8,6.7\n\t\tc0,0,0-0.1,0-0.1h9.8v-2H7.8c0,0,0-0.1,0-0.1C7.6,4,7.4,3.7,7.1,3.5C6.9,3.2,6.6,3,6.2,2.8c-0.7-0.3-1.6-0.3-2.3,0\n\t\tC3.6,3,3.3,3.2,3,3.5C2.8,3.7,2.5,4,2.4,4.4C2.2,4.7,2.2,5.1,2.2,5.5c0,0.4,0.1,0.8,0.2,1.1C2.5,7,2.8,7.3,3,7.6z M3.5,4.9\n\t\tc0.1-0.2,0.2-0.4,0.4-0.5C4,4.2,4.2,4,4.4,3.9c0.2-0.1,0.4-0.1,0.7-0.1s0.5,0,0.7,0.1C6,4,6.1,4.2,6.3,4.3c0.2,0.2,0.3,0.3,0.4,0.5\n\t\tc0.1,0.2,0.1,0.4,0.1,0.7c0,0.2,0,0.5-0.1,0.7C6.6,6.4,6.5,6.6,6.3,6.7C6.1,6.9,6,7,5.7,7.1c-0.4,0.2-0.9,0.2-1.3,0\n\t\tC4.2,7,4,6.9,3.9,6.7C3.7,6.6,3.6,6.4,3.5,6.2C3.4,6,3.4,5.8,3.4,5.5C3.4,5.3,3.4,5.1,3.5,4.9z"/><path d="M17.6,13.5H7.8c0,0,0-0.1,0-0.1c-0.2-0.4-0.4-0.7-0.6-0.9s-0.6-0.5-0.9-0.6c-0.7-0.3-1.6-0.3-2.3,0\n\t\tc-0.3,0.2-0.7,0.4-0.9,0.6c-0.3,0.3-0.5,0.6-0.6,0.9c-0.2,0.4-0.2,0.7-0.2,1.1c0,0.4,0.1,0.8,0.2,1.1C2.5,16,2.8,16.3,3,16.5\n\t\tc0.3,0.3,0.6,0.5,0.9,0.6c0.4,0.2,0.7,0.2,1.1,0.2s0.8-0.1,1.1-0.2c0.3-0.2,0.7-0.4,0.9-0.6c0.3-0.3,0.5-0.6,0.6-0.9\n\t\tc0,0,0-0.1,0-0.1h9.8V13.5z M6.7,15.1c-0.1,0.2-0.2,0.4-0.4,0.5C6.1,15.8,6,16,5.7,16c-0.4,0.2-0.9,0.2-1.3,0\n\t\tC4.2,16,4,15.8,3.9,15.7c-0.2-0.2-0.3-0.3-0.4-0.5c-0.1-0.2-0.1-0.4-0.1-0.7c0-0.2,0-0.5,0.1-0.7c0.1-0.2,0.2-0.4,0.4-0.5\n\t\tC4,13.1,4.2,13,4.4,12.9c0.2-0.1,0.4-0.1,0.7-0.1s0.5,0,0.7,0.1C6,13,6.1,13.1,6.3,13.2c0.2,0.2,0.3,0.3,0.4,0.5\n\t\tc0.1,0.2,0.1,0.4,0.1,0.7C6.8,14.7,6.8,14.9,6.7,15.1z"/></svg>',link:'<svg viewBox="0 0 20 20"><path d="M5.833 14.167q-1.729 0-2.948-1.219Q1.667 11.729 1.667 10q0-1.729 1.218-2.948 1.219-1.219 2.948-1.219H8.25q.354 0 .615.261.26.26.26.614t-.26.615q-.261.26-.615.26H5.833q-1.041 0-1.729.688-.687.687-.687 1.729t.687 1.729q.688.688 1.729.688H8.25q.354 0 .615.26.26.261.26.615t-.26.614q-.261.261-.615.261Zm1.709-3.292q-.354 0-.615-.26-.26-.261-.26-.615t.26-.615q.261-.26.615-.26h4.916q.354 0 .615.26.26.261.26.615t-.26.615q-.261.26-.615.26Zm4.208 3.292q-.354 0-.615-.261-.26-.26-.26-.614t.26-.615q.261-.26.615-.26h2.417q1.041 0 1.729-.688.687-.687.687-1.729t-.687-1.729q-.688-.688-1.729-.688H11.75q-.354 0-.615-.26-.26-.261-.26-.615t.26-.614q.261-.261.615-.261h2.417q1.729 0 2.948 1.219Q18.333 8.271 18.333 10q0 1.729-1.218 2.948-1.219 1.219-2.948 1.219Z"/></svg>',memcontent:'<svg viewBox="0 0 20 20"><path d="M2.1,8.2H0.6V6.8h0.1c0.5,0,0.9-0.1,1.1-0.4c0.3-0.3,0.5-0.7,0.5-1.3h1.1v10.4H2.1V8.2z"/><path d="M5.3,8.6c0-0.7,0.1-1.3,0.3-1.8c0.1-0.5,0.4-0.9,0.7-1.2c0.3-0.3,0.7-0.5,1.2-0.5c0.4,0,0.8,0.1,1.1,0.3\n\t\tC8.8,5.6,9,5.9,9.2,6.3c0.2,0.4,0.3,0.9,0.4,1.6c0.1,0.6,0.1,1.4,0.1,2.3c0,0.7,0,1.4,0,2.1c0,0.7-0.1,1.3-0.3,1.8\n\t\tc-0.1,0.5-0.4,0.9-0.7,1.2c-0.3,0.3-0.7,0.4-1.2,0.4c-0.4,0-0.8-0.1-1.1-0.2c-0.3-0.2-0.5-0.4-0.7-0.8c-0.2-0.4-0.3-0.9-0.4-1.6\n\t\tc-0.1-0.6-0.1-1.4-0.1-2.3C5.2,10,5.2,9.3,5.3,8.6z M6.7,12.7c0,0.4,0.1,0.7,0.1,1C6.9,14,6.9,14.1,7,14.2c0.1,0.1,0.2,0.1,0.4,0.1\n\t\tc0.2,0,0.3-0.1,0.4-0.2C7.9,14.1,8,13.9,8,13.6c0.1-0.3,0.1-0.6,0.1-1.1c0-0.4,0-1,0-1.7V9.7c0-0.7,0-1.2,0-1.6\n\t\tc0-0.4-0.1-0.7-0.1-1C8,6.9,7.9,6.8,7.8,6.7C7.7,6.6,7.6,6.5,7.4,6.5C7.3,6.5,7.1,6.6,7,6.7C6.9,6.8,6.9,7,6.8,7.3\n\t\tC6.7,7.5,6.7,7.9,6.7,8.3c0,0.4,0,1,0,1.7v1.1C6.6,11.8,6.7,12.3,6.7,12.7z"/><path d="M11.6,8.2h-1.4V6.8h0.1c0.5,0,0.9-0.1,1.1-0.4c0.3-0.3,0.5-0.7,0.5-1.3h1.1v10.4h-1.4V8.2z"/><path d="M14.8,8.6c0-0.7,0.1-1.3,0.3-1.8s0.4-0.9,0.7-1.2c0.3-0.3,0.7-0.5,1.2-0.5c0.4,0,0.8,0.1,1.1,0.3c0.3,0.2,0.5,0.5,0.7,0.9\n\t\tc0.2,0.4,0.3,0.9,0.4,1.6c0.1,0.6,0.1,1.4,0.1,2.3c0,0.7,0,1.4,0,2.1c0,0.7-0.1,1.3-0.3,1.8c-0.1,0.5-0.4,0.9-0.7,1.2\n\t\tc-0.3,0.3-0.7,0.4-1.2,0.4c-0.4,0-0.8-0.1-1.1-0.2c-0.3-0.2-0.5-0.4-0.7-0.8c-0.2-0.4-0.3-0.9-0.4-1.6c-0.1-0.6-0.1-1.4-0.1-2.3\n\t\tC14.8,10,14.8,9.3,14.8,8.6z M16.3,12.7c0,0.4,0.1,0.7,0.1,1c0.1,0.2,0.1,0.4,0.2,0.5c0.1,0.1,0.2,0.1,0.4,0.1\n\t\tc0.2,0,0.3-0.1,0.4-0.2c0.1-0.1,0.2-0.3,0.2-0.6c0.1-0.3,0.1-0.6,0.1-1.1c0-0.4,0-1,0-1.7V9.7c0-0.7,0-1.2,0-1.6\n\t\tc0-0.4-0.1-0.7-0.1-1c-0.1-0.2-0.1-0.4-0.2-0.5c-0.1-0.1-0.2-0.1-0.4-0.1c-0.2,0-0.3,0.1-0.4,0.2c-0.1,0.1-0.2,0.3-0.2,0.6\n\t\tc-0.1,0.3-0.1,0.6-0.1,1.1c0,0.4,0,1,0,1.7v1.1C16.2,11.8,16.2,12.3,16.3,12.7z"/></svg>',memlines:'<svg viewBox="0 0 20 20"><path d="M6.4,6h11.8c0.2,0,0.4-0.1,0.5-0.3C18.9,5.5,19,5.3,19,5.1s-0.1-0.4-0.3-0.6c-0.2-0.2-0.4-0.3-0.5-0.3H6.4\n\t\tC6.2,4.2,6,4.3,5.9,4.5C5.7,4.7,5.6,4.8,5.6,5.1s0.1,0.5,0.3,0.6C6,5.9,6.1,6,6.4,6z"/><path d="M18.2,7.7H6.4C6.2,7.7,6,7.8,5.9,8C5.7,8.2,5.6,8.3,5.6,8.6c0,0.3,0.1,0.5,0.3,0.6C6,9.4,6.1,9.5,6.4,9.5h11.8\n\t\tc0.2,0,0.4-0.1,0.5-0.3S19,8.8,19,8.6c0-0.2-0.1-0.4-0.3-0.6S18.4,7.7,18.2,7.7z"/><path d="M18.2,11.2H6.4c-0.2,0-0.4,0.1-0.5,0.3c-0.2,0.2-0.3,0.3-0.3,0.6c0,0.3,0.1,0.5,0.3,0.6C6,12.9,6.1,13,6.4,13h11.8\n\t\tc0.2,0,0.4-0.1,0.5-0.3s0.3-0.4,0.3-0.6c0-0.2-0.1-0.4-0.3-0.6S18.4,11.2,18.2,11.2z"/><path d="M18.2,14.7H6.4c-0.2,0-0.4,0.1-0.5,0.3c-0.2,0.2-0.3,0.3-0.3,0.6s0.1,0.5,0.3,0.6c0.1,0.2,0.3,0.3,0.5,0.3h11.8\n\t\tc0.2,0,0.4-0.1,0.5-0.3c0.2-0.2,0.3-0.4,0.3-0.6s-0.1-0.4-0.3-0.6C18.6,14.8,18.4,14.7,18.2,14.7z"/><path d="M0.3,7.2L5.3,5L0.2,2.7C1.6,4.4,1.6,5.7,0.3,7.2z"/></svg>',mouse:'<svg viewBox="0 0 20 20"><polygon points="5.1,14.7 5.1,1 15,11.1 10.5,11.1 13.3,17.6 11,18.6 8.1,11.8 " fill="currentColor"/></svg>',move:'<svg viewBox="0 0 20 20"><path d="M10 8.396q-.354 0-.615-.261-.26-.26-.26-.614V5.125l-.792.792q-.271.271-.635.26-.365-.01-.636-.281-.27-.271-.27-.646t.27-.646l2.313-2.312q.146-.146.302-.209.156-.062.323-.062t.323.062q.156.063.302.209l2.333 2.333q.271.271.261.635-.011.365-.281.636-.271.271-.646.271t-.646-.271l-.771-.771v2.396q0 .354-.26.614-.261.261-.615.261Zm0 9.583q-.167 0-.323-.062-.156-.063-.302-.209l-2.333-2.333q-.271-.271-.261-.635.011-.365.281-.636.271-.271.646-.271t.646.271l.771.771v-2.396q0-.354.26-.614.261-.261.615-.261t.615.261q.26.26.26.614v2.396l.792-.792q.271-.271.635-.26.365.01.636.281.27.271.27.646t-.27.646l-2.313 2.312q-.146.146-.302.209-.156.062-.323.062Zm4.104-5.041q-.271-.271-.271-.646t.271-.646l.771-.771h-2.396q-.354 0-.614-.26-.261-.261-.261-.615t.261-.615q.26-.26.614-.26h2.396l-.792-.792q-.271-.271-.26-.635.01-.365.281-.636.271-.27.646-.27t.646.27l2.312 2.313q.146.146.209.302.062.156.062.323t-.062.323q-.063.156-.209.302l-2.333 2.333q-.271.271-.635.261-.365-.011-.636-.281Zm-9.5 0-2.312-2.313q-.146-.146-.209-.302-.062-.156-.062-.323t.062-.323q.063-.156.209-.302l2.333-2.333q.271-.271.635-.261.365.011.636.281.271.271.271.646t-.271.646l-.771.771h2.396q.354 0 .614.26.261.261.261.615t-.261.615q-.26.26-.614.26H5.125l.792.792q.271.271.26.635-.01.365-.281.636-.271.27-.646.27t-.646-.27Z"/></svg>',newcomponent:'<svg viewBox="0 0 20 20"><path d="M3.2,1.8v16.5H17V1.8H3.2z M15.2,16.4H5V3.6h10.2V16.4z"/><polygon fill="currentColor" points="9.3,13 10.9,13 10.9,10.7 13.1,10.7 13.1,9.2 10.9,9.2 10.9,6.9 9.3,6.9 9.3,9.2 7.1,9.2 7.1,10.7 9.3,10.7"/></svg>',none:'<svg viewBox="0 0 20 20"></svg>\n',open:'<svg viewBox="0 0 20 20"><path d="m17.667 18.083-1.792-1.791v.916q0 .354-.26.615-.261.26-.615.26t-.615-.26q-.26-.261-.26-.615v-3.041q0-.355.26-.615.261-.26.615-.26h3.042q.354 0 .614.26.261.26.261.615 0 .354-.261.614-.26.261-.614.261h-.938l1.813 1.812q.25.25.25.604t-.25.625q-.25.271-.615.271-.364 0-.635-.271ZM11.708 7.5h3.209l-4.084-4.083v3.208q0 .354.261.615.26.26.614.26ZM5.083 18.333q-.687 0-1.218-.531-.532-.531-.532-1.219V3.417q0-.688.532-1.219.531-.531 1.218-.531h5.855q.354 0 .677.135.323.136.573.386l3.958 3.958q.25.25.385.573.136.323.136.677v4.146h-2.542q-.729 0-1.24.51-.51.51-.51 1.24v5.041Z"/></svg>',outputs:'<svg viewBox="0 0 20 20"><path d="M12.6,6.6c0.2,0.4,0.4,0.7,0.7,1c0.2,0.2,0.6,0.4,0.9,0.6c0.3,0.1,0.7,0.2,1.1,0.2c0.4,0,0.8-0.1,1-0.3\n\t\tc0.3-0.1,0.6-0.3,0.9-0.6c0.2-0.2,0.4-0.6,0.6-0.9C17.9,6.3,18,5.9,18,5.5s0-0.8-0.2-1.1c-0.1-0.3-0.4-0.7-0.6-0.9\n\t\ts-0.6-0.4-0.9-0.6c-0.3-0.1-0.7-0.2-1.1-0.2c-0.4,0-0.8,0-1.1,0.2c-0.3,0.1-0.7,0.4-0.9,0.6s-0.4,0.6-0.6,0.9c0,0,0,0.1,0,0.1H2.8\n\t\tv2L12.6,6.6C12.6,6.5,12.6,6.6,12.6,6.6z"/><path d="M17.9,13.4c-0.1-0.3-0.4-0.7-0.6-0.9s-0.6-0.4-0.9-0.6c-0.3-0.1-0.7-0.2-1.1-0.2c-0.4,0-0.8,0.1-1.1,0.2\n\t\tc-0.3,0.1-0.7,0.4-0.9,0.6s-0.5,0.6-0.6,0.9c0,0,0,0.1,0,0.1H2.8v2h9.9c0,0,0,0.1,0,0.1c0.1,0.3,0.4,0.7,0.6,0.9s0.6,0.4,0.9,0.6\n\t\tc0.3,0.1,0.7,0.2,1.1,0.2c0.4,0,0.8-0.1,1.1-0.2c0.3-0.1,0.7-0.4,0.9-0.6s0.4-0.6,0.6-0.9c0.1-0.3,0.2-0.7,0.2-1.1\n\t\tS18.1,13.7,17.9,13.4z"/></svg>',palette:'<svg viewBox="0 0 20 20"><path d="M9.958 18.333Q8.25 18.333 6.74 17.677Q5.229 17.021 4.104 15.885Q2.979 14.75 2.323 13.229Q1.667 11.708 1.667 10Q1.667 8.271 2.333 6.75Q3 5.229 4.156 4.104Q5.312 2.979 6.854 2.323Q8.396 1.667 10.125 1.667Q11.771 1.667 13.26 2.25Q14.75 2.833 15.875 3.854Q17 4.875 17.667 6.26Q18.333 7.646 18.333 9.25Q18.333 11.688 16.792 12.948Q15.25 14.208 13.188 14.208H11.75Q11.625 14.208 11.562 14.281Q11.5 14.354 11.5 14.458Q11.5 14.688 11.812 15.219Q12.125 15.75 12.125 16.458Q12.125 17.458 11.51 17.896Q10.896 18.333 9.958 18.333ZM5.458 10.875Q6 10.875 6.375 10.5Q6.75 10.125 6.75 9.583Q6.75 9.042 6.375 8.667Q6 8.292 5.458 8.292Q4.917 8.292 4.542 8.667Q4.167 9.042 4.167 9.583Q4.167 10.125 4.542 10.5Q4.917 10.875 5.458 10.875ZM7.917 7.583Q8.458 7.583 8.833 7.208Q9.208 6.833 9.208 6.292Q9.208 5.75 8.833 5.375Q8.458 5 7.917 5Q7.375 5 7 5.375Q6.625 5.75 6.625 6.292Q6.625 6.833 7 7.208Q7.375 7.583 7.917 7.583ZM12.021 7.583Q12.562 7.583 12.938 7.208Q13.312 6.833 13.312 6.292Q13.312 5.75 12.938 5.375Q12.562 5 12.021 5Q11.479 5 11.104 5.375Q10.729 5.75 10.729 6.292Q10.729 6.833 11.104 7.208Q11.479 7.583 12.021 7.583ZM14.479 10.875Q15.021 10.875 15.396 10.5Q15.771 10.125 15.771 9.583Q15.771 9.042 15.396 8.667Q15.021 8.292 14.479 8.292Q13.938 8.292 13.562 8.667Q13.188 9.042 13.188 9.583Q13.188 10.125 13.562 10.5Q13.938 10.875 14.479 10.875Z"/></svg>',pause:'<svg viewBox="0 0 20 20"><path d="M12.5 15.833q-.729 0-1.24-.51-.51-.511-.51-1.24V5.917q0-.729.51-1.24.511-.51 1.24-.51h1.583q.729 0 1.24.51.51.511.51 1.24v8.166q0 .729-.51 1.24-.511.51-1.24.51Zm-6.583 0q-.729 0-1.24-.51-.51-.511-.51-1.24V5.917q0-.729.51-1.24.511-.51 1.24-.51H7.5q.729 0 1.24.51.51.511.51 1.24v8.166q0 .729-.51 1.24-.511.51-1.24.51Z"/></svg>',pen:'<svg viewBox="0 0 20 20"><path d="M16.188 7.542 12.458 3.812 13.479 2.792Q14 2.271 14.719 2.271Q15.438 2.271 15.958 2.792L17.208 4.042Q17.708 4.542 17.708 5.281Q17.708 6.021 17.208 6.521ZM3.375 17.5Q3.021 17.5 2.76 17.24Q2.5 16.979 2.5 16.625V14.125Q2.5 13.958 2.562 13.802Q2.625 13.646 2.75 13.521L11.229 5.042L14.958 8.771L6.479 17.25Q6.354 17.375 6.198 17.438Q6.042 17.5 5.875 17.5Z"/></svg>',placement:'<svg viewBox="0 0 20 20"><path d="M16.8,1.7H3.2c-0.8,0-1.5,0.7-1.5,1.5v13.6c0,0.8,0.7,1.5,1.5,1.5h13.6c0.8,0,1.5-0.7,1.5-1.5V3.2\n\t\tC18.3,2.4,17.6,1.7,16.8,1.7z M17.3,11v4.5h-1.9v1.8H11v-1.8H9v1.8H4.6v-1.8H2.7V11h1.9V9.1H2.7V4.6h1.9V2.7H9v1.9H11V2.7h4.4v1.9\n\t\th1.9v4.5h-1.9V11H17.3z"/><rect x="9" y="9.1" width="1.9" height="1.9"/></svg>',play:'<svg viewBox="0 0 20 20"><path d="M8.042 14.958q-.438.292-.896.042-.458-.25-.458-.792V5.75q0-.542.458-.792T8.042 5l6.646 4.25q.416.25.416.729t-.416.729Z"/></svg>',question:'<svg viewBox="0 0 20 20"><path d="M10.021 13.333q-.521 0-.886-.323-.364-.322-.302-.906.105-1.021.459-1.656.354-.636 1.125-1.323.854-.75 1.239-1.26.386-.511.386-1.219 0-.854-.511-1.333-.51-.48-1.531-.48-.625 0-1.052.25-.427.25-.719.605-.354.458-.802.604-.448.146-.865-.021-.541-.229-.666-.771t.229-1.021q.604-.875 1.583-1.427Q8.688 2.5 10 2.5q2.188 0 3.365 1.219t1.177 2.927q0 1.042-.448 1.781-.448.74-1.406 1.677-.688.667-.98 1.073-.291.406-.375.927-.104.542-.458.886-.354.343-.854.343Zm-.021 5q-.708 0-1.208-.5t-.5-1.208q0-.708.5-1.208t1.208-.5q.708 0 1.208.5t.5 1.208q0 .708-.5 1.208t-1.208.5Z"/></svg>',questioncircled:'<svg viewBox="0 0 20 20"><path d="M9.958 15.021Q10.417 15.021 10.729 14.708Q11.042 14.396 11.042 13.938Q11.042 13.479 10.729 13.167Q10.417 12.854 9.958 12.854Q9.5 12.854 9.188 13.167Q8.875 13.479 8.875 13.938Q8.875 14.396 9.188 14.708Q9.5 15.021 9.958 15.021ZM10.062 6.458Q10.646 6.458 11.01 6.771Q11.375 7.083 11.375 7.562Q11.375 7.896 11.146 8.271Q10.917 8.646 10.5 9Q9.833 9.583 9.531 10.073Q9.229 10.562 9.229 11.042Q9.229 11.354 9.438 11.562Q9.646 11.771 9.979 11.771Q10.292 11.771 10.531 11.562Q10.771 11.354 10.833 11Q10.896 10.667 11.115 10.365Q11.333 10.062 11.833 9.583Q12.5 8.958 12.74 8.469Q12.979 7.979 12.979 7.396Q12.979 6.312 12.188 5.646Q11.396 4.979 10.104 4.979Q9.229 4.979 8.573 5.323Q7.917 5.667 7.438 6.354Q7.271 6.583 7.344 6.854Q7.417 7.125 7.646 7.312Q7.917 7.521 8.26 7.448Q8.604 7.375 8.833 7.062Q9.062 6.771 9.365 6.615Q9.667 6.458 10.062 6.458ZM10 18.333Q8.292 18.333 6.771 17.677Q5.25 17.021 4.115 15.896Q2.979 14.771 2.323 13.25Q1.667 11.729 1.667 10Q1.667 8.271 2.323 6.75Q2.979 5.229 4.115 4.104Q5.25 2.979 6.771 2.323Q8.292 1.667 10 1.667Q11.75 1.667 13.271 2.323Q14.792 2.979 15.917 4.104Q17.042 5.229 17.688 6.75Q18.333 8.271 18.333 10Q18.333 11.729 17.688 13.25Q17.042 14.771 15.917 15.896Q14.792 17.021 13.271 17.677Q11.75 18.333 10 18.333Z"/></svg>',redo:'<svg viewBox="0 96 960 960"><path d="M398 856q-97 0-167.5-63T160 636q0-94 70.5-156.5T398 417h242l-73-73q-12-12-11.5-29t12.5-29q12-12 29.5-12t29.5 12l143 143q7 7 10 14.5t3 15.5q0 8-3 15.5T770 489L626 633q-12 12-29 11.5T568 632q-12-12-12-29.5t12-29.5l72-72H398q-62 0-108 38t-46 97q0 60 46 98t108 38h239q17 0 29.5 12.5T679 814q0 17-12.5 29.5T637 856H398Z"/></svg>',ref:ref_icon_default,regroup:ref_icon_default,replace:'<svg viewBox="0 0 20 20"><path d="M13.188 11.104 15.354 8.938Q15.625 8.667 15.625 8.312Q15.625 7.958 15.354 7.688L13.208 5.542Q12.958 5.292 12.604 5.292Q12.25 5.292 11.979 5.562Q11.708 5.833 11.708 6.188Q11.708 6.542 11.979 6.812L12.625 7.479H10.042Q9.688 7.479 9.438 7.729Q9.188 7.979 9.188 8.354Q9.188 8.708 9.448 8.969Q9.708 9.229 10.062 9.229H12.583L11.938 9.875Q11.688 10.125 11.688 10.479Q11.688 10.833 11.958 11.104Q12.208 11.354 12.562 11.365Q12.917 11.375 13.188 11.104ZM6.792 14.438Q7.062 14.708 7.417 14.708Q7.771 14.708 8.062 14.417Q8.312 14.167 8.312 13.802Q8.312 13.438 8.042 13.167L7.396 12.521H9.979Q10.333 12.521 10.583 12.271Q10.833 12.021 10.833 11.646Q10.833 11.292 10.573 11.031Q10.312 10.771 9.958 10.771H7.438L8.104 10.104Q8.354 9.854 8.354 9.5Q8.354 9.146 8.083 8.896Q7.833 8.625 7.469 8.625Q7.104 8.625 6.833 8.896L4.667 11.062Q4.396 11.333 4.396 11.688Q4.396 12.042 4.667 12.312ZM10 18.333Q8.271 18.333 6.75 17.677Q5.229 17.021 4.104 15.896Q2.979 14.771 2.323 13.25Q1.667 11.729 1.667 10Q1.667 8.271 2.323 6.75Q2.979 5.229 4.104 4.104Q5.229 2.979 6.75 2.323Q8.271 1.667 10 1.667Q11.729 1.667 13.25 2.323Q14.771 2.979 15.896 4.104Q17.021 5.229 17.677 6.75Q18.333 8.271 18.333 10Q18.333 11.729 17.677 13.25Q17.021 14.771 15.896 15.896Q14.771 17.021 13.25 17.677Q11.729 18.333 10 18.333Z"/></svg>',reset:'<svg viewBox="0 0 20 20"><path d="M14.8,6.1c-1.3-1.3-2.8-1.9-4.7-1.9h0l0.2-0.2c0.2-0.2,0.2-0.4,0.2-0.6c0-0.2-0.1-0.4-0.2-0.6c-0.2-0.2-0.4-0.2-0.6-0.2\n\t\t\t\tS9.2,2.5,9,2.7L7.3,4.4C7.2,4.5,7.1,4.6,7.1,4.7C7.1,4.8,7,4.9,7,5c0,0.1,0,0.2,0.1,0.3c0,0.1,0.1,0.2,0.2,0.3L9,7.4\n\t\t\t\tc0.2,0.2,0.4,0.3,0.6,0.3s0.4-0.1,0.6-0.3c0.2-0.2,0.2-0.4,0.2-0.6s-0.1-0.4-0.2-0.6L10,5.9h0c1.4,0,2.5,0.5,3.5,1.4\n\t\t\t\ts1.4,2.1,1.4,3.5c0,1.1-0.3,2.1-0.9,2.9c-0.3,0.4-0.6,0.7-1,1c-0.4,0.3-0.9,0.5-1.4,0.8c-1,0.3-1.9,0.4-2.9,0.1\n\t\t\t\tc-0.5-0.2-1-0.4-1.4-0.7c-0.1-0.1-0.2-0.1-0.3-0.2c-0.3-0.3-0.7-0.6-0.9-1c-0.6-0.9-0.9-1.8-0.9-2.9c0-0.5,0.1-1,0.2-1.5\n\t\t\t\tC5.5,8.8,5.7,8.4,6,7.9c0.1-0.2,0.2-0.4,0.2-0.6S6.1,6.9,6,6.8C5.8,6.6,5.5,6.5,5.3,6.5C5,6.5,4.8,6.6,4.7,6.8\n\t\t\t\tC4.2,7.4,3.9,8,3.7,8.7c-0.2,0.7-0.3,1.4-0.3,2.1c0,1.5,0.4,2.9,1.3,4c0.8,1.1,1.9,1.9,3.2,2.3c0.1,0,0.2,0.1,0.2,0.1\n\t\t\t\tc1.5,0.4,2.9,0.4,4.3-0.1c0.4-0.2,0.7-0.4,1-0.6c0.7-0.4,1.3-1,1.9-1.7c0.9-1.2,1.3-2.5,1.3-4C16.7,9,16,7.4,14.8,6.1z"/></svg>',screenshot:'<svg viewBox="0 0 20 20"><path d="M10 14.583q1.604 0 2.698-1.093 1.094-1.094 1.094-2.678 0-1.583-1.094-2.677Q11.604 7.042 10 7.042q-1.583 0-2.667 1.093Q6.25 9.229 6.25 10.812q0 1.584 1.083 2.678Q8.417 14.583 10 14.583ZM3.417 17.5q-.729 0-1.24-.51-.51-.511-.51-1.24V5.896q0-.729.51-1.24.511-.51 1.24-.51h2.541l1-1.084q.25-.27.584-.416.333-.146.708-.146h3.521q.354 0 .687.146.334.146.584.416l1.02 1.084h2.521q.729 0 1.24.51.51.511.51 1.24v9.854q0 .729-.51 1.24-.511.51-1.24.51Z"/></svg>',setinput:'<svg viewBox="0 0 20 20"><path class="st0" d="M6.4,6.3"/><path d="M2.5,6.2l4.8,4.3,1.2-6.8-2.1.9C4.7,1.7,1.3,0,.2-.5L-.3.4l-.4.9c1.9.9,4,2.3,5.3,4.1l-2,.8Z"/><path d="M6.1,16.2c.3.3.6.5.9.6.4.2.7.2,1.1.2s.8-.1,1.1-.2c.4-.2.7-.4.9-.6.4-.3.6-.6.8-.9h0c0,0,9.8,0,9.8,0v-2h-9.8c-.2-.6-.4-.9-.7-1.1-.2-.3-.5-.5-.9-.7-.7-.3-1.6-.3-2.3,0-.3.2-.6.4-.9.7s-.5.5-.6.9c-.2.3-.2.7-.2,1.1s0,.8.2,1.1c0,.4.4.7.6,1ZM6.6,13.5c0-.2.2-.4.4-.5,0-.2.3-.4.5-.5.2,0,.4,0,.7,0s.5,0,.7,0c.2,0,.3.3.5.4.2.2.3.3.4.5s0,.4,0,.7,0,.5,0,.7c-.1.2-.2.4-.4.5-.2.2-.3.3-.6.4-.4.2-.9.2-1.3,0-.2,0-.4-.2-.5-.4-.2,0-.3-.3-.4-.5,0-.2,0-.4,0-.7s0-.4,0-.6Z"/></svg>',settings:'<svg viewBox="0 0 20 20"><path d="M11.583 18.333H8.417q-.334 0-.573-.218-.24-.219-.282-.553l-.229-1.854q-.208-.125-.458-.27-.25-.146-.458-.271l-1.729.729q-.313.125-.626.021-.312-.105-.479-.396l-1.562-2.729q-.167-.292-.094-.604.073-.313.323-.521l1.458-1.125V9.458L2.25 8.333q-.25-.208-.323-.521-.073-.312.094-.604l1.562-2.729q.167-.291.479-.396.313-.104.626.021l1.729.729q.208-.125.458-.27.25-.146.458-.271l.229-1.854q.042-.334.282-.553.239-.218.573-.218h3.166q.334 0 .573.218.24.219.282.553l.229 1.854q.208.125.458.271.25.145.458.27l1.729-.729q.313-.125.626-.021.312.105.479.396L18 7.208q.167.292.104.604-.062.313-.333.521l-1.459 1.125v1.084l1.459 1.125q.271.208.333.521.063.312-.104.604l-1.583 2.729q-.167.291-.479.396-.313.104-.626-.021l-1.729-.729q-.208.125-.458.271-.25.145-.458.27l-.229 1.854q-.042.334-.282.553-.239.218-.573.218ZM10 12.979q1.229 0 2.104-.875T12.979 10q0-1.229-.875-2.104T10 7.021q-1.229 0-2.104.875T7.021 10q0 1.229.875 2.104t2.104.875Z"/></svg>',slanted:'<svg viewBox="0 0 20 20"><path style="stroke:#000000;stroke-width:2;stroke-miterlimit:10;" d="M6.4,6.3"/><g><path d="M18.9,3.4c-0.4-0.4-1-0.4-1.4,0L4.2,16.8c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3L18.9,4.8\n\t\tC19.3,4.5,19.3,3.8,18.9,3.4z"/><path d="M6.1,6.5l6.2,1.9l-1.8-6.7L9,3.4c-2.8-1.9-6.6-2-7.9-2v1v1c2.1,0,4.6,0.4,6.5,1.5L6.1,6.5z"/></g></svg>',step:'<svg viewBox="0 0 20 20"><path d="M14.542 15q-.354 0-.615-.26-.26-.261-.26-.615V5.896q0-.354.26-.615.261-.26.615-.26t.614.26q.261.261.261.615v8.229q0 .354-.261.615-.26.26-.614.26Zm-8.604-.896q-.438.292-.896.042-.459-.25-.459-.771V6.646q0-.521.459-.771.458-.25.896.042l5.083 3.354q.396.271.396.729 0 .458-.396.729Z"/></svg>',strokewidth:'<svg viewBox="0 0 20 20"><path d="M4.4,14.5c-0.5,0-1-0.2-1.4-0.6c-0.4-0.4-0.6-0.8-0.6-1.4c0-0.5,0.2-1,0.6-1.4c0.4-0.4,0.8-0.6,1.4-0.6h11.1\n\tc0.5,0,1,0.2,1.4,0.6c0.4,0.4,0.6,0.8,0.6,1.4c0,0.5-0.2,1-0.6,1.4c-0.4,0.4-0.8,0.6-1.4,0.6H4.4z"/><path d="M3.4,8.1C3.1,8.1,2.9,8,2.8,7.8C2.6,7.7,2.5,7.5,2.5,7.2s0.1-0.4,0.3-0.6c0.2-0.2,0.4-0.3,0.6-0.3h13.2\n\tc0.2,0,0.4,0.1,0.6,0.3c0.2,0.2,0.3,0.4,0.3,0.6s-0.1,0.4-0.3,0.6c-0.2,0.2-0.4,0.3-0.6,0.3H3.4z"/></svg>\n',testcase:'<svg viewBox="0 0 20 20"><path d="M15,18H2V5c0-.3,0-.4-.3-.7s-.4-.3-.7-.3-.4,0-.7.3-.3.4-.3.7v13c0,.5.2,1,.6,1.4.4.4.8.6,1.4.6h13c.3,0,.4,0,.7-.3s.3-.4.3-.7,0-.4-.3-.7-.4-.3-.7-.3Z"/>\n  <path d="M19.4.6C19,.2,18.6,0,18,0H6C5.5,0,5,.2,4.6.6s-.6.8-.6,1.4v12c0,.5.2,1,.6,1.4s.8.6,1.4.6h12c.5,0,1-.2,1.4-.6s.6-.8.6-1.4V2c0-.5-.2-1-.6-1.4ZM10.1,13.8l-3.9-6.4,1.7-1.1,2.4,3.9L16.5,1.7l1.6,1.1s-8,11-8,11Z"/></svg>',timer:'<svg viewBox="0 0 20 20"><path d="M8.375 2.583Q8.021 2.583 7.76 2.323Q7.5 2.062 7.5 1.708Q7.5 1.354 7.76 1.094Q8.021 0.833 8.375 0.833H11.625Q11.979 0.833 12.24 1.094Q12.5 1.354 12.5 1.708Q12.5 2.062 12.24 2.323Q11.979 2.583 11.625 2.583ZM10 11.583Q10.354 11.583 10.615 11.323Q10.875 11.062 10.875 10.708V7.562Q10.875 7.208 10.615 6.948Q10.354 6.688 10 6.688Q9.646 6.688 9.385 6.948Q9.125 7.208 9.125 7.562V10.708Q9.125 11.062 9.385 11.323Q9.646 11.583 10 11.583ZM10 18.333Q8.458 18.333 7.094 17.74Q5.729 17.146 4.708 16.125Q3.688 15.104 3.094 13.74Q2.5 12.375 2.5 10.833Q2.5 9.292 3.094 7.927Q3.688 6.562 4.708 5.542Q5.729 4.521 7.094 3.927Q8.458 3.333 10 3.333Q11.271 3.333 12.458 3.75Q13.646 4.167 14.667 4.958L15.25 4.375Q15.5 4.125 15.854 4.125Q16.208 4.125 16.479 4.375Q16.729 4.646 16.729 5Q16.729 5.354 16.479 5.604L15.875 6.208Q16.667 7.271 17.083 8.417Q17.5 9.562 17.5 10.833Q17.5 12.375 16.906 13.74Q16.312 15.104 15.292 16.125Q14.271 17.146 12.906 17.74Q11.542 18.333 10 18.333Z"/></svg>',trash:'<svg viewBox="0 0 20 20"><path d="M5.896 17.5q-.729 0-1.24-.51-.51-.511-.51-1.24V5.125q-.354 0-.615-.26-.26-.261-.26-.615t.26-.615q.261-.26.615-.26h3.375q0-.354.26-.615.261-.26.615-.26h3.187q.355 0 .615.26.26.261.26.615h3.375q.355 0 .615.26.26.261.26.615t-.26.615q-.26.26-.615.26V15.75q0 .729-.51 1.24-.511.51-1.24.51Zm1.542-4.375q0 .354.26.615.26.26.614.26.355 0 .615-.26.261-.261.261-.615V7.75q0-.354-.261-.615-.26-.26-.615-.26-.354 0-.614.26-.26.261-.26.615Zm3.333 0q0 .354.26.615.261.26.615.26t.614-.26q.261-.261.261-.615V7.75q0-.354-.261-.615-.26-.26-.614-.26t-.615.26q-.26.261-.26.615Z"/></svg>',undo:'<svg viewBox="0 96 960 960"><path d="M323 856q-17 0-29.5-12.5T281 814q0-17 12.5-29.5T323 772h239q62 0 108-38t46-97q0-59-46-97.5T562 501H320l73 73q12 12 11.5 29T392 632q-12 12-29.5 12T333 632L190 489q-7-7-10-14.5t-3-15.5q0-8 3-15.5t10-14.5l144-144q12-12 29.5-12t29.5 12q12 12 12 29.5T393 344l-73 73h242q97 0 167.5 62.5T800 636q0 94-70.5 157T562 856H323Z"/></svg>',wirestyle:'<svg viewBox="0 0 20 20"><path d="M5,8.1C4.8,8.1,4.6,8,4.4,7.9C4.3,7.7,4.2,7.5,4.2,7.2s0.1-0.4,0.3-0.6C4.6,6.5,4.8,6.4,5,6.4H15c0.2,0,0.4,0.1,0.6,0.3c0.2,0.2,0.3,0.4,0.3,0.6s-0.1,0.4-0.3,0.6C15.4,8,15.2,8.1,15,8.1H5z" /><path d="M5.1,14.2c-0.3,0-0.5-0.1-0.7-0.3c-0.3-0.4-0.3-1,0.1-1.3c2.3-1.9,3.7-2.1,5.9-1c1.8,0.9,2.7,0.7,3.8-0.7c0.3-0.4,0.9-0.4,1.3-0.1c0.4,0.3,0.4,0.9,0.1,1.3c-1.7,2.1-3.4,2.4-6,1.2c-1.4-0.7-2-0.8-4,0.8C5.5,14.2,5.3,14.2,5.1,14.2z" /></svg>\n'},images={Adder:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<polygon points="45,67.9 52,67.9 52,52.4 67.3,52.4 67.3,45.4 52,45.4 52,30.4 45,30.4 45,45.4 29.8,45.4 29.8,52.4 45,52.4" />\n\t<path d="M103.5,48.7H90V20H71.5V5.5h-2V20H30.2V5.5h-2V20H10v28.7H-3.5v2H10V80h37.9v15.5h2V80H90V50.7h13.5V48.7z M87,77H13V23h74\n\t\tV77z" />\n</svg>',AdderArray:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M88.4,34.2v-2H73.2V1.1H28.4V5H13.2v2h15.2v8.1H13.2v2h15.2v9.2H13.2v2h15.2v9.1H13.2v2h15.2v19.8H13.2v2h15.2v8.1H13.2v2\n\t\th15.2v9.1H13.2v2h15.2v9.2H13.2v2h15.2v4h44.8v-31h15.2v-2H73.2v-9.2h15.2v-2H73.2v-9.2h15.2v-2H73.2v-8H88.4z M70.2,94.6H31.4V4.1\n\t\th38.8V94.6z" />\n\t<polygon points="47.6,64 53.6,64 53.6,53.3 65.1,53.3 65.1,47.3 53.6,47.3 53.6,36.5 47.6,36.5 47.6,47.3 37.5,47.3 37.5,53.3 \n\t\t47.6,53.3 \t" />\n</svg>',ALU:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<path d="M78.5,40v-2H66.9V20.1L30.4,0.5V9h-9.5v2h9.5v5h-9.5v2h9.5v5h-9.5v2h9.5v5h-9.5v2h9.5v8.7L41.5,50l-11.2,9.3V68h-9.5v2h9.5\n\tv5h-9.5v2h9.5v5h-9.5v2h9.5v5h-9.5v2h9.5v8.5l36.5-20.2V61h11.6v-2H66.9v-5h11.6v-2H66.9v-5h11.6v-2H66.9v-5H78.5z M63.9,77.6\n\tL33.4,94.5V60.7L46.2,50L33.4,39.3V5.5l30.5,16.4V77.6z"/>\n</svg>\n',and:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H70.4c-0.5-10.5-9-19-20-19H30v9H5v2h25v18H5v2h25v9h20.5c10.9,0,19.4-8.5,20-19H95V24z M50,42.1H32.9V7.9h17.6\n\tc9.8,0,16.7,7.6,16.7,17.1S59.8,42.1,50,42.1z"/>\n</svg>\n',and3:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H70.5c-0.5-10.5-9-19-20-19H30v9H5v2h25v7.9H5v2h25V34H5v2h25v9h20.5c11,0,19.4-8.5,20-19H95V24z M50,42.1H32.9V7.9\n\th17.6c9.8,0,16.7,7.6,16.7,17.1S59.8,42.1,50,42.1z"/>\n</svg>\n',and4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H70.5c-0.5-10.5-9-19-20-19H30v4.1H5v2h25v7.7H5v2h25v8.3H5v2h25v7.7H5v2h25V45h20.5c11,0,19.4-8.5,20-19H95V24z\n\t M50,42.1H32.9V7.9h17.6c9.8,0,16.7,7.6,16.7,17.1S59.8,42.1,50,42.1z"/>\n</svg>\n',buf:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H72.9L31.1,3.7L29,2.6V24H5v2h24v21.4l2.2-1.1L72.5,26H95V24z M32,42.6V7.4L68.1,25L32,42.6z"/>\n</svg>\n',Clock:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 50 25" style="enable-background:new 0 0 50 25;" fill="currentColor">\n<path d="M30.3,16.8c-0.6,0.6-1.5,0.9-2.5,0.9c-1.2,0-2.2-0.4-2.9-1.2c-0.7-0.8-1.1-1.9-1.1-3.3c0-1.5,0.4-2.7,1.2-3.5\n\tc0.7-0.7,1.6-1.1,2.7-1.1c1.4,0,2.5,0.5,3.2,1.4c0.4,0.5,0.6,1.1,0.6,1.6h-1.8c-0.1-0.4-0.3-0.7-0.4-0.9c-0.3-0.4-0.8-0.6-1.4-0.6\n\tc-0.7,0-1.2,0.3-1.5,0.8c-0.4,0.5-0.6,1.3-0.6,2.2s0.2,1.7,0.6,2.2s0.9,0.7,1.5,0.7s1.1-0.2,1.4-0.6c0.2-0.2,0.3-0.6,0.5-1h1.8\n\tC31.3,15.4,30.9,16.2,30.3,16.8z"/>\n<path d="M32.8,8.8h1.8v7h4.2v1.5h-6V8.8z"/>\n<path d="M47.7,17.4h-2.3l-2.6-3.7l-0.9,0.9v2.9h-1.8V8.8h1.8v3.5l3.3-3.5h2.3L44,12.4L47.7,17.4z"/>\n<polygon points="0,22.2 0,20.2 19.1,20.2 19.1,2.8 50,2.8 50,4.8 21.1,4.8 21.1,22.2 "/>\n</svg>\n',Comparator:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M39.3,55.3c-1.1,1.2-2.5,1.8-4.2,1.8c-2.1,0-3.8-0.8-5-2.4c-1.2-1.6-1.8-3.8-1.8-6.5c0-3,0.7-5.3,2.1-6.9\n\t\tc1.2-1.4,2.7-2.1,4.6-2.1c2.5,0,4.3,0.9,5.4,2.8c0.6,1.1,1,2.1,1,3.2h-3.1c-0.2-0.8-0.5-1.4-0.8-1.9c-0.6-0.7-1.4-1.1-2.5-1.1\n\t\tc-1.1,0-2,0.5-2.7,1.6c-0.6,1-1,2.5-1,4.5s0.3,3.4,1,4.3c0.7,1,1.6,1.4,2.6,1.4c1.1,0,1.9-0.4,2.5-1.2c0.3-0.4,0.6-1.1,0.8-2h3.1\n\t\tC41.1,52.6,40.4,54.1,39.3,55.3z" />\n\t<path d="M46.5,56.6h-2.9V39.5h4.5l2.7,13.5l2.7-13.5h4.4v17.1H55V45c0-0.3,0-0.8,0-1.4c0-0.6,0-1.1,0-1.4l-2.8,14.4h-3l-2.8-14.4\n\t\tc0,0.3,0,0.8,0,1.4c0,0.6,0,1.1,0,1.4V56.6z" />\n\t<path d="M67,50.4h-3.1v6.2h-3.1V39.5h6.4c1.5,0,2.7,0.4,3.5,1.3c0.9,0.9,1.3,2.3,1.3,4.1c0,2-0.4,3.4-1.3,4.3\n\t\tC69.9,50,68.6,50.4,67,50.4z M68.4,46.9c0.4-0.4,0.6-1.1,0.6-2c0-0.9-0.2-1.5-0.6-1.9c-0.4-0.4-1-0.6-1.7-0.6h-2.9v5h2.9\n\t\tC67.5,47.5,68,47.3,68.4,46.9z" />\n\t<path d="M95.5,50.1H80V10H50.7V-3.5h-2V10H20v18.5H5.5v2H20v39.3H5.5v2H20V90h28.7v13.5h2V90H80V52.1h15.5V50.1z M77,87H23V13h54V87\n\tz" />\n</svg>',Counter:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M68.7,73.8h-34v-50h34V73.8z M36.1,72.3h31v-47h-31V72.3z" />\n\t<path d="M95.5,26.6v-2h-15v-20h-60V85h-15v2h15v8.6h60V75.5h15v-2h-15V59.2h15v-2h-15v-15h15v-2h-15V26.6H95.5z M23.5,83l7.1,3.1\n\tl-7.1,3.1V83z M77.5,92.6h-54v-1.2l12.1-5.3l-12.1-5.3V7.6h54V92.6z" />\n\t<defs>\n\t\t<rect id="SVGID_1_" x="35.4" y="24.6" width="32.5" height="48.5" />\n\t</defs>\n\t<clipPath id="frame">\n\t\t<use xlink:href="#SVGID_1_" style="overflow:visible;" />\n\t</clipPath>\n\t<g style="clip-path:url(#frame);">\n\t\t<path d="M45,22.6c0-2.5,0.3-4.4,0.8-5.9c0.5-1.5,1.3-2.7,2.3-3.5c1-0.8,2.2-1.2,3.8-1.2c1.1,0,2.1,0.2,2.9,0.7\n\t\t\t\tc0.8,0.4,1.5,1.1,2.1,1.9c0.5,0.8,1,1.9,1.3,3.1s0.5,2.8,0.5,4.9c0,2.4-0.2,4.4-0.8,5.9c-0.5,1.5-1.2,2.7-2.2,3.5\n\t\t\t\ts-2.3,1.2-3.8,1.2c-2,0-3.6-0.7-4.7-2.2C45.6,29.3,45,26.5,45,22.6z M47.6,22.6c0,3.4,0.4,5.7,1.2,6.8c0.8,1.1,1.8,1.7,3,1.7\n\t\t\t\tc1.2,0,2.2-0.6,3-1.7s1.2-3.4,1.2-6.8c0-3.4-0.4-5.7-1.2-6.8s-1.8-1.7-3-1.7c-1.2,0-2.1,0.5-2.8,1.5C48,16.9,47.6,19.2,47.6,22.6\n\t\t\t\tz" />\n\t\t<path d="M54.6,56.9H52V40.6c-0.6,0.6-1.4,1.2-2.4,1.8c-1,0.6-1.9,1-2.7,1.3v-2.5c1.4-0.7,2.7-1.5,3.7-2.4s1.8-1.9,2.3-2.8h1.6\n\t\t\t\tV56.9z" />\n\t\t<path d="M58.4,78.4v2.4H44.6c0-0.6,0.1-1.2,0.3-1.8c0.3-0.9,0.9-1.9,1.7-2.8c0.8-0.9,1.9-2,3.3-3.1c2.3-1.9,3.8-3.3,4.6-4.4\n\t\t\t\ts1.2-2.1,1.2-3.1c0-1-0.4-1.9-1.1-2.6c-0.7-0.7-1.7-1-2.8-1c-1.2,0-2.2,0.4-2.9,1.1s-1.1,1.8-1.1,3.1L45.1,66\n\t\t\t\tc0.2-2,0.9-3.4,2-4.5s2.7-1.5,4.7-1.5c2,0,3.6,0.6,4.7,1.7c1.2,1.1,1.7,2.5,1.7,4.1c0,0.8-0.2,1.6-0.5,2.4s-0.9,1.6-1.7,2.5\n\t\t\t\tc-0.8,0.9-2.1,2.1-3.9,3.7c-1.5,1.3-2.5,2.2-2.9,2.6s-0.8,0.9-1.1,1.4H58.4z" />\n\t</g>\n</svg>',Decoder:'\x3c!-- Generator: Adobe Illustrator 26.5.3, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<path d="M71.1,90.1H26.8V10h44.3V90.1z M29.8,87.1h38.3V13H29.8V87.1z"/>\n<rect x="12.8" y="37" width="16.3" height="2"/>\n<rect x="12.8" y="56.4" width="16.3" height="2"/>\n<rect x="70.8" y="41" width="16.3" height="2"/>\n<rect x="70.8" y="54.7" width="16.3" height="2"/>\n<rect x="70.8" y="68.3" width="16.3" height="2"/>\n<rect x="70.8" y="27.6" width="16.3" height="2"/>\n<g>\n\t<path d="M38.7,55.5h-5.6V40.2h5.6c0.8,0,1.5,0.1,2,0.3c0.9,0.4,1.6,1,2.2,1.9c0.5,0.8,0.8,1.6,0.9,2.5s0.2,1.7,0.2,2.5\n\t\tc0,2-0.3,3.8-1,5.2C42.1,54.5,40.7,55.5,38.7,55.5z M40.7,44.1c-0.4-0.8-1.2-1.2-2.5-1.2h-2.5v10h2.5c1.3,0,2.2-0.7,2.7-2.2\n\t\tc0.3-0.8,0.4-1.8,0.4-2.9C41.3,46.1,41.1,44.9,40.7,44.1z"/>\n\t<path d="M54.1,52.2c-0.1,0.7-0.4,1.4-0.9,2c-0.8,1.1-2,1.7-3.4,1.7c-1.2,0-2.3-0.5-3.2-1.4c-0.9-0.9-1.4-2.4-1.4-4.5\n\t\tc0-2,0.4-3.5,1.3-4.5s1.9-1.6,3.3-1.6c0.8,0,1.5,0.2,2.2,0.5c0.6,0.4,1.2,0.9,1.6,1.7c0.4,0.7,0.6,1.5,0.7,2.3\n\t\tc0.1,0.5,0.1,1.3,0.1,2.2h-6.6c0,1.1,0.3,1.9,0.9,2.4c0.3,0.3,0.8,0.4,1.2,0.4c0.5,0,0.9-0.2,1.3-0.5c0.2-0.2,0.3-0.4,0.5-0.8H54.1\n\t\tz M51.6,48.7c0-0.8-0.2-1.4-0.6-1.8c-0.4-0.4-0.8-0.6-1.3-0.6c-0.6,0-1,0.2-1.3,0.6s-0.5,1-0.6,1.7H51.6z"/>\n\t<path d="M64.2,48.2h-2.6c0-0.4-0.2-0.8-0.4-1.1c-0.3-0.5-0.7-0.7-1.3-0.7c-0.8,0-1.4,0.5-1.7,1.5C58.1,48.4,58,49.1,58,50\n\t\tc0,0.8,0.1,1.5,0.2,2c0.3,0.9,0.9,1.4,1.7,1.4c0.6,0,1-0.2,1.2-0.6s0.4-0.9,0.4-1.5h2.6c-0.1,0.9-0.3,1.8-0.8,2.6\n\t\tc-0.8,1.3-1.9,1.9-3.5,1.9s-2.7-0.5-3.4-1.6c-0.7-1.1-1.1-2.5-1.1-4.2c0-1.9,0.4-3.5,1.2-4.5s1.9-1.6,3.3-1.6c1.2,0,2.2,0.3,2.9,1\n\t\tC63.6,45.5,64.1,46.6,64.2,48.2z"/>\n</g>\n</svg>\n',Decoder7Seg:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M87.7,25v-2H73.3V10H26.8v13H11.1v2h15.7v15.6H11.1v2h15.7v15.6H11.1v2h15.7v15.5H11.1v2h15.7V90h46.5V77.7h14.4v-2H73.3V69\n\th14.4v-2H73.3v-6.8h14.4v-2H73.3v-6.8h14.4v-2H73.3v-6.8h14.4v-2H73.3v-6.8h14.4v-2H73.3V25H87.7z M70.3,87H29.8V13h40.5V87z" />\n\t<path d="M35.1,42.3V40h13v1.9c-1.3,1.4-2.5,3.2-3.8,5.4c-1.3,2.3-2.2,4.6-2.9,6.9c-0.5,1.7-0.8,3.5-0.9,5.5h-2.5\n\t\tc0-1.6,0.3-3.5,0.9-5.7c0.6-2.2,1.4-4.4,2.5-6.5s2.3-3.8,3.5-5.2H35.1z" />\n\t<path d="M51.1,55.1l2.4-0.4c0.1,1,0.5,1.7,1.1,2.2c0.6,0.5,1.5,0.8,2.6,0.8c1.1,0,2-0.2,2.5-0.7s0.8-1,0.8-1.6c0-0.6-0.2-1-0.7-1.3\n\t\tc-0.3-0.2-1.2-0.5-2.5-0.8c-1.8-0.5-3.1-0.8-3.8-1.2s-1.2-0.8-1.6-1.4c-0.4-0.6-0.5-1.2-0.5-1.9c0-0.6,0.1-1.2,0.4-1.8\n\t\tc0.3-0.6,0.7-1,1.2-1.4c0.4-0.3,0.9-0.5,1.6-0.7c0.7-0.2,1.4-0.3,2.1-0.3c1.1,0,2.1,0.2,3,0.5s1.5,0.8,1.9,1.3s0.7,1.3,0.8,2.2\n\t\tL60.2,49c-0.1-0.7-0.4-1.3-1-1.8c-0.5-0.4-1.3-0.6-2.2-0.6c-1.1,0-1.9,0.2-2.4,0.6s-0.7,0.8-0.7,1.3c0,0.3,0.1,0.6,0.3,0.9\n\t\tc0.2,0.3,0.5,0.5,0.9,0.7c0.2,0.1,1,0.3,2.2,0.6c1.7,0.5,3,0.8,3.6,1.1c0.7,0.3,1.2,0.7,1.6,1.3s0.6,1.3,0.6,2.1\n\t\tc0,0.8-0.2,1.6-0.7,2.3s-1.2,1.3-2.1,1.7s-1.9,0.6-3.1,0.6c-1.9,0-3.3-0.4-4.3-1.2C52,57.8,51.4,56.6,51.1,55.1z" />\n\t<path d="M64.5,59.7v-2.8h2.8v2.8H64.5z" />\n</svg>',Decoder16Seg:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M87.6,16v-2H73.3v-4H26.8v13H12.3v2h14.5v6.8H12.3v2h14.5v6.8H12.3v2h14.5v6.8H12.3v2h14.5v6.8H12.3v2h14.5V67H12.3v2h14.5\n\tv6.7H12.3v2h14.5V90h46.5v-3.3h14.3v-2H73.3V82h14.3v-2H73.3v-2.7h14.3v-2H73.3v-2.7h14.3v-2H73.3v-2.7h14.3v-2H73.3v-2.8h14.3v-2\n\tH73.3v-2.7h14.3v-2H73.3v-2.7h14.3v-2H73.3V49h14.3v-2H73.3v-2.7h14.3v-2H73.3v-2.7h14.3v-2H73.3v-2.8h14.3v-2H73.3v-2.7h14.3v-2\n\tH73.3v-2.7h14.3v-2H73.3v-2.7h14.3v-2H73.3V16H87.6z M70.3,87H29.8V13h40.5V87z" />\n\t<path d="M39.3,55.8h-1.8V44.6c-0.4,0.4-1,0.8-1.7,1.2s-1.3,0.7-1.9,0.9V45c1-0.5,1.8-1,2.6-1.7s1.3-1.3,1.6-1.9h1.1V55.8z" />\n\t<path d="M56,52.4l1.7-0.3c0.1,0.7,0.4,1.2,0.8,1.6c0.4,0.4,1.1,0.6,1.9,0.6c0.8,0,1.4-0.2,1.8-0.5s0.6-0.7,0.6-1.2\n\t\tc0-0.4-0.2-0.7-0.5-0.9c-0.2-0.2-0.8-0.4-1.8-0.6c-1.3-0.3-2.2-0.6-2.7-0.8s-0.9-0.6-1.1-1c-0.3-0.4-0.4-0.9-0.4-1.4\n\t\tc0-0.5,0.1-0.9,0.3-1.3c0.2-0.4,0.5-0.7,0.9-1c0.3-0.2,0.6-0.4,1.1-0.5c0.5-0.1,1-0.2,1.5-0.2c0.8,0,1.5,0.1,2.1,0.4s1.1,0.6,1.4,1\n\t\ts0.5,0.9,0.6,1.6L62.5,48c-0.1-0.5-0.3-1-0.7-1.2c-0.4-0.3-0.9-0.4-1.6-0.4c-0.8,0-1.4,0.1-1.7,0.4C58.2,47,58,47.3,58,47.7\n\t\tc0,0.2,0.1,0.4,0.2,0.6c0.1,0.2,0.4,0.3,0.7,0.5c0.2,0.1,0.7,0.2,1.6,0.4c1.2,0.3,2.1,0.6,2.6,0.8c0.5,0.2,0.9,0.5,1.2,0.9\n\t\tc0.3,0.4,0.4,0.9,0.4,1.5c0,0.6-0.2,1.1-0.5,1.7s-0.8,0.9-1.5,1.2s-1.4,0.4-2.2,0.4c-1.3,0-2.4-0.3-3.1-0.8\n\t\tC56.7,54.3,56.2,53.5,56,52.4z" />\n\t<path d="M65.9,55.8v-2h2v2H65.9z" />\n\t<path d="M50.3,45l-1.7,0.1c-0.2-0.7-0.4-1.2-0.7-1.5c-0.5-0.5-1.1-0.8-1.8-0.8c-0.6,0-1.1,0.2-1.5,0.5c-0.6,0.4-1,1-1.3,1.8\n\t\ts-0.5,1.9-0.5,3.3c0.4-0.6,0.9-1.1,1.6-1.4s1.3-0.5,1.9-0.5c1.2,0,2.2,0.4,3,1.3s1.2,2,1.2,3.3c0,0.9-0.2,1.7-0.6,2.5\n\t\tS49,55,48.4,55.4s-1.4,0.6-2.3,0.6c-1.5,0-2.7-0.5-3.6-1.6c-0.9-1.1-1.4-2.9-1.4-5.3c0-2.8,0.5-4.8,1.5-6c0.9-1.1,2.1-1.6,3.6-1.6\n\t\tc1.1,0,2,0.3,2.8,0.9S50.1,43.9,50.3,45z M43.1,51.2c0,0.6,0.1,1.2,0.4,1.7c0.3,0.6,0.6,1,1.1,1.3c0.5,0.3,0.9,0.4,1.5,0.4\n\t\tc0.7,0,1.4-0.3,1.9-0.9c0.5-0.6,0.8-1.4,0.8-2.4c0-1-0.3-1.8-0.8-2.3s-1.2-0.9-2-0.9c-0.8,0-1.5,0.3-2,0.9S43.1,50.3,43.1,51.2z" />\n</svg>',DecoderBCD4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M92,17.4v-2H77.6V10h-55v14.7H8.1v2h14.5v14.2H8.1v2h14.5v14.2H8.1v2h14.5v14.2H8.1v2h14.5V90h55v-5.2H92v-2H77.6V66H92v-2\n\tH77.6V49.8H92v-2H77.6V33.6H92v-2H77.6V17.4H92z M74.6,87h-49V13h49V87z" />\n\t<path d="M29.7,60.5V41.4h5.6c1.1,0,2.1,0.2,2.8,0.6c0.7,0.4,1.2,1,1.6,1.8c0.4,0.8,0.6,1.6,0.6,2.5c0,0.8-0.2,1.6-0.5,2.3\n\t\tc-0.3,0.7-0.9,1.3-1.6,1.7c0.9,0.3,1.6,0.9,2.1,1.7c0.5,0.8,0.7,1.8,0.7,2.9c0,0.9-0.1,1.7-0.4,2.5c-0.3,0.8-0.7,1.4-1.1,1.8\n\t\tc-0.4,0.4-1,0.7-1.6,0.9c-0.7,0.2-1.5,0.3-2.4,0.3H29.7z M31.6,49.4h3.2c0.9,0,1.5-0.1,1.9-0.2c0.5-0.2,0.9-0.5,1.1-1\n\t\tc0.3-0.4,0.4-1,0.4-1.7c0-0.6-0.1-1.2-0.4-1.7c-0.2-0.5-0.6-0.8-1-1c-0.4-0.2-1.2-0.3-2.3-0.3h-3V49.4z M31.6,58.3h3.7\n\t\tc0.6,0,1.1,0,1.3-0.1c0.5-0.1,0.8-0.3,1.1-0.5c0.3-0.2,0.6-0.6,0.8-1.1c0.2-0.5,0.3-1,0.3-1.6c0-0.7-0.1-1.3-0.4-1.9\n\t\tc-0.3-0.5-0.7-0.9-1.2-1.1c-0.5-0.2-1.2-0.3-2.2-0.3h-3.5V58.3z" />\n\t<path d="M54.4,53.8l2,0.6c-0.4,2.1-1.2,3.7-2.2,4.8c-1.1,1.1-2.4,1.6-4,1.6c-1.6,0-2.9-0.4-3.9-1.3c-1-0.8-1.8-2.1-2.3-3.6\n\t\tc-0.5-1.6-0.8-3.3-0.8-5.1c0-2,0.3-3.7,0.9-5.2c0.6-1.5,1.4-2.6,2.5-3.4c1.1-0.8,2.3-1.2,3.6-1.2c1.5,0,2.8,0.5,3.8,1.5\n\t\ts1.7,2.3,2.1,4.1l-2,0.6c-0.3-1.4-0.9-2.4-1.5-3c-0.7-0.6-1.5-1-2.5-1c-1.2,0-2.1,0.4-2.9,1.1c-0.8,0.7-1.3,1.7-1.6,2.8\n\t\tc-0.3,1.2-0.5,2.4-0.5,3.7c0,1.6,0.2,3,0.6,4.3c0.4,1.2,0.9,2.1,1.7,2.7c0.8,0.6,1.6,0.9,2.5,0.9c1.1,0,2-0.4,2.8-1.2\n\t\tC53.6,56.6,54.1,55.4,54.4,53.8z" />\n\t<path d="M58.8,60.5V41.4H64c1.2,0,2.1,0.1,2.7,0.3c0.9,0.3,1.6,0.7,2.2,1.4c0.8,0.9,1.4,1.9,1.8,3.3c0.4,1.3,0.6,2.8,0.6,4.5\n\t\tc0,1.5-0.1,2.7-0.4,3.9s-0.6,2-1,2.8c-0.4,0.7-0.9,1.3-1.4,1.7c-0.5,0.4-1.1,0.7-1.8,1c-0.7,0.2-1.5,0.3-2.4,0.3H58.8z M60.8,58.3\n\t\tH64c1,0,1.8-0.1,2.3-0.4s1-0.6,1.3-1c0.5-0.6,0.8-1.4,1.1-2.4c0.3-1,0.4-2.2,0.4-3.7c0-2-0.3-3.5-0.8-4.6c-0.5-1.1-1.1-1.8-1.9-2.2\n\t\tc-0.5-0.3-1.4-0.4-2.6-0.4h-3.1V58.3z" />\n</svg>',Demux:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<path d="M80,25v-2H65V4.4l-17,9.9V1h-2v14.4l-15,8.7V43H16v2h15v9H16v2h15v19.9l34,18.6V78h15v-2H65v-9h15v-2H65V36h15v-2H65v-9H80z\n\t M62,9.6v13.5c-7.3,0.8-11.3,5.7-15.2,10.5c-3.6,4.4-7,8.6-12.8,9.2v-17L62,9.6z M62,25.1v9c-6.4,0.7-9.8,5.3-13.2,9.7\n\tc-3.8,5-7.3,9.7-14.8,10.2v-9.1c6.7-0.5,10.6-5.3,14.3-9.9C52.1,30.3,55.7,25.9,62,25.1z M34,74.1V56c8.5-0.5,12.7-6,16.4-10.9\n\tc3.2-4.2,6.2-8.2,11.6-8.9v53.3L34,74.1z"/>\n</svg>\n',FlipflopD:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M95,31v-2H80V10H20v19H5v2h15v38H5v2h15v19h60V71h15v-2H80V31H95z M23,66.9l7.1,3.1L23,73.1V66.9z M77,87H23V75.3L35.1,70\n\tL23,64.7V13h54V87z" />\n\t<rect x="62.4" y="60" width="11.9" height="1.5" />\n\t<path d="M27.3,36.3V23.4h4.4c1,0,1.8,0.1,2.3,0.2c0.7,0.2,1.4,0.5,1.9,0.9c0.7,0.6,1.2,1.3,1.5,2.2c0.3,0.9,0.5,1.9,0.5,3.1\n\t\tc0,1-0.1,1.8-0.3,2.6s-0.5,1.4-0.9,1.9c-0.4,0.5-0.7,0.9-1.2,1.2s-0.9,0.5-1.5,0.6s-1.3,0.2-2.1,0.2H27.3z M29,34.8h2.8\n\t\tc0.8,0,1.5-0.1,2-0.2s0.9-0.4,1.2-0.7c0.4-0.4,0.7-0.9,0.9-1.6c0.2-0.7,0.3-1.5,0.3-2.5c0-1.3-0.2-2.4-0.7-3.1\n\t\tc-0.4-0.7-1-1.2-1.6-1.5c-0.5-0.2-1.2-0.3-2.2-0.3H29V34.8z" />\n\t<path d="M72.6,35.1c0.8,0.5,1.5,0.9,2.2,1.2l-0.5,1.2c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\ts-1.7-1.4-2.2-2.4s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S73.2,34.5,72.6,35.1z M68.8,33c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7s-0.9-1.4-1.6-1.8c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.8,33z" />\n\t<path d="M72.5,75.1c0.8,0.5,1.5,0.9,2.2,1.2l-0.5,1.2c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\ts-1.7-1.4-2.2-2.4s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S73.1,74.5,72.5,75.1z M68.7,73c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7s-0.9-1.4-1.6-1.8c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.7,73z" />\n</svg>',FlipflopJK:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M95,31v-2H80V10H20v19H5v2h15v18H5v2h15v18H5v2h15v19h60V71h15v-2H80V31H95z M23,46.9l7.1,3.1L23,53.1V46.9z M77,87H23V55.3\n\tL35.1,50L23,44.7V13h54V87z" />\n\t<rect x="62.4" y="60.2" width="11.9" height="1.5" />\n\t<path d="M26.5,32.8l1.5-0.2c0,1,0.2,1.7,0.6,2s0.8,0.5,1.4,0.5c0.4,0,0.8-0.1,1.1-0.3c0.3-0.2,0.5-0.5,0.6-0.8s0.2-0.9,0.2-1.6\n\t\tv-8.9h1.7v8.8c0,1.1-0.1,1.9-0.4,2.5s-0.7,1-1.2,1.4s-1.2,0.5-2,0.5c-1.1,0-2-0.3-2.6-1S26.4,34.1,26.5,32.8z" />\n\t<path d="M27,76.7V63.8h1.7v6.4l6.4-6.4h2.3L32,69l5.6,7.7h-2.2l-4.6-6.5l-2.1,2.1v4.5H27z" />\n\t<path d="M72.6,35.3c0.8,0.5,1.5,0.9,2.2,1.2l-0.5,1.2c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\ts-1.7-1.4-2.2-2.4s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S73.2,34.7,72.6,35.3z M68.8,33.1c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7s-0.9-1.4-1.6-1.8c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.8,33.1z" />\n\t<path d="M72.5,75.3c0.8,0.5,1.5,0.9,2.2,1.2l-0.5,1.2c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\ts-1.7-1.4-2.2-2.4s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S73.1,74.7,72.5,75.3z M68.7,73.1c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7s-0.9-1.4-1.6-1.8c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.7,73.1z" />\n</svg>',FlipflopT:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M95,31v-2H80V10H20v19H5v2h15v38H5v2h15v19h60V71h15v-2H80V31H95z M23,66.9l7.1,3.1L23,73.1V66.9z M77,87H23V75.3L35.1,70\n\t\tL23,64.7V13h54V87z" />\n\t<rect x="61.9" y="60.2" width="11.9" height="1.5" />\n\t<path d="M30.1,36.4V25h-4.2v-1.5h10.2V25h-4.3v11.4H30.1z" />\n\t<path d="M72,35.3c0.8,0.5,1.5,0.9,2.2,1.2l-0.5,1.2c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\ts-1.7-1.4-2.2-2.4s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S72.7,34.6,72,35.3z M68.3,33.1c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7s-0.9-1.4-1.6-1.8c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.3,33.1z" />\n\t<path d="M72,75.3c0.8,0.5,1.5,0.9,2.2,1.2l-0.5,1.2c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\ts-1.7-1.4-2.2-2.4s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S72.6,74.6,72,75.3z M68.2,73.1c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7s-0.9-1.4-1.6-1.8c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.2,73.1z" />\n</svg>',GateArray:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M88.4,34.2v-2H73.2V1.1H28.4V5H13.2v2h15.2v8.1H13.2v2h15.2v9.2H13.2v2h15.2v9.1H13.2v2h15.2v19.8H13.2v2h15.2v8.1H13.2v2\n\th15.2v9.1H13.2v2h15.2v9.2H13.2v2h15.2v4h44.8v-31h15.2v-2H73.2v-9.2h15.2v-2H73.2v-9.2h15.2v-2H73.2v-8H88.4z M70.2,94.6H31.4V4.1\n\th38.8V94.6z" />\n\t<path d="M38.7,35.5v25.8h13.2c7.3,0,12.9-5.8,12.9-12.9s-5.6-12.9-12.9-12.9H38.7z M40.5,37.4h11.4c6.3,0,10.8,4.9,10.8,11.1\n\ts-4.8,11.1-11.1,11.1H40.5C40.5,59.5,40.5,37.4,40.5,37.4z" />\n</svg>',HalfAdder:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n    <polygon points="46,65.9 51,65.9 51,54.3 62.2,54.3 62.2,49.3 51,49.3 51,38.2 46,38.2 46,49.3 34.9,49.3 34.9,54.3 46,54.3 \t" />\n    <path d="M87.2,32.4v-2H72.7V16.7H25.1v13.7H10.6v2h14.5v35.2H10.6v2h14.5v17.8h47.6V69.6h14.5v-2H72.7V32.4H87.2z M69.7,84.4H28.1\n\t\tV19.7h41.6V84.4z" />\n</svg>',imply:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H72.4C62.1,5.2,46,5,41.2,5H24.1l2,2.4c0,0,0.8,1,1.8,2.7C27,9.7,26.1,9.4,25,9.4c-2.7,0-5,2-5.4,4.6H5v2h14.6\n\tc0.5,2.5,2.7,4.4,5.4,4.4c2.6,0,4.8-1.9,5.4-4.3c0.8,2.5,1.4,5.6,1.4,9c0,3.4-0.6,6.4-1.4,9H5v2h24.7c-1.6,4.1-3.6,6.6-3.6,6.6\n\tl-2,2.4h17.2c2.4,0,7.7,0,13.6-2.4c5.9-2.4,12.4-7.3,17.5-16.6H95V24z M25,17.4c-1.4,0-2.5-1.1-2.5-2.5s1.1-2.5,2.5-2.5\n\ts2.5,1.1,2.5,2.5S26.4,17.4,25,17.4z M53.5,39.8C48.1,42,43.7,42,41.2,42H30c1.9-3.1,4.8-9,4.8-17c0-8-2.9-13.9-4.8-17h11.3\n\tc4.7,0,18.3-0.1,28,17C64.5,33.4,58.7,37.7,53.5,39.8z"/>\n</svg>\n',Input1:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 32 24" style="enable-background:new 0 0 32 24;" fill="currentColor">\n<path d="M32,10.5h-3.6c-0.8-0.8-1.9-2-2.8-2.9c-0.7-0.8-1.1-1.2-1.3-1.4C21.4,2.5,16,1,11.7,3.6c-6.4,3.5-6.4,13.2,0,16.8\n\tc4.1,2.5,9.4,1.2,12.3-2.2c0.1-0.1,0.2-0.1,0.3-0.2c0,0,0,0,1.6-1.6c0.9-0.9,1.9-1.9,2.6-2.6H32V10.5z M14,17.9\n\tC8.8,15.7,8.8,8.2,14,6c4.1-1.8,9,1.4,9,5.9C23,16.5,18.1,19.8,14,17.9z"/>\n</svg>\n',Input4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n<path d="M1790.2,405.5v-120h-423.9V99H423v1579h943.3v-163.7h423.9v-120h-423.9v-251.7h423.9v-120h-423.9V779.4h423.9v-120h-423.9\n\tV405.5H1790.2z M603,1163.4V913h583.3v250.4H603z M603,843.9V592.6h583.3v251.3H603z M1186.3,279v239.5H603V279H1186.3z M603,1498\n\tv-257.3h583.3V1498H603z"/>\n</svg>\n',Input8:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n\t<path d="M1661.1,260v-50h-324.8V37.4H453v1702.2h883.3V1582h324.2v-50h-324.2v-138.9h324.2v-50h-324.2v-138.8h324.2v-50h-324.2\n\tv-138.9h324.2v-50h-324.2V826.6h324.2v-50h-324.2V637.7h324.2v-50h-324.2V448.9h324.2v-50h-324.2V260H1661.1z M573,1618.9v-138.8\n\th643.3v138.8H573z M573,1430.1v-138.8h643.3v138.8H573z M573,1241.3v-138.9h643.3v138.9H573z M573,1052.4V913.6h643.3v138.8H573z\n\t M573,863.6V724.7h643.3v138.9H573z M573,674.7V535.9h643.3v138.8H573z M573,485.9V347h643.3v138.9H573z M573,297V158.2h643.3V297\n\tH573z" />\n</svg>',Random:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)">\n\t<path d="M475.9,12730c-2.1-0.8-339.2-191.5-340.3-192.6c-0.4-0.4-0.3-0.9,0.3-1.5c0.5-0.5,51.6-25,113.5-54.4\n\t\tc61.9-29.5,147.6-70.2,190.3-90.5c61.1-29.1,78.5-37.1,81.1-37.4c2.8-0.3,4-0.1,7.5,1.7c3.3,1.7,318.8,200.6,331.3,208.9\n\t\tc3.9,2.6,4.7,3.6,3.9,4.9c-0.4,0.7-27,12-158.6,68c-10.5,4.5-63.2,26.8-116.9,49.7c-53.7,22.8-99.4,42.1-101.5,42.8\n\t\tC482.3,12730.9,478.9,12731,475.9,12730z M482.4,12692c25.7-3.4,43.5-15.6,43.5-29.7c0-13-15.4-25.3-37.8-30.1\n\t\tc-33.4-7.2-69.1,2-78.6,20.1c-2.4,4.5-2.4,11.2-0.3,15.7c4.2,8.4,14.4,15.8,28.5,20.3C451,12692.6,467.4,12694,482.4,12692z\n\t\t M537.5,12470.6c28.3-2.5,48.1-14.9,48.2-30c0.1-14-15.9-26-41.4-31c-8.9-1.8-27.3-2.1-35.6-0.7c-20.3,3.5-34,11.1-39.1,21.6\n\t\tc-1.9,3.8-2.1,4.8-1.8,8.7c0.3,6,2.4,9.9,7.8,15C488.1,12466.1,513.5,12472.8,537.5,12470.6z"/>\n\t<path d="M875.5,12541.5c-12.7-8-299.1-189-315.1-199.1c-10-6.4-19.6-12.8-21.3-14.4l-3.2-2.8v-4.9c0-2.7,0.7-54.9,1.7-115.9\n\t\ts2.3-152.7,3-203.9c1.7-123.7,1.5-116.5,3.6-116.5c0.9,0,330.4,219.1,334.9,222.7c1.4,1.2,3,2.8,3.4,3.8\n\t\tc0.7,1.3,0.7,43.6,0.4,217.8c-0.3,191.4-0.5,216.2-1.4,216.3C880.9,12544.6,878.2,12543.3,875.5,12541.5z M852.7,12462.6\n\t\tc10.3-5,15.3-16.2,14.6-33c-1.5-32.6-26.4-67.1-52.4-72.6c-6-1.3-10.7-0.7-16,1.9c-6.5,3.1-11.3,9.9-13.5,19.1\n\t\tc-1.2,5-1,18.3,0.3,24.4c6.6,29.7,27.4,55.7,49.7,61.7C841.7,12465.7,847.2,12465.3,852.7,12462.6z M754.6,12262.5\n\t\tc6.4-3.3,11.5-10.5,13.6-19.1c0.5-2.2,0.9-7,0.9-11.9c-0.1-9.3-1.9-18.1-5.5-27.3c-7.9-20.1-22.2-36.9-37.3-44.1\n\t\tc-7-3.3-11.3-4.3-17.3-3.9c-11.2,0.8-19.2,8.7-22,21.9c-1.5,6.8-0.9,19.3,1.3,27.7c7,26.7,26.3,50.6,46.3,57.3\n\t\tC741.3,12265.3,749.7,12265.1,754.6,12262.5z M642.9,12056.5c7.4-2.2,13.2-8.1,16.1-16.4c2.1-5.8,2.6-19.9,1.1-27.7\n\t\tc-5.8-29.1-27-56.2-49-62.5c-5.8-1.7-14.2-1.1-18.6,1.1c-5.7,2.9-9.6,7.9-12.4,15.7c-1.9,5.4-2.4,18.9-0.9,26.7\n\t\tc2.3,11.8,8.3,26.2,15.5,36.3c4,5.7,13.4,15.3,18.4,18.9C623.4,12056.1,634.5,12059,642.9,12056.5z"/>\n\t<path d="M118.7,12510.8c0-0.9,1.2-38.1,2.6-83c5.2-160.1,6.6-204.1,8.5-265.2c2.6-83.4,2.4-79.3,4.6-81.4\n\t\tc1.9-1.9,376.6-198,378.4-198c0.6,0,1.3,0.4,1.5,0.9c0.4,1-5.4,406.4-6.1,428.7l-0.4,12.8l-2.1,2.2c-1.6,1.7-24.8,13-106.7,52\n\t\tc-57.5,27.3-143.7,68.3-191.5,91c-47.7,22.7-87.3,41.3-87.9,41.3C119.1,12512.3,118.7,12511.7,118.7,12510.8z M299.3,12246.2\n\t\tc8.1-2.8,14.8-7.2,22.8-15.2c22.6-22.5,32.6-57.2,22.6-78.5c-11.9-25.2-46.5-17.1-68.5,15.9c-19.1,28.7-20.1,63.5-2.3,75.6\n\t\tc4.7,3.2,7.6,4,14,4C292.8,12248.1,294.8,12247.8,299.3,12246.2z"/>\n</g>\n</svg>\n',Rectangle:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path fill="#888888" fill-opacity="0.3" d="M78.1,86.4H21.2c-4.4,0-8-3.6-8-8V21.6c0-4.4,3.6-8,8-8h56.9c4.4,0,8,3.6,8,8v56.9\n\t\tC86.1,82.9,82.5,86.4,78.1,86.4z" />\n\t<path d="M78.1,88.4H21.2c-5.5,0-10-4.5-10-10V21.6c0-5.5,4.5-10,10-10h56.9c5.5,0,10,4.5,10,10v56.9C88.1,84,83.6,88.4,78.1,88.4z\n\t\t M21.2,15.6c-3.3,0-6,2.7-6,6v56.8c0,3.3,2.7,6,6,6h56.9c3.3,0,6-2.6,6-5.9V21.6c0-3.3-2.7-6-6-6H21.2z" />\n</svg>',Label:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 60" style="enable-background:new 0 0 100 60;" fill="currentColor">\n\t<path d="M7.6,44.1l14.4-15.2L13.4,14h4.4l3.9,6.8c1,1.8,1.6,2.8,1.8,3.1c0.4,0.7,0.7,1.5,1.2,2.4c1-1.4,2.6-3.2,4.7-5.4l6.6-7h5.2\n\t\tL26.7,29.5l8.2,14.5h-4.4l-4.9-8.8c-0.5-0.9-1-2-1.7-3.3c-0.7,1-1.6,2.1-2.7,3.2l-8.4,8.9H7.6z"/>\n\t<path d="M48.6,44.1l2.4-11.6L41.8,14h4.3l4.4,8.8c1,1.9,1.9,4,2.8,6.2c1-1.9,2.4-3.9,4.1-6.1l7.1-8.8h4.8L55,32.7l-2.4,11.3H48.6z"\n\t\t/>\n\t<path d="M65.9,44.1l0.4-3l15.1-18l3.1-3.8c0.6-0.8,1.2-1.5,1.8-2.1c-1.3,0.2-2.2,0.2-2.7,0.2l-1,0l-1.2,0l-1.2,0H70.2l0.7-3.4h20.7\n\t\tl-0.3,3.1L75.2,36.3c-2,2.4-3.2,3.8-3.8,4.5c0.6-0.1,1-0.1,1.2-0.1H89l-0.7,3.4H65.9z"/>\n</svg>\n',LatchSR:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M95,31v-2H80V10H20v19H5v2h15v38H5v2h15v19h60V71h15v-2H80V31H95z M77,87H23V13h54V87z" />\n\t<rect x="62" y="59.5" width="11.9" height="1.5" />\n\t<path d="M26.4,31.6l1.6-0.1c0.1,0.6,0.3,1.2,0.5,1.6c0.3,0.4,0.7,0.7,1.3,1c0.6,0.3,1.2,0.4,2,0.4c0.7,0,1.2-0.1,1.7-0.3\n\t\ts0.9-0.5,1.1-0.8s0.4-0.7,0.4-1.1c0-0.4-0.1-0.8-0.4-1.1s-0.6-0.6-1.2-0.8c-0.3-0.1-1.1-0.3-2.3-0.6s-2-0.6-2.5-0.8\n\t\tc-0.6-0.3-1.1-0.7-1.4-1.2s-0.5-1-0.5-1.6c0-0.7,0.2-1.3,0.6-1.8s0.9-1,1.6-1.3s1.5-0.4,2.4-0.4c1,0,1.8,0.2,2.5,0.5\n\t\tc0.7,0.3,1.3,0.8,1.7,1.4s0.6,1.3,0.6,2l-1.6,0.1c-0.1-0.8-0.4-1.4-0.9-1.8s-1.3-0.6-2.2-0.6c-1,0-1.8,0.2-2.3,0.6\n\t\tc-0.5,0.4-0.7,0.8-0.7,1.4c0,0.5,0.2,0.8,0.5,1.1c0.3,0.3,1.2,0.6,2.6,0.9c1.4,0.3,2.3,0.6,2.9,0.8c0.8,0.3,1.3,0.8,1.7,1.3\n\t\ts0.5,1.1,0.5,1.8c0,0.7-0.2,1.3-0.6,1.9c-0.4,0.6-1,1.1-1.7,1.4c-0.7,0.3-1.6,0.5-2.5,0.5c-1.2,0-2.1-0.2-2.9-0.5s-1.4-0.9-1.9-1.5\n\t\tC26.6,33.3,26.4,32.5,26.4,31.6z" />\n\t<path d="M26.7,76V63.1h5.7c1.1,0,2,0.1,2.6,0.3s1.1,0.6,1.4,1.2s0.5,1.2,0.5,1.9c0,0.9-0.3,1.7-0.9,2.3s-1.5,1-2.7,1.2\n\t\tc0.5,0.2,0.8,0.4,1,0.6c0.5,0.5,1,1,1.4,1.7L38,76h-2.1l-1.7-2.7c-0.5-0.8-0.9-1.4-1.2-1.8s-0.6-0.7-0.9-0.9s-0.5-0.3-0.8-0.3\n\t\tc-0.2,0-0.5-0.1-0.9-0.1h-2V76H26.7z M28.4,68.8H32c0.8,0,1.4-0.1,1.8-0.2s0.8-0.4,1-0.8s0.3-0.7,0.3-1.2c0-0.6-0.2-1.1-0.7-1.5\n\t\ts-1.1-0.6-2.1-0.6h-4.1V68.8z" />\n\t<path d="M72.2,34.6c0.8,0.5,1.5,0.9,2.2,1.2L73.9,37c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\tS63.1,34,62.6,33s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S72.8,34,72.2,34.6z M68.4,32.4c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7S71,25.4,70.3,25c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.4,32.4z" />\n\t<path d="M72.1,74.6c0.8,0.5,1.5,0.9,2.2,1.2L73.8,77c-0.9-0.3-1.8-0.9-2.8-1.6c-1,0.5-2,0.8-3.2,0.8c-1.2,0-2.2-0.3-3.2-0.8\n\t\tS63,74,62.5,73s-0.8-2.2-0.8-3.4c0-1.3,0.3-2.4,0.8-3.5s1.2-1.8,2.2-2.4s2-0.8,3.2-0.8c1.2,0,2.3,0.3,3.2,0.8\n\t\tc1,0.6,1.7,1.4,2.2,2.4c0.5,1,0.8,2.2,0.8,3.4c0,1.1-0.2,2-0.5,2.9S72.7,74,72.1,74.6z M68.3,72.4c1,0.3,1.8,0.7,2.4,1.2\n\t\tc1-0.9,1.5-2.3,1.5-4.1c0-1-0.2-2-0.5-2.7s-0.9-1.4-1.6-1.8c-0.7-0.4-1.4-0.6-2.3-0.6c-1.3,0-2.3,0.4-3.2,1.3\n\t\tc-0.8,0.9-1.3,2.2-1.3,3.9c0,1.7,0.4,3,1.2,3.9s1.9,1.3,3.2,1.3c0.6,0,1.2-0.1,1.7-0.3c-0.5-0.3-1.1-0.6-1.7-0.7L68.3,72.4z" />\n</svg>',Mux:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<path d="M83,44.9v-2H68V24.1l-15-8.7V1h-2v13.3L34,4.4V23H19v2h15v9H19v2h15v29H19v2h15v9H19v2h15v16.5l34-18.6V56h15v-2H68v-9.1H83\n\tz M37,25.1c6.5,0.7,10.1,5.1,13.9,9.8c3.7,4.6,7.5,9.3,14.1,9.9v9.1c-7.4-0.6-10.9-5.2-14.6-10.1c-3.4-4.5-6.9-9.1-13.4-9.7V25.1z\n\t M65,25.9v16.9c-5.6-0.6-9-4.8-12.6-9.2c-3.9-4.9-8-9.9-15.4-10.6V9.6L65,25.9z M37,89.5V36.1c5.5,0.6,8.6,4.7,11.8,8.9\n\tc3.7,4.9,7.8,10.4,16.2,10.9v18.2L37,89.5z"/>\n</svg>\n',nand:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H80.4c-0.5-2.6-2.7-4.5-5.4-4.5c-2,0-3.8,1.1-4.7,2.7C68.9,12.5,60.8,5,50.5,5H30v9H5v2h25v18H5v2h25v9h20.5\n\tc10.3,0,18.5-7.5,19.8-17.2c1,1.6,2.7,2.7,4.7,2.7c2.7,0,4.9-1.9,5.4-4.5H95V24z M50,42.1H32.9V7.9h17.6c9.8,0,16.7,7.6,16.7,17.1\n\tS59.8,42.1,50,42.1z M75,27.5c-1.4,0-2.5-1.1-2.5-2.5c0-1.4,1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5C77.5,26.4,76.4,27.5,75,27.5z"/>\n</svg>\n',nand3:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H80.4c-0.5-2.6-2.7-4.5-5.4-4.5c-2,0-3.8,1.1-4.7,2.7C68.9,12.5,60.8,5,50.5,5H30v9H5v2h25v7.7H5v2h25V34H5v2h25v9\n\th20.5c10.3,0,18.4-7.5,19.8-17.2c1,1.6,2.7,2.7,4.7,2.7c2.7,0,4.9-1.9,5.4-4.5H95V24z M50,42.1H32.9V7.9h17.6\n\tc9.8,0,16.7,7.6,16.7,17.1S59.8,42.1,50,42.1z M75,27.5c-1.4,0-2.5-1.1-2.5-2.5c0-1.4,1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5\n\tC77.5,26.4,76.4,27.5,75,27.5z"/>\n</svg>\n',nand4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H80.4c-0.5-2.6-2.7-4.5-5.4-4.5c-2,0-3.8,1.1-4.7,2.7C68.9,12.5,60.8,5,50.5,5H30v3.8H5v2h25v8H5v2h25v8H5v2h25v8H5v2\n\th25V45h20.5c10.3,0,18.4-7.5,19.8-17.2c1,1.6,2.7,2.7,4.7,2.7c2.7,0,4.9-1.9,5.4-4.5H95V24z M50,42.1H32.9V7.9h17.6\n\tc9.8,0,16.7,7.6,16.7,17.1S59.8,42.1,50,42.1z M75,27.5c-1.4,0-2.5-1.1-2.5-2.5c0-1.4,1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5\n\tC77.5,26.4,76.4,27.5,75,27.5z"/>\n</svg>\n',nimply:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H70.4c-0.5-10.5-9-19-20-19H30v9H5v2h25v15.9c-1-1.4-2.6-2.3-4.5-2.3c-2.7,0-4.9,1.9-5.4,4.5H5v2h15.1\n\tc0.5,2.6,2.7,4.5,5.4,4.5c1.9,0,3.5-0.9,4.5-2.3V45h20.5c10.9,0,19.4-8.5,20-19H95V24z M25.5,37.5c-1.4,0-2.5-1.1-2.5-2.5\n\ts1.1-2.5,2.5-2.5S28,33.6,28,35S26.9,37.5,25.5,37.5z M50,42.1H32.9V7.9h17.6c9.8,0,16.7,7.6,16.7,17.1S59.8,42.1,50,42.1z"/>\n</svg>\n',nor:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H80.4c-0.5-2.6-2.7-4.5-5.4-4.5c-1.7,0-3.1,0.7-4.1,1.9C60.5,5.2,45.8,5,41.2,5H24.1l2,2.4c0,0,1.9,2.4,3.6,6.6H5v2\n\th25.4c0.8,2.6,1.4,5.6,1.4,9c0,3.4-0.6,6.4-1.4,9H5v2h24.7c-1.6,4.1-3.6,6.6-3.6,6.6l-2,2.4h17.2c2.4,0,7.7,0,13.6-2.4\n\tc5.3-2.2,11.1-6.3,16-14c1,1.2,2.5,1.9,4.1,1.9c2.7,0,4.9-1.9,5.4-4.5H95V24z M53.5,39.8C48.1,42,43.7,42,41.2,42H30\n\tc1.9-3.1,4.8-9,4.8-17c0-8-2.9-13.9-4.8-17h11.3c4.7,0,18.3-0.1,28,17C64.5,33.4,58.7,37.7,53.5,39.8z M75,27.5\n\tc-1.4,0-2.5-1.1-2.5-2.5c0-1.4,1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5C77.5,26.4,76.4,27.5,75,27.5z"/>\n</svg>\n',nor3:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H80.4c-0.5-2.6-2.7-4.5-5.4-4.5c-1.7,0-3.2,0.8-4.2,1.9C60.6,5.2,45.7,5,41.2,5H24.1l2,2.4c0,0,2,2.4,3.6,6.6H5v2\n\th25.4c0.7,2.3,1.2,4.9,1.4,7.9H5v2h26.8c-0.1,3-0.6,5.8-1.4,8.1H5v2h24.7c-1.6,4.2-3.6,6.6-3.6,6.6l-2,2.4h17.2\n\tc2.4,0,7.7,0,13.6-2.4c5.3-2.1,11.1-6.3,16-14c1,1.1,2.5,1.9,4.1,1.9c2.7,0,4.9-1.9,5.4-4.5H95V24z M53.6,39.8\n\tC48.1,42,43.7,42,41.2,42H30c1.9-3.1,4.8-9,4.8-17s-3-13.9-4.8-17h11.3c4.7,0,18.3-0.1,28,17C64.5,33.4,58.8,37.7,53.6,39.8z\n\t M75,27.5c-1.4,0-2.5-1.1-2.5-2.5c0-1.4,1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5C77.5,26.4,76.4,27.5,75,27.5z"/>\n</svg>\n',nor4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M29.5,41H5v-2h24.5V41z M32,30.9H5v-2h27V30.9z M95,26H79v-2h16V26z M32.8,21H5v-2h27.8V21z M29.4,10.9H5v-2h24.4V10.9z"/>\n<path d="M24.1,5l2,2.4c0,0,5.7,7,5.7,17.6s-5.7,17.6-5.7,17.6l-2,2.4h17.2c2.4,0,7.7,0,13.6-2.4s12.5-7.3,17.7-16.9L71.2,25l1.3-0.7\n\tC62.3,5.2,46,5,41.2,5H24.1z M30,8h11.3c4.7,0,18.3-0.1,28,17c-4.8,8.4-10.5,12.7-15.7,14.8C48.1,42,43.7,42,41.2,42H30\n\tc1.9-3.1,4.8-9,4.8-17S31.8,11.1,30,8z"/>\n<path d="M75,30.5c-3,0-5.5-2.5-5.5-5.5c0-3,2.5-5.5,5.5-5.5s5.5,2.5,5.5,5.5C80.5,28,78,30.5,75,30.5z M75,22.5\n\tc-1.4,0-2.5,1.1-2.5,2.5c0,1.4,1.1,2.5,2.5,2.5s2.5-1.1,2.5-2.5C77.5,23.6,76.4,22.5,75,22.5z"/>\n</svg>\n',not:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H80.4c-0.5-2.6-2.7-4.5-5.4-4.5c-2.2,0-4.1,1.3-5,3.1l-38.9-19L29,2.6V24H5v2H29v21.4l2.2-1.1l38.9-19\n\tc0.9,1.8,2.8,3.1,5,3.1c2.7,0,4.9-1.9,5.4-4.5H95V24z M32,42.6V7.4L68.1,25L32,42.6z M75,27.5c-1.4,0-2.5-1.1-2.5-2.5\n\tc0-1.4,1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5C77.5,26.4,76.4,27.5,75,27.5z"/>\n</svg>\n',or:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H72.4C62.1,5.2,46,5,41.2,5H24.1l2,2.4c0,0,1.9,2.4,3.6,6.6H5v2h25.4c0.8,2.6,1.4,5.6,1.4,9\n\tc0,3.4-0.6,6.4-1.4,9H5v2h24.7c-1.6,4.1-3.6,6.6-3.6,6.6l-2,2.4h17.2c2.4,0,7.7,0,13.6-2.4c5.9-2.4,12.4-7.3,17.5-16.6H95V24z\n\t M53.5,39.8C48.1,42,43.7,42,41.2,42H30c1.9-3.1,4.8-9,4.8-17c0-8-2.9-13.9-4.8-17h11.3c4.7,0,18.3-0.1,28,17\n\tC64.5,33.4,58.7,37.7,53.5,39.8z"/>\n</svg>\n',or3:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H72.3C62.1,5.2,46,5,41.2,5H24.1l2,2.4c0,0,2,2.4,3.6,6.6H5v2h25.4c0.7,2.3,1.3,5,1.4,8H5v2h26.8\n\tc-0.1,3-0.6,5.7-1.4,8H5v2h24.7c-1.6,4.2-3.6,6.6-3.6,6.6l-2,2.4h17.2c2.4,0,7.7,0,13.6-2.4c5.8-2.4,12.4-7.2,17.5-16.6H95V24z\n\t M53.6,39.8C48.1,42,43.7,42,41.2,42H30c1.9-3.1,4.8-9,4.8-17s-3-13.9-4.8-17h11.3c4.7,0,18.3-0.1,28,17\n\tC64.5,33.4,58.8,37.7,53.6,39.8z"/>\n</svg>\n',or4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H72.3C62.1,5.2,46,5,41.2,5H24.1l2,2.4c0,0,0.4,0.5,1,1.5H5v2h23.3c1,2,2.2,4.7,2.9,8H5v2h26.5\n\tc0.2,1.3,0.3,2.7,0.3,4.1c0,1.4-0.1,2.7-0.3,3.9H5v2h26.2c-0.7,3.3-1.8,6-2.8,8H5v2h22.3c-0.7,1.1-1.2,1.7-1.2,1.7l-2,2.4h17.2\n\tc2.4,0,7.7,0,13.6-2.4c5.8-2.4,12.4-7.2,17.5-16.6H95V24z M53.6,39.8C48.1,42,43.7,42,41.2,42H30c1.9-3.1,4.8-9,4.8-17\n\ts-3-13.9-4.8-17h11.3c4.7,0,18.3-0.1,28,17C64.5,33.4,58.8,37.7,53.6,39.8z"/>\n</svg>\n',Output1:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 32 24" style="enable-background:new 0 0 32 24;" fill="currentColor">\n<path d="M24.1,7.2c-0.9-1.5-2-2.7-3.5-3.5c-1.5-0.9-3.1-1.3-4.9-1.3s-3.4,0.4-4.9,1.3c-1.5,0.9-2.7,2-3.5,3.5c-0.6,0.9-0.9,2-1.1,3\n\tL4.5,7c-0.2-0.4-0.6-0.5-1-0.4l0,0C3.1,6.7,2.9,7,2.9,7.4v0c0,0,0,0,0,0v2.8H0v3.2h2.8V16c0,0.4,0.3,0.7,0.6,0.8c0.1,0,0.2,0,0.2,0\n\tc0.3,0,0.6-0.2,0.7-0.4l0,0c0,0,0,0,0,0l1.7-2.9c0.2,1.2,0.6,2.3,1.2,3.4c0.9,1.5,2,2.7,3.5,3.5c1.5,0.9,3.1,1.3,4.9,1.3\n\ts3.4-0.4,4.9-1.3c1.5-0.9,2.7-2,3.5-3.5c0.9-1.5,1.3-3.1,1.3-4.9C25.4,10.3,25,8.7,24.1,7.2z M21.7,14.6c-0.3,0.8-0.8,1.5-1.4,2.1\n\tc-0.6,0.6-1.3,1-2.1,1.4c-0.8,0.3-1.6,0.5-2.5,0.5S14,18.3,13.3,18c-0.8-0.3-1.5-0.8-2.1-1.4c-0.6-0.6-1-1.3-1.4-2.1\n\tc-0.3-0.8-0.5-1.6-0.5-2.5c0-0.9,0.2-1.7,0.5-2.5c0.3-0.8,0.8-1.5,1.4-2.1c0.6-0.6,1.3-1,2.1-1.4c0.8-0.3,1.6-0.5,2.5-0.5\n\ts1.7,0.2,2.5,0.5c0.8,0.3,1.5,0.8,2.1,1.4c0.6,0.6,1,1.3,1.4,2.1c0.3,0.8,0.5,1.6,0.5,2.5C22.2,12.9,22,13.8,21.7,14.6z"/>\n</svg>\n',Output4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n<path d="M419.9,115.9v163.7H-4v120h423.9v251.7H-4v120h423.9v243.2H-4v120h423.9v253.9H-4v120h423.9v186.5h943.3v-1579H419.9z\n\t M599.9,1201.3V950h583.3v251.3H599.9z M1183.2,630.5v250.4H599.9V630.5H1183.2z M1183.2,295.9v257.3H599.9V295.9H1183.2z\n\t M599.9,1514.9v-239.5h583.3v239.5H599.9z"/>\n</svg>\n',Output8:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n<path d="M323.8,47.3v157.6H-0.4v50h324.2v138.9H-0.4v50h324.2v138.8H-0.4v50h324.2v138.9H-0.4v50h324.2v138.8H-0.4v50h324.2v138.9\n\tH-0.4v50h324.2V1338H-0.4v50h324.2v138.9H-1v50h324.8v172.6h883.3V47.3H323.8z M443.8,1628.7v-138.8h643.3v138.8H443.8z\n\t M443.8,1439.9V1301h643.3v138.9H443.8z M443.8,1251v-138.8h643.3V1251H443.8z M443.8,1062.2V923.3h643.3v138.9H443.8z M443.8,873.3\n\tV734.5h643.3v138.8H443.8z M443.8,684.5V545.6h643.3v138.9H443.8z M443.8,495.6V356.8h643.3v138.8H443.8z M443.8,306.8V168h643.3\n\tv138.8H443.8z"/>\n</svg>\n',Display7Seg:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n<path d="M370.3,38.4v248.2H2.5v95h367.8v96.6H-0.6v95h370.9v85.9H2.5v95h367.8v92H2.1v95h368.2v93.1H2.5v95h367.8v92.8H2.5v95h367.8\n\tv99.5H0.5v95h369.8v245.3h1289.9V38.4H370.3z M1540.2,1636.8H490.3V158.4h1049.9V1636.8z"/>\n\t<g fill="#00ff00" fill-opacity="0.65" stroke="#000000" stroke-width="10">\n<polygon points="760.4,334.1 826,268.5 1206.9,268.5 1275.1,336.7 1212.3,399.6 824.5,399.6 "/>\n<polygon points="760.4,893.6 826,828.1 1206.9,828.1 1275.1,896.3 1212.3,959.1 824.5,959.1 "/>\n<polygon points="760.4,1446 826,1380.4 1206.9,1380.4 1275.1,1448.6 1212.3,1511.5 824.5,1511.5 "/>\n<polygon points="735.6,1416.4 670,1350.8 670,993.8 738.2,925.6 801.1,988.5 801.1,1352.3 "/>\n<polygon points="735.6,864.3 670,798.8 670,441.8 738.2,373.6 801.1,436.5 801.1,800.2 "/>\n<polygon points="1294.7,1416.4 1229.1,1350.8 1229.1,993.8 1297.3,925.6 1360.2,988.5 1360.2,1352.3 "/>\n<polygon points="1294.7,864.3 1229.1,798.8 1229.1,441.8 1297.3,373.6 1360.2,436.5 1360.2,800.2 "/>\n\t</g>\n</svg>\n',Display16Seg:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n<path d="M370.3,38.4v117.4H0.6v46.1h369.7v49.7H0.6v46.1h369.7v49.6H0.6v46.1h369.7v49.7H0.6v46.1h369.7v50.7H1.6V584h368.7v51.6\n\tH1.6v44.1h368.7v51.7H1.6v44.1h368.7v51.7H1.6v44.1h368.7v51.6H1.6V967h368.7v51.7H1.6v44.1h368.7v51.7H1.6v44.1h368.7v51.7H1.6\n\tv44.1h368.7v51.6H1.6v44.1h368.7v51.7H1.6v44.1h368.7v51.7H1.6v44.1h368.7v51.6H1.6v44.1h368.7v119.4h1289.9V38.4H370.3z\n\t M1540.2,1636.8H490.3V158.4h1049.9V1636.8z"/>\n<g fill="#00ff00" fill-opacity="0.65" stroke="#000000" stroke-width="7">\n\t<polygon points="650,313.2 694.8,268.5 954.5,268.5 1001.1,315 958.2,357.9 693.7,357.9 \t"/>\n\t<polygon points="1034.4,313.2 1079.2,268.5 1339,268.5 1385.5,315 1342.6,357.9 1078.2,357.9 \t"/>\n\t<polygon points="1404.5,873.1 1359.7,828.4 1359.7,380.6 1406.3,334.1 1449.2,376.9 1449.2,829.4 \t"/>\n\t<polygon points="627.8,873.1 583.1,828.4 583.1,380.6 629.6,334.1 672.5,376.9 672.5,829.4 \t"/>\n\t<polygon points="1404.5,1455.3 1359.7,1410.5 1359.7,962.8 1406.3,916.3 1449.2,959.1 1449.2,1411.6 \t"/>\n\t<polygon points="627.8,1455.3 583.1,1410.5 583.1,962.8 629.6,916.3 672.5,959.1 672.5,1411.6 \t"/>\n\t<polygon points="1015.3,873.1 970.5,828.4 970.5,380.6 1017.1,334.1 1060,376.9 1060,829.4 \t"/>\n\t<polygon points="948.2,826 891.4,826 697,457.4 697,384.2 752.5,384.2 948.2,757.1 \t"/>\n\t<polygon points="1084.2,757.1 1279.9,384.2 1335.5,384.2 1335.5,457.4 1141,826 1084.2,826 \t"/>\n\t<polygon points="695.9,1337.8 891.6,964.9 947.1,964.9 947.1,1038 752.7,1406.6 695.9,1406.6 \t"/>\n\t<polygon points="1335.6,1406.6 1278.8,1406.6 1084.3,1038 1084.3,964.9 1139.9,964.9 1335.6,1337.8 \t"/>\n\t<polygon points="1015.3,1455.3 970.5,1410.5 970.5,962.8 1017.1,916.3 1060,959.1 1060,1411.6 \t"/>\n\t<polygon points="650,893.6 694.8,848.9 954.5,848.9 1001.1,895.4 958.2,938.3 693.7,938.3 \t"/>\n\t<polygon points="1034.4,893.6 1079.2,848.9 1339,848.9 1385.5,895.4 1342.6,938.3 1078.2,938.3 \t"/>\n\t<polygon points="650,1474 694.8,1429.3 954.5,1429.3 1001.1,1475.8 958.2,1518.7 693.7,1518.7 \t"/>\n\t<polygon points="1034.4,1474 1079.2,1429.3 1339,1429.3 1385.5,1475.8 1342.6,1518.7 1078.2,1518.7 \t"/>\n</g>\n</svg>\n',DisplayAscii:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n\t<g fill="#8888ff" fill-opacity="1">\n\t\t<path d="M714.4,845.3H611v-76.8c0-37.1,8.8-66.1,26.4-86.9c17.6-20.8,42.8-34.4,75.6-41v37.9\n\t\tc-25,7.3-41.6,20.9-49.9,40.8c-4.6,10.7-6.4,20.8-5.5,30.2h56.8V845.3z" />\n\t\t<path d="M1256.7,1182.5h-136.2l-102-182.8l-107.8,182.8H780.3L952.9,909L788.7,645.7h134l95.8,174.5l98.3-174.5h129.7\n\t\tl-164.3,259L1256.7,1182.5z" />\n\t\t<path d="M1417.7,724.3c0,36.7-8.9,65.6-26.8,86.7c-17.8,21.1-42.9,34.8-75.2,41.2v-38.2c23.8-7.5,40.2-20.3,49.2-38.2\n\t\tc4.9-10.7,6.9-21.5,6.2-32.4h-57.2v-95.8h103.8V724.3z" />\n\t</g>\n\t<path d="M372.2,49.4v234.7H0v100h372.2v91.6H-3.1v100h375.3v80.9H0v100h372.2v87H-0.4v100h372.6v88.1H0v100h372.2v87.8H0v100h372.2\n\tv94.5H-2v100h374.2v231.7h1286.1V49.4H372.2z M1478.3,1565.7H552.2V229.4h926.1V1565.7z" />\n\t<rect x="2151.4" y="1368.3" style="fill:none;" width="0" height="4.1" />\n</svg>',DisplayBar:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n\t<path d="M3.3,848.3h429.1v173.3H3.3V848.3z" />\n\t<path d="M435.7,1024.9H0V845h435.8V1024.9z M6.6,1018.3h422.4V851.6H6.6V1018.3z" />\n\t<path fill="#00ff00" fill-opacity="0.65" d="M498.1,1721.2V89.2h738.8v1632H498.1z" />\n\t<path d="M1301.9,1786.2H433.1V24.2h868.8V1786.2z M563.1,1656.2h608.8v-1502H563.1V1656.2z" />\n</svg>',Display4:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n<path fill="#8888ff" fill-opacity="1" d="M1041.4,1259.6c-83.2,0-141.6-29.1-175-87.5c-33.5-58.3-50.2-141.3-50.2-249.1s16.7-191,50.2-249.5\n\tc33.5-58.5,91.9-87.9,175-87.9s141.6,29.3,175.2,87.9c33.3,58.5,50,141.7,50,249.5c0,107.8-16.7,190.8-50.2,249.1\n\tC1182.8,1230.4,1124.6,1259.6,1041.4,1259.6z M1116.6,1095.2c11.8-39.6,17.6-97,17.6-172c0-78.7-6-137-17.8-174.8\n\tc-11.9-37.8-36.8-56.7-75-56.7c-38.2,0-63.4,19-75.7,56.7c-12.3,37.8-18.4,96-18.4,174.8c0,75.1,6.1,132.6,18.4,172.3\n\tc12.3,39.9,37.5,59.6,75.7,59.6C1079.5,1155.2,1104.5,1135.1,1116.6,1095.2z"/>\n<path d="M414.2,118v167.5H0v120h414.2v253.9H0v120h414.2v243.2H0v120h414.2v251.7H0v120h414.2V1697H1649V118H414.2z M1469,1517\n\tH594.2V298H1469V1517z"/>\n</svg>\n',Display8:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1792 1792" style="enable-background:new 0 0 1792 1792;" fill="currentColor">\n\t<path fill="#8888ff" fill-opacity="1" d="M1041.4,1366.5c-109.6,0-186.4-38.4-230.5-115.1c-44.1-76.7-66.2-186.1-66.2-328.1c0-142,22-251.6,66.2-328.7\n\t\tc44.1-77.1,120.9-115.7,230.5-115.7c109.6,0,186.5,38.6,230.8,115.7c43.9,77.1,65.9,186.7,65.9,328.7c0,142-22.1,251.4-66.2,328.1\n\t\tC1227.8,1328.2,1150.9,1366.5,1041.4,1366.5z M1140.4,1149.9c15.4-52.2,23.1-127.8,23.1-226.7c0-103.6-7.8-180.4-23.4-230.2\n\t\tc-15.6-49.8-48.6-74.8-98.8-74.8c-50.2,0-83.5,24.9-99.7,74.8c-16.2,49.8-24.3,126.6-24.3,230.2c0,98.9,8.1,174.5,24.3,227\n\t\tc16.2,52.4,49.4,78.6,99.7,78.6C1091.6,1228.9,1124.6,1202.6,1140.4,1149.9z" />\n\t<path d="M346,57.9v62.3H-2.7v120H346v90.3H-2.7v120H346v90.4H-2.7v120H346v90.3H-2.7v120H346v90.4H-2.7v120H346v90.2H-2.7v120H346\n\tv90.4H-5.2v120H346v90.3H-2.7v120H346v44.5h1371.2V57.9H346z M1587.2,1627.1H476V187.9h1111.2V1627.1z" />\n</svg>',ShiftDisplay:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 60.5" style="enable-background:new 0 0 100 60.5;" fill="currentColor">\n\t<path d="M17.9,15.7h3.7c0.8,0,1.5,0.1,1.9,0.2c0.6,0.2,1.1,0.5,1.5,0.9s0.7,1,1,1.6c0.2,0.6,0.3,1.4,0.3,2.4c0,0.8-0.1,1.5-0.3,2.1\n\t\tc-0.3,0.7-0.6,1.3-1.1,1.8c-0.4,0.3-0.8,0.6-1.4,0.8c-0.4,0.1-1,0.2-1.8,0.2h-3.8V15.7z M19.9,17.4V24h1.5c0.6,0,1,0,1.2-0.1\n\t\tc0.3-0.1,0.6-0.2,0.8-0.4s0.4-0.5,0.5-1c0.1-0.4,0.2-1.1,0.2-1.8s-0.1-1.4-0.2-1.8s-0.3-0.7-0.6-1s-0.6-0.4-0.9-0.5\n\t\tc-0.3-0.1-0.8-0.1-1.7-0.1H19.9z" />\n\t<path d="M13,10v8.5H5v2h8V40H5v2h8v9.6h83.3V10H13z M16,36.5l8.7,3.8L16,44.1V36.5z M93.3,48.6H16V46l0.1,0.2l13.6-5.9l-13.6-5.9\n\tL16,34.6V13h77.3V48.6z" />\n\t<g fill="#8888ff" fill-opacity="1">\n\t\t<path d="M43.4,38.9h-3.3V27.5h-3.9v-2.2c1,0,1.7-0.1,2.1-0.2c0.7-0.1,1.2-0.4,1.6-0.9c0.3-0.3,0.5-0.7,0.6-1.2\n\t\tc0.1-0.3,0.1-0.5,0.1-0.7h2.7V38.9z" />\n\t\t<path d="M53.9,39.3c-2.1,0-3.6-0.7-4.4-2.2c-0.8-1.5-1.3-3.6-1.3-6.3s0.4-4.8,1.3-6.3c0.8-1.5,2.3-2.2,4.4-2.2\n\t\tc2.1,0,3.6,0.7,4.4,2.2c0.8,1.5,1.3,3.6,1.3,6.3s-0.4,4.8-1.3,6.3C57.5,38.5,56,39.3,53.9,39.3z M55.8,35.1c0.3-1,0.4-2.4,0.4-4.3\n\t\tc0-2-0.1-3.5-0.4-4.4S54.9,25,53.9,25c-1,0-1.6,0.5-1.9,1.4s-0.5,2.4-0.5,4.4c0,1.9,0.2,3.3,0.5,4.3s0.9,1.5,1.9,1.5\n\t\tC54.9,36.6,55.5,36.1,55.8,35.1z" />\n\t\t<path d="M69.3,38.9H66V27.5h-3.9v-2.2c1,0,1.7-0.1,2.1-0.2c0.7-0.1,1.2-0.4,1.6-0.9c0.3-0.3,0.5-0.7,0.6-1.2\n\t\tc0.1-0.3,0.1-0.5,0.1-0.7h2.7V38.9z" />\n\t\t<path d="M79.8,39.3c-2.1,0-3.6-0.7-4.4-2.2s-1.3-3.6-1.3-6.3s0.4-4.8,1.3-6.3s2.3-2.2,4.4-2.2c2.1,0,3.6,0.7,4.4,2.2\n\t\tc0.8,1.5,1.3,3.6,1.3,6.3s-0.4,4.8-1.3,6.3C83.4,38.5,81.9,39.3,79.8,39.3z M81.7,35.1c0.3-1,0.4-2.4,0.4-4.3c0-2-0.1-3.5-0.4-4.4\n\t\tS80.8,25,79.8,25c-1,0-1.6,0.5-1.9,1.4s-0.5,2.4-0.5,4.4c0,1.9,0.2,3.3,0.5,4.3s0.9,1.5,1.9,1.5C80.8,36.6,81.4,36.1,81.7,35.1z" />\n\t</g>\n</svg>',Passthrough1:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<rect x="45.8" y="5.9" fill="#9E9E9E" width="8" height="36.6"/>\n<rect x="19.6" y="21.7" width="60" height="6"/>\n</svg>\n',PassthroughN:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<rect x="45.8" y="3.6" fill="#9E9E9E" width="8" height="91.2"/>\n<rect x="19.6" y="11.6" width="60" height="5.4"/>\n<rect x="19.6" y="34.3" width="60" height="5.4"/>\n<rect x="19.6" y="56.9" width="60" height="5.4"/>\n<rect x="19.6" y="79.6" width="60" height="5.4"/>\n</svg>\n',RAM:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M36.5,18.8v67h27.1v-67H36.5z M38.5,37.5h4.4V44h-4.4V37.5z M44.1,52.5v-7.2h4.6v7.2H44.1z M48.7,53.8v6.5h-4.6v-6.5H48.7z\n\t M38.5,45.3h4.4v7.2h-4.4V45.3z M44.1,44v-6.5h4.6V44H44.1z M38.5,53.8h4.4v6.5h-4.4V53.8z M38.5,61.6h4.4v6.8h-4.4V61.6z\n\t M44.1,61.6h4.6v6.8h-4.6V61.6z M50,61.6h5.1v6.8H50V61.6z M50,60.3v-6.5h5.1v6.5H50z M50,52.5v-7.2h5.1v7.2H50z M50,44v-6.5h5.1V44\n\tH50z M50,36.2v-7h5.1v7H50z M50,27.9v-7h5.1v7H50z M48.7,27.9h-4.6v-7h4.6V27.9z M48.7,29.2v7h-4.6v-7H48.7z M42.8,36.2h-4.4v-7h4.4\n\tV36.2z M38.5,69.7h4.4v6.5h-4.4V69.7z M44.1,69.7h4.6v6.5h-4.6V69.7z M48.7,77.5v6.3h-4.6v-6.3H48.7z M50,77.5h5.1v6.3H50V77.5z\n\t M50,76.2v-6.5h5.1v6.5H50z M56.4,69.7h5.1v6.5h-5.1V69.7z M56.4,68.4v-6.8h5.1v6.8H56.4z M61.6,60.3h-5.1v-6.5h5.1V60.3z\n\t M56.4,52.5v-7.2h5.1v7.2H56.4z M61.6,44h-5.1v-6.5h5.1V44z M56.4,36.2v-7h5.1v7H56.4z M61.6,27.9h-5.1v-7h5.1V27.9z M42.8,20.8v7\n\th-4.4v-7H42.8z M38.5,77.5h4.4v6.3h-4.4V77.5z M56.4,83.8v-6.3h5.1v6.3H56.4z" />\n\t<path d="M24.9,55.7V44.3h3.9c0.9,0,1.6,0.1,2,0.2c0.7,0.2,1.2,0.4,1.7,0.8c0.6,0.5,1.1,1.2,1.4,2c0.3,0.8,0.4,1.7,0.4,2.7\n\t\tc0,0.9-0.1,1.6-0.3,2.3s-0.5,1.2-0.8,1.7c-0.3,0.4-0.7,0.8-1,1c-0.4,0.3-0.8,0.4-1.4,0.6c-0.5,0.1-1.1,0.2-1.8,0.2H24.9z\n\t\t M26.4,54.4h2.4c0.8,0,1.3-0.1,1.8-0.2s0.8-0.3,1-0.6c0.4-0.4,0.6-0.8,0.8-1.4c0.2-0.6,0.3-1.3,0.3-2.2c0-1.2-0.2-2.1-0.6-2.8\n\t\tc-0.4-0.6-0.9-1.1-1.4-1.3c-0.4-0.2-1.1-0.2-2-0.2h-2.4V54.4z" />\n\t<path d="M74.5,54.5c0.7,0.5,1.4,0.8,1.9,1.1L76,56.6c-0.8-0.3-1.6-0.8-2.5-1.4c-0.8,0.5-1.8,0.7-2.8,0.7c-1,0-2-0.2-2.8-0.8\n\t\ts-1.5-1.2-1.9-2.1c-0.5-0.9-0.7-1.9-0.7-3.1c0-1.1,0.2-2.2,0.7-3.1c0.5-0.9,1.1-1.6,2-2.1c0.8-0.5,1.8-0.7,2.8-0.7\n\t\tc1.1,0,2,0.3,2.9,0.8c0.8,0.5,1.5,1.2,1.9,2.1s0.7,1.9,0.7,3.1c0,0.9-0.1,1.8-0.4,2.5C75.5,53.3,75.1,53.9,74.5,54.5z M71.1,52.6\n\t\tc0.9,0.2,1.6,0.6,2.2,1.1c0.9-0.8,1.3-2,1.3-3.7c0-0.9-0.2-1.7-0.5-2.4c-0.3-0.7-0.8-1.2-1.4-1.6c-0.6-0.4-1.3-0.6-2-0.6\n\t\tc-1.1,0-2.1,0.4-2.8,1.2c-0.7,0.8-1.1,1.9-1.1,3.5c0,1.5,0.4,2.6,1.1,3.4c0.7,0.8,1.7,1.2,2.8,1.2c0.5,0,1.1-0.1,1.5-0.3\n\t\tc-0.5-0.3-1-0.5-1.5-0.7L71.1,52.6z" />\n\t<path d="M94.9,24.8v-2h-15V6.5H73V0h-1.3v6.5h-12V0h-1.3v6.5H45.2V0h-1.3v6.5H31.3V0H30v6.5H19.9v16.3H5v2h14.9v13.6H5v2h14.9v15H5\n\tv2h14.9v14.3H5v2h14.9v15.6h-15v2h15v8.4h60v-26h15v-2h-15V57.4h15v-2h-15v-15h15v-2h-15V24.8H94.9z M22.9,87.3l7.1,3.1l-7.1,3.1\n\tV87.3z M76.9,96.7h-54v-1.1L35,90.4l-12.1-5.3V9.5h54V96.7z" />\n</svg>',ROM:'\x3c!-- Generator: Adobe Illustrator 26.5.3, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M63.6,18.8H36.5v67h27.1V18.8z M56.4,29.2h5.1v7h-5.1V29.2z M56.4,45.3h5.1v7.2h-5.1V45.3z M38.4,20.8h4.4v7h-4.4V20.8z\n\t\t M38.4,29.2h4.4v7h-4.4V29.2z M42.9,83.8h-4.4v-6.3h4.4V83.8z M42.9,76.2h-4.4v-6.5h4.4V76.2z M42.9,68.4h-4.4v-6.8h4.4V68.4z\n\t\t M42.9,60.3h-4.4v-6.5h4.4V60.3z M42.9,52.5h-4.4v-7.2h4.4V52.5z M42.9,44h-4.4v-6.5h4.4V44z M48.7,83.8h-4.6v-6.3h4.6V83.8z\n\t\t M48.7,76.2h-4.6v-6.5h4.6V76.2z M48.7,68.4h-4.6v-6.8h4.6V68.4z M48.7,60.3h-4.6v-6.5h4.6V60.3z M48.7,52.5h-4.6v-7.2h4.6V52.5z\n\t\t M48.7,44h-4.6v-6.5h4.6V44z M48.7,36.2h-4.6v-7h4.6V36.2z M48.7,27.9h-4.6v-7h4.6V27.9z M55.1,83.8H50v-6.3h5.1V83.8z M55.1,76.2\n\t\tH50v-6.5h5.1V76.2z M55.1,68.4H50v-6.8h5.1V68.4z M55.1,60.3H50v-6.5h5.1V60.3z M55.1,52.5H50v-7.2h5.1V52.5z M55.1,44H50v-6.5h5.1\n\t\tV44z M55.1,36.2H50v-7h5.1V36.2z M55.1,27.9H50v-7h5.1V27.9z M61.5,83.8h-5.1v-6.3h5.1V83.8z M61.5,76.2h-5.1v-6.5h5.1V76.2z\n\t\t M61.5,68.4h-5.1v-6.8h5.1V68.4z M61.6,60.3h-5.1v-6.5h5.1V60.3z M61.6,44h-5.1v-6.5h5.1V44z M61.6,27.9h-5.1v-7h5.1V27.9z" />\n\t<path d="M94.9,24.8v-2h-15V6.5H73V0h-1.3v6.5h-12V0h-1.3v6.5H45.2V0h-1.3v6.5H31.3V0H30v6.5H19.9v16.3v2v13.6v2v15v2v14.3v2v15.6v2\n\t\tv8.4h60v-26h15v-2h-15V57.4h15v-2h-15v-15h15v-2h-15V24.8H94.9z M76.9,96.7h-54v-1.1V85.1V9.5h54V96.7z" />\n</svg>',Register:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M40.7,16.4v67h20.1v-67H40.7z M58.8,18.4v15.2H42.7V18.4H58.8z M42.7,50V35.1h16.1V50H42.7z M58.8,51.5v14.4H42.7V51.5H58.8\n\tz M42.7,81.4V67.3h16.1v14.1H42.7z" />\n\t<path d="M26.3,50.4V38.9h3.9c0.9,0,1.6,0.1,2,0.2c0.7,0.2,1.2,0.4,1.7,0.8c0.6,0.5,1.1,1.2,1.4,2c0.3,0.8,0.4,1.7,0.4,2.7\n\t\tc0,0.9-0.1,1.6-0.3,2.3s-0.5,1.2-0.8,1.7c-0.3,0.4-0.7,0.8-1,1c-0.4,0.3-0.8,0.4-1.4,0.6c-0.5,0.1-1.1,0.2-1.8,0.2H26.3z M27.9,49\n\t\th2.4c0.8,0,1.3-0.1,1.8-0.2s0.8-0.3,1-0.6c0.4-0.4,0.6-0.8,0.8-1.4c0.2-0.6,0.3-1.3,0.3-2.2c0-1.2-0.2-2.1-0.6-2.8\n\t\tc-0.4-0.6-0.9-1.1-1.4-1.3c-0.4-0.2-1.1-0.2-2-0.2h-2.4V49z" />\n\t<path d="M72.8,49.2c0.7,0.5,1.4,0.8,1.9,1.1l-0.4,1.1c-0.8-0.3-1.6-0.8-2.5-1.4c-0.8,0.5-1.8,0.7-2.8,0.7c-1,0-2-0.2-2.8-0.8\n\t\ts-1.5-1.2-1.9-2.1c-0.5-0.9-0.7-1.9-0.7-3.1c0-1.1,0.2-2.2,0.7-3.1c0.5-0.9,1.1-1.6,2-2.1c0.8-0.5,1.8-0.7,2.8-0.7\n\t\tc1.1,0,2,0.3,2.9,0.8c0.8,0.5,1.5,1.2,1.9,2.1s0.7,1.9,0.7,3.1c0,0.9-0.1,1.8-0.4,2.5C73.8,47.9,73.4,48.6,72.8,49.2z M69.5,47.2\n\t\tc0.9,0.2,1.6,0.6,2.2,1.1c0.9-0.8,1.3-2,1.3-3.7c0-0.9-0.2-1.7-0.5-2.4c-0.3-0.7-0.8-1.2-1.4-1.6c-0.6-0.4-1.3-0.6-2-0.6\n\t\tc-1.1,0-2.1,0.4-2.8,1.2c-0.7,0.8-1.1,1.9-1.1,3.5c0,1.5,0.4,2.6,1.1,3.4c0.7,0.8,1.7,1.2,2.8,1.2c0.5,0,1.1-0.1,1.5-0.3\n\t\tc-0.5-0.3-1-0.5-1.5-0.7L69.5,47.2z" />\n\t<path d="M95,22.4v-2H80v-18H20v18H5.1v2H20V36H5.1v2H20v15H5.1v2H20v14.3H5.1v2H20v17.6H5v2h15v8.3h60V71.3h15v-2H80V55h15v-2H80V38\n\th15v-2H80V22.4H95z M23,86.9l7.1,3.1L23,93.1V86.9z M77,96.2H23v-0.9L35.1,90L23,84.7V5.4h54V96.2z" />\n</svg>',ShiftRegister:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n\t<path d="M60.8,83.4H40.7v-67h20.1V83.4z M42.7,81.4h16.1v-63H42.7V81.4z" />\n\t<path d="M26.3,42.2V30.8h3.9c0.9,0,1.6,0.1,2,0.2c0.7,0.2,1.2,0.4,1.7,0.8c0.6,0.5,1.1,1.2,1.4,2c0.3,0.8,0.4,1.7,0.4,2.7\n\t\tc0,0.9-0.1,1.6-0.3,2.3S35,40,34.7,40.4c-0.3,0.4-0.7,0.8-1,1c-0.4,0.3-0.8,0.4-1.4,0.6c-0.5,0.1-1.1,0.2-1.8,0.2H26.3z M27.9,40.9\n\t\th2.4c0.8,0,1.3-0.1,1.8-0.2s0.8-0.3,1-0.6c0.4-0.4,0.6-0.8,0.8-1.4c0.2-0.6,0.3-1.3,0.3-2.2c0-1.2-0.2-2.1-0.6-2.8\n\t\tc-0.4-0.6-0.9-1.1-1.4-1.3c-0.4-0.2-1.1-0.2-2-0.2h-2.4V40.9z" />\n\t<path d="M26.3,79V67.6h1.5v10.1h3.6V79H26.3z" />\n\t<path d="M32.3,79V67.6h2.1c1,0,1.3,0.1,1.9,0.3s1,0.6,1.3,1.1s0.5,1.1,0.5,1.7c0,0.8-0.3,1.5-0.8,2.1s-0.9,0.9-2,1.1\n\tc0.4,0.2,0.7,0.4,0.9,0.6c0.4,0.4,0.5,0.8,0.8,1.5l1.2,3.1h-1.9l-0.7-2.4c-0.2-0.8-0.3-1.2-0.6-1.6s-0.5-0.6-0.8-0.8\n\tS33.6,74,33.4,74c-0.2,0-0.5-0.1-0.8-0.1h1.2V79H32.3z M33.8,72.6H34c0.7,0,0.8-0.1,1.2-0.2s0.7-0.4,0.9-0.7s0.3-0.7,0.3-1\n\tc0-0.5-0.2-1-0.6-1.3c-0.4-0.3-0.6-0.5-1.4-0.5h-0.6C33.8,68.9,33.8,72.6,33.8,72.6z" />\n\t<path d="M72.8,49.2c0.7,0.5,1.4,0.8,1.9,1.1l-0.4,1.1c-0.8-0.3-1.6-0.8-2.5-1.4c-0.8,0.5-1.8,0.7-2.8,0.7c-1,0-2-0.2-2.8-0.8\n\t\ts-1.5-1.2-1.9-2.1c-0.5-0.9-0.7-1.9-0.7-3.1c0-1.1,0.2-2.2,0.7-3.1c0.5-0.9,1.1-1.6,2-2.1c0.8-0.5,1.8-0.7,2.8-0.7\n\t\tc1.1,0,2,0.3,2.9,0.8c0.8,0.5,1.5,1.2,1.9,2.1s0.7,1.9,0.7,3.1c0,0.9-0.1,1.8-0.4,2.5C73.8,47.9,73.4,48.6,72.8,49.2z M69.5,47.2\n\t\tc0.9,0.2,1.6,0.6,2.2,1.1c0.9-0.8,1.3-2,1.3-3.7c0-0.9-0.2-1.7-0.5-2.4c-0.3-0.7-0.8-1.2-1.4-1.6c-0.6-0.4-1.3-0.6-2-0.6\n\t\tc-1.1,0-2.1,0.4-2.8,1.2c-0.7,0.8-1.1,1.9-1.1,3.5c0,1.5,0.4,2.6,1.1,3.4c0.7,0.8,1.7,1.2,2.8,1.2c0.5,0,1.1-0.1,1.5-0.3\n\t\tc-0.5-0.3-1-0.5-1.5-0.7L69.5,47.2z" />\n\t<path d="M95,22.4v-2H80v-18H20V36H5.1v2H20v34.6H5.1v2H20v14.3H5v2h15v8.3h60V71.3h15v-2H80V55h15v-2H80V38.7h15v-2H80V22.4H95z\n\t M23,86.9l7.1,3.1L23,93.1V86.9z M77,96.2H23v-0.9L35.1,90L23,84.7V5.4h54V96.2z" />\n\t<polygon points="56,52.3 54.6,53.3 54.6,39.2 52.6,39.2 52.6,54.7 50.9,56 49,54.7 49,39.2 47,39.2 47,53.3 45.5,52.3 44.3,53.9 \n\t50.9,58.4 57.2,53.9 " />\n\t<rect x="26.2" y="65.9" width="5.1" height="1" />\n</svg>',ControlledInverter:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<path d="M88.4,26.1v-2H73.2V11.9H51.8V4.6h-2v7.3H28.4v12.2H13.2v2h15.2v14.2H13.2v2h15.2v14.2H13.2v2h15.2v14.2H13.2v2h15.2v12.1\n\th44.8V74.7h15.2v-2H73.2V58.5h15.2v-2H73.2V42.3h15.2v-2H73.2V26.1H88.4z M70.2,83.8H31.4V14.9h18.4v28.5l-13-6.9v27.7l23.4-13.4\n\tc0.4,1.5,1.7,2.6,3.3,2.6c1.8,0,3.4-1.6,3.4-3.4c0-1.8-1.4-3.3-3.4-3.4c-1.5,0-2.8,1-3.2,2.4l-8.5-4.5V14.9h18.4V83.8z M57.7,49.9\n\tL38.8,60.8V39.9L57.7,49.9z M62.1,50c0-0.7,0.7-1.4,1.3-1.4c0.9,0.1,1.5,0.6,1.5,1.4c0,0.7-0.7,1.4-1.4,1.4S62.1,50.7,62.1,50z"/>\n</svg>\n',tri:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H72.9L51,13.4v-23.5h-2v22.5L31.1,3.7L29,2.6V24H5v2h24v21.4l2.2-1.1L72.5,26H95V24z M32,42.6V7.4L68.1,25L32,42.6z"\n\t/>\n</svg>\n',TristateBufferArray:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" fill="currentColor">\n<path d="M88.4,26.1v-2H73.2V11.9H51.8V5.5h-2v6.4H28.4v12.2H13.2v2h15.2v14.2H13.2v2h15.2v14.2H13.2v2h15.2v14.2H13.2v2h15.2v12.1\n\th44.8V74.7h15.2v-2H73.2V58.5h15.2v-2H73.2V42.3h15.2v-2H73.2V26.1H88.4z M70.2,83.8H31.4V14.9h18.4v27l-10-5.3v27.7l25.1-14.4\n\tl-13.1-7v-28h18.4V83.8z M60.7,49.9L41.8,60.8V39.9L60.7,49.9z"/>\n</svg>\n',txa:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n<path d="M95,24H70.5L29.9,4.3V14H5v2h24.9v18H5v2h24.9v10.4L70.8,26H95V24z M63.6,24H32.9V9.2L63.6,24z M32.9,41.5V26H64L32.9,41.5z\n\t"/>\n</svg>\n',xnor:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n  <rect x="5" y="14" width="20.7" height="2"/>\n  <rect x="5" y="34.1" width="20.7" height="2"/>\n  <rect x="80" y="24" width="15" height="2"/>\n  <path d="M21.7,44.8l-2.4-1.7c5.1-7.1,7-11.9,7-17.9s-2.3-12.2-6.9-17.9l2.3-1.9c5.1,6.3,7.6,12.7,7.6,19.8s-2.1,12.1-7.5,19.7h-.1Z"/>\n  <path d="M24.9,44.9l1.6-2.3c2.1-3.1,5.5-9.5,5.3-18-.1-7.6-3-13.3-5.3-16.8l-1.6-2.3h20c15.2,0,23.4,13,26.5,17.9.3.4.5.8.6,1l.6.8-.6.8c-.2.2-.4.6-.6,1-2.8,4.5-11.5,18.1-27.1,18.1M68.7,24.8c-2.8-4.5-10.3-16.5-23.9-16.5h-14.5c2.2,3.9,4.3,9.3,4.4,16.1,0,7.6-2.3,13.6-4.4,17.4h0c0,.1,14,.1,14,.1,13.9,0,21.6-12.2,24.5-16.7"/>\n  <path d="M76,30.6c-3.1,0-5.6-2.5-5.6-5.6s2.5-5.6,5.6-5.6,5.6,2.5,5.6,5.6-2.5,5.6-5.6,5.6ZM76,22.4c-1.4,0-2.6,1.2-2.6,2.6s1.2,2.6,2.6,2.6,2.6-1.2,2.6-2.6-1.2-2.6-2.6-2.6Z"/>\n</svg>',xnor3:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n  <rect x="5" y="14" width="20.7" height="2"/>\n  <rect x="5" y="24" width="23" height="2"/>\n  <rect x="5" y="34.1" width="20.7" height="2"/>\n  <rect x="80" y="24" width="15" height="2"/>\n  <path d="M21.7,44.8l-2.4-1.7c5.1-7.1,7-11.9,7-17.9s-2.3-12.2-6.9-17.9l2.3-1.9c5.1,6.3,7.6,12.7,7.6,19.8s-2.1,12.1-7.5,19.7h-.1Z"/>\n  <path d="M24.9,44.9l1.6-2.3c2.1-3.1,5.5-9.5,5.3-18-.1-7.6-3-13.3-5.3-16.8l-1.6-2.3h20c15.2,0,23.4,13,26.5,17.9.3.4.5.8.6,1l.6.8-.6.8c-.2.2-.4.6-.6,1-2.8,4.5-11.5,18.1-27.1,18.1M68.7,24.8c-2.8-4.5-10.3-16.5-23.9-16.5h-14.5c2.2,3.9,4.3,9.3,4.4,16.1,0,7.6-2.3,13.6-4.4,17.4h0c0,.1,14,.1,14,.1,13.9,0,21.6-12.2,24.5-16.7"/>\n  <path d="M76,30.6c-3.1,0-5.6-2.5-5.6-5.6s2.5-5.6,5.6-5.6,5.6,2.5,5.6,5.6-2.5,5.6-5.6,5.6ZM76,22.4c-1.4,0-2.6,1.2-2.6,2.6s1.2,2.6,2.6,2.6,2.6-1.2,2.6-2.6-1.2-2.6-2.6-2.6Z"/>\n</svg>',xnor4:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n  <rect x="5" y="9.2" width="18" height="2"/>\n  <rect x="5" y="19.2" width="22.2" height="2"/>\n  <rect x="5" y="29.3" width="22.2" height="2"/>\n  <rect x="5" y="39.4" width="18" height="2"/>\n  <rect x="80" y="24" width="15" height="2"/>\n  <path d="M21.7,44.8l-2.4-1.7c5.1-7.1,7-11.9,7-17.9s-2.3-12.2-6.9-17.9l2.3-1.9c5.1,6.3,7.6,12.7,7.6,19.8s-2.1,12.1-7.5,19.7h-.1Z"/>\n  <path d="M24.9,44.9l1.6-2.3c2.1-3.1,5.5-9.5,5.3-18-.1-7.6-3-13.3-5.3-16.8l-1.6-2.3h20c15.2,0,23.4,13,26.5,17.9.3.4.5.8.6,1l.6.8-.6.8c-.2.2-.4.6-.6,1-2.8,4.5-11.5,18.1-27.1,18.1M68.7,24.8c-2.8-4.5-10.3-16.5-23.9-16.5h-14.5c2.2,3.9,4.3,9.3,4.4,16.1,0,7.6-2.3,13.6-4.4,17.4h0c0,.1,14,.1,14,.1,13.9,0,21.6-12.2,24.5-16.7"/>\n  <path d="M76,30.6c-3.1,0-5.6-2.5-5.6-5.6s2.5-5.6,5.6-5.6,5.6,2.5,5.6,5.6-2.5,5.6-5.6,5.6ZM76,22.4c-1.4,0-2.6,1.2-2.6,2.6s1.2,2.6,2.6,2.6,2.6-1.2,2.6-2.6-1.2-2.6-2.6-2.6Z"/>\n</svg>',xor:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n  <rect x="5" y="14" width="20.7" height="2"/>\n  <rect x="5" y="34.1" width="20.7" height="2"/>\n  <rect x="71.2" y="24" width="23.8" height="2"/>\n  <path d="M21.7,44.8l-2.4-1.7c5.1-7.1,7-11.9,7-17.9s-2.3-12.2-6.9-17.9l2.3-1.9c5.1,6.3,7.6,12.7,7.6,19.8s-2.1,12.1-7.5,19.7h-.1Z"/>\n  <path d="M24.9,44.9l1.6-2.3c2.1-3.1,5.5-9.5,5.3-18-.1-7.6-3-13.3-5.3-16.8l-1.6-2.3h20c15.2,0,23.4,13,26.5,17.9.3.4.5.8.6,1l.6.8-.6.8c-.2.2-.4.6-.6,1-2.8,4.5-11.5,18.1-27.1,18.1M68.7,24.8c-2.8-4.5-10.3-16.5-23.9-16.5h-14.5c2.2,3.9,4.3,9.3,4.4,16.1,0,7.6-2.3,13.6-4.4,17.4h0c0,.1,14,.1,14,.1,13.9,0,21.6-12.2,24.5-16.7"/>\n</svg>',xor3:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n  <rect x="5" y="14" width="20.7" height="2"/>\n  <rect x="5" y="24" width="23" height="2"/>\n  <rect x="5" y="34.1" width="20.7" height="2"/>\n  <rect x="71.2" y="24" width="23.8" height="2"/>\n  <path d="M21.7,44.8l-2.4-1.7c5.1-7.1,7-11.9,7-17.9s-2.3-12.2-6.9-17.9l2.3-1.9c5.1,6.3,7.6,12.7,7.6,19.8s-2.1,12.1-7.5,19.7h-.1Z"/>\n  <path d="M24.9,44.9l1.6-2.3c2.1-3.1,5.5-9.5,5.3-18-.1-7.6-3-13.3-5.3-16.8l-1.6-2.3h20c15.2,0,23.4,13,26.5,17.9.3.4.5.8.6,1l.6.8-.6.8c-.2.2-.4.6-.6,1-2.8,4.5-11.5,18.1-27.1,18.1M68.7,24.8c-2.8-4.5-10.3-16.5-23.9-16.5h-14.5c2.2,3.9,4.3,9.3,4.4,16.1,0,7.6-2.3,13.6-4.4,17.4h0c0,.1,14,.1,14,.1,13.9,0,21.6-12.2,24.5-16.7"/>\n</svg>',xor4:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 100 50" style="enable-background:new 0 0 100 50;" fill="currentColor">\n  <rect x="5" y="9.2" width="18" height="2"/>\n  <rect x="5" y="19.2" width="22.2" height="2"/>\n  <rect x="5" y="29.3" width="22.2" height="2"/>\n  <rect x="5" y="39.4" width="18" height="2"/>\n  <rect x="71.2" y="24" width="23.8" height="2"/>\n  <path d="M21.7,44.8l-2.4-1.7c5.1-7.1,7-11.9,7-17.9s-2.3-12.2-6.9-17.9l2.3-1.9c5.1,6.3,7.6,12.7,7.6,19.8s-2.1,12.1-7.5,19.7h-.1Z"/>\n  <path d="M24.9,44.9l1.6-2.3c2.1-3.1,5.5-9.5,5.3-18-.1-7.6-3-13.3-5.3-16.8l-1.6-2.3h20c15.2,0,23.4,13,26.5,17.9.3.4.5.8.6,1l.6.8-.6.8c-.2.2-.4.6-.6,1-2.8,4.5-11.5,18.1-27.1,18.1M68.7,24.8c-2.8-4.5-10.3-16.5-23.9-16.5h-14.5c2.2,3.9,4.3,9.3,4.4,16.1,0,7.6-2.3,13.6-4.4,17.4h0c0,.1,14,.1,14,.1,13.9,0,21.6-12.2,24.5-16.7"/>\n</svg>'};function isIconName(name2){return name2 in icons}function makeImage(name2,width,height){return makeSvgHolder("svgimg",name2,raw(inlineSvgFor(images,name2)),width,height)}function makeIcon(name2,width,height){return makeSvgHolder("svgicon",name2,raw(inlineSvgFor(icons,name2)),width,height)}function makeSvgHolder(className,iconName,content,width,height){const elem=document.createElement("i");return elem.classList.add(className),elem.setAttribute("data-icon",iconName),void 0!==width&&(elem.style.width="".concat(width,"px")),void 0!==height&&(elem.style.height="".concat(height,"px")),applyModifierTo(elem,content),elem}function inlineSvgFor(svgData,name2){return svgData[name2]}function inlineIconSvgFor(name2){return inlineSvgFor(icons,name2)}function isModifierObject(mod){return"function"==typeof mod.applyTo}function isNode(obj){return"object"==typeof obj&&"nodeType"in obj}function applyModifierTo(parent,modifier){if(isNode(modifier))parent.appendChild(modifier);else if(isModifierObject(modifier))modifier.applyTo(parent);else{const text=""+modifier;parent.appendChild(document.createTextNode(text))}}function applyModifiersTo(parent,modifiers){for(const mod of modifiers)applyModifierTo(parent,mod)}function elemBuilder(tagName){return function(){for(var _len4=arguments.length,modifiers=new Array(_len4),_key4=0;_key4<_len4;_key4++)modifiers[_key4]=arguments[_key4];return{render:()=>{const el=document.createElement(tagName);return applyModifiersTo(el,modifiers),el},applyTo:function(parent){parent.appendChild(this.render())}}}}function attrBuilder(attrName){const builder=__name((attrValue=>({applyTo:p=>p.setAttribute(attrName,""+attrValue)})),"builder");return builder.attrName=attrName,builder}function data(dataName){return attrBuilder("data-"+dataName)}function raw(rawHTML){return{applyTo:p=>p.insertAdjacentHTML("beforeend",rawHTML)}}function mods(){for(var _len5=arguments.length,modifiers=new Array(_len5),_key5=0;_key5<_len5;_key5++)modifiers[_key5]=arguments[_key5];return{applyTo:p=>applyModifiersTo(p,modifiers)}}__name(isIconName,"isIconName"),__name(makeImage,"makeImage"),__name(makeIcon,"makeIcon"),__name(makeSvgHolder,"makeSvgHolder"),__name(inlineSvgFor,"inlineSvgFor"),__name(inlineIconSvgFor,"inlineIconSvgFor"),__name(isModifierObject,"isModifierObject"),__name(isNode,"isNode"),__name(applyModifierTo,"applyModifierTo"),__name(applyModifiersTo,"applyModifiersTo"),__name(elemBuilder,"elemBuilder"),__name(attrBuilder,"attrBuilder"),__name(data,"data"),__name(raw,"raw"),__name(mods,"mods");var emptyMod={applyTo:__=>{}};function attr(attrName,attrValue){return attrBuilder(attrName)(attrValue)}__name(attr,"attr");var div=elemBuilder("div"),span=elemBuilder("span"),a=elemBuilder("a"),b=elemBuilder("b"),i=elemBuilder("i"),ul=elemBuilder("ul"),li=(elemBuilder("ol"),elemBuilder("li")),table=elemBuilder("table"),thead=elemBuilder("thead"),tbody=elemBuilder("tbody"),tr=elemBuilder("tr"),th=elemBuilder("th"),td=elemBuilder("td"),input=elemBuilder("input"),select=elemBuilder("select"),option=elemBuilder("option"),button=elemBuilder("button"),label=elemBuilder("label"),style=(elemBuilder("img"),elemBuilder("canvas"),attrBuilder("style")),type=attrBuilder("type"),cls=attrBuilder("class"),href=attrBuilder("href"),target=attrBuilder("target"),title=attrBuilder("title"),br=(attrBuilder("src"),attrBuilder("draggable")("true"),raw("<br>")),asValue=__name((bool=>b(isUnknown(bool)||isHighImpedance(bool)?Unknown:String(Number(bool)))),"asValue");function tooltipContent(title2,body){let maxWidth=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200;return div(style("max-width: ".concat(maxWidth,"px")),void 0===title2?emptyMod:div(style("padding-bottom: 3px; border-bottom: 1px solid grey;"),title2),div(body))}__name(tooltipContent,"tooltipContent");var fixedWidthInContextMenu=style("font-family: monospace; font-weight: bolder; font-size: 90%");function setupSvgIcon(_iconElem){var _a;const iconElem=_iconElem,iconName=null!=(_a=iconElem.dataset.icon)?_a:"question";isIconName(iconName)?iconElem.innerHTML=inlineIconSvgFor(iconName):console.log("Unknown icon name '".concat(iconName,"'"))}__name(setupSvgIcon,"setupSvgIcon");var Template=class{constructor(templateString){this.templateString=templateString}expand(values){return this.templateString.replace(/\$(s?)\{(\w+)(\?(\w*)(:(\w*))?)?\}/g,((match,s,key,plurDecl,plural,singDecl,singular)=>{const value=values[key];return"s"===s?S.plural(void 0===value?0:Number(value),plural,singular):String(null!=value?value:"<<"+key+">>")}))}};function template(templ){return new Template(templ)}__name(Template,"Template"),__name(template,"template");var langs={fr:{plural:(n,plural,singular)=>Math.abs(n)<2?null!=singular?singular:"":null!=plural?plural:"s",ComponentBar:{Labels:{More:"Plus",Less:"Moins"},SectionNames:{InputOutput:"Entrées/ sorties",Layout:"Dispo- sition",Gates:"Portes",Components:"Compo- sants",Custom:"Person- nalisé"},Components:RichStringEnum.withProps()({Input1:["Entrée","IN"],InputN:["Entrée multiple","IN mult."],Input8:["Entrée octet (8 bits)","IN 8 bits"],Clock:["Générateur de signal d’horloge","Horloge"],Random:["Entrée aléatoire","Aléatoire"],Output1:["Sortie","OUT"],OutputN:["Sortie multiple","OUT mult."],Output8:["Sortie octet (8 bits)","OUT 8 bits"],DisplayN:["Afficheur d’une valeur","Afficheur"],Display8:["Affichage de 8 bits","Aff. 8 bits"],Display7Seg:["Afficheur à 7 segments","7 segments"],Display16Seg:["Afficheur à 16 segments","16 segments"],DisplayAscii:["Affichage d’un caractère ASCII (sur 7 bits)","Caractère"],DisplayBar:["Affichage d’un bit sous forme de segment lumineux","Segment"],ShiftDisplay:["Affichage avec buffer à décalage","Affichage à décalage"],Passthrough1:["Broche","Broche"],PassthroughN:["Broche à plusieurs entrées-sortes","Broche (n)"],Label:["Étiquette","Label"],Rectangle:["Rectangle de regroupement","Groupe"],not:["Porte NON","NON"],buf:["Buffer (porte OUI)","OUI"],tri:["Sortie à 3 états","3 états"],and:["Porte ET","ET"],or:["Porte OU","OU"],xor:["Porte OU-X","OU-X"],nand:["Porte NON-ET","NON-ET"],nor:["Porte NON-OU","NON-OU"],xnor:["Porte NON-OU-X","NON-OU-X"],imply:["Porte IMPLIQUE","IMPLIQUE"],nimply:["Porte NON-IMPLIQUE","NON-IMPL."],transfer:["Fausse porte TRANSFERT à deux entrées","TRANSF."],and3:["Porte ET à 3 entrées","ET (3)"],or3:["Porte OU à 3 entrées","OU (3)"],xor3:["Porte OU-X à 3 entrées","OU-X (3)"],nand3:["Porte NON-ET à 3 entrées","NON-ET (3)"],nor3:["Porte NON-OU à 3 entrées","NON-OU (3)"],xnor3:["Porte NON-OU-X à 3 entrées","NON-OU-X (3)"],and4:["Porte ET à 4 entrées","ET (4)"],or4:["Porte OU à 4 entrées","OU (4)"],xor4:["Porte OU-X à 4 entrées","OU-X (4)"],nand4:["Porte NON-ET à 4 entrées","NON-ET (4)"],nor4:["Porte NON-OU à 4 entrées","NON-OU (4)"],xnor4:["Porte NON-OU-X à 4 entrées","NON-OU-X (4)"],ControlledInverter:["Inverseur commuté","Inv. comm."],GateArray:["Porte multiple","Porte mult."],TristateBufferArray:["Sortie à 3 états multiple","3 états mult."],HalfAdder:["Demi-additionneur","Demi-add."],Adder:["Additionneur","Addit."],AdderArray:["Additionneur multiple","Add. mult."],ALU:["Unité arithmétique et logique","ALU"],Mux:["Multiplexer","Mux"],Mux2to1:["Multiplexer 2-vers-1 (1 bit de contrôle)","Mux 2-1"],Mux4to1:["Multiplexer 4-vers-1 (2 bits de contrôle)","Mux 4-1"],Mux8to1:["Multiplexer 8-vers-1 (3 bits de contrôle)","Mux 8-1"],Mux4to2:["Multiplexer 4-vers-2 (1 bit de contrôle)","Mux 4-2"],Mux8to2:["Multiplexer 8-vers-2 (2 bits de contrôle)","Mux 8-2"],Mux8to4:["Multiplexer 8-vers-4 (1 bit de contrôle)","Mux 8-4"],Mux16to8:["Multiplexer 16-vers-8 (1 bit de contrôle)","Mux 16-8"],Demux:["Démultiplexer","Demux"],Demux1to2:["Démultiplexer 1-vers-2 (1 bit de contrôle)","Demux 1-2"],Demux1to4:["Démultiplexer 1-vers-4 (2 bits de contrôle)","Demux 1-4"],Demux1to8:["Démultiplexer 1-vers-8 (3 bits de contrôle)","Demux 1-8"],Demux2to4:["Démultiplexer 2-vers-4 (1 bit de contrôle)","Demux 2-4"],Demux2to8:["Démultiplexer 2-vers-8 (2 bits de contrôle)","Demux 2-8"],Demux4to8:["Démultiplexer 4-vers-8 (1 bit de contrôle)","Demux 4-8"],Demux8to16:["Démultiplexer 8-vers-16 (1 bit de contrôle)","Demux 8-16"],LatchSR:["Verrou SR","Verrou SR"],FlipflopJK:["Bascule JK","Basc. JK"],FlipflopT:["Bascule T","Basc. T"],FlipflopD:["Bascule D","Basc. D"],Register:["Registre","Registre"],ShiftRegister:["Registre à décalage","Reg. déc."],RAM:["RAM (mémoire vive)","RAM"],ROM:["ROM (mémoire morte)","ROM"],Counter:["Compteur 4 bits","Compteur"],Decoder:["Décodeur binaire vers 1-sur-n","Décodeur"],Decoder7Seg:["Décodeur 7 segments","Déc. 7 seg."],Decoder16Seg:["Décodeur ASCII vers 16 segments","Déc. 16 seg."],DecoderBCD4:["Décodeur 4 bits vers BCD sur 5 bits","Déc. BCD"],Comparator:["Comparateur","Compar."]})},Modes:{FULL:tuple("Admin","En plus du mode complet, ce mode permet de rendre les entrées, les sorties des portes, voire les portes elles-mêmes indéterminées"),DESIGN:tuple("Complet","La totalité des actions de conception d’un circuit sont possible"),CONNECT:tuple("Connexion","Il est possible de déplacer et de connecter des éléments déjà sur le canevas, mais pas d’en rajouter (le menu de gauche ne serait pas actif)"),TRYOUT:tuple("Test","Il est seulement possible de changer les entrées pour tester un circuit préétabli"),STATIC:tuple("Statique","Les éléments sont juste affichés; aucune interaction n’est possible")},Orientations:{e:"Vers la droite (par défaut)",s:"Vers le bas",w:"Vers la gauche",n:"Vers le haut"},Settings:{Settings:"Réglages",CircuitName:"Nom:",DefaultFileName:"circuit",NameOfDownloadedFile:"Ceci sera le nom du fichier téléchargé.",animateWires:tuple("Animer les fils","Si coché, les fils sont animés pour montrer dans quel sens logique le signal se propage."),hideWireColors:tuple("Cacher l’état des fils","Si coché, les fils sont affichés avec une couleur neutre plutôt que de montrer s’ils véhiculent un 1 ou un 0."),hideInputColors:tuple("Cacher l’état des entrées","Si coché, les entrées sont affichées avec une couleur neutre, même si elles livrent au circuit une valeur bien déterminée. S’utilise volontiers en cachant aussi l’état des fils."),hideOutputColors:tuple("Cacher l’état des sorties","Si coché, les sorties sont affichées avec une couleur neutre. S’utilise volontiers en cachant aussi l’état des fils."),hideMemoryContent:tuple("Cacher le contenu stocké","Si coché, les verrous, bascules, registres et autres mémoires ne montrent pas leur contenu."),showGateTypes:tuple("Montrer type des portes","Si coché, affiche sur les portes logique le nom de la fonction réalisée."),showDisconnectedPins:tuple("Toujours montrer les pattes","Si non coché, les pattes non connectées des composants sont masquées dans les modes où les connexions du circuit ne peuvent pas être modifiées (et restent visibles sinon)."),hideTooltips:tuple("Désactiver tooltips","Si coché, les informations supplémentaires des tooltips (comme les tables de vérité) ne seront pas affichées."),groupParallelWires:tuple("Grouper les fils parallèles","Si coché, les fils parralèles allant d'un composant à un autre seront regroupés en un seul fil plus épais."),showHiddenWires:tuple("Montrer les fils cachés","Si coché, les fils cachés seront quand même affichés."),showAnchors:tuple("Montrer les ancrages","Si coché, des flèches indiqueront les composants auxquels sont ancrés les composants lors de leur déplacement."),showIds:tuple("Montrer les identifiants","Si coché, les identifiants des composants seront affichés."),propagationDelay:"Un 1 ou un 0 imposé sur une connexion sera répercuté à l’autre bout de la connexion après ce délai de propagation.",propagationDelayField:tuple("Propagation en","ms"),zoomLevel:"Le niveau de zoom sur les composants du circuit.",zoomLevelField:tuple("Zoom:","%"),showUserDataLink:tuple("Voir les","données liées"),userDataHeader:"Les données suivantes sont exportées avec le circuit:",wireStyle:"Style des fils:"},Tests:{Title:"Tests",DefaultTestCaseName:"Test",DefaultTestSuiteName:"Tests",SetInputs:"Entrées",WantedOutputs:"Sorties",SetTheseInputs:"Régler ces entrées",Run:"Tester",RunTestSuite:"Exécuter les tests",DeleteTestCase:"Supprimer ce test",EditTestCaseName:"Renommer ce test",EnterNewTestCaseName:"Entrez le nouveau nom du test:",ComponentUsedInTestSuite:template("Ce composant est utilisé dans des tests. Voulez-vous vraiment le supprimer? Les tests seront conservés, mais ne fonctionneront pas tant qu’un autre composant avec cette référence (“${ref}”) ne sera pas ajouté au circuit.")},TopBar:{DirtyTooltip:"Le circuit a été modifié depuis la dernière sauvegarde.",CircuitNameTooltip:"Nom du circuit actuellement édité; cliquez pour modifier",SetCircuitName:"Tapez le nom du circuit (ou laissez vide pour le nom par défaut):",CustomComponentCaptionTooltip:"Nom du sous-circuit actuellement édité; cliquez pour modifier",CloseCircuit:"Retour au circuit complet",Undo:tuple("Annuler","Annule la dernière action"),Redo:tuple("Rétablir","Rétablit la dernière action annulée ou répète l’action précédente"),Download:tuple("Télécharger","Télécharge le circuit (ou les composants personnalisés avec la touche Option/Alt)"),Screenshot:tuple("Screenshot","Télécharge le circuit sous forme d’image (PNG ou SVG avec touche Option/Alt)"),Open:tuple("Ouvrir","Ouvre un circuit précédemment téléchargé"),Restore:tuple("Restaurer","Restaure le circuit précédemment modifié"),Reset:tuple("Réinitialiser","Réinitialise l’état de ce circuit"),TimelinePlay:tuple("Play","Démarre l’écoulement du temps"),TimelinePause:tuple("Pause","Arrête l’écoulement du temps"),TimelineStep:tuple("Pas à pas","Avance au prochain événement"),TimeLabel:"Temps: ",Design:tuple("Concevoir","Compose ou modifie le circuit"),Delete:tuple("Supprimer","Supprime des éléments du circuit"),Move:tuple("Déplacer","Déplace tout le circuit"),Tests:tuple("Tests","Montre les tests pour ce circuit")},Messages:{UnsupportedFileType:template("Type de fichier non pris en charge: ${type}."),LoadedDefinitions:template("${n} composant$s{n} personnalisé$s{n} chargé$s{n}"),SavedToUrl:"Circuit enregistré dans l’URL",SetAnchorPrompt:"Cliquez sur le composant auquel s’ancrer",AnchorAdded:"Ancrage ajouté",CircularAnchorsForbidden:"Les ancrages circulaires ne sont pas pris en charge.",NotImplemented:"Cette fonctionnalité n’est pas encore implémentée.",NoPermission:"Cette action n’est pas autorisée dans ce mode.",ReallyCloseWindow:"Voulez-vous vraiment fermer la fenêtre sans prendre en compte les derniers changements?",LoadedCircuitFromSessionStorage:template("Circuit restauré depuis sauvegarde automatique du ${day} à ${time}"),FailedToLoadCircuitFromStorage:template("Impossible de restaurer le circuit (${error})."),NoSavedData:"Rien à restaurer pour cet éditeur.",DevelopedBy:"Développé par ",DidUndo:"Annuler",DidRedo:"Rétablir",DidRepeat:"Répéter",NothingToUndo:"Rien à annuler",NothingToRedo:"Rien à rétablir ou répéter",NewTestCaseTitle:"Création d’un nouveau test de circuit",NewTestCaseSetName:"Entrez le nom du test:",TestCaseInputToSet:template("Entrée$s{n} à régler:"),TestCaseOuputToCheck:template("Sorties$s{n} attendue$s{n}:"),TooManyInputsForAutoTestCases:template("Impossible de créer automatiquement des tests pour plus de ${max} entrées."),AutoTestCasesWarning:template("Ceci va créer ${numCases} tests, un pour chacune des combinaisons des ${numInputs} entrées. Voulez-vous continuer?"),ComputingTestCases:"Génération des tests…",RunningTests:"Excécution des tests…"},Components:{Generic:{contextMenu:{Delete:"Supprimer",Reset:"Réactiver",MakeNewComponent:"Créer un nouveau composant…",MakeNewComponentFailed:"Impossible de créer un nouveau composant.",MakeNewTestCase:"Créer un nouveau test…",MakeAllTestCases:"Créer tous les tests…",MakeNewTestCaseFailed:"Impossible de créer un nouveau test.",SetIdentifier:"Attribuer un identifiant…",ChangeIdentifier:tuple("Changer l’identifiant (",")…"),SetIdentifierPrompt:"Choisissez l’identifiant unique à attribuer à ce composant:",IdentifierCannotBeEmpty:"L’identifiant ne peut pas être vide.",IdentifierAlreadyInUseShouldSwap:"L’identifiant est déjà utilisé par un autre composant. Voulez-vous inverser les identifiants?",SetAnchor:"Définir l’ancrage…",ClearAnchor:tuple("Supprimer l’ancrage (",")"),Orientation:"Orientation",ChangeOrientationDesc:"Changez l’orientation avec Commande + double-clic sur le composant",LockPosition:"Verrouiller la position",ShowAsUnknown:"Afficher comme inconnu",ForceOutputSingle:"Forcer la sortie",ForceOutputMultiple:"Forcer une sortie",Output:"Sortie",NormalOutput:"Sortie normale",ForceAsUnknown:"Forcer comme état inconnu",ForceAs1:"Forcer à 1",ForceAs0:"Forcer à 0",ForceAsZ:"Forcer à haute impédance",ForceOutputDesc:"Forcez une sortie avec Option + double-clic sur la sortie",SetName:"Ajouter un nom…",ChangeName:"Changer le nom…",SetNamePrompt:"Choisissez le nom à afficher ou laissez vide pour le supprimer:",SetFontPrompt:tuple("Entrez une spécification de police ou laissez vide pour la valeur par défaut (","):"),TriggerOn:"Stocker au",TriggerRisingEdge:"flanc montant",TriggerFallingEdge:"flanc descendant",ShowContent:"Montrer le contenu",ParamControlBitAtBottom:"Bit de contrôle en bas",ParamControlBitsAtBottom:"Bits de contrôle en bas",ParamNumInputs:tuple("Nombre d’entrées",template("${val} entrée$s{val}")),ParamNumBits:tuple("Nombre de bits",template("${val} bit$s{val}")),ParamNumWords:tuple("Nombre de lignes",template("${val} ligne$s{val}"))},InputCarryInDesc:"Cin (retenue précédente)",InputClockDesc:"Clock (horloge)",InputClearDesc:"C (Clear, mise à 0)",InputPresetDesc:"P (Preset, mise à 1)",InputSetDesc:"S (Set, mise à 1)",InputResetDesc:"R (Reset, mise à 0)",InputDataDesc:"D (Données)",InputWriteEnableDesc:"WE (écriture activée)",OutputSumDesc:"S (somme)",OutputCarryDesc:"C (retenue)",OutputCarryOutDesc:"Cout (retenue)",OutputQDesc:"Q (sortie normale)",OutputQBarDesc:"Q̅ (sortie inversée)"},Custom:{MenuButtonSuffix:" (composant personnalisé)",contextMenu:{ChangeName:"Renommer…",ChangeNamePrompt:"Choisissez le nom de ce composant personnalité:",ChangeNameEmpty:"Le nom ne peut pas être vide.",ChangeCircuit:"Modifier le circuit",Delete:"Supprimer ce composant",EditFromComponentMessage:"Vous pouvez modifier ce composant depuis le menu d’un composant du circuit.",CannotDeleteInUse:"Impossible de supprimer ce composant car il est utilisé dans le circuit.",CannotDeleteInUseBy:template("Impossible de supprimer ce composant car il est utilisé dans la définition d’un autre composant (${caption})."),ConfirmDelete:"Voulez-vous vraiment supprimer ce composant personnalisé?"},tooltip:{titleSuffix:" (composant personnalisé)",desc:"Ce composant calcule ses sorties selon le circuit personnalisé que vous avez défini."},messages:{EmptySelection:"Aucun composant n’est sélectionné.",NoInput:"Aucune entrée n’est sélectionnée.",NoOutput:"Aucune sortie n’est sélectionnée.",InputsOutputsMustHaveNames:"Toutes les entrées et sorties doivent avoir un nom.",MissingComponents:template("Les composants suivants sont connectés à des sorties mais ne sont pas sélectionnés: ${list}."),NoWires:"Aucun fil n’est présent entre les composants sélectionnés.",UselessComponents:template("Les composants suivants ne sont pas connectés à des sorties et sont inutiles: ${list}."),CannotIncludeClock:"Les horloges ne peuvent pas être incluses dans les composants personnalisés. Ajoutez une entrée normale, qui pourra être connectée à une horloge de l'extérieur du composant.",CannotBeModified:"Ce composant ne peut pas être modifié dans ce mode.",EnterCaptionPrompt:"Entrez le nom (unique) du composant personnalisé:",ComponentAlreadyExists:template("Un composant personnalisé avec l’identifiant '${id}' existe déjà."),InputsOutputsChanged:"Les entrées et sorties ont changé et certaines connexions pourront être supprimées en adaptant le circuit. Voulez-vous continuer?",NotInMainEditor:"Revenez d’abord à l’éditeur principal pour modifier le circuit personnalisé de ce composant."}},Adder:{tooltip:{title:"Additionneur",desc:"Additionne deux bits A et B et une retenue d’entrée Cin, et fournit un bit de somme S et une retenue de sortie Cout."}},AdderArray:{tooltip:{title:template("Additionneur à ${numBits} bit$s{numBits}"),desc:"Additionne les deux nombres d'entrées A et B avec une retenue d’entrée Cin, et fournit les bits de somme S et une retenue de sortie Cout."}},ALU:{"A+B":tuple("+","Addition"),"A-B":tuple("A–B","Soustraction (A – B)"),"B-A":tuple("B–A","Soustraction (B – A)"),"A+1":tuple("A+1","A + 1"),"A-1":tuple("A–1","A – 1"),"-A":tuple("–A","Négation d’A"),"A*2":tuple("A×2","Addition d’A à lui-même (A × 2)"),"A/2":tuple("A/2","Décalage arithmétique à droite de 1 (A / 2)"),"A|B":tuple("OU","Disjonction (A OU B)"),"A&B":tuple("ET","Conjonction (A ET B)"),"A|~B":tuple("OU-n","A OU NON(B)"),"A&~B":tuple("ET-n","A ET NON(B)"),"~A":tuple("A̅","Inversion d’A"),"A^B":tuple("OU-X","Disjonction excl. (A OU-X B)"),"A<<":tuple("<<","Décalage logique à gauche de 1 de A"),"A>>":tuple(">>","Décalage logique à droite de 1 de A"),InputCinDesc:"retenue d’entrée",OutputCoutDesc:"retenue de sortie",tooltip:{title:"Unité arithmétique et logique (ALU)",CurrentlyCarriesOut:"Effectue actuellement",SomeUnknownOperation:"une opération inconnue",ThisOperation:"l’opération"},contextMenu:{toggleShowOp:"Afficher l’opération",ParamUseExtendedOpcode:"Utiliser opérations étendues"}},Clock:{tooltip:{title:"Horloge",period:tuple("Période: "," ms"),dutycycle:tuple("Rapport cyclique: ","%"),phase:tuple("Déphasage: "," ms")},contextMenu:{Period:"Période",CustomPeriod:"Autre",SetPeriodMillis:"Entrez la période de l’horloge en millisecondes:",InvalidPeriod:"La période doit être un nombre entier positif.",ReplaceWithInput:"Remplacer par entrée"},timeline:{NextRisingEdge:"Prochain flanc montant de l’horloge",NextFallingEdge:"Prochain flanc descendant de l’horloge"}},Comparator:{tooltip:{title:"Comparateur",desc:"Comparateur entre deux bits A et B, activé par une entrée E."}},Counter:{tooltip:{title:"Compteur",desc:"Compteur à quatre bits."},contextMenu:{DisplayTempl:template("Affichage ${desc}"),DisplayNone:"absent",DisplayDecimal:"décimal",DisplayHex:"hexadécimal"}},Decoder:{tooltip:{title:"Décodeur binaire",desc:template("Ce décodeur prend en entrée un nombre binaire codé sur ${numFrom} bit$s{numFrom} et active la sortie correspondante parmi ${numTo} (actuellement, ${n}).")}},Decoder7Seg:{tooltip:"Décodeur 7 segments"},Decoder16Seg:{tooltip:"Décodeur ASCII vers 16 segments"},DecoderBCD4:{tooltip:"Décodeur 4 bits vers BCD (binary-coded decimal)"},Demux:{tooltip:template("Démultiplexeur ${from} vers ${to}")},FlipflopD:{tooltip:{title:"Bascule D",desc:"Stocke un bit."}},FlipflopJK:{InputJDesc:"J (Jump, mise à 1)",InputKDesc:"K (Kill, mise à 0)",tooltip:{title:"Bascule JK",desc:"Stocke un bit."}},FlipflopT:{InputTDesc:"T (Toggle, bascule)",tooltip:{title:"Bascule T",desc:"Stocke un bit."}},Gate:{not:tuple("NON","NON","La sortie est égale à l’entrée inversée."),buf:tuple("OUI","OUI","La sortie est égale à l’entrée."),and:tuple("ET","ET","La sortie vaut 1 lorsque toutes les entrées valent 1."),or:tuple("OU","OU","La sortie vaut 1 lorsqu’au moins une des entrées vaut 1."),xor:tuple("OU-X","OU-X","La sortie vaut 1 lorsqu’un nombre impair d’entrées valent 1."),nand:tuple("NON-ET","N-ET","Porte ET inversée: la sortie vaut 1 à moins que toutes les entrées ne valent 1."),nor:tuple("NON-OU","N-OU","Porte OU inversée: la sortie vaut 1 lorsque toutes les entrées valent 0."),xnor:tuple("NON-OU-X","N-OU-X","Porte OU-X inversée: la sortie vaut 1 lorsqu’un nombre pair d’entrées valent 1."),imply:tuple("IMPLIQUE","IMPL","La sortie vaut 1 si la première entrée vaut 0 ou si les deux entrées valent 1."),rimply:tuple("IMPLIQUE (bis)","IMPL","La sortie vaut 1 si la seconde entrée vaut 0 ou si les deux entrées valent 1."),nimply:tuple("NON-IMPLIQUE","N-IMPL","Porte IMPLIQUE inversée: la sortie ne vaut 1 que lorsque la première entrée vaut 1 et la seconde 0."),rnimply:tuple("NON-IMPLIQUE (bis)","N-IMPL","Porte IMPLIQUE inversée: la sortie ne vaut 1 que lorsque la première entrée vaut 0 et la seconde 1."),txa:tuple("TRANSFERT-A",void 0,"La sortie est égale à la première entrée; la seconde entrée est ignorée."),txb:tuple("TRANSFERT-B",void 0,"La sortie est égale à la seconde entrée; la première entrée est ignorée."),txna:tuple("TRANSFERT-NON-A",void 0,"La sortie est égale à la première entrée inversée; la seconde entrée est ignorée."),txnb:tuple("TRANSFERT-NON-B",void 0,"La sortie est égale à la seconde entrée inversée; la première entrée est ignorée."),tooltip:{GateTitle:gateType=>mods("Porte ",gateType),UnknownGate:"Porte inconnue",Input:"Entrée",Output:"Sortie",CurrentlyDelivers:"Actuellement, il livre",ShouldCurrentlyDeliver:"Actuellement, il devrait livrer",UndeterminedOutputBecauseInputUnknown:"une sortie indéterminée comme son entrée n’est pas connue. Sa table de vérité est:",UndeterminedOutputBecauseInputsUnknown:"une sortie indéterminée comme toutes ses entrées ne sont connues. Sa table de vérité est:",ThisOutput:"une sortie de",BecauseInputIs:"car son entrée est",AccordingToTruthTable:"selon la table de vérité suivante:",Inverter:tuple("Inverseur (porte ",")"),Buffer:tuple("Buffer (porte ",")")},contextMenu:{ReplaceBy:"Remplacer par",GateTempl:template("Porte ${type}"),ShowAs:"Afficher comme",NormalGateTempl:template("Porte ${type} normale"),UnknownGate:"Porte inconnue (avec «?»)",VariantChangeDesc:"Changez entre les variantes avec Majuscule + double-clic sur la porte"}},HalfAdder:{tooltip:{title:"Demi-additionneur",desc:"Additionne deux bits A et B et fournit un bit de somme S et une retenue de sortie C."}},Input:{tooltip:{title:template("Entrée (${numBits} bit$s{numBits})")},contextMenu:{LockValue:"Verrouiller cette valeur",PushButton:"Poussoir",ToggleButton:"Commutateur",ReplaceWithClock:"Remplacer par horloge",InputSetFromOutside:"Entrée contrôlée depuis l’extérieur"}},Random:{tooltip:{title:"Valeur aléatoire",desc:tuple("À chaque coup d’horloge, la valeur de sortie sera 1 avec une probabilité de ",".")},contextMenu:{ShowProb:"Montrer la probabilité"}},Rectangle:{contextMenu:{Size:"Taille",SizePrompt:"Entrez la taille de ce rectangle:",Rounded:"Arrondi",WithBackgroundColor:"Avec couleur de fond",SetTitle:"Ajouter un titre…",ChangeTitle:"Changer le titre…",SetTitlePrompt:"Entrez le titre à afficher ou laissez vide pour le supprimer:",InsideFrame:"À l’intérieur du cadre",Font:"Police…",Color:"Couleur",ColorYellow:"Jaune",ColorRed:"Rouge",ColorGreen:"Vert",ColorBlue:"Bleu",ColorTurquoise:"Turquoise",ColorGrey:"Gris",Border:"Bordure",BorderNone:"Aucune bordure",Border1px:"Fine (1 pixel)",Border2px:"Moyenne (2 pixels)",Border3px:"Épaisse (3 pixels)",Border5px:"Très épaisse (5 pixels)",Border10px:"Énorme (10 pixels)",TitlePlacement:"Position du titre",PlacementTop:"En haut",PlacementTopLeft:"En haut à gauche",PlacementTopRight:"En haut à droite",PlacementBottom:"En bas",PlacementBottomLeft:"En bas à gauche",PlacementBottomRight:"En bas à droite",PlacementLeft:"À gauche",PlacementRight:"À droite",PlacementCenter:"Au centre"}},Label:{contextMenu:{ChangeText:"Changer le texte…",ChangeTextPrompt:"Choisissez le texte à afficher:",Font:"Police…"}},LatchSR:{tooltip:{title:"Verrou SR",desc:"Stocke un bit."}},Mux:{tooltip:template("Multiplexeur ${from} vers ${to}")},MuxDemux:{contextMenu:{ShowWiring:"Afficher les connexions",UseZForDisconnected:"Utiliser Z pour sorties déconnectées",ParamNumFrom:tuple("Nombre d’entrées",template("${val} entrée$s{val}")),ParamNumTo:tuple("Nombre de sorties",template("${val} sortie$s{val}"))}},Output:{tooltip:{title:template("Sortie (${numBits} bit$s{numBits})")}},Display7Seg:{tooltip:"Afficheur 7 segments"},Display16Seg:{tooltip:"Afficheur 16 segments"},DisplayAscii:{tooltip:{title:"Afficheur de caractère ASCII",desc:tuple("Affiche le caractère ASCII représenté par ses 7 entrées, actuellement ","."),CurrentlyUndefined:"Comme toutes ses entrées ne sont pas connues, ce caractère est actuellement indéfini.",CurrentlyThisCharacter:"Actuellement, c’est le caractère numéro",WhichIsNotPrintable:" (un caractère non imprimable)."},contextMenu:{AdditionalDisplay:"Affichage supplémentaire",DisplayNone:"Aucun",DisplayDecimal:"Valeur décimale",DisplayHex:"Valeur hexadécimale",ChangeDisplayDesc:"Changez l’affichage supplémentaire avec un double-clic sur le composant"}},DisplayBar:{tooltip:{title:"Afficheur lumineux",ValueUnknown:"Son état est indéterminé car son entrée n’est pas connue.",ValueZ:"Son état est indéterminé car son entrée est flottante (haute impédance).",Value1:tuple("Il est actuellement allumé car son entrée est de ","."),Value0:tuple("Il est actuellement éteint car son entrée est de ",".")},contextMenu:{TransparentWhenOff:"Transparent si éteint",Display:"Affichage",DisplayVerticalBar:"Barre verticale",DisplayHorizontalBar:"Barre horizontale",DisplaySmallSquare:"Petit carré",DisplayLargeSquare:"Grand carré",DisplayChangeDesc:"Changez l’affichage avec un double-clic sur le composant",Color:"Couleur",ColorGreen:"Vert",ColorRed:"Rouge",ColorYellow:"Jaune"}},Display:{tooltip:{title:template("Afficheur ${numBits} bit$s{numBits}"),desc:tuple(template("Affiche la valeur ${radixStr} de ses ${numBits} entrée$s{numBits}, actuellement "),"."),RadixBinary:"binaire",RadixDecimal:"décimale",RadixSignedDecimal:"décimale signée",RadixHexadecimal:"hexadécimale",RadixGeneric:template("en base ${radix}"),CurrentlyUndefined:"Comme toutes ses entrées ne sont pas connues, cette valeur est actuellement indéfinie."},contextMenu:{DisplayAs:"Afficher",DisplayNone:"Aucun",DisplayAsBinary:"en binaire (base 2)",DisplayAsDecimal:"en décimal (base 10)",DisplayAsSignedDecimal:"en décimal signé",DisplayAsOctal:"en octal (base 8)",DisplayAsHexadecimal:"en hexadécimal (base 16)",DisplayAsUnknown:"comme inconnu"}},ShiftDisplay:{tooltip:"Affichage à décalage",contextMenu:{Decoding:"Décodage",DecodingNone:"Aucun",DecodingOctal:"Octal",DecodingHex:"Hexadécimal",DecodingAscii7:"ASCII (7 bits)",DecodingAscii8:"ASCII (8 bits)",DecodingUint4:"Entier sur 4 bits",DecodingInt4:"Entier signé sur 4 bits",DecodingUint8:"Entier sur 8 bits",DecodingInt8:"Entier signé sur 8 bits",DecodingUint16:"Entier sur 16 bits",DecodingInt16:"Entier signé sur 16 bits",DecodingChangeWarning:"Attention, changer le décodage peut tronquer la valeur stockée",Grouping:"Regrouper les données",GroupingNone:"Pas de regroupement",GroupBy:template("Par ${n}")},EmptyCaption:"(vide)"},Passthrough:{tooltip:"Broche. Sert uniquement à arranger les connexions.",contextMenu:{Slant:"Inclinaison",SlantNone:"Aucune",SlantRight:"De 45° vers la droite",SlantLeft:"De 45° vers la gauche"}},GateArray:{tooltip:{title:"Porte multiple",desc:template("Effectue plusieurs fois en parallèle l’opération logique choisie; actuellement, ${op}.")},contextMenu:{Type:"Type",ShowAsUnknown:"Masquer le type"}},TristateBufferArray:{tooltip:{title:"Sortie à 3 états multiple",desc:"Représente plusieurs sorties à trois états, contrôlées par un seul bit de contrôle."}},RAM:{tooltip:{title:"RAM (mémoire vive)",desc:template("Stocke ${numWords} ligne$s{numWords} de ${numDataBits} bit$s{numDataBits}.")},contextMenu:{SelectedDataDisplay:"Affichage des données addressées",EditContent:"Éditer le contenu…",EditContentPrompt:"Tapez le nouveau contenu de la mémoire en séparant les lignes par des espaces. S’il y a autant de caractères que de bits, les données sont lues comme étant du binaire, sinon, comme de l'hexadécimal.",SaveContent:"Sauvegarder le contenu",LoadContent:"Charger le contenu…",SwapROMRAM:"Échanger ROM et RAM"}},ROM:{tooltip:{title:"ROM (mémoire morte)",desc:template("Stocke ${numWords} ligne$s{numWords} de ${numDataBits} bits${numDataBits}.")}},Register:{tooltip:{title:"Registre",desc:template("Stocke ${numBits} bit$s{numBits}.")},contextMenu:{ParamHasIncDec:"Avec incrémentaiton",Saturating:"Avec saturation"}},ShiftRegister:{tooltip:{title:"Registre à décalage",desc:template("Stocke ${numBits} bit$s{numBits} et les décale à chaque activation.")}},ControlledInverter:{tooltip:{title:"Inverseur commuté",desc:"Inverse ses entrées si le bit de contrôle S vaut 1; sinon, les sorties sont égales aux entrées."}},TristateBuffer:{tooltip:"Sortie à 3 états"},Wire:{contextMenu:{AddMiddlePoint:"Ajouter un point intermédiaire",AddPassthrough:"Ajouter une broche",CustomPropagationDelay:template("Délai de propagation spécifique${current}…"),CustomPropagationDelayDesc:template("Délai de propagation personnalisé en millisecondes pour cette connexion (laisser vide pour utiliser la valeur par défaut du circuit, actuellement de ${current} ms):"),WireColor:"Couleur du fil",WireColorBlack:"Noir (par défaut)",WireColorRed:"Rouge",WireColorBlue:"Bleu",WireColorYellow:"Jaune",WireColorGreen:"Vert",WireColorWhite:"Blanc",WireStyle:"Style",WireStyleDefault:"Par défaut",WireStyleAuto:"Auto",WireStyleStraight:"Ligne",WireStyleSquareHV:"H puis V",WireStyleSquareVH:"V puis H",WireStyleCurved:"Courbe",HiddenWire:"Masquer le fil"},timeline:{PropagatingValue:template("Propagation de la valeur ${val} sur le fil")}}},Dialogs:{Generic:{Close:"Fermer"},Share:{title:"Partager ce circuit",URL:"URL:",EmbedInIframe:"Inclusion via <iframe>:",EmbedWithWebComp:"Inclusion via un web component:",EmbedInMarkdown:"Inclusion en Markdown/Myst:"}}},en:{plural:(n,plural,singular)=>1===Math.abs(n)?null!=singular?singular:"":null!=plural?plural:"s",ComponentBar:{SectionNames:{InputOutput:"Input/ Output",Gates:"Gates",Layout:"Layout",Components:"Compo- nents",Custom:"Custom"},Labels:{More:"More",Less:"Less"},Components:RichStringEnum.withProps()({Input1:["Input","IN"],InputN:["Multiple Inputs","IN Mult."],Input8:["Byte (8-Bit) Input","IN (8-Bit)"],Clock:["Clock Generator","Clock"],Random:["Random Input","Random"],Output1:["Output","OUT"],OutputN:["Multiple Outputs","OUT Mult."],Output8:["Byte (8-Bit) Output","OUT (8-Bit)"],DisplayN:["Value Display","Display"],Display8:["Byte (8-Bit) Display","8-Bit Displ."],Display7Seg:["7-Segment Display","7-Segment"],Display16Seg:["16-Segment Display","16-Segment"],DisplayAscii:["ASCII Character (7-Bit) Display","Character"],DisplayBar:["Bit Display as a Light Bar","Bar"],ShiftDisplay:["Display with Shift Buffer","Shift Displ."],Passthrough1:["Passthrough","Passthrough"],PassthroughN:["Passthrough with multiple inputs-outputs","Passthr. (n)"],Label:["Label","Label"],Rectangle:["Grouping Rectangle","Group"],not:["NOT Gate","NOT"],buf:["Buffer","BUF"],tri:["Tristate Buffer","Tristate"],and:["AND Gate","AND"],or:["OR Gate","OR"],xor:["XOR Gate","XOR"],nand:["NAND Gate","NAND"],nor:["NOR Gate","NOR"],xnor:["XNOR Gate","XNOR"],imply:["IMPLY Gate","IMPLY"],nimply:["NIMPLY Gate","NIMPLY"],transfer:["Fake 2-Input TRANSFER Gate","TRANSF."],and3:["3-Input AND Gate","AND (3)"],or3:["3-Input OR Gate","OR (3)"],xor3:["3-Input XOR Gate","XOR (3)"],nand3:["3-Input NAND Gate","NAND (3)"],nor3:["3-Input NOR Gate","NOR (3)"],xnor3:["3-Input XNOR Gate","XNOR (3)"],and4:["4-Input AND Gate","AND (4)"],or4:["4-Input AND Gate","OR (4)"],xor4:["4-Input AND Gate","XOR (4)"],nand4:["4-Input AND Gate","NAND (4)"],nor4:["4-Input AND Gate","NOR (4)"],xnor4:["4-Input AND Gate","XNOR (4)"],ControlledInverter:["Switched Inverter","Switched Inv."],GateArray:["Gate Array","Gate Array"],TristateBufferArray:["Tristate Buffer Array","Tristate Arr."],HalfAdder:["Half Adder","Half Adder"],Adder:["Full Adder","Full Adder"],AdderArray:["Adder Array","Adder Arr."],ALU:["Arithmetic and Logic Unit","ALU"],Mux:["Multiplexer","Mux"],Mux2to1:["2-to-1 Multiplexer (1 Control Bit)","Mux 2-1"],Mux4to1:["4-to-1 Multiplexer (2 Control Bit)","Mux 4-1"],Mux8to1:["8-to-1 Multiplexer (3 Control Bit)","Mux 8-1"],Mux4to2:["4-to-2 Multiplexer (1 Control Bit)","Mux 4-2"],Mux8to2:["8-to-2 Multiplexer (2 Control Bit)","Mux 8-2"],Mux8to4:["8-to-4 Multiplexer (1 Control Bit)","Mux 8-4"],Mux16to8:["16-to-8 Multiplexer (1 Control Bit)","Mux 16-8"],Demux:["Demultiplexer","Demux"],Demux1to2:["1-to-2 Demultiplexer (1 Control Bit)","Demux 1-2"],Demux1to4:["1-to-4 Demultiplexer (2 Control Bit)","Demux 1-4"],Demux1to8:["1-to-8 Demultiplexer (3 Control Bit)","Demux 1-8"],Demux2to4:["2-to-4 Demultiplexer (1 Control Bit)","Demux 2-4"],Demux2to8:["2-to-8 Demultiplexer (2 Control Bit)","Demux 2-8"],Demux4to8:["4-to-8 Demultiplexer (1 Control Bit)","Demux 4-8"],Demux8to16:["8-to-16 Demultiplexer (1 Control Bit)","Demux 8-16"],LatchSR:["SR Latch","SR Latch"],FlipflopJK:["JK Flip-Flop","FF-JK"],FlipflopT:["T Flip-Flop","FF-T"],FlipflopD:["D Flip-Flop","FF-D"],Register:["Register","Register"],ShiftRegister:["Shift Register","Shift Reg."],RAM:["RAM Module","RAM"],ROM:["ROM Module","ROM"],Counter:["4-Bit Counter","Counter"],Decoder:["Binary to One-of-N Decoder","Decoder"],Decoder7Seg:["7-Segment Decoder","7-Seg. Dec."],Decoder16Seg:["ASCII-to-16-Segment Decoder","16-Seg. Dec."],DecoderBCD4:["4-Bit-to-BCD Decoder","BCD Dec."],Comparator:["Comparator","Compar."]})},Modes:{FULL:tuple("Admin","In addition to the full mode, this enables features like hiding wire colors, setting inputs and output to undetermined values, create faulty components, etc."),DESIGN:tuple("Full","All standard circuit-design features are enabled"),CONNECT:tuple("Connect","You can move and connect components already on the canvas, but not add more components (the left component bar is not shown)"),TRYOUT:tuple("Tryout","You can only change inputs to try out a already-designed circuit"),STATIC:tuple("Static","Components are displayed without any possible interaction")},Orientations:{e:"Right (default)",s:"Down",w:"Left",n:"Up"},Settings:{Settings:"Settings",CircuitName:"Name:",DefaultFileName:"circuit",NameOfDownloadedFile:"This will be the name of the downloaded file.",animateWires:tuple("Animate wires","If checked, wires are shown as animated to show the propagation direction."),hideWireColors:tuple("Hide wire colors","If checked, wires are shown with a neutral color instead of showing whether they carry a 1 or a 0."),hideInputColors:tuple("Hide input colors","If checked, inputs are shown with a neutral color, even if they still deliver a well determined value. Can be used together with hidden wire colors."),hideOutputColors:tuple("Hide output colors","If checked, outputs are shown with a neutral color. Can be used together with hidden wire colors."),hideMemoryContent:tuple("Hide stored values","If checked, latches, flip-flops, registers and other memory components don’t show the content they store."),showGateTypes:tuple("Show gate types","If checked, gates types are displayed textually on top of the gate symbol."),showDisconnectedPins:tuple("Always show pins","If unchecked, disconnected component pins are hidden in modes where new connections can’t be made (but stay visible otherwise)."),hideTooltips:tuple("Disable tooltips","If checked, additional information in component tooltips (such as truth tables) won’t be shown."),groupParallelWires:tuple("Group parallel wires","If checked, parallel wires from one component to another will be grouped together as a thicker wire."),showHiddenWires:tuple("Show hidden wires","If checked, hidden wires will still be shown."),showAnchors:tuple("Show anchors","If checked, arrows will be shown to denote which component is anchored to which other component while moving."),showIds:tuple("Show IDs","If checked, component IDs will be shown on top of them"),propagationDelay:"A 1 or 0 output on some wire will propagate to the other end of the wire after this propagation delay.",propagationDelayField:tuple("Propagation in","ms"),zoomLevel:"The zoom level on the circuit components.",zoomLevelField:tuple("Zoom:","%"),showUserDataLink:tuple("See ","linked data"),userDataHeader:"This data is exported with the circuit:",wireStyle:"Wire style:"},Tests:{Title:"Tests",DefaultTestCaseName:"Test",DefaultTestSuiteName:"Test Suite",SetInputs:"Inputs",WantedOutputs:"Outputs",SetTheseInputs:"Set these inputs",Run:"Run",RunTestSuite:"Run test suite",DeleteTestCase:"Delete this test case",EditTestCaseName:"Rename this test case",EnterNewTestCaseName:"Enter the new name for this test case:",ComponentUsedInTestSuite:template("This component is used in test suites. Do you really want to delete it? The tests will be kept, but won’t work until another component with this reference (“${ref}”) is added to the circuit.")},TopBar:{DirtyTooltip:"The circuit has been modified since the last download/save",CircuitNameTooltip:"Name of the circuit; click to change",SetCircuitName:"Set the name of the circuit (or leave empty to use the default name):",CustomComponentCaptionTooltip:"Name of the subcircuit currently being edited; click to change",CloseCircuit:"Back to the main circuit",Undo:tuple("Undo","Undo the last action"),Redo:tuple("Redo","Redo the last undone action or repeat the last action"),Download:tuple("Download","Download the circuit (or the custom components with Option/Alt key down)"),Screenshot:tuple("Screenshot","Download the circuit as an image (PNG or SVG with Option/Alt key down)"),Open:tuple("Open","Open a previously downloaded circuit"),Restore:tuple("Restore","Restore the circuit to the last state"),Reset:tuple("Reset","Reset the state of this circuit"),TimelinePlay:tuple("Play","Starts logical time"),TimelinePause:tuple("Pause","Stops logical time"),TimelineStep:tuple("Step","Moves logical time to the next scheduled event"),TimeLabel:"Time: ",Design:tuple("Design","Create or modify the circuit"),Delete:tuple("Delete","Delete elements from the circuit"),Move:tuple("Move","Move the whole circuit"),Tests:tuple("Tests","Show tests for the circuit")},Messages:{UnsupportedFileType:template("Unsupported file type: ${type}."),LoadedDefinitions:template("Loaded ${n} custom component definition$s{n}"),SavedToUrl:"Circuit saved to URL",SetAnchorPrompt:"Click on the component to anchor to",AnchorAdded:"Anchor added",CircularAnchorsForbidden:"Circular anchors are not supported.",NotImplemented:"This feature is not implemented yet.",NoPermission:"This action is not allowed in this mode.",ReallyCloseWindow:"Do you really want to close the window without saving the changes?",LoadedCircuitFromSessionStorage:template("Loaded from last session on ${day} at ${time}"),FailedToLoadCircuitFromStorage:template("Failed to load the circuit (${error})"),NoSavedData:"Nothing to restore for this editor.",DevelopedBy:"Developed by",DidUndo:"Undo",DidRedo:"Redo",DidRepeat:"Repeat",NothingToUndo:"Nothing to undo",NothingToRedo:"Nothing to redo or repeat",NewTestCaseTitle:"Create a new test case",NewTestCaseSetName:"Enter the name of the new test case:",TestCaseInputToSet:template("Input$s{n} to set:"),TestCaseOuputToCheck:template("Output$s{n} to check:"),TooManyInputsForAutoTestCases:template("Cannot create test cases automatically for more than ${max} inputs."),AutoTestCasesWarning:template("This will create ${numCases} test cases, one for each combination of the ${numInputs} inputs. Do you want to continue?"),ComputingTestCases:"Generating test cases…",RunningTests:"Running test cases…"},Components:{Generic:{contextMenu:{Delete:"Delete",Reset:"Reset",MakeNewComponent:"Make New Component…",MakeNewComponentFailed:"Cannot create new custom component.",MakeNewTestCase:"Make New Test Case…",MakeAllTestCases:"Make All Test Cases…",MakeNewTestCaseFailed:"Cannot create new test case.",SetIdentifier:"Set Identifier…",ChangeIdentifier:tuple("Change Identifier (",")…"),SetIdentifierPrompt:"Choose the unique identifier to use for this component:",IdentifierCannotBeEmpty:"The identifier cannot be empty.",IdentifierAlreadyInUseShouldSwap:"The identifier is already in use. Do you want to swap the component identifiers?",SetAnchor:"Set Anchor…",ClearAnchor:tuple("Remove Anchor (",")"),Orientation:"Orientation",ChangeOrientationDesc:"Change the orientation with Command + double click on the component",LockPosition:"Lock Position",ShowAsUnknown:"Show As Unknown",ForceOutputSingle:"Force Output",ForceOutputMultiple:"Force an Output",Output:"Output",NormalOutput:"Normal Output",ForceAsUnknown:"Force as Unkown",ForceAs1:"Force as 1",ForceAs0:"Force as 0",ForceAsZ:"Force as High Impedance",ForceOutputDesc:"Force an output with Option + click on an output node",SetName:"Set Name…",ChangeName:"Change Name…",SetNamePrompt:"Choose the name to display or leave empty to remove it:",SetFontPrompt:tuple("Enter a font specification or leave empty to use the default value (","):"),TriggerOn:"Trigger on",TriggerRisingEdge:"Rising Edge",TriggerFallingEdge:"Fallling Edge",ShowContent:"Show Content",ParamControlBitAtBottom:"Control Bit at Bottom",ParamControlBitsAtBottom:"Control Bits at Bottom",ParamNumInputs:tuple("Number of Inputs",template("${val} Input$s{val}")),ParamNumBits:tuple("Number of Bits",template("${val} Bit$s{val}")),ParamNumWords:tuple("Number of Lines",template("${val} Line$s{val}"))},InputCarryInDesc:"Cin (Previous Carry)",InputClockDesc:"Clock",InputClearDesc:"C (Clear, set to 0)",InputPresetDesc:"P (Preset, set to 1)",InputSetDesc:"S (Set, set to 1)",InputResetDesc:"R (Reset, set to 0)",InputDataDesc:"D (Data)",InputWriteEnableDesc:"WE (Write Enable)",OutputSumDesc:"S (Sum)",OutputCarryDesc:"C (Carry)",OutputCarryOutDesc:"Cout (Carry)",OutputQDesc:"Q (Normal Output)",OutputQBarDesc:"Q̅ (Inverted Output)"},Custom:{MenuButtonSuffix:" (custom component)",contextMenu:{ChangeName:"Rename…",ChangeNamePrompt:"Enter the name of this custom component:",ChangeNameEmpty:"The name cannot be empty.",ChangeCircuit:"Edit Circuit",Delete:"Delete Custom Component",EditFromComponentMessage:"You can edit this custom component by right-clicking such a component in the circuit.",CannotDeleteInUse:"Cannot delete this custom component because it is in use in the circuit.",CannotDeleteInUseBy:template("Cannot delete this custom component because it is used to define another component (${caption})."),ConfirmDelete:"Are you sure you want to delete this custom component?"},tooltip:{titleSuffix:" (Custom Component)",desc:"This custom component computes its outputs according to the circuit you have defined."},messages:{EmptySelection:"No components are selected.",NoInput:"No input is selected.",NoOutput:"No output is selected.",InputsOutputsMustHaveNames:"All inputs and outputs must have unique (non-dynamic) names.",MissingComponents:template("The following components are connected to outputs but are missing from selection: ${list}."),NoWires:"There are no wires between the selected components.",UselessComponents:template("The following components are not connected to outputs and are useless: ${list}."),CannotIncludeClock:"Clocks cannot be included in custom components. Add a normal input, which can later be connected to an external clock.",CannotBeModified:"This custom component cannot be modified in this mode.",EnterCaptionPrompt:"Entrez le nom (unique) du composant personnalisé:",ComponentAlreadyExists:template("A custom component definition with id '${id}' already exists."),InputsOutputsChanged:"The inputs and outputs have changed and some connections may be removed by adapting the circuit. Do you want to continue?",NotInMainEditor:"Please go back to the main editor to edit the custom circuit of this component."}},Adder:{tooltip:{title:"Adder",desc:"Adds two bits A and B together with an input carry Cin, and outputs a sum bit S and an output carry Cout."}},AdderArray:{tooltip:{title:template("${numBits}-Bit Adder Array"),desc:"Adds the two inputs numbers A et B together with an input carry Cin, and outputs sum bits S and an output carry Cout."}},ALU:{"A+B":tuple("+","Addition"),"A-B":tuple("A–B","Subtraction (A – B)"),"B-A":tuple("B–A","Subtraction (B – A)"),"A+1":tuple("A+1","A + 1"),"A-1":tuple("A–1","A – 1"),"-A":tuple("–A","Negation of A"),"A*2":tuple("A×2","Addition of A to itself (A × 2)"),"A/2":tuple("A/2","Arithmetic right shift by 1 (A/2)"),"A|B":tuple("OR","Disjunction (A OR B)"),"A&B":tuple("AND","Conjunction (A AND B)"),"A|~B":tuple("ORn","A OR NOT(B)"),"A&~B":tuple("ANDn","A AND NOT(B)"),"~A":tuple("A̅","Inversion of A"),"A^B":tuple("XOR","Excl. Disjunction (A XOR B)"),"A<<":tuple("<<","Logical Left Shift by 1 of A"),"A>>":tuple(">>","Logical Right Shift by 1 of A"),InputCinDesc:"input carry",OutputCoutDesc:"output carry",tooltip:{title:"Arithmetic and Logic Unit (ALU)",CurrentlyCarriesOut:"Currently carries out",SomeUnknownOperation:"an unknown operation",ThisOperation:"operation"},contextMenu:{toggleShowOp:"Show Operation",ParamUseExtendedOpcode:"Use Extended Opcode"}},Clock:{tooltip:{title:"Clock",period:tuple("Period: "," ms"),dutycycle:tuple("Duty cycle: ","%"),phase:tuple("Phase: "," ms")},contextMenu:{Period:"Period",CustomPeriod:"Other",SetPeriodMillis:"Enter the period in milliseconds:",InvalidPeriod:"The period must be a positive number.",ReplaceWithInput:"Replace with Input"},timeline:{NextRisingEdge:"Next rising edge of the clock",NextFallingEdge:"Next falling edge of the clock"}},Comparator:{tooltip:{title:"Comparator",desc:"Comparator between two bits A and B, enabled by an input E."}},Counter:{tooltip:{title:"Counter",desc:"4-bit counter."},contextMenu:{DisplayTempl:template("${desc} Display"),DisplayNone:"No",DisplayDecimal:"Decimal",DisplayHex:"Hexadecimal"}},Decoder:{tooltip:{title:"Binary Decoder",desc:template("Takes as input a binary number coded on ${numFrom} bit$s{numFrom} and activates the corresponding output among ${numTo} (currently, ${n}).")}},Decoder7Seg:{tooltip:"7-Segment Decoder"},Decoder16Seg:{tooltip:"7-Bit ASCII to 16-Segment Decoder"},DecoderBCD4:{tooltip:"4-Bit to BCD (Binary-Coded Decimal) Decoder"},Demux:{tooltip:template("${from}-to-${to} Demultiplexer")},FlipflopD:{tooltip:{title:"D Flip-Flop",desc:"Stores one bit."}},FlipflopJK:{InputJDesc:"J (Jump, set to 1)",InputKDesc:"K (Kill, set to 0)",tooltip:{title:"JK Flip-Flop",desc:"Stores one bit."}},FlipflopT:{InputTDesc:"T (Toggle)",tooltip:{title:"T Flip-Flop",desc:"Stores one bit."}},Gate:{not:tuple("NOT","NOT","The output is the inverted input."),buf:tuple("BUF","BUF","The output is the same as the input."),and:tuple("AND","AND","The output is 1 when all inputs are 1."),or:tuple("OR","OR","The output is 1 when at least one of the inputs is 1."),xor:tuple("XOR","XOR","The output is 1 when an odd number of inputs are 1."),nand:tuple("NAND","NAND","Inverted AND gate: the output is 1 unless all inputs are 1."),nor:tuple("NOR","NOR","Inverted OR gate: the output is 1 when all inputs are 0."),xnor:tuple("XNOR","XNOR","Inverted XOR gate: the output is 1 when an even number of inputs are 1."),imply:tuple("IMPLY","IMPL","The output is 1 if the first input is 0 or if both inputs are 1."),rimply:tuple("IMPLY (bis)","IMPL","The output is 1 if the second input is 0 or if both inputs are 1."),nimply:tuple("NIMPLY","N-IMPL","Inverted IMPLY gate: the output is only 1 if the first input is 1 and the second one 0."),rnimply:tuple("NIMPLY (bis)","N-IMPL","Inverted IMPLY gate: la sortie ne vaut 1 que lorsque la première entrée vaut 0 et la seconde 1."),txa:tuple("TRANSFER-A",void 0,"The output is the same as the first input; the second input is ignored."),txb:tuple("TRANSFER-B",void 0,"The output is the same as the second input; the first input is ignored."),txna:tuple("TRANSFER-NOT-A",void 0,"The output is the inverted first input; the second input is ignored."),txnb:tuple("TRANSFER-NOT-B",void 0,"The output is the inverted second input; the first input is ignored."),tooltip:{GateTitle:gateType=>mods(gateType," Gate"),UnknownGate:"Unknown Gate",Input:"Input",Output:"Output",CurrentlyDelivers:"It currently delivers",ShouldCurrentlyDeliver:"it should currently deliver",UndeterminedOutputBecauseInputUnknown:"an unknown output as its input is unknown. Its truth table is:",UndeterminedOutputBecauseInputsUnknown:"an unknown output as not all inputs are known. Its truth table is:",ThisOutput:"the output",BecauseInputIs:"because its input is",AccordingToTruthTable:"according to the following truth table:",Inverter:tuple("Inverter ("," gate)"),Buffer:tuple("Buffer ("," gate)")},contextMenu:{ReplaceBy:"Replace By",GateTempl:template("${type} Gate"),ShowAs:"Show As",NormalGateTempl:template("Normal ${type} Gate"),UnknownGate:"Unknown Gate (with “?”)",VariantChangeDesc:"Switch to a variant with Shift + double-click on the gate"}},HalfAdder:{tooltip:{title:"Half Adder",desc:"Adds two bits A and B. Outputs a sum bit S and an output carry bit C."}},Input:{tooltip:{title:template("Input (${numBits}-Bit)")},contextMenu:{LockValue:"Lock This Value",PushButton:"Push Button",ToggleButton:"Toggle Button",ReplaceWithClock:"Replace With Clock",InputSetFromOutside:"Input set from outside"}},Random:{tooltip:{title:"Random Input",desc:tuple("When triggered by the clock, the output value will be 1 with probability ",".")},contextMenu:{ShowProb:"Show Probability"}},Rectangle:{contextMenu:{Size:"Size",SizePrompt:"Enter the size of this rectangle:",Rounded:"Rounded",WithBackgroundColor:"With Background Color",SetTitle:"Add Title…",ChangeTitle:"Change Title…",SetTitlePrompt:"Enter the title to display or leave empty to remove it:",InsideFrame:"Inside Frame",Font:"Font",Color:"Color",ColorYellow:"Yellow",ColorRed:"Red",ColorGreen:"Green",ColorBlue:"Blue",ColorTurquoise:"Turquoise",ColorGrey:"Grey",Border:"Border",BorderNone:"None",Border1px:"Fine (1 pixel)",Border2px:"Medium (2 pixels)",Border3px:"Thick (3 pixels)",Border5px:"Very Thick (5 pixels)",Border10px:"Huge (10 pixels)",TitlePlacement:"Title Placement",PlacementTop:"Top",PlacementTopLeft:"Top Left",PlacementTopRight:"Top Right",PlacementBottom:"Bottom",PlacementBottomLeft:"Bottom Left",PlacementBottomRight:"Bottom Right",PlacementLeft:"Left",PlacementRight:"Right",PlacementCenter:"Center"}},Label:{contextMenu:{ChangeText:"Change Text…",ChangeTextPrompt:"Type the text to display:",Font:"Font…"}},LatchSR:{tooltip:{title:"SR Latch",desc:"Stores one bit."}},Mux:{tooltip:template("${from}-to-${to} Multiplexer")},MuxDemux:{contextMenu:{ShowWiring:"Show Internal Wiring",UseZForDisconnected:"Use Z For Disconnected Pins",ParamNumFrom:tuple("Number of Inputs",template("${val} Input$s{val}")),ParamNumTo:tuple("Number of Outputs",template("${val} Output$s{val}"))}},Output:{tooltip:{title:template("Output (${numBits}-Bit)")}},Display7Seg:{tooltip:"7-Segment Display"},Display16Seg:{tooltip:"16-Segment Display"},DisplayAscii:{tooltip:{title:"ASCII Character Display",desc:tuple("Displays the ASCII character represented by the 7 inputs, currently ","."),CurrentlyUndefined:"As not all inputs are known, this character is currently undefined.",CurrentlyThisCharacter:"Currently, this character is",WhichIsNotPrintable:" (a non-printable character)."},contextMenu:{AdditionalDisplay:"Additional Display",DisplayNone:"None",DisplayDecimal:"Decimal Value",DisplayHex:"Hexadecimal Value",ChangeDisplayDesc:"Change the additional display with a double-click on the component"}},DisplayBar:{tooltip:{title:"Bar/LED Display",ValueUnknown:"Its state is undefined because its input is unknown.",ValueZ:"Its state is undefined because its input is floating (high impedance).",Value1:tuple("It is currently on because its input is ","."),Value0:tuple("It is currently off because its input is ",".")},contextMenu:{TransparentWhenOff:"Transparent When Off",Display:"Display",DisplayVerticalBar:"Vertical Bar",DisplayHorizontalBar:"Horizontal Bar",DisplaySmallSquare:"Small Square",DisplayLargeSquare:"Large Square",DisplayChangeDesc:"Change display types with a double-click on the component",Color:"Color",ColorGreen:"Green",ColorRed:"Red",ColorYellow:"Yellow"}},Display:{tooltip:{title:template("${numBits}-Bit Display"),desc:tuple(template("Displays the ${radixStr} value of its ${numBits} input$s{numBits}, which is currently "),"."),RadixBinary:"binary",RadixDecimal:"decimal",RadixSignedDecimal:"signed decimal",RadixHexadecimal:"hexadecimal",RadixGeneric:template("base-${radix}"),CurrentlyUndefined:"As not all inputs are known, this value is currently undefined."},contextMenu:{DisplayAs:"Display as",DisplayNone:"None",DisplayAsBinary:"Binary (Base 2)",DisplayAsDecimal:"Decimal (Base 10)",DisplayAsSignedDecimal:"Signed Decimal",DisplayAsOctal:"Octal (Base 8)",DisplayAsHexadecimal:"Hexadecimal (Base 16)",DisplayAsUnknown:"Unkown"}},ShiftDisplay:{tooltip:"Shift Buffer Display",contextMenu:{Decoding:"Decoding",DecodingNone:"None",DecodingOctal:"Octal",DecodingHex:"Hexadecimal",DecodingAscii7:"ASCII (on 7 bits)",DecodingAscii8:"ASCII (on 8 bits)",DecodingUint4:"4-Bit Integer",DecodingInt4:"4-Bit Signed Integer",DecodingUint8:"8-Bit Integer",DecodingInt8:"8-Bit Signed Integer",DecodingUint16:"16-Bit Integer",DecodingInt16:"16-Bit Signed Integer",DecodingChangeWarning:"Changing the decoding may truncate the stored value.",Grouping:"Group Data",GroupingNone:"No Grouping",GroupBy:template("By ${n}")},EmptyCaption:"(empty)"},Passthrough:{tooltip:"Passthrough. Only used to arrange wires.",contextMenu:{Slant:"Slant",SlantNone:"None",SlantRight:"Rightward By 45°",SlantLeft:"Leftward By 45°"}},GateArray:{tooltip:{title:"Gate Array",desc:template("Computes in parallel several times the chosen logical operation, which currently is ${op}.")},contextMenu:{Type:"Type",ShowAsUnknown:"Hide Type"}},TristateBufferArray:{tooltip:{title:"Tristate Buffer Array",desc:"Represents multiple tristate buffers switched by a single control bit."}},RAM:{tooltip:{title:"RAM (Random-Access Memory)",desc:template("Stores ${numWords} row$s{numWords} of ${numDataBits} bit$s{numDataBits}.")},contextMenu:{SelectedDataDisplay:"Addressed Data Display",EditContent:"Edit Content…",EditContentPrompt:"Type in the new memory content, separating lines with spaces. If there are as many characters as bits, the input is parsed as a binary string, and otherwise as a hexadecimal string.",SaveContent:"Save Content",LoadContent:"Load Content…",SwapROMRAM:"Swap ROM/RAM"}},ROM:{tooltip:{title:"ROM (Read-Only Memory)",desc:template("Stores ${numWords} row$s{numWords} of ${numDataBits} bit$s{numDataBits}.")}},Register:{tooltip:{title:"Register",desc:template("Stores ${numBits} bit$s{numBits}.")},contextMenu:{ParamHasIncDec:"With Increment/Decrement",Saturating:"Saturating"}},ShiftRegister:{tooltip:{title:"Shift Register",desc:template("Stores ${numBits} bit$s{numBits} and shifts them left or right at each activation.")}},ControlledInverter:{tooltip:{title:"Switched Inverter",desc:"Inverts its inputs when the control bit S is on; otherwise, just outputs the inputs."}},TristateBuffer:{tooltip:"Tristate Buffer"},Wire:{contextMenu:{AddMiddlePoint:"Add Middle Point",AddPassthrough:"Add Passthrough",CustomPropagationDelay:template("Specific Propagation Delay${current}…"),CustomPropagationDelayDesc:template("Specific propagation delay in milliseconds for this connection (leave empty to use the default value for the circuit, which currently is ${current} ms):"),WireColor:"Wire Color",WireColorBlack:"Black (default)",WireColorRed:"Red",WireColorGreen:"Green",WireColorBlue:"Blue",WireColorYellow:"Yellow",WireColorWhite:"White",WireStyle:"Style",WireStyleDefault:"By Default",WireStyleAuto:"Auto",WireStyleStraight:"Straight",WireStyleSquareHV:"H then V",WireStyleSquareVH:"V then H",WireStyleCurved:"Curve",HiddenWire:"Hide Wire"},timeline:{PropagatingValue:template("Propagation of value ${val} on wire")}}},Dialogs:{Generic:{Close:"Close"},Share:{title:"Share Circuit",URL:"URL:",EmbedInIframe:"Embed using <iframe>:",EmbedWithWebComp:"Embed with a web component:",EmbedInMarkdown:"Embed in Markdown/Myst:"}}}};function isLang(lang){return lang in langs}function setLang(l){S=langs[l],_lang=l}function getLang(){return _lang}__name(isLang,"isLang"),__name(setLang,"setLang"),__name(getLang,"getLang");var S=langs.en,_lang="en";function buildMap(repr,compList,isInputOutput){const map=new Map;for(const[ref,value]of Object.entries(repr)){const comp=compList.get(ref);isInputOutput(comp)?map.set(comp,value):map.set(ref,value)}return map}function fixMap(map,compList,isInputOutput){for(const[k,v]of map.entries())if(isString(k)){const comp=compList.get(k);isInputOutput(comp)&&(map.delete(k),map.set(comp,v))}}function isInput(comp){return"in"===(null==comp?void 0:comp.def.type)}function isOutput(comp){return"out"===(null==comp?void 0:comp.def.type)}__name(buildMap,"buildMap"),__name(fixMap,"fixMap"),__name(isInput,"isInput"),__name(isOutput,"isOutput");var TestCaseCombinational=class{static get Repr(){return t3.intersection([t3.type({in:t3.record(t3.string,InputOutputValueRepr),out:t3.record(t3.string,InputOutputValueRepr)}),t3.partial({name:t3.string,stopOnFail:t3.boolean})],"TestCaseCombinational")}constructor(repr,compList){var _a;void 0!==repr?(this.name=repr.name,this.in=buildMap(repr.in,compList,isInput),this.out=buildMap(repr.out,compList,isOutput),this.stopOnFail=null!=(_a=repr.stopOnFail)&&_a):(this.name=S.Tests.DefaultTestCaseName,this.in=new Map,this.out=new Map,this.stopOnFail=!1)}tryFixReferences(compList){fixMap(this.in,compList,isInput),fixMap(this.out,compList,isOutput)}toJSON(){const mapRepr=__name((map=>Object.fromEntries([...map.entries()].map((_ref5=>{let[k,v]=_ref5;var _a;return[isString(k)?k:null!=(_a=k.ref)?_a:"?",v]})))),"mapRepr");return{name:this.name,in:mapRepr(this.in),out:mapRepr(this.out),stopOnFail:!0===this.stopOnFail||void 0}}};__name(TestCaseCombinational,"TestCaseCombinational");var TestSuite=class{static get Repr(){return t3.intersection([t3.type({cases:t3.array(TestCaseCombinational.Repr)}),t3.partial({name:t3.string,hidden:t3.boolean})],"TestSuite")}static get ReprArray(){return t3.array(TestSuite.Repr)}constructor(reprAndComps){var _a;if(void 0!==reprAndComps){const[repr,compList]=reprAndComps;this.name=repr.name,this.isHidden=null!=(_a=repr.hidden)&&_a,this.testCases=repr.cases.map((tc=>new TestCaseCombinational(tc,compList)))}else this.name=void 0,this.isHidden=!1,this.testCases=[]}toJSON(){return{name:this.name,hidden:!0===this.isHidden||void 0,cases:this.testCases.map((tc=>tc.toJSON()))}}};__name(TestSuite,"TestSuite");var TestCaseResult={Pass:{_tag:"pass"},Skip:{_tag:"skip"},Fail:mismatches=>({_tag:"fail",mismatches:mismatches}),Error:msg=>({_tag:"error",msg:msg})},TestSuiteResults=class{constructor(testSuite){this.testSuite=testSuite,this.testCaseResults=[]}addTestCaseResult(testCase,result){this.testCaseResults.push([testCase,result])}isAllPass(){return this.testCaseResults.every((_ref6=>{let[,result]=_ref6;return"pass"===result._tag}))}dump(){console.group("Test Suite Results for ".concat(this.testSuite.name));for(const[testCase,result]of this.testCaseResults){if(console.group("Test Case ".concat(testCase.name)),"pass"===result._tag)console.log("PASS");else if("fail"===result._tag){const mismatches=result.mismatches.map((m=>"".concat(m.output.ref,": ").concat(reprForLogicValues(m.actual,!1)," instead of ").concat(reprForLogicValues(m.expected,!1))));console.log("FAIL - mismatches: "+mismatches.join(", "))}else"error"===result._tag&&console.log("ERROR - ".concat(result.msg));console.groupEnd()}console.groupEnd()}};__name(TestSuiteResults,"TestSuiteResults");var TestSuites=class{constructor(parent){this.parent=parent,this._testSuites=[]}get suites(){return this._testSuites}totalCases(){return this._testSuites.reduce(((acc,suite)=>acc+suite.testCases.length),0)}set(testSuites){this._testSuites.length=0,this._testSuites.push(...testSuites)}push(testSuite){this._testSuites.push(testSuite)}hasReferenceTo(ref){if(void 0===ref)return!1;const isRef=__name(((s,ref2)=>isString(s)?s===ref2:s.ref===ref2),"isRef");for(const suite of this._testSuites)for(const testCase of suite.testCases){for(const input2 of testCase.in.keys())if(isRef(input2,ref))return!0;for(const output of testCase.out.keys())if(isRef(output,ref))return!0}return!1}};__name(TestSuites,"TestSuites");var{abs:abs,cos:cos,sin:sin,acos:acos,atan2:atan2,sqrt:sqrt,pow:pow}=Math;function crt(v){return v<0?-pow(-v,1/3):pow(v,1/3)}__name(crt,"crt");var pi=Math.PI,tau=2*pi,quart=pi/2,nMax=Number.MAX_SAFE_INTEGER||9007199254740991,nMin=Number.MIN_SAFE_INTEGER||-9007199254740991,ZERO={x:0,y:0,z:0},utils={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t38,derivativeFn){const d=derivativeFn(t38);let l=d.x*d.x+d.y*d.y;return void 0!==d.z&&(l+=d.z*d.z),sqrt(l)},compute:function(t38,points,_3d){if(0===t38)return points[0].t=0,points[0];const order2=points.length-1;if(1===t38)return points[order2].t=1,points[order2];const mt=1-t38;let p=points;if(0===order2)return points[0].t=t38,points[0];if(1===order2){const ret={x:mt*p[0].x+t38*p[1].x,y:mt*p[0].y+t38*p[1].y,t:t38};return _3d&&(ret.z=mt*p[0].z+t38*p[1].z),ret}if(order2<4){let a2,b2,c,mt2=mt*mt,t210=t38*t38,d=0;2===order2?(p=[p[0],p[1],p[2],ZERO],a2=mt2,b2=mt*t38*2,c=t210):3===order2&&(a2=mt2*mt,b2=mt2*t38*3,c=mt*t210*3,d=t38*t210);const ret={x:a2*p[0].x+b2*p[1].x+c*p[2].x+d*p[3].x,y:a2*p[0].y+b2*p[1].y+c*p[2].y+d*p[3].y,t:t38};return _3d&&(ret.z=a2*p[0].z+b2*p[1].z+c*p[2].z+d*p[3].z),ret}const dCpts=JSON.parse(JSON.stringify(points));for(;dCpts.length>1;){for(let i2=0;i2<dCpts.length-1;i2++)dCpts[i2]={x:dCpts[i2].x+(dCpts[i2+1].x-dCpts[i2].x)*t38,y:dCpts[i2].y+(dCpts[i2+1].y-dCpts[i2].y)*t38},void 0!==dCpts[i2].z&&(dCpts[i2]=dCpts[i2].z+(dCpts[i2+1].z-dCpts[i2].z)*t38);dCpts.splice(dCpts.length-1,1)}return dCpts[0].t=t38,dCpts[0]},computeWithRatios:function(t38,points,ratios,_3d){const mt=1-t38,r=ratios,p=points;let d,f1=r[0],f2=r[1],f3=r[2],f4=r[3];return f1*=mt,f2*=t38,2===p.length?(d=f1+f2,{x:(f1*p[0].x+f2*p[1].x)/d,y:(f1*p[0].y+f2*p[1].y)/d,z:!!_3d&&(f1*p[0].z+f2*p[1].z)/d,t:t38}):(f1*=mt,f2*=2*mt,f3*=t38*t38,3===p.length?(d=f1+f2+f3,{x:(f1*p[0].x+f2*p[1].x+f3*p[2].x)/d,y:(f1*p[0].y+f2*p[1].y+f3*p[2].y)/d,z:!!_3d&&(f1*p[0].z+f2*p[1].z+f3*p[2].z)/d,t:t38}):(f1*=mt,f2*=1.5*mt,f3*=3*mt,f4*=t38*t38*t38,4===p.length?(d=f1+f2+f3+f4,{x:(f1*p[0].x+f2*p[1].x+f3*p[2].x+f4*p[3].x)/d,y:(f1*p[0].y+f2*p[1].y+f3*p[2].y+f4*p[3].y)/d,z:!!_3d&&(f1*p[0].z+f2*p[1].z+f3*p[2].z+f4*p[3].z)/d,t:t38}):void 0))},derive:function(points,_3d){const dpoints=[];for(let p=points,d=p.length,c=d-1;d>1;d--,c--){const list=[];for(let dpt,j=0;j<c;j++)dpt={x:c*(p[j+1].x-p[j].x),y:c*(p[j+1].y-p[j].y)},_3d&&(dpt.z=c*(p[j+1].z-p[j].z)),list.push(dpt);dpoints.push(list),p=list}return dpoints},between:function(v,m,M){return m<=v&&v<=M||utils.approximately(v,m)||utils.approximately(v,M)},approximately:function(a2,b2,precision){return abs(a2-b2)<=(precision||1e-6)},length:function(derivativeFn){const len=utils.Tvalues.length;let sum=0;for(let t38,i2=0;i2<len;i2++)t38=.5*utils.Tvalues[i2]+.5,sum+=utils.Cvalues[i2]*utils.arcfn(t38,derivativeFn);return.5*sum},map:function(v,ds,de,ts,te){return ts+(te-ts)*((v-ds)/(de-ds))},lerp:function(r,v1,v2){const ret={x:v1.x+r*(v2.x-v1.x),y:v1.y+r*(v2.y-v1.y)};return void 0!==v1.z&&void 0!==v2.z&&(ret.z=v1.z+r*(v2.z-v1.z)),ret},pointToString:function(p){let s=p.x+"/"+p.y;return void 0!==p.z&&(s+="/"+p.z),s},pointsToString:function(points){return"["+points.map(utils.pointToString).join(", ")+"]"},copy:function(obj){return JSON.parse(JSON.stringify(obj))},angle:function(o,v1,v2){const dx1=v1.x-o.x,dy1=v1.y-o.y,dx2=v2.x-o.x,dy2=v2.y-o.y;return atan2(dx1*dy2-dy1*dx2,dx1*dx2+dy1*dy2)},round:function(v,d){const s=""+v,pos=s.indexOf(".");return parseFloat(s.substring(0,pos+1+d))},dist:function(p1,p2){const dx=p1.x-p2.x,dy=p1.y-p2.y;return sqrt(dx*dx+dy*dy)},closest:function(LUT,point){let mpos,d,mdist=pow(2,63);return LUT.forEach((function(p,idx){d=utils.dist(point,p),d<mdist&&(mdist=d,mpos=idx)})),{mdist:mdist,mpos:mpos}},abcratio:function(t38,n){if(2!==n&&3!==n)return!1;if(void 0===t38)t38=.5;else if(0===t38||1===t38)return t38;const bottom2=pow(t38,n)+pow(1-t38,n);return abs((bottom2-1)/bottom2)},projectionratio:function(t38,n){if(2!==n&&3!==n)return!1;if(void 0===t38)t38=.5;else if(0===t38||1===t38)return t38;const top2=pow(1-t38,n);return top2/(pow(t38,n)+top2)},lli8:function(x1,y1,x2,y2,x3,y3,x4,y4){const d=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);return 0!=d&&{x:((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4))/d,y:((x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4))/d}},lli4:function(p1,p2,p3,p4){const x1=p1.x,y1=p1.y,x2=p2.x,y2=p2.y,x3=p3.x,y3=p3.y,x4=p4.x,y4=p4.y;return utils.lli8(x1,y1,x2,y2,x3,y3,x4,y4)},lli:function(v1,v2){return utils.lli4(v1,v1.c,v2,v2.c)},makeline:function(p1,p2){return new Bezier(p1.x,p1.y,(p1.x+p2.x)/2,(p1.y+p2.y)/2,p2.x,p2.y)},findbbox:function(sections){let mx=nMax,my=nMax,MX=nMin,MY=nMin;return sections.forEach((function(s){const bbox=s.bbox();mx>bbox.x.min&&(mx=bbox.x.min),my>bbox.y.min&&(my=bbox.y.min),MX<bbox.x.max&&(MX=bbox.x.max),MY<bbox.y.max&&(MY=bbox.y.max)})),{x:{min:mx,mid:(mx+MX)/2,max:MX,size:MX-mx},y:{min:my,mid:(my+MY)/2,max:MY,size:MY-my}}},shapeintersections:function(s1,bbox1,s2,bbox2,curveIntersectionThreshold){if(!utils.bboxoverlap(bbox1,bbox2))return[];const intersections=[],a1=[s1.startcap,s1.forward,s1.back,s1.endcap],a2=[s2.startcap,s2.forward,s2.back,s2.endcap];return a1.forEach((function(l1){l1.virtual||a2.forEach((function(l2){if(l2.virtual)return;const iss=l1.intersects(l2,curveIntersectionThreshold);iss.length>0&&(iss.c1=l1,iss.c2=l2,iss.s1=s1,iss.s2=s2,intersections.push(iss))}))})),intersections},makeshape:function(forward,back,curveIntersectionThreshold){const bpl=back.points.length,fpl=forward.points.length,start2=utils.makeline(back.points[bpl-1],forward.points[0]),end2=utils.makeline(forward.points[fpl-1],back.points[0]),shape={startcap:start2,forward:forward,back:back,endcap:end2,bbox:utils.findbbox([start2,forward,back,end2]),intersections:function(s2){return utils.shapeintersections(shape,shape.bbox,s2,s2.bbox,curveIntersectionThreshold)}};return shape},getminmax:function(curve,d,list){if(!list)return{min:0,max:0};let t38,c,min3=nMax,max3=nMin;-1===list.indexOf(0)&&(list=[0].concat(list)),-1===list.indexOf(1)&&list.push(1);for(let i2=0,len=list.length;i2<len;i2++)t38=list[i2],c=curve.get(t38),c[d]<min3&&(min3=c[d]),c[d]>max3&&(max3=c[d]);return{min:min3,mid:(min3+max3)/2,max:max3,size:max3-min3}},align:function(points,line){const tx=line.p1.x,ty=line.p1.y,a2=-atan2(line.p2.y-ty,line.p2.x-tx),d=__name((function(v){return{x:(v.x-tx)*cos(a2)-(v.y-ty)*sin(a2),y:(v.x-tx)*sin(a2)+(v.y-ty)*cos(a2)}}),"d");return points.map(d)},roots:function(points,line){line=line||{p1:{x:0,y:0},p2:{x:1,y:0}};const order2=points.length-1,aligned=utils.align(points,line),reduce=__name((function(t38){return 0<=t38&&t38<=1}),"reduce");if(2===order2){const a3=aligned[0].y,b3=aligned[1].y,c2=aligned[2].y,d2=a3-2*b3+c2;if(0!==d2){const m1=-sqrt(b3*b3-a3*c2),m2=-a3+b3;return[-(m1+m2)/d2,-(-m1+m2)/d2].filter(reduce)}return b3!==c2&&0===d2?[(2*b3-c2)/(2*b3-2*c2)].filter(reduce):[]}const pa=aligned[0].y,pb=aligned[1].y,pc=aligned[2].y;let d=3*pb-pa-3*pc+aligned[3].y,a2=3*pa-6*pb+3*pc,b2=-3*pa+3*pb,c=pa;if(utils.approximately(d,0)){if(utils.approximately(a2,0))return utils.approximately(b2,0)?[]:[-c/b2].filter(reduce);const q3=sqrt(b2*b2-4*a2*c),a22=2*a2;return[(q3-b2)/a22,(-b2-q3)/a22].filter(reduce)}a2/=d,b2/=d,c/=d;const p=(3*b2-a2*a2)/3,p3=p/3,q=(2*a2*a2*a2-9*a2*b2+27*c)/27,q2=q/2,discriminant=q2*q2+p3*p3*p3;let u1,v1,x1,x2,x3;if(discriminant<0){const mp3=-p/3,r=sqrt(mp3*mp3*mp3),t38=-q/(2*r),phi=acos(t38<-1?-1:t38>1?1:t38),t1=2*crt(r);return x1=t1*cos(phi/3)-a2/3,x2=t1*cos((phi+tau)/3)-a2/3,x3=t1*cos((phi+2*tau)/3)-a2/3,[x1,x2,x3].filter(reduce)}if(0===discriminant)return u1=q2<0?crt(-q2):-crt(q2),x1=2*u1-a2/3,x2=-u1-a2/3,[x1,x2].filter(reduce);{const sd=sqrt(discriminant);return u1=crt(-q2+sd),v1=crt(q2+sd),[u1-v1-a2/3].filter(reduce)}},droots:function(p){if(3===p.length){const a2=p[0],b2=p[1],c=p[2],d=a2-2*b2+c;if(0!==d){const m1=-sqrt(b2*b2-a2*c),m2=-a2+b2;return[-(m1+m2)/d,-(-m1+m2)/d]}return b2!==c&&0===d?[(2*b2-c)/(2*(b2-c))]:[]}if(2===p.length){const a2=p[0],b2=p[1];return a2!==b2?[a2/(a2-b2)]:[]}return[]},curvature:function(t38,d1,d2,_3d,kOnly){let num,dnm,adk,dk,k=0,r=0;const d=utils.compute(t38,d1),dd=utils.compute(t38,d2),qdsum=d.x*d.x+d.y*d.y;if(_3d?(num=sqrt(pow(d.y*dd.z-dd.y*d.z,2)+pow(d.z*dd.x-dd.z*d.x,2)+pow(d.x*dd.y-dd.x*d.y,2)),dnm=pow(qdsum+d.z*d.z,1.5)):(num=d.x*dd.y-d.y*dd.x,dnm=pow(qdsum,1.5)),0===num||0===dnm)return{k:0,r:0};if(k=num/dnm,r=dnm/num,!kOnly){const pk=utils.curvature(t38-.001,d1,d2,_3d,!0).k,nk=utils.curvature(t38+.001,d1,d2,_3d,!0).k;dk=(nk-k+(k-pk))/2,adk=(abs(nk-k)+abs(k-pk))/2}return{k:k,r:r,dk:dk,adk:adk}},inflections:function(points){if(points.length<4)return[];const p=utils.align(points,{p1:points[0],p2:points.slice(-1)[0]}),a2=p[2].x*p[1].y,b2=p[3].x*p[1].y,c=p[1].x*p[2].y,v1=18*(-3*a2+2*b2+3*c-p[3].x*p[2].y),v2=18*(3*a2-b2-3*c),v3=18*(c-a2);if(utils.approximately(v1,0)){if(!utils.approximately(v2,0)){let t38=-v3/v2;if(0<=t38&&t38<=1)return[t38]}return[]}const d2=2*v1;if(utils.approximately(d2,0))return[];const trm=v2*v2-4*v1*v3;if(trm<0)return[];const sq=Math.sqrt(trm);return[(sq-v2)/d2,-(v2+sq)/d2].filter((function(r){return 0<=r&&r<=1}))},bboxoverlap:function(b1,b2){const dims=["x","y"],len=dims.length;for(let dim,l,t38,d,i2=0;i2<len;i2++)if(dim=dims[i2],l=b1[dim].mid,t38=b2[dim].mid,d=(b1[dim].size+b2[dim].size)/2,abs(l-t38)>=d)return!1;return!0},expandbox:function(bbox,_bbox){_bbox.x.min<bbox.x.min&&(bbox.x.min=_bbox.x.min),_bbox.y.min<bbox.y.min&&(bbox.y.min=_bbox.y.min),_bbox.z&&_bbox.z.min<bbox.z.min&&(bbox.z.min=_bbox.z.min),_bbox.x.max>bbox.x.max&&(bbox.x.max=_bbox.x.max),_bbox.y.max>bbox.y.max&&(bbox.y.max=_bbox.y.max),_bbox.z&&_bbox.z.max>bbox.z.max&&(bbox.z.max=_bbox.z.max),bbox.x.mid=(bbox.x.min+bbox.x.max)/2,bbox.y.mid=(bbox.y.min+bbox.y.max)/2,bbox.z&&(bbox.z.mid=(bbox.z.min+bbox.z.max)/2),bbox.x.size=bbox.x.max-bbox.x.min,bbox.y.size=bbox.y.max-bbox.y.min,bbox.z&&(bbox.z.size=bbox.z.max-bbox.z.min)},pairiteration:function(c1,c2,curveIntersectionThreshold){const c1b=c1.bbox(),c2b=c2.bbox(),r=1e5,threshold=curveIntersectionThreshold||.5;if(c1b.x.size+c1b.y.size<threshold&&c2b.x.size+c2b.y.size<threshold)return[(r*(c1._t1+c1._t2)/2|0)/r+"/"+(r*(c2._t1+c2._t2)/2|0)/r];let cc1=c1.split(.5),cc2=c2.split(.5),pairs=[{left:cc1.left,right:cc2.left},{left:cc1.left,right:cc2.right},{left:cc1.right,right:cc2.right},{left:cc1.right,right:cc2.left}];pairs=pairs.filter((function(pair){return utils.bboxoverlap(pair.left.bbox(),pair.right.bbox())}));let results=[];return 0===pairs.length||(pairs.forEach((function(pair){results=results.concat(utils.pairiteration(pair.left,pair.right,threshold))})),results=results.filter((function(v,i2){return results.indexOf(v)===i2}))),results},getccenter:function(p1,p2,p3){const dx1=p2.x-p1.x,dy1=p2.y-p1.y,dx2=p3.x-p2.x,dy2=p3.y-p2.y,dx1p=dx1*cos(quart)-dy1*sin(quart),dy1p=dx1*sin(quart)+dy1*cos(quart),dx2p=dx2*cos(quart)-dy2*sin(quart),dy2p=dx2*sin(quart)+dy2*cos(quart),mx1=(p1.x+p2.x)/2,my1=(p1.y+p2.y)/2,mx2=(p2.x+p3.x)/2,my2=(p2.y+p3.y)/2,mx1n=mx1+dx1p,my1n=my1+dy1p,mx2n=mx2+dx2p,my2n=my2+dy2p,arc=utils.lli8(mx1,my1,mx1n,my1n,mx2,my2,mx2n,my2n),r=utils.dist(arc,p1);let _,s=atan2(p1.y-arc.y,p1.x-arc.x),m=atan2(p2.y-arc.y,p2.x-arc.x),e=atan2(p3.y-arc.y,p3.x-arc.x);return s<e?((s>m||m>e)&&(s+=tau),s>e&&(_=e,e=s,s=_)):e<m&&m<s?(_=e,e=s,s=_):e+=tau,arc.s=s,arc.e=e,arc.r=r,arc},numberSort:function(a2,b2){return a2-b2}},PolyBezier=class{constructor(curves){this.curves=[],this._3d=!1,curves&&(this.curves=curves,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(curve){return utils.pointsToString(curve.points)})).join(", ")+"]"}addCurve(curve){this.curves.push(curve),this._3d=this._3d||curve._3d}length(){return this.curves.map((function(v){return v.length()})).reduce((function(a2,b2){return a2+b2}))}curve(idx){return this.curves[idx]}bbox(){const c=this.curves;for(var bbox=c[0].bbox(),i2=1;i2<c.length;i2++)utils.expandbox(bbox,c[i2].bbox());return bbox}offset(d){const offset2=[];return this.curves.forEach((function(v){offset2.push(...v.offset(d))})),new PolyBezier(offset2)}};__name(PolyBezier,"PolyBezier");var{abs:abs2,min:min,max:max,cos:cos2,sin:sin2,acos:acos2,sqrt:sqrt2}=Math,pi2=Math.PI,Bezier=class{constructor(coords){let args=coords&&coords.forEach?coords:Array.from(arguments).slice(),coordlen=!1;if("object"==typeof args[0]){coordlen=args.length;const newargs=[];args.forEach((function(point2){["x","y","z"].forEach((function(d){void 0!==point2[d]&&newargs.push(point2[d])}))})),args=newargs}let higher=!1;const len=args.length;if(coordlen){if(coordlen>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");higher=!0}}else if(6!==len&&8!==len&&9!==len&&12!==len&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const _3d=this._3d=!higher&&(9===len||12===len)||coords&&coords[0]&&void 0!==coords[0].z,points=this.points=[];for(let idx=0,step=_3d?3:2;idx<len;idx+=step){var point={x:args[idx],y:args[idx+1]};_3d&&(point.z=args[idx+2]),points.push(point)}const order2=this.order=points.length-1,dims=this.dims=["x","y"];_3d&&dims.push("z"),this.dimlen=dims.length;const aligned=utils.align(points,{p1:points[0],p2:points[order2]}),baselength=utils.dist(points[0],points[order2]);this._linear=aligned.reduce(((t38,p)=>t38+abs2(p.y)),0)<baselength/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(p1,p2,p3,t38){if(void 0===t38&&(t38=.5),0===t38)return new Bezier(p2,p2,p3);if(1===t38)return new Bezier(p1,p2,p2);const abc=Bezier.getABC(2,p1,p2,p3,t38);return new Bezier(p1,abc.A,p3)}static cubicFromPoints(S2,B,E,t38,d1){void 0===t38&&(t38=.5);const abc=Bezier.getABC(3,S2,B,E,t38);void 0===d1&&(d1=utils.dist(B,abc.C));const d2=d1*(1-t38)/t38,selen=utils.dist(S2,E),lx=(E.x-S2.x)/selen,ly=(E.y-S2.y)/selen,bx1=d1*lx,by1=d1*ly,bx2=d2*lx,by2=d2*ly,e1_x=B.x-bx1,e1_y=B.y-by1,e2_x=B.x+bx2,e2_y=B.y+by2,A=abc.A,v1_x=A.x+(e1_x-A.x)/(1-t38),v1_y=A.y+(e1_y-A.y)/(1-t38),v2_x=A.x+(e2_x-A.x)/t38,v2_y=A.y+(e2_y-A.y)/t38,nc1={x:S2.x+(v1_x-S2.x)/t38,y:S2.y+(v1_y-S2.y)/t38},nc2={x:E.x+(v2_x-E.x)/(1-t38),y:E.y+(v2_y-E.y)/(1-t38)};return new Bezier(S2,nc1,nc2,E)}static getUtils(){return utils}getUtils(){return Bezier.getUtils()}static get PolyBezier(){return PolyBezier}valueOf(){return this.toString()}toString(){return utils.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const p=this.points,s=["M",p[0].x,p[0].y,2===this.order?"Q":"C"];for(let i2=1,last=p.length;i2<last;i2++)s.push(p[i2].x),s.push(p[i2].y);return s.join(" ")}setRatios(ratios){if(ratios.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=ratios,this._lut=[]}verify(){const print=this.coordDigest();print!==this._print&&(this._print=print,this.update())}coordDigest(){return this.points.map((function(c,pos){return""+pos+c.x+c.y+(c.z?c.z:0)})).join("")}update(){this._lut=[],this.dpoints=utils.derive(this.points,this._3d),this.computedirection()}computedirection(){const points=this.points,angle=utils.angle(points[0],points[this.order],points[1]);this.clockwise=angle>0}length(){return utils.length(this.derivative.bind(this))}static getABC(){let order2=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,S2=arguments.length>1?arguments[1]:void 0,B=arguments.length>2?arguments[2]:void 0,E=arguments.length>3?arguments[3]:void 0,t38=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const u=utils.projectionratio(t38,order2),um=1-u,C={x:u*S2.x+um*E.x,y:u*S2.y+um*E.y},s=utils.abcratio(t38,order2);return{A:{x:B.x+(B.x-C.x)/s,y:B.y+(B.y-C.y)/s},B:B,C:C,S:S2,E:E}}getABC(t38,B){B=B||this.get(t38);let S2=this.points[0],E=this.points[this.order];return Bezier.getABC(this.order,S2,B,E,t38)}getLUT(steps){if(this.verify(),steps=steps||100,this._lut.length===steps)return this._lut;this._lut=[],steps++,this._lut=[];for(let p,t38,i2=0;i2<steps;i2++)t38=i2/(steps-1),p=this.compute(t38),p.t=t38,this._lut.push(p);return this._lut}on(point,error){error=error||5;const lut=this.getLUT(),hits=[];for(let c,i2=0,t38=0;i2<lut.length;i2++)c=lut[i2],utils.dist(c,point)<error&&(hits.push(c),t38+=i2/lut.length);return!!hits.length&&(t/=hits.length)}project(point){const LUT=this.getLUT(),l=LUT.length-1,closest=utils.closest(LUT,point),mpos=closest.mpos,t1=(mpos-1)/l,t210=(mpos+1)/l,step=.1/l;let p,d,mdist=closest.mdist,t38=t1,ft=t38;for(mdist+=1;t38<t210+step;t38+=step)p=this.compute(t38),d=utils.dist(point,p),d<mdist&&(mdist=d,ft=t38);return ft=ft<0?0:ft>1?1:ft,p=this.compute(ft),p.t=ft,p.d=mdist,p}get(t38){return this.compute(t38)}point(idx){return this.points[idx]}compute(t38){return this.ratios?utils.computeWithRatios(t38,this.points,this.ratios,this._3d):utils.compute(t38,this.points,this._3d,this.ratios)}raise(){const p=this.points,np=[p[0]],k=p.length;for(let pi3,pim,i2=1;i2<k;i2++)pi3=p[i2],pim=p[i2-1],np[i2]={x:(k-i2)/k*pi3.x+i2/k*pim.x,y:(k-i2)/k*pi3.y+i2/k*pim.y};return np[k]=p[k-1],new Bezier(np)}derivative(t38){return utils.compute(t38,this.dpoints[0],this._3d)}dderivative(t38){return utils.compute(t38,this.dpoints[1],this._3d)}align(){let p=this.points;return new Bezier(utils.align(p,{p1:p[0],p2:p[p.length-1]}))}curvature(t38){return utils.curvature(t38,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return utils.inflections(this.points)}normal(t38){return this._3d?this.__normal3(t38):this.__normal2(t38)}__normal2(t38){const d=this.derivative(t38),q=sqrt2(d.x*d.x+d.y*d.y);return{t:t38,x:-d.y/q,y:d.x/q}}__normal3(t38){const r1=this.derivative(t38),r2=this.derivative(t38+.01),q1=sqrt2(r1.x*r1.x+r1.y*r1.y+r1.z*r1.z),q2=sqrt2(r2.x*r2.x+r2.y*r2.y+r2.z*r2.z);r1.x/=q1,r1.y/=q1,r1.z/=q1,r2.x/=q2,r2.y/=q2,r2.z/=q2;const c={x:r2.y*r1.z-r2.z*r1.y,y:r2.z*r1.x-r2.x*r1.z,z:r2.x*r1.y-r2.y*r1.x},m=sqrt2(c.x*c.x+c.y*c.y+c.z*c.z);c.x/=m,c.y/=m,c.z/=m;const R=[c.x*c.x,c.x*c.y-c.z,c.x*c.z+c.y,c.x*c.y+c.z,c.y*c.y,c.y*c.z-c.x,c.x*c.z-c.y,c.y*c.z+c.x,c.z*c.z];return{t:t38,x:R[0]*r1.x+R[1]*r1.y+R[2]*r1.z,y:R[3]*r1.x+R[4]*r1.y+R[5]*r1.z,z:R[6]*r1.x+R[7]*r1.y+R[8]*r1.z}}hull(t38){let p=this.points,_p=[],q=[],idx=0;for(q[idx++]=p[0],q[idx++]=p[1],q[idx++]=p[2],3===this.order&&(q[idx++]=p[3]);p.length>1;){_p=[];for(let pt,i2=0,l=p.length-1;i2<l;i2++)pt=utils.lerp(t38,p[i2],p[i2+1]),q[idx++]=pt,_p.push(pt);p=_p}return q}split(t1,t210){if(0===t1&&t210)return this.split(t210).left;if(1===t210)return this.split(t1).right;const q=this.hull(t1),result={left:2===this.order?new Bezier([q[0],q[3],q[5]]):new Bezier([q[0],q[4],q[7],q[9]]),right:2===this.order?new Bezier([q[5],q[4],q[2]]):new Bezier([q[9],q[8],q[6],q[3]]),span:q};return result.left._t1=utils.map(0,0,1,this._t1,this._t2),result.left._t2=utils.map(t1,0,1,this._t1,this._t2),result.right._t1=utils.map(t1,0,1,this._t1,this._t2),result.right._t2=utils.map(1,0,1,this._t1,this._t2),t210?(t210=utils.map(t210,t1,1,0,1),result.right.split(t210).left):result}extrema(){const result={};let roots=[];return this.dims.forEach(function(dim){let mfn=__name((function(v){return v[dim]}),"mfn"),p=this.dpoints[0].map(mfn);result[dim]=utils.droots(p),3===this.order&&(p=this.dpoints[1].map(mfn),result[dim]=result[dim].concat(utils.droots(p))),result[dim]=result[dim].filter((function(t38){return t38>=0&&t38<=1})),roots=roots.concat(result[dim].sort(utils.numberSort))}.bind(this)),result.values=roots.sort(utils.numberSort).filter((function(v,idx){return roots.indexOf(v)===idx})),result}bbox(){const extrema=this.extrema(),result={};return this.dims.forEach(function(d){result[d]=utils.getminmax(this,d,extrema[d])}.bind(this)),result}overlaps(curve){const lbbox=this.bbox(),tbbox=curve.bbox();return utils.bboxoverlap(lbbox,tbbox)}offset(t38,d){if(void 0!==d){const c=this.get(t38),n=this.normal(t38),ret={c:c,n:n,x:c.x+n.x*d,y:c.y+n.y*d};return this._3d&&(ret.z=c.z+n.z*d),ret}if(this._linear){const nv=this.normal(0),coords=this.points.map((function(p){const ret={x:p.x+t38*nv.x,y:p.y+t38*nv.y};return p.z&&nv.z&&(ret.z=p.z+t38*nv.z),ret}));return[new Bezier(coords)]}return this.reduce().map((function(s){return s._linear?s.offset(t38)[0]:s.scale(t38)}))}simple(){if(3===this.order){const a1=utils.angle(this.points[0],this.points[3],this.points[1]),a2=utils.angle(this.points[0],this.points[3],this.points[2]);if(a1>0&&a2<0||a1<0&&a2>0)return!1}const n1=this.normal(0),n2=this.normal(1);let s=n1.x*n2.x+n1.y*n2.y;return this._3d&&(s+=n1.z*n2.z),abs2(acos2(s))<pi2/3}reduce(){let i2,segment,t1=0,t210=0,pass1=[],pass2=[],extrema=this.extrema().values;for(-1===extrema.indexOf(0)&&(extrema=[0].concat(extrema)),-1===extrema.indexOf(1)&&extrema.push(1),t1=extrema[0],i2=1;i2<extrema.length;i2++)t210=extrema[i2],segment=this.split(t1,t210),segment._t1=t1,segment._t2=t210,pass1.push(segment),t1=t210;return pass1.forEach((function(p1){for(t1=0,t210=0;t210<=1;)for(t210=t1+.01;t210<=1.01;t210+=.01)if(segment=p1.split(t1,t210),!segment.simple()){if(t210-=.01,abs2(t1-t210)<.01)return[];segment=p1.split(t1,t210),segment._t1=utils.map(t1,0,1,p1._t1,p1._t2),segment._t2=utils.map(t210,0,1,p1._t1,p1._t2),pass2.push(segment),t1=t210;break}t1<1&&(segment=p1.split(t1,1),segment._t1=utils.map(t1,0,1,p1._t1,p1._t2),segment._t2=p1._t2,pass2.push(segment))})),pass2}translate(v,d1,d2){d2="number"==typeof d2?d2:d1;const o=this.order;let d=this.points.map(((_,i2)=>(1-i2/o)*d1+i2/o*d2));return new Bezier(this.points.map(((p,i2)=>({x:p.x+v.x*d[i2],y:p.y+v.y*d[i2]}))))}scale(d){const order2=this.order;let distanceFn=!1;if("function"==typeof d&&(distanceFn=d),distanceFn&&2===order2)return this.raise().scale(distanceFn);const clockwise=this.clockwise,points=this.points;if(this._linear)return this.translate(this.normal(0),distanceFn?distanceFn(0):d,distanceFn?distanceFn(1):d);const r1=distanceFn?distanceFn(0):d,r2=distanceFn?distanceFn(1):d,v=[this.offset(0,10),this.offset(1,10)],np=[],o=utils.lli4(v[0],v[0].c,v[1],v[1].c);if(!o)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(t38){const p=np[t38*order2]=utils.copy(points[t38*order2]);p.x+=(t38?r2:r1)*v[t38].n.x,p.y+=(t38?r2:r1)*v[t38].n.y})),distanceFn?([0,1].forEach((function(t38){if(2!==order2||!t38){var p=points[t38+1],ov={x:p.x-o.x,y:p.y-o.y},rc=distanceFn?distanceFn((t38+1)/order2):d;distanceFn&&!clockwise&&(rc=-rc);var m=sqrt2(ov.x*ov.x+ov.y*ov.y);ov.x/=m,ov.y/=m,np[t38+1]={x:p.x+rc*ov.x,y:p.y+rc*ov.y}}})),new Bezier(np)):([0,1].forEach((t38=>{if(2===order2&&t38)return;const p=np[t38*order2],d2=this.derivative(t38),p2={x:p.x+d2.x,y:p.y+d2.y};np[t38+1]=utils.lli4(p,p2,o,points[t38+1])})),new Bezier(np))}outline(d1,d2,d3,d4){if(d2=void 0===d2?d1:d2,this._linear){const n=this.normal(0),start2=this.points[0],end2=this.points[this.points.length-1];let s,mid,e;void 0===d3&&(d3=d1,d4=d2),s={x:start2.x+n.x*d1,y:start2.y+n.y*d1},e={x:end2.x+n.x*d3,y:end2.y+n.y*d3},mid={x:(s.x+e.x)/2,y:(s.y+e.y)/2};const fline=[s,mid,e];s={x:start2.x-n.x*d2,y:start2.y-n.y*d2},e={x:end2.x-n.x*d4,y:end2.y-n.y*d4},mid={x:(s.x+e.x)/2,y:(s.y+e.y)/2};const bline=[e,mid,s],ls2=utils.makeline(bline[2],fline[0]),le2=utils.makeline(fline[2],bline[0]),segments2=[ls2,new Bezier(fline),le2,new Bezier(bline)];return new PolyBezier(segments2)}const reduced=this.reduce(),len=reduced.length,fcurves=[];let p,bcurves=[],alen=0,tlen=this.length();const graduated=void 0!==d3&&void 0!==d4;function linearDistanceFunction(s,e,tlen2,alen2,slen){return function(v){const f1=alen2/tlen2,f2=(alen2+slen)/tlen2,d=e-s;return utils.map(v,0,1,s+f1*d,s+f2*d)}}__name(linearDistanceFunction,"linearDistanceFunction"),reduced.forEach((function(segment){const slen=segment.length();graduated?(fcurves.push(segment.scale(linearDistanceFunction(d1,d3,tlen,alen,slen))),bcurves.push(segment.scale(linearDistanceFunction(-d2,-d4,tlen,alen,slen)))):(fcurves.push(segment.scale(d1)),bcurves.push(segment.scale(-d2))),alen+=slen})),bcurves=bcurves.map((function(s){return p=s.points,p[3]?s.points=[p[3],p[2],p[1],p[0]]:s.points=[p[2],p[1],p[0]],s})).reverse();const fs=fcurves[0].points[0],fe=fcurves[len-1].points[fcurves[len-1].points.length-1],bs=bcurves[len-1].points[bcurves[len-1].points.length-1],be=bcurves[0].points[0],ls=utils.makeline(bs,fs),le=utils.makeline(fe,be),segments=[ls].concat(fcurves).concat([le]).concat(bcurves);return new PolyBezier(segments)}outlineshapes(d1,d2,curveIntersectionThreshold){d2=d2||d1;const outline=this.outline(d1,d2).curves,shapes=[];for(let i2=1,len=outline.length;i2<len/2;i2++){const shape=utils.makeshape(outline[i2],outline[len-i2],curveIntersectionThreshold);shape.startcap.virtual=i2>1,shape.endcap.virtual=i2<len/2-1,shapes.push(shape)}return shapes}intersects(curve,curveIntersectionThreshold){return curve?curve.p1&&curve.p2?this.lineIntersects(curve):(curve instanceof Bezier&&(curve=curve.reduce()),this.curveintersects(this.reduce(),curve,curveIntersectionThreshold)):this.selfintersects(curveIntersectionThreshold)}lineIntersects(line){const mx=min(line.p1.x,line.p2.x),my=min(line.p1.y,line.p2.y),MX=max(line.p1.x,line.p2.x),MY=max(line.p1.y,line.p2.y);return utils.roots(this.points,line).filter((t38=>{var p=this.get(t38);return utils.between(p.x,mx,MX)&&utils.between(p.y,my,MY)}))}selfintersects(curveIntersectionThreshold){const reduced=this.reduce(),len=reduced.length-2,results=[];for(let result,left2,right2,i2=0;i2<len;i2++)left2=reduced.slice(i2,i2+1),right2=reduced.slice(i2+2),result=this.curveintersects(left2,right2,curveIntersectionThreshold),results.push(...result);return results}curveintersects(c1,c2,curveIntersectionThreshold){const pairs=[];c1.forEach((function(l){c2.forEach((function(r){l.overlaps(r)&&pairs.push({left:l,right:r})}))}));let intersections=[];return pairs.forEach((function(pair){const result=utils.pairiteration(pair.left,pair.right,curveIntersectionThreshold);result.length>0&&(intersections=intersections.concat(result))})),intersections}arcs(errorThreshold){return errorThreshold=errorThreshold||.5,this._iterate(errorThreshold,[])}_error(pc,np1,s,e){const q=(e-s)/4,c1=this.get(s+q),c2=this.get(e-q),ref=utils.dist(pc,np1),d1=utils.dist(pc,c1),d2=utils.dist(pc,c2);return abs2(d1-ref)+abs2(d2-ref)}_iterate(errorThreshold,circles){let safety,t_s=0,t_e=1;do{safety=0,t_e=1;let np2,np3,arc,prev_arc,done,np1=this.get(t_s),curr_good=!1,prev_good=!1,t_m=t_e,prev_e=1,step=0;do{if(prev_good=curr_good,prev_arc=arc,t_m=(t_s+t_e)/2,step++,np2=this.get(t_m),np3=this.get(t_e),arc=utils.getccenter(np1,np2,np3),arc.interval={start:t_s,end:t_e},curr_good=this._error(arc,np1,t_s,t_e)<=errorThreshold,done=prev_good&&!curr_good,done||(prev_e=t_e),curr_good){if(t_e>=1){if(arc.interval.end=prev_e=1,prev_arc=arc,t_e>1){let d={x:arc.x+arc.r*cos2(arc.e),y:arc.y+arc.r*sin2(arc.e)};arc.e+=utils.angle({x:arc.x,y:arc.y},d,this.get(1))}break}t_e+=(t_e-t_s)/2}else t_e=t_m}while(!done&&safety++<100);if(safety>=100)break;prev_arc=prev_arc||arc,circles.push(prev_arc),t_s=prev_e}while(t_e<1);return circles}};__name(Bezier,"Bezier");var t7=__toESM(require_lib()),t5=__toESM(require_lib()),import_json52=__toESM(require_dist());function perm(mode){return parent=>parent.editor.mode>=mode}__name(perm,"perm");var UIPermissions={canModifyTestCases:perm(4),canModifyCustomComponents:perm(3)},t4=__toESM(require_lib()),MenuData={sep:()=>({_tag:"sep"}),text:caption=>({_tag:"text",caption:caption}),item:(icon,caption,action,shortcut,danger)=>({_tag:"item",icon:icon,caption:caption,action:action,shortcut:shortcut,danger:danger}),submenu:(icon,caption,items)=>({_tag:"submenu",icon:icon,caption:caption,items:items})},_DrawContextImpl=class{constructor(comp,g,drawParams,isMouseOver,borderColor){this.g=g,this.drawParams=drawParams,this.isMouseOver=isMouseOver,this.borderColor=borderColor,this.entranceTransform=g.getTransform(),this.entranceTransformInv=this.entranceTransform.inverse(),comp.applyDrawTransform(g),this.componentTransform=g.getTransform()}exit(){this.g.setTransform(this.entranceTransform)}inNonTransformedFrame(f){this.g.setTransform(this.entranceTransform),f(this),this.g.setTransform(this.componentTransform)}rotatePoint(x,y){return mult(this.entranceTransformInv,...mult(this.componentTransform,x,y))}};function mult(m,x,y){return[m.a*x+m.c*y+m.e,m.b*x+m.d*y+m.f]}__name(_DrawContextImpl,"_DrawContextImpl"),__name(mult,"mult");var Drawable=class{constructor(parent){this._ref=void 0,this.parent=parent}get ref(){return this._ref}doSetValidatedId(id){this._ref=id}requestRedraw(req){var _a;req.component=this,null==(_a=this.parent.ifEditing)||_a.redrawMgr.requestRedraw(req)}get drawZIndex(){return DrawZIndex.Normal}draw(g,drawParams){var _a,_b;const inSelectionRect=null!=(_b=null==(_a=drawParams.currentSelection)?void 0:_a.isSelected(this))&&_b,isPointerOver=this===drawParams.currentCompUnderPointer||inSelectionRect,borderColor=isPointerOver?drawParams.anythingMoving&&this.lockPos?COLOR_MOUSE_OVER_DANGER:COLOR_MOUSE_OVER:COLOR_COMPONENT_BORDER,ctx=new _DrawContextImpl(this,g,drawParams,isPointerOver,borderColor);try{this.doDraw(g,ctx)}finally{ctx.exit()}}applyDrawTransform(__g2){}get lockPos(){return!1}cursorWhenMouseover(__e2){}toString(){return"".concat(this.constructor.name,"(").concat(this.toStringDetails(),")")}toStringDetails(){return""}makeTooltip(){}makeContextMenu(){}makeSetIdContextMenuItem(){const currentId=this._ref,s=S.Components.Generic.contextMenu,caption=void 0===currentId?s.SetIdentifier:span(s.ChangeIdentifier[0],span(fixedWidthInContextMenu,currentId),s.ChangeIdentifier[1]);return MenuData.item("ref",caption,(()=>{this.runSetIdDialog()}),"⌥↩︎")}runSetIdDialog(){const s=S.Components.Generic.contextMenu;for(;;){const currentId=this._ref,newId=window.prompt(s.SetIdentifierPrompt,currentId);if(null===newId)break;if(newId===currentId)break;if(this instanceof ComponentBase){if(0===newId.length){window.alert(s.IdentifierCannotBeEmpty);continue}const componentList=this.parent.components,otherComp=componentList.get(newId);if(void 0===otherComp)componentList.changeIdOf(this,newId);else{if(!window.confirm(s.IdentifierAlreadyInUseShouldSwap))continue;componentList.swapIdsOf(otherComp,this)}}else this.doSetValidatedId(0===newId.length?void 0:newId);this.requestRedraw({why:"ref changed"});break}}pointerDown(__){return{wantsDragEvents:!0}}pointerDragged(__){}pointerUp(__){return InteractionResult.NoChange}pointerClicked(__){return InteractionResult.NoChange}pointerDoubleClicked(__){return InteractionResult.NoChange}keyDown(e){"Enter"===e.key&&e.altKey&&this.runSetIdDialog()}};__name(Drawable,"Drawable");var Orientations_={e:{},s:{},w:{},n:{}},Orientations=RichStringEnum.withProps()(Orientations_),Orientation={default:"e",invert(o){switch(o){case"e":return"w";case"w":return"e";case"n":return"s";case"s":return"n"}},nextClockwise(o){switch(o){case"e":return"s";case"s":return"w";case"w":return"n";case"n":return"e"}},nextCounterClockwise(o){switch(o){case"e":return"n";case"n":return"w";case"w":return"s";case"s":return"e"}},isVertical:o=>"s"===o||"n"===o,add(compOrient,nodeOrient){switch(compOrient){case"e":return nodeOrient;case"w":return Orientation.invert(nodeOrient);case"s":return Orientation.nextClockwise(nodeOrient);case"n":return Orientation.nextCounterClockwise(nodeOrient)}}},PositionSupportRepr=t4.type({pos:t4.readonly(t4.tuple([t4.number,t4.number])),anchor:typeOrUndefined(t4.string),lockPos:typeOrUndefined(t4.boolean),orient:typeOrUndefined(t4.keyof(Orientations_)),ref:typeOrUndefined(t4.string)}),DrawableWithPosition=class extends Drawable{constructor(parent,saved){var _a,_b;if(super(parent),this._anchor=void 0,void 0!==saved)this.doSetValidatedId(saved.ref),this._posX=saved.pos[0],this._posY=saved.pos[1],this._lockPos=null!=(_a=saved.lockPos)&&_a,this._orient=null!=(_b=saved.orient)?_b:Orientation.default;else{const editor=this.parent.editor;this._posX=Math.max(0,editor.pointerX),this._posY=editor.pointerY,this._lockPos=!1,this._orient=Orientation.default}}toJSONBase(){var _a;return{pos:[this.posX,this.posY],lockPos:!!this._lockPos||void 0,orient:this.orient===Orientation.default?void 0:this.orient,anchor:null==(_a=this._anchor)?void 0:_a.ref,ref:this.ref}}get posX(){return this._posX}get posY(){return this._posY}get lockPos(){return this._lockPos}isInRect(rect){return this._posX>=rect.left&&this._posX<=rect.right&&this._posY>=rect.top&&this._posY<=rect.bottom}get orient(){return this._orient}canRotate(){return!0}canLockPos(){return!0}doSetLockPos(lockPos){this._lockPos=lockPos}doSetOrient(newOrient){this._orient=newOrient,this.requestRedraw({why:"orientation changed",invalidateMask:!0})}get width(){return Orientation.isVertical(this._orient)?this.unrotatedHeight:this.unrotatedWidth}get height(){return Orientation.isVertical(this._orient)?this.unrotatedWidth:this.unrotatedHeight}applyDrawTransform(g){const abcd=(()=>{switch(this._orient){case"e":return;case"s":return[0,1,-1,0];case"w":return[-1,0,0,-1];case"n":return[0,-1,1,0]}})();void 0!==abcd&&(g.translate(this.posX,this.posY),g.transform(...abcd,0,0),g.translate(-this.posX,-this.posY))}isOver(x,y){return this.parent.mode>=2&&inRect(this._posX,this._posY,this.width,this.height,x,y)}trySetPosition(posX,posY,snapToGrid){const newPos=this.tryMakePosition(posX,posY,snapToGrid);if(void 0!==newPos)return this.doSetPosition(newPos[0],newPos[1]),newPos}tryMakePosition(posX,posY,snapToGrid){const roundTo=snapToGrid?GRID_STEP/2:1;if(posX=Math.round(posX/roundTo)*roundTo,posY=Math.round(posY/roundTo)*roundTo,posX!==this._posX||posY!==this.posY)return[posX,posY]}doSetPosition(posX,posY){const delta=[posX-this._posX,posY-this._posY];this._posX=posX,this._posY=posY,this.requestRedraw({why:"position changed",invalidateMask:!0}),this.positionChanged(delta)}makeOrientationAndPosMenuItems(){var _a;const s=S.Components.Generic.contextMenu,shortcuts={e:"→",s:"↓",w:"←",n:"↑"};return[...this.canRotate()?[["start",MenuData.submenu("direction",s.Orientation,[...Orientations.values.map((orient=>{const isCurrent=this._orient===orient,icon=isCurrent?"check":"none",caption=S.Orientations[orient],action=isCurrent?()=>{}:()=>{this.doSetOrient(orient)};return MenuData.item(icon,caption,action,shortcuts[orient])})),MenuData.sep(),MenuData.text(s.ChangeOrientationDesc)])]]:[],...this.canLockPos()?[["start",MenuData.item(this.lockPos?"check":"none",s.LockPosition,(()=>{this.doSetLockPos(!this.lockPos)}),"L")]]:[],...void 0===this._anchor?[["start",MenuData.item("none",s.SetAnchor,(()=>{this.parent.editor.showMessage(S.Messages.SetAnchorPrompt),this.parent.editor.setCurrentPointerAction("setanchor",!1,this)}))]]:[["start",MenuData.item("none",span(s.ClearAnchor[0],span(fixedWidthInContextMenu,null!=(_a=this._anchor.ref)?_a:"???"),s.ClearAnchor[1]),(()=>{this.anchor=void 0}))]]]}keyDown(e){if(this.canRotate()){if("ArrowRight"===e.key)return void this.doSetOrient("e");if("ArrowDown"===e.key)return void this.doSetOrient("s");if("ArrowLeft"===e.key)return void this.doSetOrient("w");if("ArrowUp"===e.key)return void this.doSetOrient("n")}this.canLockPos()&&"l"===e.key?this.doSetLockPos(!this.lockPos):super.keyDown(e)}};__name(DrawableWithPosition,"DrawableWithPosition");var DrawableWithDraggablePosition=class extends DrawableWithPosition{constructor(parent,saved){super(parent,saved),this._isMovingWithContext=void 0}get anchor(){return this._anchor}set anchor(anchor){this._anchor!==anchor&&(void 0!==this._anchor&&this._anchor.removeAnchoredDrawable(this),this._anchor=anchor,void 0!==anchor&&anchor.addAnchoredDrawable(this))}get isMoving(){return void 0!==this._isMovingWithContext}tryStartMoving(e){if(!this.lockPos&&void 0===this._isMovingWithContext){const[offsetX,offsetY]=this.parent.editor.offsetXY(e);this._isMovingWithContext={mouseOffsetToPosX:offsetX-this.posX,mouseOffsetToPosY:offsetY-this.posY,lastAnchorX:this.posX,lastAnchorY:this.posY,createdClone:void 0}}}tryStopMoving(e){var _a;let wasMoving=!1;return void 0!==this._isMovingWithContext&&(this._isMovingWithContext=void 0,wasMoving=!0),null==(_a=this.parent.ifEditing)||_a.moveMgr.setDrawableStoppedMoving(this,e),wasMoving}setPosition(x,y,snapToGrid){const newPos=this.tryMakePosition(x,y,snapToGrid);void 0!==newPos&&this.doSetPosition(...newPos)}pointerDown(e){if(this.parent.mode>=2){if(e.metaKey)return this.parent.linkMgr.startSettingAnchorFrom(this),{wantsDragEvents:!1};this.tryStartMoving(e)}return{wantsDragEvents:!0}}pointerDragged(e){var _a;if(this.parent.mode>=2&&!this.lockPos){null==(_a=this.parent.ifEditing)||_a.moveMgr.setDrawableMoving(this,e);const[x,y]=this.parent.editor.offsetXY(e),snapToGrid=!e.metaKey;this.updateSelfPositionIfNeeded(x,y,snapToGrid,e)}}pointerUp(e){var _a,_b;null==(_b=null==(_a=this._isMovingWithContext)?void 0:_a.createdClone)||_b.pointerUp(e);const result=this.tryStopMoving(e);return InteractionResult.fromBoolean(result)}updateSelfPositionIfNeeded(x,y,snapToGrid,e){if(void 0===this._isMovingWithContext)return;const{mouseOffsetToPosX:mouseOffsetToPosX,mouseOffsetToPosY:mouseOffsetToPosY,lastAnchorX:lastAnchorX,lastAnchorY:lastAnchorY,createdClone:createdClone}=this._isMovingWithContext;if(void 0!==createdClone)return void createdClone.pointerDragged(e);let targetX=x-mouseOffsetToPosX,targetY=y-mouseOffsetToPosY;if(e.shiftKey){Math.abs(lastAnchorX-targetX)<=Math.abs(lastAnchorY-targetY)?targetX=lastAnchorX:targetY=lastAnchorY}const newPos=this.tryMakePosition(targetX,targetY,snapToGrid);if(void 0===newPos)return;let clone;return e.altKey&&this.parent.mode>=3&&void 0!==(clone=this.makeClone(!0))?(this._isMovingWithContext.createdClone=clone,this.parent.editor.eventMgr.setCurrentComponentUnderPointer(clone)):this.doSetPosition(...newPos),newPos}makeClone(__setSpawning){}};__name(DrawableWithDraggablePosition,"DrawableWithDraggablePosition");var WireColor={black:"black",red:"red",blue:"blue",yellow:"yellow",green:"green",white:"white"},DEFAULT_WIRE_COLOR=WireColor.black,NodeBase=class extends DrawableWithPosition{constructor(component,nodeSpec,group2,shortName,fullName,_gridOffsetX,_gridOffsetY,hasTriangle,relativePosition,_leadLengthOverride){if(super(component.parent),this.component=component,this.group=group2,this.shortName=shortName,this.fullName=fullName,this._gridOffsetX=_gridOffsetX,this._gridOffsetY=_gridOffsetY,this.hasTriangle=hasTriangle,this._leadLengthOverride=_leadLengthOverride,this._isAlive=!0,this._value=!1,this._initialValue=void 0,this._color=DEFAULT_WIRE_COLOR,this.id=nodeSpec.id,"force"in nodeSpec&&(this._forceValue=toLogicValue(nodeSpec.force)),"color"in nodeSpec&&void 0!==nodeSpec.color&&(this._color=nodeSpec.color),"initialValue"in nodeSpec&&void 0!==nodeSpec.initialValue){const initialValue=toLogicValue(nodeSpec.initialValue);this._initialValue=initialValue,this._value=initialValue}this.parent.nodeMgr.addLiveNode(this.asNode),this.updatePositionFromParent(),this.doSetOrient(relativePosition),this._leadLength=this.updateLeadLength()}get asNode(){return this}updateLeadLength(leadLengthOverride){var _a;return this._leadLength=null!=(_a=null!=leadLengthOverride?leadLengthOverride:this._leadLengthOverride)?_a:this.defaultLeadLength(Orientation.isVertical(this.orient))}defaultLeadLength(isVertical){const bias=this.hasTriangle?-2:0;return isVertical?bias+Math.abs(this._gridOffsetY)*GRID_STEP-this.component.unrotatedHeight/2:bias+Math.abs(this._gridOffsetX)*GRID_STEP-this.component.unrotatedWidth/2}get leadLength(){return this._leadLength}get drawCoords(){const dir=this.wireProlongDirection,x=this.posX,y=this.posY;switch(dir){case"e":return[x+this.leadLength,y,x,y,dir];case"w":return[x-this.leadLength,y,x,y,dir];case"n":return[x,y-this.leadLength,x,y,dir];case"s":return[x,y+this.leadLength,x,y,dir]}}get drawCoordsInParentTransform(){const x=this.posXInParentTransform,y=this.posYInParentTransform;switch(this.orient){case"e":return[x-this.leadLength,y,x,y];case"w":return[x+this.leadLength,y,x,y];case"n":return[x,y+this.leadLength,x,y];case"s":return[x,y-this.leadLength,x,y]}}get anchor(){}set anchor(__){throw new Error("Node does not support anchoring")}isOutput(){return Node2.isOutput(this.asNode)}get unrotatedWidth(){return WAYPOINT_DIAMETER}get unrotatedHeight(){return WAYPOINT_DIAMETER}get color(){return this._color}doSetColor(color){this._color=color,this.propagateColor(color),this.requestRedraw({why:"color changed"})}propagateColor(__color){}isOver(x,y){return void 0!==this.distSquaredIfOver(x,y,!1)}distSquaredIfOver(x,y,moreTolerant){if(this.parent.mode>=2&&this.acceptsMoreConnections)return distSquaredToWaypointIfOver(x,y,this.posX,this.posY,moreTolerant)}destroy(){this.preDestroy(),this._isAlive=!1,this.parent.nodeMgr.removeLiveNode(this.asNode)}forceDraw(){return!1}doDraw(g,ctx){const mode=this.parent.mode;if(mode<2&&!this.forceDraw()||!this.acceptsMoreConnections)return;const showForced=void 0!==this._forceValue&&mode>=4,showForcedWarning=mode>=4&&!isUnknown(this._value)&&!isUnknown(this.value)&&this._value!==this.value,parentOrientIsVertical=Orientation.isVertical(this.component.orient),neutral=this.parent.editor.options.hideWireColors;drawWaypoint(g,ctx,this.posX,this.posY,this.nodeDisplayStyle,this.value,ctx.isMouseOver,neutral,showForced,showForcedWarning,parentOrientIsVertical)}get isAlive(){return this._isAlive}get value(){return void 0!==this._forceValue?this._forceValue:this._value}set value(val){const oldVisibleValue=this.value;val!==this._value&&(this._value=val,this.propagateNewValueIfNeeded(oldVisibleValue))}propagateNewValueIfNeeded(oldVisibleValue){const newVisibleValue=this.value;newVisibleValue!==oldVisibleValue&&this.propagateNewValue(newVisibleValue)}get gridOffsetX(){return this._gridOffsetX}set gridOffsetX(newVal){this._gridOffsetX=newVal,this.updatePositionFromParent()}get gridOffsetY(){return this._gridOffsetY}set gridOffsetY(newVal){this._gridOffsetY=newVal,this.updatePositionFromParent()}get posXInParentTransform(){return this.component.posX+this._gridOffsetX*GRID_STEP}get posYInParentTransform(){return this.component.posY+this._gridOffsetY*GRID_STEP}updatePositionFromParent(){var _a;const component=this.component,[appliedGridOffsetX,appliedGridOffsetY]=(()=>{switch(component.orient){case"e":return[+this._gridOffsetX,+this._gridOffsetY];case"w":return[-this._gridOffsetX,-this._gridOffsetY];case"s":return[-this._gridOffsetY,+this._gridOffsetX];case"n":return[+this._gridOffsetY,-this._gridOffsetX]}})();return null!=(_a=super.trySetPosition(component.posX+appliedGridOffsetX*GRID_STEP,component.posY+appliedGridOffsetY*GRID_STEP,!1))?_a:[this.posX,this.posY]}get wireProlongDirection(){switch(this.component.orient){case"e":switch(this.orient){case"e":return"w";case"w":return"e";case"s":return"n";case"n":return"s"}break;case"w":return this.orient;case"s":switch(this.orient){case"e":return"n";case"w":return"s";case"s":return"e";case"n":return"w"}break;case"n":switch(this.orient){case"e":return"s";case"w":return"n";case"s":return"w";case"n":return"e"}}}cursorWhenMouseover(__e2){return"crosshair"}pointerDown(__){return this.parent.linkMgr.startDraggingWireFrom(this.asNode),{wantsDragEvents:!1}}pointerUp(__){const newWire=this.parent.linkMgr.stopDraggingWireOn(this.asNode);return void 0===newWire?InteractionResult.NoChange:tryMakeRepeatableNodeAction(newWire.startNode,newWire.endNode,((startNode,endNode)=>void 0!==this.parent.linkMgr.addWire(startNode,endNode,!0)))}};__name(NodeBase,"NodeBase");var NodeIn=class extends NodeBase{constructor(){super(...arguments),this._tag="_nodein",this._incomingWire=null,this.prefersSpike=!1,this.isClock=!1}get incomingWire(){return this._incomingWire}set incomingWire(wire){this._incomingWire=wire,this.value=null!==wire&&wire.startNode.value}get connectedWires(){return null===this._incomingWire?[]:[this._incomingWire]}preDestroy(){null!==this._incomingWire&&this.parent.linkMgr.deleteWire(this._incomingWire)}get acceptsMoreConnections(){return null===this._incomingWire}positionChanged(__delta){var _a;null==(_a=this._incomingWire)||_a.invalidateWirePath()}get forceValue(){}get initialValue(){}propagateNewValue(__newValue){this.component.setNeedsRecalc()}get nodeDisplayStyle(){return null===this._incomingWire?1:0}};__name(NodeIn,"NodeIn");var NodeOut=class extends NodeBase{constructor(){super(...arguments),this._tag="_nodeout",this._outgoingWires=[]}get isClock(){return!1}addOutgoingWire(wire){-1===this._outgoingWires.indexOf(wire)&&this._outgoingWires.push(wire)}removeOutgoingWire(wire){const i2=this._outgoingWires.indexOf(wire);-1!==i2&&this._outgoingWires.splice(i2,1)}get outgoingWires(){return this._outgoingWires}get connectedWires(){return this._outgoingWires}preDestroy(){for(const wire of[...this._outgoingWires])this.parent.linkMgr.deleteWire(wire)}get acceptsMoreConnections(){return!0}positionChanged(__delta){if(void 0!==this._outgoingWires)for(const wire of this._outgoingWires)wire.invalidateWirePath()}findWireTo(node){return this._outgoingWires.find((wire=>wire.endNode===node))}get forceValue(){return this._forceValue}set forceValue(newForceValue){const oldVisibleValue=this.value;this._forceValue=newForceValue,this.propagateNewValueIfNeeded(oldVisibleValue),this.requestRedraw({why:"changed forced output value",invalidateTests:!0})}get initialValue(){return this._initialValue}propagateColor(color){for(const wire of this._outgoingWires)wire.endNode.doSetColor(color)}propagateNewValue(newValue){const now=this.parent.editor.timeline.logicalTime();for(const wire of this._outgoingWires)wire.propagateNewValue(newValue,now)}forceDraw(){return this._outgoingWires.length>1&&this.component.alwaysDrawMultiOutNodes}get nodeDisplayStyle(){return 0===this._outgoingWires.length?3:2}pointerDoubleClicked(e){const superChange=super.pointerDoubleClicked(e);return superChange.isChange?superChange:this.parent.mode>=4&&e.altKey&&this.isOutput()&&this.component.allowsForcedOutputs?(this.forceValue=(()=>{switch(this._forceValue){case void 0:return Unknown;case Unknown:return HighImpedance;case HighImpedance:return!1;case!1:return!0;case!0:return}})(),InteractionResult.SimpleChange):InteractionResult.NoChange}};__name(NodeOut,"NodeOut");var Node2={isOutput:node=>"_nodeout"===node._tag};function tryMakeRepeatableNodeAction(startNode,endNode,handleNodes){const startGroup=startNode.group,endGroup=endNode.group;if(void 0===startGroup||void 0===endGroup)return InteractionResult.SimpleChange;const startIndex=startGroup.indexOf(startNode),startIncrement=startIndex<startGroup.nodes.length-1?1:-1,endIndex=endGroup.indexOf(endNode),endIncrement=endIndex<endGroup.nodes.length-1?1:-1,repeat=__name((function makeRepeatFunction2(startIndex2,endIndex2){return!(startIndex2>=startGroup.nodes.length||startIndex2<0||endIndex2>=endGroup.nodes.length||endIndex2<0)&&(()=>!!handleNodes(startGroup.nodes[startIndex2],endGroup.nodes[endIndex2])&&makeRepeatFunction2(startIndex2+startIncrement,endIndex2+endIncrement))}),"makeRepeatFunction")(startIndex+startIncrement,endIndex+endIncrement);return!1===repeat?InteractionResult.SimpleChange:InteractionResult.RepeatableChange(repeat)}__name(tryMakeRepeatableNodeAction,"tryMakeRepeatableNodeAction");var NodeSeqRepr=__name((fullNodeRepr=>t5.union([t5.number,t5.string,fullNodeRepr,t5.array(t5.union([t5.number,t5.string,fullNodeRepr]))],"NodeSeqRepr")),"NodeSeqRepr"),InputNodeRepr=t5.type({id:t5.number},"InputNode"),OutputNodeRepr=t5.intersection([t5.type({id:t5.number}),t5.partial({force:LogicValueRepr,initialValue:LogicValueRepr,color:t5.keyof(WireColor)})],"OutputNode"),InputNodeSeqRepr=NodeSeqRepr(InputNodeRepr),OutputNodeSeqRepr=NodeSeqRepr(OutputNodeRepr),OnlyInNodeIds=t5.partial({id:InputNodeSeqRepr}),OnlyOutNodeIds=t5.partial({id:OutputNodeSeqRepr}),InAndOutNodeIds=t5.partial({in:InputNodeSeqRepr,out:OutputNodeSeqRepr}),NoNodeIds=t5.type({}),NodeIDsRepr=__name(((hasIn,hasOut)=>hasIn?hasOut?InAndOutNodeIds:OnlyInNodeIds:hasOut?OnlyOutNodeIds:NoNodeIds),"NodeIDsRepr"),ComponentRepr=__name(((hasIn,hasOut)=>t5.intersection([t5.type({type:t5.string}),PositionSupportRepr,NodeIDsRepr(hasIn,hasOut)],"Component")),"ComponentRepr");function isNodeArray(obj){return isArray(obj)}__name(isNodeArray,"isNodeArray");var NodeGroup=class{constructor(parent,name2){this.parent=parent,this.name=name2,this._orient="e",this._avgGridOffets=void 0,this.hasNameOverrides=!1,this._nodes=[],this._nodes.group=this}get nodes(){return this._nodes}addNode(node){void 0!==this._avgGridOffets&&console.warn("Adding nodes to a group after the group's position has been used"),this._nodes.push(node),this._orient=node.orient}get avgGridOffsets(){if(void 0===this._avgGridOffets){let x=0,y=0;for(const node of this._nodes)x+=node.gridOffsetX,y+=node.gridOffsetY;const len=this._nodes.length;this._avgGridOffets=[x/len,y/len]}return this._avgGridOffets}get orient(){return this._orient}get posXInParentTransform(){return this.parent.posX+this.avgGridOffsets[0]*GRID_STEP}get posYInParentTransform(){return this.parent.posY+this.avgGridOffsets[1]*GRID_STEP}indexOf(node){for(let i2=0;i2<this._nodes.length;i2++)if(this._nodes[i2]===node)return i2;return-1}};function isDynamicName(obj){if(!isRecord(obj))return!1;for(const key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&"string"!=typeof obj[key])return!1;return!0}__name(NodeGroup,"NodeGroup"),__name(isDynamicName,"isDynamicName");var ComponentNameRepr=typeOrUndefined(t5.union([t5.string,t5.record(t5.union([t5.string,t5.number]),t5.string)]));function isNodeDesc(desc){return isNumber(desc[0])}__name(isNodeDesc,"isNodeDesc");var ComponentBase=class extends DrawableWithDraggablePosition{constructor(parent,def,saved){super(parent,saved),this._anchoredDrawables=[],this.def=def,this._width=def.size.gridWidth*GRID_STEP,this._height=def.size.gridHeight*GRID_STEP,this._value=def.initialValue(saved);const ins=def.nodeRecs.ins,outs=def.nodeRecs.outs;function countNodes(rec){if(void 0===rec)return 0;let count=0;for(const desc of Object.values(rec))if(isNodeDesc(desc))count++;else for(const innerDesc of desc)isNodeDesc(innerDesc)?count++:count+=innerDesc.length;return count}__name(countNodes,"countNodes");const numInputs=countNodes(ins),numOutputs=countNodes(outs);void 0!==saved?this._state=1:this.setSpawning();const[inputSpecs,outputSpecs,hasAnyPrecomputedInitialValues]=this.nodeSpecsFromRepr(saved,numInputs,numOutputs);[this.inputs,this.inputGroups]=this.makeNodes(ins,inputSpecs,NodeIn),[this.outputs,this.outputGroups]=this.makeNodes(outs,outputSpecs,NodeOut),hasAnyPrecomputedInitialValues?this.requestPropagate():this.setNeedsRecalc(!0)}setSpawning(){var _a;this._state=0,null==(_a=this.parent.ifEditing)||_a.moveMgr.setDrawableMoving(this)}setSpawned(){var _a;this._state=1,null==(_a=this.parent.ifEditing)||_a.moveMgr.setDrawableStoppedMoving(this)}setInvalid(){this._state=3}toNodelessJSON(){const repr=this.toJSON();return delete repr.ref,delete repr.in,delete repr.out,delete repr.id,repr}toJSONBase(){return{...{type:this.jsonType()},...super.toJSONBase(),...this.buildNodesRepr()}}jsonType(){return this.def.type}makeNodes(nodeRec,specs,node){const nodes={},allNodes=[],nodeGroups=new Map;if(void 0!==nodeRec){const makeNode=__name(((group2,shortName,desc)=>{var _a,_b,_c;const spec=specs[nextSpecIndex++],[offsetX,offsetY,orient,nameOrOptions,options_]=desc;let nameOverride,options;isString(nameOrOptions)?nameOverride=nameOrOptions:void 0!==nameOrOptions&&(options=nameOrOptions),void 0!==options_&&(options=options_);const isClock=null!=(_a=null==options?void 0:options.isClock)&&_a,prefersSpike=null!=(_b=null==options?void 0:options.prefersSpike)&&_b,leadLength=null==options?void 0:options.leadLength,hasTriangle=null!=(_c=null==options?void 0:options.hasTriangle)&&_c;void 0!==group2&&void 0!==nameOverride?(shortName=nameOverride,group2.hasNameOverrides=!0):void 0!==(null==options?void 0:options.labelName)&&(shortName=options.labelName);const newNode=new node(this,spec,group2,shortName,void 0===nameOverride?shortName:nameOverride,offsetX,offsetY,hasTriangle,orient,leadLength);return(prefersSpike||isClock)&&(newNode instanceof NodeIn?(newNode.prefersSpike=!0,newNode.isClock=isClock):console.warn("prefersSpike is only supported for inputs, can't set it for ".concat(name))),allNodes.push(newNode),newNode}),"makeNode");let nextSpecIndex=0;for(const[fieldName,desc]of Object.entries(nodeRec))if(isNodeDesc(desc))nodes[fieldName]=makeNode(void 0,fieldName,desc);else{const makeNodesForGroup=__name(((groupDesc,groupName,namePrefix)=>{const group2=new NodeGroup(this,groupName);nodeGroups.set(groupName,group2);for(let i2=0;i2<groupDesc.length;i2++)group2.addNode(makeNode(group2,namePrefix+i2,groupDesc[i2]));return group2.nodes}),"makeNodesForGroup");if(isNodeDesc(desc[0])){const groupDesc=desc;nodes[fieldName]=makeNodesForGroup(groupDesc,fieldName,fieldName)}else{const groupMultiDesc=desc;nodes[fieldName]=groupMultiDesc.map(((groupDesc,i2)=>makeNodesForGroup(groupDesc,"".concat(fieldName).concat(i2),"".concat(fieldName).concat(i2,"."))))}}}return nodes._all=allNodes,[nodes,nodeGroups]}nodeSpecsFromRepr(_repr,numInputs,numOutputs){const nodeMgr=this.parent.nodeMgr,makeDefaultSpec=__name((()=>({id:nodeMgr.getFreeId()})),"makeDefaultSpec"),makeDefaultSpecArray=__name((len=>ArrayFillUsing(makeDefaultSpec,len)),"makeDefaultSpecArray");if(void 0===_repr)return[makeDefaultSpecArray(numInputs),makeDefaultSpecArray(numOutputs),!1];let inputSpecs=[],outputSpecs=[];const makeNormalizedSpecs=__name(((num,seqRepr)=>{if(void 0===seqRepr)return makeDefaultSpecArray(num);const specs=[];function pushId(sourceId){const id=nodeMgr.getFreeIdFrom(sourceId);specs.push({id:id})}__name(pushId,"pushId");for(const spec of isArray(seqRepr)?seqRepr:[seqRepr])if(isNumber(spec))pushId(spec);else if(isString(spec)){const[start2,end2]=spec.split("-").map((s=>parseInt(s)));for(let i2=start2;i2<=end2;i2++)pushId(i2)}else spec.id=nodeMgr.getFreeIdFrom(spec.id),specs.push(spec);return specs}),"makeNormalizedSpecs");if(0!==numInputs)if(0!==numOutputs){const repr=_repr;inputSpecs=makeNormalizedSpecs(numInputs,repr.in),outputSpecs=makeNormalizedSpecs(numOutputs,repr.out)}else{inputSpecs=makeNormalizedSpecs(numInputs,_repr.id)}else if(0!==numOutputs){outputSpecs=makeNormalizedSpecs(numOutputs,_repr.id)}const hasAnyPrecomputedInitialValues=outputSpecs.some((spec=>void 0!==spec.initialValue));return[inputSpecs,outputSpecs,hasAnyPrecomputedInitialValues]}buildNodesRepr(){const numInputs=this.inputs._all.length,numOutputs=this.outputs._all.length;function inNodeReprs(nodes){const reprOne=__name((node=>node.id),"reprOne");return 1===nodes.length?reprOne(nodes[0]):compactRepr(nodes.map(reprOne))}function outNodeReprs(nodes){const reprOne=__name((node=>{const valueNotForced=void 0===node.forceValue,noInitialValue=void 0===node.initialValue,hasStandardColor=node.color===DEFAULT_WIRE_COLOR;return valueNotForced&&hasStandardColor&&noInitialValue?node.id:{id:node.id,intialValue:noInitialValue?void 0:toLogicValueRepr(node.initialValue),force:valueNotForced?void 0:toLogicValueRepr(node.forceValue),color:hasStandardColor?void 0:node.color}}),"reprOne");return 1===nodes.length?reprOne(nodes[0]):compactRepr(nodes.map(reprOne))}function compactRepr(reprs){const newArray=[];let currentRangeStart,currentRangeEnd;function pushRange(){void 0!==currentRangeStart&&void 0!==currentRangeEnd&&(currentRangeStart===currentRangeEnd?newArray.push(currentRangeStart):currentRangeEnd===currentRangeStart+1?(newArray.push(currentRangeStart),newArray.push(currentRangeEnd)):newArray.push("".concat(currentRangeStart,"-").concat(currentRangeEnd)),currentRangeStart=void 0,currentRangeEnd=void 0)}__name(pushRange,"pushRange");for(const repr of reprs)isNumber(repr)?void 0!==currentRangeStart&&repr-1===currentRangeEnd?currentRangeEnd=repr:(pushRange(),currentRangeStart=currentRangeEnd=repr):(pushRange(),newArray.push(repr));return pushRange(),1===newArray.length?newArray[0]:newArray}return __name(inNodeReprs,"inNodeReprs"),__name(outNodeReprs,"outNodeReprs"),__name(compactRepr,"compactRepr"),0!==numInputs?0!==numOutputs?{in:inNodeReprs(this.inputs._all),out:outNodeReprs(this.outputs._all)}:{id:inNodeReprs(this.inputs._all)}:0!==numOutputs?{id:outNodeReprs(this.outputs._all)}:{}}get anchoredDrawables(){return this._anchoredDrawables}addAnchoredDrawable(drawable){this._anchoredDrawables.push(drawable)}removeAnchoredDrawable(drawable){this._anchoredDrawables=this._anchoredDrawables.filter((d=>d!==drawable))}get unrotatedWidth(){return this._width}get unrotatedHeight(){return this._height}toStringDetails(){const maybeName=this._name;return(void 0!==maybeName?"name='".concat(maybeName,"', "):"")+String(this.value)}get state(){return this._state}get allowsForcedOutputs(){return!0}get alwaysDrawMultiOutNodes(){return!1}*allNodes(){for(const node of this.inputs._all)yield node;for(const node of this.outputs._all)yield node}*allNodeGroups(){for(const group2 of this.inputGroups.values())yield group2;for(const group2 of this.outputGroups.values())yield group2}get value(){return this._value}doSetValue(newValue){let forcePropagate=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const oldValue=this._value;!forcePropagate&&deepArrayEquals(newValue,oldValue)||(this._value=newValue,this.requestRedraw({why:"value changed",invalidateTests:!0}),this.requestPropagate())}recalcValue(forcePropagate){this.doSetValue(this.doRecalcValue(),forcePropagate)}propagateCurrentValue(){this.propagateValue(this._value)}propagateValue(__newValue){}inputValues(nodes){return nodes.map((node=>node.value))}outputValues(nodes,values){let reverse=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const num=nodes.length;if(values.length!==num)throw new Error("outputValues: expected ".concat(num," values, got ").concat(values.length));for(let i2=0;i2<num;i2++){const j=reverse?num-i2-1:i2;nodes[i2].value=values[j]}}setNeedsRecalc(){let forcePropagate=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parent.recalcMgr.enqueueForRecalc(this,forcePropagate)}requestPropagate(){this.parent.recalcMgr.enqueueForPropagate(this)}updateNodePositions(){for(const node of this.allNodes())node.updatePositionFromParent()}bounds(){return new DrawingRect(this,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}draw(g,drawParams){if(super.draw(g,drawParams),3===this._state){g.fillStyle="rgba(255, 0, 0, 0.3)";const bounds=this.bounds(!0);g.fill(bounds.outline(g,5))}}doDraw(g,ctx){this.doDrawDefault(g,ctx)}doDrawDefault(g,ctx,opts_){var _a,_b,_c;const bounds=this.bounds(),opts="function"!=typeof opts_?opts_:{drawLabels:opts_};g.fillStyle=null!=(_a=null==opts?void 0:opts.background)?_a:COLOR_BACKGROUND;const outline=bounds.outline(g);g.fill(outline);for(const node of this.allNodes())this.drawWireLineTo(g,node,bounds);const drawLabels=!(null!=(_b=null==opts?void 0:opts.skipLabels)&&_b);if(drawLabels)for(const group2 of this.allNodeGroups())group2.hasNameOverrides||this.drawGroupBox(g,group2,bounds);null==(_c=null==opts?void 0:opts.drawInside)||_c.call(opts,bounds),g.lineWidth=3,g.strokeStyle=ctx.borderColor,g.stroke(outline),ctx.inNonTransformedFrame((ctx2=>{var _a2,_b2,_c2;if(void 0!==(null==(_a2=null==opts?void 0:opts.componentName)?void 0:_a2[0])){const[name2,onRight,value]=opts.componentName,val=isNumber(value)||isString(value)?value:value();drawComponentName(g,ctx2,name2,val,this,onRight)}if(drawLabels){const labelSize=null!=(_b2=null==opts?void 0:opts.labelSize)?_b2:11;g.fillStyle=COLOR_COMPONENT_INNER_LABELS,g.textAlign="center",g.font="bold ".concat(labelSize,"px sans-serif");for(const group2 of this.allNodeGroups())group2.hasNameOverrides||this.drawGroupLabel(ctx2,group2,bounds);g.font="".concat(labelSize,"px sans-serif");for(const node of this.allNodes())(void 0===node.group||node.group.hasNameOverrides)&&this.drawNodeLabel(ctx2,node,bounds)}null==(_c2=null==opts?void 0:opts.drawLabels)||_c2.call(opts,ctx2,bounds)}))}drawWireLineTo(g,node,bounds){var _a;node.isClock?drawClockInput(g,bounds.left,node,null!=(_a=this._trigger)?_a:EdgeTrigger.rising):drawWireLineToComponent(g,node)}drawGroupBox(g,group2,bounds){if(!shouldDrawLeadsTo(group2.nodes))return;const groupWidth=Orientation.isVertical(Orientation.add(this.orient,group2.orient))?8:6,first=group2.nodes[0],last=group2.nodes[group2.nodes.length-1];switch(g.beginPath(),group2.orient){case"e":g.rect(bounds.right-groupWidth,first.posYInParentTransform-2,groupWidth,last.posYInParentTransform-first.posYInParentTransform+4);break;case"w":g.rect(bounds.left,first.posYInParentTransform-2,groupWidth,last.posYInParentTransform-first.posYInParentTransform+4);break;case"n":g.rect(last.posXInParentTransform-2,bounds.top,first.posXInParentTransform-last.posXInParentTransform+4,groupWidth);break;case"s":g.rect(last.posXInParentTransform-2,bounds.bottom-groupWidth,first.posXInParentTransform-last.posXInParentTransform+4,groupWidth)}g.fillStyle=COLOR_GROUP_SPAN,g.fill()}drawNodeLabel(ctx,node,bounds){node.isClock||isTrivialNodeName(node.shortName)||drawLabel(ctx,this.orient,node.shortName,node.orient,...this.anchorFor(node,bounds,1),node)}drawGroupLabel(ctx,group2,bounds){isTrivialNodeName(group2.name)||drawLabel(ctx,this.orient,group2.name,group2.orient,...this.anchorFor(group2,bounds,1),group2.nodes)}anchorFor(elem,bounds,offset2){switch(elem.orient){case"e":return[bounds.right+offset2,elem.posYInParentTransform];case"w":return[bounds.left-offset2,elem.posYInParentTransform];case"n":return[elem.posXInParentTransform,bounds.top-offset2];case"s":return[elem.posXInParentTransform,bounds.bottom+offset2]}}replaceWithComponent(newComp){var _a,_b;const saveWires=__name(((nodes,getWires)=>{const savedWires=new Map;for(const node of nodes){const wires=getWires(node);if(null===wires)continue;const group2=node.group,keyName=void 0===group2?node.shortName:"".concat(group2.name,"[").concat(group2.nodes.indexOf(node),"]");savedWires.set(keyName,wires)}return savedWires}),"saveWires"),savedWiresIn=saveWires(this.inputs._all,(node=>node.incomingWire)),savedWiresOut=saveWires(this.outputs._all,(node=>node.outgoingWires)),restoreNodes=__name(((savedWires,nodes,setWires)=>{for(const node of nodes){const group2=node.group;if(void 0===group2){let wires=savedWires.get(node.shortName);void 0===wires&&(wires=savedWires.get(node.shortName+"[0]")),void 0!==wires&&setWires(wires,node)}else{const i2=group2.nodes.indexOf(node);let wires=savedWires.get("".concat(group2.name,"[").concat(i2,"]"));void 0===wires&&0===i2&&(wires=savedWires.get(group2.name)),void 0!==wires&&setWires(wires,node)}}}),"restoreNodes");restoreNodes(savedWiresIn,newComp.inputs._all,((wire,node)=>{wire.setEndNode(node)}));const now=this.parent.editor.timeline.logicalTime();restoreNodes(savedWiresOut,newComp.outputs._all,((wires,node)=>{for(const wire of[...wires])wire.setStartNode(node,now)}));const componentList=this.parent.components;componentList.tryDelete(this)||console.warn("Could not delete old component"),newComp.setPosition(this.posX,this.posY,!1),newComp.setSpawned();const ref=this.ref;return void 0===ref||componentList.looksLikeAutoGeneratedId(this)||componentList.changeIdOf(newComp,ref),null==(_a=this.parent.ifEditing)||_a.undoMgr.takeSnapshot(),null==(_b=this.parent.ifEditing)||_b.redrawMgr.requestRedraw({why:"component replaced",component:newComp,invalidateMask:!0,invalidateTests:!0}),newComp}makeClone(setSpawning){const repr=this.toNodelessJSON(),newComp=this.def.makeFromJSON(this.parent,repr);return void 0===newComp?console.warn("Could not create component clone"):setSpawning&&newComp.setSpawning(),newComp}pointerDown(e){if(this.parent.mode>=2&&!e.shiftKey){const eventMgr=this.parent.editor.eventMgr;let elems;void 0!==eventMgr.currentSelection&&(elems=eventMgr.currentSelection.previouslySelectedElements).size>0&&!elems.has(this)&&(eventMgr.currentSelection=void 0)}return super.pointerDown(e)}pointerUp(e){var _a;let wasSpawning=!1;0===this._state&&(this._state=1,wasSpawning=!0);const wasMoving=super.pointerUp(e).isChange;if(wasSpawning||wasMoving){const newLinks=this.parent.nodeMgr.tryConnectNodesOf(this);return newLinks.length>0&&this.autoConnected(newLinks),null==(_a=this.parent.ifEditing)||_a.setDirty("moved component"),InteractionResult.SimpleChange}const linkMgr=this.parent.editor.linkMgr;return linkMgr.isSettingAnchor?linkMgr.stopSettingAnchorOn(this):InteractionResult.NoChange}autoConnected(__newLinks){}updateSelfPositionIfNeeded(x,y,snapToGrid,e){return 0===this._state?this.trySetPosition(x,y,snapToGrid):super.updateSelfPositionIfNeeded(x,y,snapToGrid,e)}positionChanged(delta){this.updateNodePositions();for(const anchored of this._anchoredDrawables)anchored.setPosition(anchored.posX+delta[0],anchored.posY+delta[1],!1)}pointerClicked(e){return this.parent.mode>=2&&e.shiftKey?(this.parent.editor.eventMgr.toggleSelect(this),InteractionResult.SimpleChange):InteractionResult.NoChange}pointerDoubleClicked(e){if(this.parent.mode>=2&&e.metaKey&&this.canRotate()){const doChange=__name((()=>(this.doSetOrient(Orientation.nextClockwise(this.orient)),!0)),"doChange");return doChange(),InteractionResult.RepeatableChange(doChange)}return InteractionResult.NoChange}doSetOrient(orient){super.doSetOrient(orient),this.updateNodePositions()}destroy(){this._state=2;for(const node of this.allNodes())node.destroy()}cursorWhenMouseover(e){var _a,_b;const mode=this.parent.mode;return null!=(_a=null==e?void 0:e.ctrlKey)&&_a&&mode>=2?"context-menu":null!=(_b=null==e?void 0:e.altKey)&&_b&&mode>=3?"copy":!this.lockPos&&mode>=2?"grab":void 0}makeContextMenu(){const menuItems=[],baseItems=this.makeBaseContextMenu(this.parent.editor),specificItems=this.makeComponentSpecificContextMenuItems();let lastWasSep=!0;function addItemsAt(placement,items){let insertSep=arguments.length>2&&void 0!==arguments[2]&&arguments[2];insertSep&&(lastWasSep||menuItems.push(MenuData.sep()),lastWasSep=!0);for(const[pl,it]of items)pl===placement&&(menuItems.push(it),lastWasSep="sep"===it._tag)}return __name(addItemsAt,"addItemsAt"),addItemsAt("start",specificItems),addItemsAt("start",baseItems),addItemsAt("mid",baseItems,!0),addItemsAt("mid",specificItems),addItemsAt("end",baseItems,!0),addItemsAt("end",specificItems),menuItems}makeBaseContextMenu(editor){const s=S.Components.Generic.contextMenu,nonEmptySelectionInMainEditor=!editor.eventMgr.currentSelectionEmpty()&&this.parent.isMainEditor(),makeNewComponentItems=nonEmptySelectionInMainEditor&&UIPermissions.canModifyCustomComponents(this.parent)?[["start",MenuData.item("newcomponent",s.MakeNewComponent,(()=>{var _a;const result=editor.factory.tryMakeNewCustomComponent(editor);isString(result)?result.length>0&&window.alert(s.MakeNewComponentFailed+" "+result):(null==(_a=editor.options.showOnly)||_a.push(result.id),editor.updateCustomComponentButtons())}))]]:[],makeNewTestCaseItems=nonEmptySelectionInMainEditor&&UIPermissions.canModifyTestCases(this.parent)?[["start",MenuData.item("testcase",s.MakeNewTestCase,(()=>{const result=editor.factory.tryMakeNewTestCase(editor);isString(result)?result.length>0&&window.alert(s.MakeNewTestCaseFailed+" "+result):this.parent.editor.addTestCases(result)}))],["start",MenuData.item("testcase",s.MakeAllTestCases,(async()=>{const result=await editor.factory.tryMakeAllTestCases(editor);isString(result)?result.length>0&&window.alert(s.MakeNewTestCaseFailed+" "+result):this.parent.editor.addTestCases(result)}))]]:[];(makeNewComponentItems.length>0||makeNewTestCaseItems.length>0)&&makeNewTestCaseItems.push(["start",MenuData.sep()]);const setRefItems=editor.mode<4?[]:[["end",this.makeSetIdContextMenuItem()],["end",MenuData.sep()]],resetItem=3!==this.state?[]:[["end",MenuData.item("reset",s.Reset,(()=>{this._state=1,this.setNeedsRecalc(!0)}))]],deleteItem=MenuData.item("trash",s.Delete,(()=>this.parent.components.tryDelete(this)?(this.requestRedraw({why:"deleted component",invalidateMask:!0,invalidateTests:!0}),InteractionResult.SimpleChange):InteractionResult.NoChange),"⌫",!0);return[["start",MenuData.sep()],...makeNewComponentItems,...makeNewTestCaseItems,...this.makeOrientationAndPosMenuItems(),...setRefItems,...resetItem,["end",deleteItem]]}makeComponentSpecificContextMenuItems(){return[]}makeForceOutputsContextMenuItem(){let withSepBefore=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const numOutputs=this.outputs._all.length;if(0===numOutputs||this.parent.mode<4)return[];const s=S.Components.Generic.contextMenu;function makeOutputItems(out){const currentForceValue=out.forceValue,items2=[void 0,Unknown,!0,!1,HighImpedance].map((newForceValue=>MenuData.item(currentForceValue===newForceValue?"check":"none",(()=>{switch(newForceValue){case void 0:return s.NormalOutput;case Unknown:return s.ForceAsUnknown;case!0:return s.ForceAs1;case!1:return s.ForceAs0;case HighImpedance:return s.ForceAsZ}})(),(()=>{out.forceValue=newForceValue}))));return items2.splice(1,0,MenuData.sep()),items2}__name(makeOutputItems,"makeOutputItems");const footerItems=[MenuData.sep(),MenuData.text(s.ForceOutputDesc)],items=[];return withSepBefore&&items.push(["mid",MenuData.sep()]),1===numOutputs?items.push(["mid",MenuData.submenu("force",s.ForceOutputSingle,[...makeOutputItems(this.outputs._all[0]),...footerItems])]):items.push(["mid",MenuData.submenu("force",s.ForceOutputMultiple,[...this.outputs._all.map((out=>{const icon=void 0!==out.forceValue?"force":"none";return MenuData.submenu(icon,s.Output+" "+out.fullName,makeOutputItems(out))})),...footerItems])]),items}makeSetNameContextMenuItem(currentName,handler){const s=S.Components.Generic.contextMenu,caption=void 0===currentName?s.SetName:s.ChangeName;return MenuData.item("pen",caption,(()=>this.runSetNameDialog(currentName,handler)),"↩︎")}runSetNameDialog(currentName,handler){const currentDisplayName=void 0===currentName||isString(currentName)?currentName:import_json52.default.stringify(currentName),promptReturnValue=window.prompt(S.Components.Generic.contextMenu.SetNamePrompt,currentDisplayName);if(null!==promptReturnValue){let newName;if(0===promptReturnValue.length)newName=void 0;else try{const parsedValue=import_json52.default.parse(promptReturnValue);newName=isDynamicName(parsedValue)?parsedValue:promptReturnValue}catch(e){newName=promptReturnValue}handler(newName)}}runSetFontDialog(currentFont,defaultIfEmpty,callback){const s=S.Components.Generic.contextMenu,promptReturnValue=window.prompt(s.SetFontPrompt[0]+defaultIfEmpty+s.SetFontPrompt[1],currentFont===defaultIfEmpty?"":currentFont);if(null!==promptReturnValue){callback(0===promptReturnValue.length?defaultIfEmpty:promptReturnValue)}}};__name(ComponentBase,"ComponentBase");var ParametrizedComponentBase=class extends ComponentBase{constructor(parent,_ref7,saved){let[instance,def]=_ref7;super(parent,instance,saved),this._defP=def}makeChangeParamsContextMenuItem(icon,_ref8,currentValue,fieldName,values){let[caption,itemCaption]=_ref8;const makeChangeValueItem=__name((val=>{const isCurrent=currentValue===val,icon2=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>{this.replaceWithNewParams({[fieldName]:val})};return MenuData.item(icon2,itemCaption.expand({val:val}),action)}),"makeChangeValueItem");return void 0===values&&(values=this._defP.paramDefs[fieldName].range),["mid",MenuData.submenu(icon,caption,values.map(makeChangeValueItem))]}makeChangeBooleanParamsContextMenuItem(caption,currentValue,fieldName){const icon=currentValue?"check":"none";return["mid",MenuData.item(icon,caption,(()=>{this.replaceWithNewParams({[fieldName]:!currentValue})}))]}replaceWithNewParams(newParams){const newRepr={...this.toNodelessJSON(),...newParams},newComp=this._defP.makeFromJSON(this.parent,newRepr);if(void 0!==newComp)return this.replaceWithComponent(newComp);console.warn("Could not create component variant")}keyDown(e){"+"===e.key?this.tryChangeParam(0,!0):"-"===e.key?this.tryChangeParam(0,!1):"*"===e.key?this.tryChangeParam(1,!0):"/"===e.key?this.tryChangeParam(1,!1):super.keyDown(e)}tryChangeParam(paramIndex,increase){const params=Object.keys(this._defP.defaultParams);if(paramIndex>=params.length)return;const paramName=params[paramIndex];let currentParamValue=this.toJSON()[paramName];const paramDef=this._defP.paramDefs[paramName];let newParamValue;if(void 0===currentParamValue&&(currentParamValue=paramDef.defaultValue),isNumber(currentParamValue)){if(newParamValue=paramDef.nextValue(currentParamValue,increase),void 0===newParamValue||newParamValue===currentParamValue)return}else isBoolean(currentParamValue)&&(newParamValue=!currentParamValue);if(void 0===newParamValue)return;const newComp=this.replaceWithNewParams({[paramName]:newParamValue});void 0!==newComp&&this.parent.editor.eventMgr.setCurrentComponentUnderPointer(newComp)}};function group(orient,nodes){return FixedArrayMap(nodes,(_ref9=>{let[x,y,name2,opts]=_ref9;return[x,y,orient,name2,opts]}))}function groupVertical(orient,x,yCenter,num,spacing,opts){const spacing_=null!=spacing?spacing:useCompact(num)?1:2,yTop=yCenter-(num-1)*spacing_/2;return group(orient,ArrayFillUsing((i2=>[x,yTop+i2*spacing_,void 0,opts]),num))}function groupVerticalMulti(orient,x,yCenter,numOuter,numInner){const innerSpacing=useCompact(1===numInner?numOuter:numInner)?1:2,groupSpacing=1===numInner?innerSpacing:2*innerSpacing,groupOffset=(numInner-1)*innerSpacing+groupSpacing,yTop=yCenter-(numOuter*(numInner-1)*innerSpacing+(numOuter-1)*groupSpacing)/2;return ArrayFillUsing((g=>group(orient,ArrayFillUsing((i2=>[x,yTop+g*groupOffset+i2*innerSpacing]),numInner))),numOuter)}function groupHorizontal(orient,xCenter,y,num,spacing,opts){const spacing_=null!=spacing?spacing:useCompact(num)?1:2,xRight=xCenter+(num-1)*spacing_/2;return group(orient,ArrayFillUsing((i2=>[xRight-i2*spacing_,y,void 0,opts]),num))}function makeComponentRepr(type7,hasIn,hasOut,props){return t5.intersection([t5.type({type:t5.string,...props}),ComponentRepr(hasIn,hasOut)],type7)}__name(ParametrizedComponentBase,"ParametrizedComponentBase"),__name(group,"group"),__name(groupVertical,"groupVertical"),__name(groupVerticalMulti,"groupVerticalMulti"),__name(groupHorizontal,"groupHorizontal"),__name(makeComponentRepr,"makeComponentRepr");var ComponentDef=class{constructor(type7,idPrefix,aults,size,_buttonProps,_initialValue,makeNodes,repr){this.type=type7,this.idPrefix=idPrefix,this.aults=aults,this.size=size,this._buttonProps=_buttonProps,this._initialValue=_initialValue,this.impl=void 0;const nodes=makeNodes(size,aults);this.nodeRecs=nodes;const hasIn="ins"in nodes,hasOut="outs"in nodes;this.repr=makeComponentRepr(type7,hasIn,hasOut,null!=repr?repr:{})}isValid(){return void 0!==this.impl}initialValue(saved){return this._initialValue(saved,this.aults)}button(visual,options){return{type:this.type,visual:visual,width:this._buttonProps.imgWidth,...options}}make(parent){const comp=new this.impl(parent);return parent.components.add(comp),comp}makeFromJSON(parent,data2){var _a;const validated=validateJson(data2,this.repr,null!=(_a=this.impl.name)?_a:"component");if(void 0===validated)return;const comp=new this.impl(parent,validated);return parent.components.add(comp),comp}};function defineComponent(type7,_ref10){let{idPrefix:idPrefix,button:button2,repr:repr,valueDefaults:valueDefaults,size:size,makeNodes:makeNodes,initialValue:initialValue}=_ref10;return new ComponentDef(type7,idPrefix,valueDefaults,size,button2,null!=initialValue?initialValue:()=>{},makeNodes,repr)}function defineAbstractComponent(items){return{...items,aults:items.valueDefaults}}__name(ComponentDef,"ComponentDef"),__name(defineComponent,"defineComponent"),__name(defineAbstractComponent,"defineAbstractComponent");var ParamDef=class{constructor(defaultValue,range,isAllowed){this.defaultValue=defaultValue,this.range=range,this.isAllowed=isAllowed}validate(n,context){return this.isAllowed(n)?n:(console.warn("Using default value ".concat(this.defaultValue," for ").concat(context," instead of invalid value ").concat(n,"; allowed values are: ").concat(this.range.join(", "))),this.defaultValue)}nextValue(value,increase){const i2=this.range.indexOf(value);if(-1===i2)return this.defaultValue;const j=i2+(increase?1:-1);return j<0||j>=this.range.length?void 0:this.range[j]}};function param(defaultValue,range){return void 0===range?new ParamDef(defaultValue,[],(()=>!0)):new ParamDef(defaultValue,range,(val=>range.includes(val)))}function paramBool(){return new ParamDef(!1,[!1,!0],isBoolean)}function paramDefaults(defs){return Object.fromEntries(Object.entries(defs).map((_ref11=>{let[k,v]=_ref11;return[k,v.defaultValue]})))}__name(ParamDef,"ParamDef"),__name(param,"param"),__name(paramBool,"paramBool"),__name(paramDefaults,"paramDefaults");var ParametrizedComponentDef=class{constructor(type7,idPrefix,hasIn,hasOut,variantName,_buttonProps,repr,valueDefaults,paramDefs,size,_makeNodes,_initialValue,_validateParams){this.type=type7,this.idPrefix=idPrefix,this.variantName=variantName,this._buttonProps=_buttonProps,this.paramDefs=paramDefs,this.size=size,this._makeNodes=_makeNodes,this._initialValue=_initialValue,this._validateParams=_validateParams,this.impl=void 0,this.defaultParams=paramDefaults(paramDefs),this.aults={...valueDefaults,...this.defaultParams},this.repr=makeComponentRepr(type7,hasIn,hasOut,null!=repr?repr:{})}isValid(){return void 0!==this.impl}with(params){const size=this.size(params),nodes=this._makeNodes({...size,...params},this.aults);return[{type:this.type,idPrefix:this.idPrefix,size:size,nodeRecs:nodes,initialValue:saved=>this._initialValue(saved,params),makeFromJSON:this.makeFromJSON.bind(this)},this]}button(params,visual,options){return{type:this.type,params:defParams(this,params),visual:visual,width:this._buttonProps.imgWidth,...options}}make(parent,params){const fullParams=void 0===params?this.defaultParams:mergeWhereDefined(this.defaultParams,params),resolvedParams=this.doValidate(fullParams,void 0),comp=new this.impl(parent,resolvedParams);return parent.components.add(comp),comp}makeFromJSON(parent,data2){var _a;const validated=validateJson(data2,this.repr,null!=(_a=this.impl.name)?_a:"component");if(void 0===validated)return;const fullParams=mergeWhereDefined(this.defaultParams,validated),resolvedParams=this.doValidate(fullParams,validated.type),comp=new this.impl(parent,resolvedParams,validated);return parent.components.add(comp),comp}doValidate(fullParams,jsonType){var _a,_b;const className=null!=(_b=null==(_a=this.impl)?void 0:_a.name)?_b:"component";return fullParams=Object.fromEntries(Object.entries(this.paramDefs).map((_ref12=>{let[paramName,paramDef]=_ref12;var _a2;const paramValue=null!=(_a2=fullParams[paramName])?_a2:paramDef.defaultValue;if("type"===paramName)return[paramName,paramValue];return[paramName,paramDef.validate(paramValue,"".concat(className,".").concat(paramName))]}))),this._validateParams(fullParams,jsonType,this.paramDefs)}};function defineParametrizedComponent(type7,hasIn,hasOut,_ref13){let{variantName:variantName,idPrefix:idPrefix,button:button2,repr:repr,valueDefaults:valueDefaults,params:params,validateParams:validateParams,size:size,makeNodes:makeNodes,initialValue:initialValue}=_ref13;return new ParametrizedComponentDef(type7,idPrefix,hasIn,hasOut,variantName,button2,repr,valueDefaults,params,size,makeNodes,initialValue,null!=validateParams?validateParams:params2=>params2)}function defParams(def,params){return{def:def,params:params}}function defineAbstractParametrizedComponent(items){return items}__name(ParametrizedComponentDef,"ParametrizedComponentDef"),__name(defineParametrizedComponent,"defineParametrizedComponent"),__name(defParams,"defParams"),__name(defineAbstractParametrizedComponent,"defineAbstractParametrizedComponent");var GRID_STEP=10,WAYPOINT_DIAMETER=8,WAYPOINT_HIT_RADIUS_SQUARED=(WAYPOINT_DIAMETER/2+6)**2,WAYPOINT_HIT_RADIUS_SQUARED_TOLERANT=(WAYPOINT_DIAMETER/2+10)**2;function pxToGrid(x){return Math.round(x/GRID_STEP)}function distSquared(x0,y0,x1,y1){const dx=x1-x0,dy=y1-y0;return dx*dx+dy*dy}function inRect(centerX,centerY,width,height,pointX,pointY){const w2=width/2,h2=height/2;return pointX>=centerX-w2&&pointX<centerX+w2&&pointY>=centerY-h2&&pointY<centerY+h2}__name(pxToGrid,"pxToGrid"),__name(distSquared,"distSquared"),__name(inRect,"inRect");var DrawingRect=class{constructor(comp,honorRotation){this.width=comp.unrotatedWidth,this.height=comp.unrotatedHeight;honorRotation&&Orientation.isVertical(comp.orient)&&([this.width,this.height]=[this.height,this.width]),this.top=comp.posY-this.height/2,this.left=comp.posX-this.width/2,this.bottom=this.top+this.height,this.right=this.left+this.width}outline(g){let margin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const path=g.createPath();return path.rect(this.left-margin,this.top-margin,this.width+2*margin,this.height+2*margin),path}};__name(DrawingRect,"DrawingRect");var COLOR_BACKGROUND,COLOR_OFF_BACKGROUND,COLOR_BACKGROUND_UNUSED_REGION,COLOR_BACKGROUND_INVALID,COLOR_BORDER,COLOR_GRID_LINES,COLOR_GRID_LINES_GUIDES,COLOR_LABEL_OFF,COLOR_LABEL_ON,COLORCOMP_COMPONENT_BORDER,COLOR_COMPONENT_BORDER,COLOR_COMPONENT_INNER_LABELS,COLOR_COMPONENT_ID,COLOR_GROUP_SPAN,COLOR_WIRE_BORDER,COLOR_MOUSE_OVER,COLOR_MOUSE_OVER_NORMAL,COLOR_MOUSE_OVER_DANGER,COLOR_NODE_MOUSE_OVER,COLORCOMPS_FULL,COLOR_FULL,COLOR_FULL_ALT,COLOR_DARK_RED,COLORCOMPS_EMPTY,COLOR_EMPTY,COLOR_EMPTY_ALT,COLOR_UNKNOWN,COLOR_UNKNOWN_ALT,COLOR_HIGH_IMPEDANCE,COLOR_ANCHOR_IN,COLOR_ANCHOR_OUT,COLOR_ANCHOR_NEW,COLOR_GATE_NAMES,COLOR_LED_ON,COLOR_WIRE,COLOR_RECTANGLE_BACKGROUND,COLOR_RECTANGLE_BORDER,PATTERN_STRIPED_GRAY,DrawZIndex={Background:0,Normal:1,Overlay:2},USER_COLORS={COLOR_BACKGROUND:void 0},_currentModeIsDark=!1;function setDarkMode(darkMode,force){if(force||darkMode!==_currentModeIsDark){doSetColors(darkMode);for(const editor of LogicEditor.allConnectedEditors)editor.wrapHandler((()=>{editor.setDark(darkMode),editor.editTools.redrawMgr.requestRedraw({why:"dark/light mode switch"})}))()}}function isDarkMode(){return _currentModeIsDark}function doSetColors(darkMode){var _a;darkMode?(COLOR_BACKGROUND=null!=(_a=USER_COLORS.COLOR_BACKGROUND)?_a:ColorString2(30),COLOR_OFF_BACKGROUND=ColorString2(60),COLOR_BACKGROUND_INVALID=ColorString2([168,20,20]),COLOR_BACKGROUND_UNUSED_REGION=ColorString2(55),COLOR_BORDER=ColorString2(85),COLOR_GRID_LINES=ColorString2(30),COLOR_GRID_LINES_GUIDES=ColorString2(45),COLOR_LABEL_OFF=ColorString2(185),COLOR_LABEL_ON=COLOR_BACKGROUND,COLORCOMP_COMPONENT_BORDER=220,COLOR_COMPONENT_INNER_LABELS=ColorString2(139),COLOR_COMPONENT_ID=ColorString2([0,0,150]),COLOR_GROUP_SPAN=ColorString2([128,128,128,.13]),COLOR_WIRE_BORDER=ColorString2(175),COLOR_MOUSE_OVER_NORMAL=ColorString2([0,123,255]),COLOR_MOUSE_OVER_DANGER=ColorString2([194,34,14]),COLOR_NODE_MOUSE_OVER=ColorString2([128,128,128,.5]),COLORCOMPS_FULL=[255,193,7],COLOR_DARK_RED=ColorString2([180,0,0]),COLORCOMPS_EMPTY=[80,89,99],COLOR_UNKNOWN=ColorString2([108,106,98]),COLOR_HIGH_IMPEDANCE=ColorString2([103,84,23]),COLOR_GATE_NAMES=ColorString2([95,95,95]),COLOR_LED_ON={green:ColorString2([11,144,11]),red:ColorString2([144,11,11]),yellow:ColorString2([144,144,11])},COLOR_WIRE={black:COLOR_WIRE_BORDER,red:ColorString2([206,63,57]),blue:ColorString2([77,102,153]),yellow:ColorString2([245,209,63]),green:ColorString2([87,136,97]),white:ColorString2([230,217,199])},PATTERN_STRIPED_GRAY=createStripedPattern(COLOR_BACKGROUND,"rgba(128,128,128,0.4)")):(COLOR_BACKGROUND=ColorString2(255),COLOR_OFF_BACKGROUND=ColorString2(223),COLOR_BACKGROUND_INVALID=ColorString2([255,187,187]),COLOR_BACKGROUND_UNUSED_REGION=ColorString2(238),COLOR_BORDER=ColorString2(200),COLOR_GRID_LINES=ColorString2(240),COLOR_GRID_LINES_GUIDES=ColorString2(215),COLOR_LABEL_OFF=ColorString2(255),COLOR_LABEL_ON=ColorString2(0),COLORCOMP_COMPONENT_BORDER=0,COLOR_COMPONENT_INNER_LABELS=ColorString2(170),COLOR_COMPONENT_ID=ColorString2([50,50,250]),COLOR_GROUP_SPAN=ColorString2([128,128,128,.13]),COLOR_WIRE_BORDER=ColorString2(80),COLOR_MOUSE_OVER_NORMAL=ColorString2([0,123,255]),COLOR_MOUSE_OVER_DANGER=ColorString2([194,34,14]),COLOR_NODE_MOUSE_OVER=ColorString2([128,128,128,.5]),COLORCOMPS_FULL=[255,193,7],COLOR_DARK_RED=ColorString2([180,0,0]),COLORCOMPS_EMPTY=[52,58,64],COLOR_UNKNOWN=ColorString2([152,158,164]),COLOR_HIGH_IMPEDANCE=ColorString2([137,114,35]),COLOR_GATE_NAMES=ColorString2([190,190,190]),COLOR_LED_ON={green:ColorString2([20,232,20]),red:ColorString2([232,20,20]),yellow:ColorString2([232,232,20])},COLOR_WIRE={black:COLOR_WIRE_BORDER,red:ColorString2([206,63,57]),blue:ColorString2([77,102,153]),yellow:ColorString2([245,209,63]),green:ColorString2([87,136,97]),white:ColorString2([230,217,199])},PATTERN_STRIPED_GRAY=createStripedPattern(COLOR_BACKGROUND,"rgba(128,128,128,0.2)")),COLOR_RECTANGLE_BACKGROUND={yellow:ColorString2([230,230,0,.2]),blue:ColorString2([54,54,255,.2]),green:ColorString2([54,255,54,.2]),red:ColorString2([255,54,54,.2]),grey:ColorString2([120,120,120,.2]),turquoise:ColorString2([0,210,210,.2])},COLOR_RECTANGLE_BORDER={yellow:ColorString2([196,196,0,.5]),blue:ColorString2([115,115,255,.5]),green:ColorString2([0,167,0,.5]),red:ColorString2([214,0,0,.5]),grey:ColorString2([35,35,35,.5]),turquoise:ColorString2([0,162,162,.5])},COLOR_COMPONENT_BORDER=ColorString2(COLORCOMP_COMPONENT_BORDER),setColorPointerOverIsDanger(!1),COLOR_FULL=ColorString2(COLORCOMPS_FULL),COLOR_EMPTY=ColorString2(COLORCOMPS_EMPTY),COLOR_FULL_ALT=ligherColor(COLOR_FULL,40),COLOR_EMPTY_ALT=ligherColor(COLOR_EMPTY,80),COLOR_UNKNOWN_ALT=ligherColor(COLOR_UNKNOWN,50),COLOR_ANCHOR_IN=ColorString2([200,100,100,.5]),COLOR_ANCHOR_OUT=ColorString2([100,100,200,.5]),COLOR_ANCHOR_NEW=ColorString2([100,100,100,.5]),_currentModeIsDark=darkMode}function createStripedPattern(background,stripeColor){if(!InBrowser)return null;const canvas2=document.createElement("canvas");canvas2.width=8,canvas2.height=24;const g=canvas2.getContext("2d");g.fillStyle=background,g.fillRect(0,0,canvas2.width,canvas2.height),g.fillStyle=stripeColor,g.beginPath(),g.moveTo(4,0),g.lineTo(canvas2.width,0),g.lineTo(0,canvas2.height),g.lineTo(0,12),g.closePath(),g.moveTo(4,canvas2.height),g.lineTo(canvas2.width,canvas2.height),g.lineTo(canvas2.width,12),g.closePath(),g.fill();const pattern=g.createPattern(canvas2,"repeat");return null===pattern&&console.warn("Failed to create pattern"),pattern}function setColorPointerOverIsDanger(mouseOverIsDanger){COLOR_MOUSE_OVER=mouseOverIsDanger?COLOR_MOUSE_OVER_DANGER:COLOR_MOUSE_OVER_NORMAL}function ColorString2(input2){return isArray(input2)?3===input2.length?"rgb(".concat(input2[0],",").concat(input2[1],",").concat(input2[2],")"):"rgba(".concat(input2[0],",").concat(input2[1],",").concat(input2[2],",").concat(input2[3],")"):"rgb(".concat(input2,",").concat(input2,",").concat(input2,")")}function colorCompsRGB(c){c.startsWith("rgb(")&&(c=c.substring("rgb(".length));c.endsWith(")")&&(c=c.substring(0,c.length-")".length));return FixedArrayAssert(c.split(",").map((compStr=>parseInt(compStr))),3)}function ligherColor(col,offset2){return ColorString2(FixedArrayAssert(colorCompsRGB(col).map((c=>Math.min(255,c+offset2))),3))}function colorForLogicValue(value){return isUnknown(value)?COLOR_UNKNOWN:isHighImpedance(value)?COLOR_HIGH_IMPEDANCE:value?COLOR_FULL:COLOR_EMPTY}function colorsForLogicValue(value){return isUnknown(value)?[COLOR_UNKNOWN,COLOR_UNKNOWN_ALT]:isHighImpedance(value)?[COLOR_HIGH_IMPEDANCE,COLOR_HIGH_IMPEDANCE]:value?[COLOR_FULL,COLOR_FULL_ALT]:[COLOR_EMPTY,COLOR_EMPTY_ALT]}function colorForFraction(fraction){return ColorString2([(COLORCOMPS_FULL[0]-COLORCOMPS_EMPTY[0])*fraction+COLORCOMPS_EMPTY[0],(COLORCOMPS_FULL[1]-COLORCOMPS_EMPTY[1])*fraction+COLORCOMPS_EMPTY[1],(COLORCOMPS_FULL[2]-COLORCOMPS_EMPTY[2])*fraction+COLORCOMPS_EMPTY[2]])}function parseColorToRGBA(col){const canvas2=document.createElement("canvas");canvas2.width=canvas2.height=1;const ctx=canvas2.getContext("2d");ctx.clearRect(0,0,1,1),ctx.fillStyle="#000",ctx.fillStyle=col;const computed=ctx.fillStyle;if(ctx.fillStyle="#fff",ctx.fillStyle=col,computed===ctx.fillStyle)return ctx.fillRect(0,0,1,1),FixedArrayAssert([...ctx.getImageData(0,0,1,1).data],4)}doSetColors(_currentModeIsDark),__name(setDarkMode,"setDarkMode"),__name(isDarkMode,"isDarkMode"),__name(doSetColors,"doSetColors"),__name(createStripedPattern,"createStripedPattern"),__name(setColorPointerOverIsDanger,"setColorPointerOverIsDanger"),__name(ColorString2,"ColorString"),__name(colorCompsRGB,"colorCompsRGB"),__name(ligherColor,"ligherColor"),__name(colorForLogicValue,"colorForLogicValue"),__name(colorsForLogicValue,"colorsForLogicValue"),__name(colorForFraction,"colorForFraction"),__name(parseColorToRGBA,"parseColorToRGBA");var _cachedAscents=new Map;function fontAscentHalf(g){const font=g.font;let halfAscent=_cachedAscents.get(font);return void 0===halfAscent&&(halfAscent=Math.ceil(g.measureText("0").actualBoundingBoxAscent-1)/2,_cachedAscents.set(font,halfAscent)),halfAscent}__name(fontAscentHalf,"fontAscentHalf");var TextVAlign_bottom=0,TextVAlign_middle=1,TextVAlign_top=2;function strokeTextVAlign(g,valign,text,x,y){g.strokeText(text,x,y+valign*fontAscentHalf(g))}function fillTextVAlign(g,valign,text,x,y){g.fillText(text,x,y+valign*fontAscentHalf(g))}function useCompact(numNodes){return numNodes>=5}__name(strokeTextVAlign,"strokeTextVAlign"),__name(fillTextVAlign,"fillTextVAlign"),__name(useCompact,"useCompact");var trivialNameMatcher=/^(In|Out|in|out)\d*$/;function isTrivialNodeName(name2){return void 0===name2||trivialNameMatcher.test(name2)}function triangle(g,x0,y0,x1,y1,x2,y2){g.moveTo(x0,y0),g.lineTo(x1,y1),g.lineTo(x2,y2),g.closePath()}function circle(g,cx,cy,d){const r=d/2;g.ellipse(cx,cy,r,r,0,0,2*Math.PI)}function strokeSingleLine(g,x0,y0,x1,y1){g.beginPath(),g.moveTo(x0,y0),g.lineTo(x1,y1),g.stroke()}function shouldDrawLeadsTo(nodes){return nodes.map(whatToDrawForNode).some((x=>x.drawLead))}function whatToDrawForNode(node){const editor=node.parent.editor,wires=node.connectedWires,connected=wires.length>0;if(editor.mode<=1&&!connected&&!editor.options.showDisconnectedPins)return{drawLabel:!1,drawLead:!1,drawTriangle:!1,drawHiddenMark:!1};const drawHiddenMark=connected&&wires.some((w=>w.isHidden));return{drawLabel:!0,drawLead:!connected||drawHiddenMark,drawTriangle:node.hasTriangle,drawHiddenMark:drawHiddenMark}}function shouldDrawNodeLabel(nodeOrArray){if(isArray(nodeOrArray))return nodeOrArray.map(whatToDrawForNode).some((x=>x.drawLabel));return whatToDrawForNode(nodeOrArray).drawLabel}function drawWireLineToComponent(g,node){const{drawLead:drawLead,drawTriangle:drawTriangle,drawHiddenMark:drawHiddenMark}=whatToDrawForNode(node),[x1,y1,x0,y0]=node.drawCoordsInParentTransform;if(drawLead){const neutral=node.parent.editor.options.hideWireColors;drawStraightWireLine(g,x0,y0,x1,y1,node.value,node.color,neutral,void 0)}if(drawTriangle){if(g.strokeStyle=COLOR_COMPONENT_BORDER,g.fillStyle=COLOR_COMPONENT_BORDER,g.beginPath(),x0===x1){if(node.isOutput()&&y1<=y0||!node.isOutput()&&y0<=y1){const shift=node.isOutput()?1:0;triangle(g,x1-3,y1-2+shift,x1+3,y1-2+shift,x1,y1+1+shift)}else{const shift=node.isOutput()?-3:-4;triangle(g,x1-3,y1-2-shift,x1+3,y1-2-shift,x1,y1-5-shift)}}else if(y0===y1){const shift=node.isOutput()?1:0;node.isOutput()&&x1<=x0||!node.isOutput()&&x0<=x1?triangle(g,x1-2+shift,y1-3,x1-2+shift,y1+3,x1+1+shift,y1):triangle(g,x1+2-shift,y1-3,x1+2-shift,y1+3,x1-1-shift,y1)}else console.log("ERROR  wireLineToComponent cannot draw triangle as line is not vertical or horizontal between (".concat(x0,", ").concat(y0,") and (").concat(x1,", ").concat(y1,")"));g.lineWidth=2,g.fill(),g.stroke()}drawHiddenMark&&(g.lineWidth=2,g.strokeStyle=COLOR_WIRE[node.color],g.beginPath(),Orientation.isVertical(node.orient)?(g.moveTo(x0+5,y0+1.5),g.lineTo(x0-5,y0-1.5)):(g.moveTo(x0+1.5,y0-5),g.lineTo(x0-1.5,y0+5)),g.stroke())}function drawStraightWireLine(g,x0,y0,x1,y1,value,color,neutral,timeFraction){g.beginPath(),g.moveTo(x0,y0),g.lineTo(x1,y1),strokeWireOutlineAndSingleValue(g,value,color,neutral,timeFraction)}function strokeWireOutlineAndSingleValue(g,value,color,neutral,timeFraction){strokeWireOutline(g,color,!1),strokeWireValue(g,value,void 0,neutral,timeFraction)}function strokeWireOutline(g,color,isMouseOver){const oldLineCap=g.lineCap;g.lineCap="butt";isMouseOver?(g.lineWidth=6,g.strokeStyle=COLOR_MOUSE_OVER):(g.lineWidth=4,g.strokeStyle=COLOR_WIRE[color]),g.stroke(),g.lineCap=oldLineCap}function strokeWireValue(g,value,lengthToDrawAndTotal,neutral,timeFraction){const oldLineCap=g.lineCap;g.lineCap="butt",g.lineWidth=2;const[baseColor,altColor]=neutral?[COLOR_UNKNOWN,COLOR_UNKNOWN_ALT]:colorsForLogicValue(value);g.strokeStyle=baseColor;if(void 0!==lengthToDrawAndTotal){const[lengthToDraw,totalLength]=lengthToDrawAndTotal;g.setLineDash([lengthToDraw,totalLength]),g.stroke(),g.setLineDash([])}else void 0===timeFraction?g.stroke():(g.setLineDash([20,20]),g.lineDashOffset=20*-timeFraction*2,g.stroke(),g.strokeStyle=altColor,g.lineDashOffset+=20,g.stroke(),g.lineDashOffset=0,g.setLineDash([]));g.lineCap=oldLineCap}function distSquaredToWaypointIfOver(x,y,waypointX,waypointY,moreTolerant){const distSq=distSquared(x,y,waypointX,waypointY);if(distSq<(moreTolerant?WAYPOINT_HIT_RADIUS_SQUARED_TOLERANT:WAYPOINT_HIT_RADIUS_SQUARED))return distSq}function drawWaypoint(g,ctx,x,y,style2,value,isMouseOver,neutral,showForced,showForcedWarning,parentOrientIsVertical){const[circleColor,thickness]=showForced?[COLOR_DARK_RED,3]:[COLOR_WIRE_BORDER,1];g.strokeStyle=circleColor,g.lineWidth=thickness,g.fillStyle=1===style2?COLOR_BACKGROUND:neutral?COLOR_UNKNOWN:colorForLogicValue(value),g.beginPath(),circle(g,x,y,WAYPOINT_DIAMETER),g.fill(),g.stroke(),isMouseOver&&(g.fillStyle=COLOR_NODE_MOUSE_OVER,g.beginPath(),circle(g,x,y,2*WAYPOINT_DIAMETER),g.fill(),g.stroke()),showForcedWarning&&(g.textAlign="center",g.fillStyle=circleColor,g.font="bold 14px sans-serif",ctx.inNonTransformedFrame((ctx2=>{fillTextVAlign(g,TextVAlign_middle,"!!",...ctx2.rotatePoint(x+(parentOrientIsVertical?13:0),y+(parentOrientIsVertical?0:-13)))})))}function drawClockInput(g,left2,clockNode,trigger){const clockY=clockNode.posYInParentTransform;g.strokeStyle=COLOR_COMPONENT_BORDER,g.lineWidth=2,g.beginPath(),g.moveTo(left2+1,clockY-4),g.lineTo(left2+9,clockY),g.lineTo(left2+1,clockY+4),g.stroke(),trigger===EdgeTrigger.falling&&(g.fillStyle=COLOR_COMPONENT_BORDER,g.closePath(),g.fill()),drawWireLineToComponent(g,clockNode)}function drawLabel(ctx,compOrient,text,anchor,x,y,referenceNode){if(void 0===text)return;void 0===referenceNode&&(isNumber(x)?isNumber(y)||(referenceNode=y):referenceNode=x);let showLabel=!0;if(void 0!==referenceNode&&(showLabel=shouldDrawNodeLabel(referenceNode)),!showLabel)return;const[halign,valign,dx,dy]=(()=>{if(void 0===anchor)return["center",TextVAlign_middle,0,0];switch(Orientation.add(compOrient,anchor)){case"e":return["right",TextVAlign_middle,-3,0];case"w":return["left",TextVAlign_middle,3,0];case"n":return["center",TextVAlign_top,0,4];case"s":return["center",TextVAlign_bottom,0,-4]}})(),xx=isNumber(x)?x:(isNodeArray(x)?x.group:x).posXInParentTransform,yy=isNumber(y)?y:(isNodeArray(y)?y.group:y).posYInParentTransform,[finalX,finalY]=ctx.rotatePoint(xx,yy),g=ctx.g;g.textAlign=halign,fillTextVAlign(g,valign,text,finalX+dx,finalY+dy)}function drawValueTextCentered(g,value,comp,opts){drawValueText(g,value,comp.posX,comp.posY,opts)}function drawValueText(g,value,x,y,opts){var _a;let spec="",label2="";const small=null!=(_a=null==opts?void 0:opts.small)&&_a,fillStyle=null==opts?void 0:opts.fillStyle,sizeStrBig=small?"12":"18",sizeStrSmall=small?"10":"16";isUnknown(value)?(g.fillStyle=null!=fillStyle?fillStyle:COLOR_LABEL_OFF,spec="bold "+sizeStrBig,label2="?"):isHighImpedance(value)?(g.fillStyle=null!=fillStyle?fillStyle:COLOR_LABEL_OFF,spec=sizeStrSmall,label2="Z"):value?(g.fillStyle=null!=fillStyle?fillStyle:COLOR_LABEL_ON,spec="bold "+sizeStrBig,label2="1"):(g.fillStyle=null!=fillStyle?fillStyle:COLOR_LABEL_OFF,spec=sizeStrBig,label2="0"),g.font="".concat(spec,"px sans-serif"),g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,label2,x,y)}__name(isTrivialNodeName,"isTrivialNodeName"),__name(triangle,"triangle"),__name(circle,"circle"),__name(strokeSingleLine,"strokeSingleLine"),__name(shouldDrawLeadsTo,"shouldDrawLeadsTo"),__name(whatToDrawForNode,"whatToDrawForNode"),__name(shouldDrawNodeLabel,"shouldDrawNodeLabel"),__name(drawWireLineToComponent,"drawWireLineToComponent"),__name(drawStraightWireLine,"drawStraightWireLine"),__name(strokeWireOutlineAndSingleValue,"strokeWireOutlineAndSingleValue"),__name(strokeWireOutline,"strokeWireOutline"),__name(strokeWireValue,"strokeWireValue"),__name(distSquaredToWaypointIfOver,"distSquaredToWaypointIfOver"),__name(drawWaypoint,"drawWaypoint"),__name(drawClockInput,"drawClockInput"),__name(drawLabel,"drawLabel"),__name(drawValueTextCentered,"drawValueTextCentered"),__name(drawValueText,"drawValueText");var NAME_POSITION_SETTINGS={right:["start",TextVAlign_middle,7],left:["end",TextVAlign_middle,9],top:["center",TextVAlign_bottom,5],bottom:["center",TextVAlign_top,5]};function textSettingsForName(onRight,orient){if(onRight)switch(orient){case"e":return NAME_POSITION_SETTINGS.right;case"w":return NAME_POSITION_SETTINGS.left;case"n":return NAME_POSITION_SETTINGS.top;case"s":return NAME_POSITION_SETTINGS.bottom}else switch(orient){case"e":return NAME_POSITION_SETTINGS.left;case"w":return NAME_POSITION_SETTINGS.right;case"n":return NAME_POSITION_SETTINGS.bottom;case"s":return NAME_POSITION_SETTINGS.top}}function drawComponentName(g,ctx,name2,value,comp,onRight){if(void 0===name2)return;let displayName;if(displayName=isString(name2)?name2:value in name2?"".concat(name2[value]):"default"in name2?"".concat(name2.default):isUnknown(value)?Unknown:void 0,void 0===displayName)return;const[hAlign,vAlign,deltaX]=textSettingsForName(onRight,comp.orient);g.fillStyle=COLOR_COMPONENT_BORDER,g.font="italic 18px sans-serif";const point=ctx.rotatePoint(comp.posX+(onRight?1:-1)*(comp.unrotatedWidth/2+deltaX),comp.posY);g.textAlign=hAlign,fillTextVAlign(g,vAlign,displayName,...point)}function drawAnchorsAroundComponent(g,comp,includeTo){const anchor=comp.anchor;if(void 0!==anchor){const color=includeTo?COLOR_ANCHOR_IN:COLOR_ANCHOR_NEW;drawAnchorTo(g,comp.posX,comp.posY,anchor.posX,anchor.posY,[anchor.width,anchor.height],color,void 0)}function drawAllTo(drawable){if(drawable instanceof ComponentBase)for(const anchoredComp of drawable.anchoredDrawables)anchoredComp instanceof Waypoint||(drawAnchorTo(g,anchoredComp.posX,anchoredComp.posY,drawable.posX,drawable.posY,[drawable.width,drawable.height],COLOR_ANCHOR_OUT,comp),drawAllTo(anchoredComp))}includeTo&&drawAllTo(comp),__name(drawAllTo,"drawAllTo")}function drawAnchorTo(g,sX,sY,tX,tY,distOrDim,color,whileDraggingComp){const[dt,[tWidth,tHeight]]=isNumber(distOrDim)?[distOrDim,[0,0]]:[10,distOrDim];if(Math.abs(sX-tX)<tWidth/2&&Math.abs(sY-tY)<tHeight/2)return;if(void 0!==whileDraggingComp){const c=whileDraggingComp;if(sX>=c.posX-c.width/2&&sX<=c.posX+c.width/2&&sY>=c.posY-c.height/2&&sY<=c.posY+c.height/2)return}let dirX=tX-sX,dirY=tY-sY;const magn=Math.sqrt(dirX*dirX+dirY*dirY);if(magn<20)return;dirX/=magn,dirY/=magn;const perpX=-dirY,st=[(sX+=0*dirX)+3*perpX,(sY+=0*dirY)+3*dirX],sb=[sX-3*perpX,sY-3*dirX],th2=[tX-=dt*dirX,tY-=dt*dirY],mt=[(tX-=20*dirX)+3*perpX,(tY-=20*dirY)+3*dirX],at=[tX+8*perpX,tY+8*dirX],mb=[tX-3*perpX,tY-3*dirX],ab=[tX-8*perpX,tY-8*dirX];g.fillStyle=color,g.beginPath(),g.moveTo(st[0],st[1]),g.lineTo(mt[0],mt[1]),g.lineTo(at[0],at[1]),g.lineTo(th2[0],th2[1]),g.lineTo(ab[0],ab[1]),g.lineTo(mb[0],mb[1]),g.lineTo(sb[0],sb[1]),g.closePath(),g.fill()}function bezierPoint(t38,coords){const u=1-t38,f1=u**3,f2=3*u**2*t38,f3=3*u*t38**2,f4=t38**3;return[f1*coords[0]+f2*coords[4]+f3*coords[6]+f4*coords[2],f1*coords[1]+f2*coords[5]+f3*coords[7]+f4*coords[3]]}function bezierExtrema(coords,forY){const di=Number(forY),start2=coords[0+di],end2=coords[2+di],c1=coords[4+di],c2=coords[6+di],a2=-3*start2+9*c1-9*c2+3*end2,b2=6*start2-12*c1+6*c2,c=-3*start2+3*c1,roots=[];let r;if(Math.abs(a2)<1e-6)Math.abs(b2)>1e-6&&(r=-c/b2)>0&&r<1&&roots.push(r);else{const discriminant=b2**2-4*a2*c;if(discriminant>=0){const sqrtD=Math.sqrt(discriminant);r=(-b2-sqrtD)/(2*a2),r>0&&r<1&&roots.push(r),r=(-b2+sqrtD)/(2*a2),r>0&&r<1&&roots.push(r)}}return roots}function bezierBoundingBox(coords,margin){const ts=[0,1,...bezierExtrema(coords,!1),...bezierExtrema(coords,!0)];let minX=1/0,maxX=-1/0,minY=1/0,maxY=-1/0;for(const t38 of ts){const[x,y]=bezierPoint(t38,coords);minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y)}return[minX-margin,minY-margin,maxX+margin,maxY+margin]}function isPointOnStraightWire(x,y,coords){const[x1,y1,x2,y2]=coords,length2=(x2-x1)**2+(y2-y1)**2;if(0===length2)return x===x1&&y===y1;const t38=((x-x1)*(x2-x1)+(y-y1)*(y2-y1))/length2;if(t38<0||t38>1)return!1;return(x-(x1+t38*(x2-x1)))**2+(y-(y1+t38*(y2-y1)))**2<=16}function makeBezierCoords(coords){const[startX,startY,endX,endY]=coords,endpointDist=Math.sqrt((endX-startX)**2+(endY-startY)**2),bezierMEta={tStepSize:1/Math.max(3,Math.ceil(endpointDist/8*1.25)),boundingBox:bezierBoundingBox(coords,4)};return[...coords,bezierMEta]}function isPointOnBezierWire(x,y,coords){const bezierMeta=coords[8],[left2,top2,right2,bottom2]=bezierMeta.boundingBox;if(x<left2||x>right2||y<top2||y>bottom2)return!1;const stepSize=bezierMeta.tStepSize;for(let t38=0;t38<=1;t38+=stepSize){const[wx,wy]=bezierPoint(t38,coords);if((wx-x)**2+(wy-y)**2<=16)return!0}return!1}function displayValuesFromArray(values,mostSignificantFirst){let binaryStringRep="",hasUnset=!1;const add=mostSignificantFirst?v=>binaryStringRep+=v:v=>binaryStringRep=v+binaryStringRep;for(const value2 of values)isUnknown(value2)||isHighImpedance(value2)?(hasUnset=!0,add(value2)):add(+value2);const value=hasUnset?Unknown:parseInt(binaryStringRep,2);return[binaryStringRep,value]}function formatWithRadix(value,radix,numBits){let withPrefix=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(isUnknown(value))return Unknown;if(-10===radix){const asBinStr=(value>>>0).toString(2).padStart(numBits,"0");if("1"===asBinStr[0]){const rest=parseInt(asBinStr.substring(1),2);return"–"+String(-(-Math.pow(2,numBits-1)+rest))}return String(value)}{const padWidth=10===radix?1:Math.ceil(Math.log(Math.pow(2,numBits))/Math.log(radix)),caption=value.toString(radix).toUpperCase().padStart(padWidth,"0");return(withPrefix?(()=>{switch(radix){case 16:return"0x";case 8:return"0o";case 2:return"0b";default:return""}})():"")+caption}}__name(textSettingsForName,"textSettingsForName"),__name(drawComponentName,"drawComponentName"),__name(drawAnchorsAroundComponent,"drawAnchorsAroundComponent"),__name(drawAnchorTo,"drawAnchorTo"),__name(bezierPoint,"bezierPoint"),__name(bezierExtrema,"bezierExtrema"),__name(bezierBoundingBox,"bezierBoundingBox"),__name(isPointOnStraightWire,"isPointOnStraightWire"),__name(makeBezierCoords,"makeBezierCoords"),__name(isPointOnBezierWire,"isPointOnBezierWire"),__name(displayValuesFromArray,"displayValuesFromArray"),__name(formatWithRadix,"formatWithRadix");var t6=__toESM(require_lib()),Slant={none:"none",up:"up",down:"down"},PassthroughDef=defineParametrizedComponent("pass",!0,!0,{variantName:_ref14=>{let{bits:bits}=_ref14;return"pass-".concat(bits)},idPrefix:"pass",button:{imgWidth:32},repr:{bits:typeOrUndefined(t6.number),slant:typeOrUndefined(t6.keyof(Slant))},valueDefaults:{slant:Slant.none},params:{bits:param(1,[1,2,3,4,8,16])},validateParams:_ref15=>{let{bits:bits}=_ref15;return{numBits:bits}},size:_ref16=>{let{numBits:numBits}=_ref16;return{gridWidth:2,gridHeight:useCompact(numBits)?numBits:2*numBits}},makeNodes:_ref17=>{let{numBits:numBits}=_ref17;return{ins:{In:groupVertical("w",-1,0,numBits,void 0,{leadLength:10})},outs:{Out:groupVertical("e",1,0,numBits,void 0,{leadLength:10})}}},initialValue:(saved,_ref18)=>{let{numBits:numBits}=_ref18;return ArrayFillWith(!1,numBits)}}),Passthrough=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a;super(parent,PassthroughDef.with(params),saved),this.numBits=params.numBits,this._hShift=[0,0],this._slant=null!=(_a=null==saved?void 0:saved.slant)?_a:PassthroughDef.aults.slant,this.updateNodeOffsets()}toJSON(){return{...this.toJSONBase(),bits:this.numBits===PassthroughDef.aults.bits?void 0:this.numBits,slant:this._slant===PassthroughDef.aults.slant?void 0:this._slant}}destroy(){var _a;const savedWireEnds=[];for(let i2=0;i2<this.numBits;i2++){const nodeOut=null==(_a=this.inputs.In[i2].incomingWire)?void 0:_a.startNode;if(void 0===nodeOut||!(nodeOut instanceof NodeOut))continue;const nodeIns=[];for(const wire of this.outputs.Out[i2].outgoingWires){const endNode=wire.endNode;null!==endNode&&nodeIns.push([endNode,wire.style])}nodeIns.length>0&&savedWireEnds.push([nodeOut,nodeIns])}if(super.destroy(),savedWireEnds.length>0){const linkMgr=this.parent.linkMgr;for(const[nodeOut,nodeIns]of savedWireEnds)for(const[nodeIn,style2]of nodeIns){const wire=linkMgr.addWire(nodeOut,nodeIn,!1);void 0!==wire?void 0!==style2&&wire.doSetStyle(style2):console.error("Failed to add wire back")}}}get alwaysDrawMultiOutNodes(){return!0}doRecalcValue(){return this.inputValues(this.inputs.In)}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}isOver(x,y){if(this._slant===Slant.none)return super.isOver(x,y);let yPosWithNoHOffset=0,f=0;switch(this._slant){case Slant.up:yPosWithNoHOffset=this.inputs.In[0].posY,f=-1;break;case Slant.down:yPosWithNoHOffset=this.inputs.In[this.numBits-1].posY,f=1}const deltaX=(y-yPosWithNoHOffset)*f;return super.isOver(x+deltaX,y)}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.Passthrough.tooltip)))}doDraw(g,ctx){const height=this.unrotatedHeight,top2=this.posY-height/2,bottom2=top2+height,[topShift,bottomShift]=this._hShift;for(const input2 of this.inputs._all)drawWireLineToComponent(g,input2);for(const output of this.outputs._all)drawWireLineToComponent(g,output);g.beginPath(),g.moveTo(this.posX+topShift,top2),g.lineTo(this.posX+bottomShift,bottom2),ctx.isMouseOver?(g.lineWidth=11,g.strokeStyle=COLOR_NODE_MOUSE_OVER,g.stroke(),g.strokeStyle=COLOR_COMPONENT_BORDER):g.strokeStyle=COLOR_UNKNOWN,this.parent.mode>=2&&(g.lineWidth=3,g.stroke())}makeComponentSpecificContextMenuItems(){if(1===this.numBits)return[];const s=S.Components.Passthrough.contextMenu,makeItemSetSlant=__name(((desc,slant)=>{const isCurrent=this._slant===slant,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>this.doSetSlant(slant);return MenuData.item(icon,desc,action)}),"makeItemSetSlant");return[["mid",MenuData.submenu("slanted",s.Slant,[makeItemSetSlant(s.SlantNone,Slant.none),MenuData.sep(),makeItemSetSlant(s.SlantRight,Slant.down),makeItemSetSlant(s.SlantLeft,Slant.up)])],["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("inputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits")]}doSetSlant(slant){this._slant=slant,this.updateNodeOffsets(),this.requestRedraw({why:"slant changed",invalidateMask:!0})}updateNodeOffsets(){const n=this.numBits;switch(this._slant){case"none":for(let i2=0;i2<n;i2++)this.inputs.In[i2].gridOffsetX=-1,this.outputs.Out[i2].gridOffsetX=1;this._hShift=[0,0];break;case"down":{const f=n>4?1:2;for(let i2=0;i2<n;i2++){const shift=f*(n-1-i2);this.inputs.In[i2].gridOffsetX=-1+shift,this.outputs.Out[i2].gridOffsetX=1+shift}this._hShift=[f*(n-.5)*GRID_STEP,-f*GRID_STEP/2];break}case"up":{const f=n>4?1:2;for(let i2=0;i2<n;i2++){const shift=f*i2;this.inputs.In[i2].gridOffsetX=-1+shift,this.outputs.Out[i2].gridOffsetX=1+shift}this._hShift=[-f*GRID_STEP/2,f*(n-.5)*GRID_STEP];break}}}};__name(Passthrough,"Passthrough"),PassthroughDef.impl=Passthrough;var WirePath=class{constructor(parts){this.parts=parts,this._length=void 0}get length(){if(void 0===this._length){const helperElement=document.createElementNS("http://www.w3.org/2000/svg","path");helperElement.setAttributeNS(null,"d",buildPathDesc(this.parts)),this._length=helperElement.getTotalLength()}return this._length}draw(g){g.beginPath();const start2=this.parts[0];g.moveTo(start2[0],start2[1]);for(const part of this.parts)4===part.length?g.lineTo(part[2],part[3]):g.bezierCurveTo(part[4],part[5],part[6],part[7],part[2],part[3])}drawBezierDebug(g){g.strokeStyle="red",g.lineWidth=1;for(const part of this.parts){if(4===part.length)continue;const bezierMeta=part[8],[left2,top2,right2,bottom2]=bezierMeta.boundingBox;g.strokeRect(left2,top2,right2-left2,bottom2-top2);const stepSize=bezierMeta.tStepSize;for(let t38=0;t38<=1;t38+=stepSize){const[x,y]=bezierPoint(t38,part);g.beginPath(),circle(g,x,y,8),g.stroke()}}}isOver(x,y){return void 0!==this.partIndexIfMouseover(x,y)}partIndexIfMouseover(x,y){for(let i2=0;i2<this.parts.length-1;i2++){const part=this.parts[i2];if(4===part.length){if(isPointOnStraightWire(x,y,part))return i2}else if(isPointOnBezierWire(x,y,part))return i2}}};function buildPathDesc(parts){const start2=parts[0],pathDescParts=["M".concat(start2[0]," ").concat(start2[1])];for(const part of parts)4===part.length?pathDescParts.push("L".concat(part[2]," ").concat(part[3])):pathDescParts.push("C".concat(part[4]," ").concat(part[5],",").concat(part[6]," ").concat(part[7],",").concat(part[2]," ").concat(part[3]));return pathDescParts.join(" ")}__name(WirePath,"WirePath"),__name(buildPathDesc,"buildPathDesc");var Waypoint=class extends DrawableWithDraggablePosition{constructor(wire,saved){super(wire.parent,Waypoint.toSuperRepr(saved)),this.wire=wire}static get Repr(){return t7.union([t7.tuple([t7.number,t7.number,t7.keyof(Orientations_),typeOrNull(t7.string),t7.partial({lockPos:t7.boolean})]),t7.tuple([t7.number,t7.number,t7.keyof(Orientations_),t7.string]),t7.tuple([t7.number,t7.number,t7.keyof(Orientations_)]),t7.tuple([t7.number,t7.number])],"Wire")}static toSuperRepr(saved){if(void 0===saved)return;const[posX,posY,orient,anchor,options]=saved;return{pos:[posX,posY],anchor:null===anchor?void 0:anchor,lockPos:null==options?void 0:options.lockPos,orient:orient,ref:void 0}}toJSON(){var _a;const anchor=null==(_a=this.anchor)?void 0:_a.ref;return this.lockPos?[this.posX,this.posY,this.orient,null!=anchor?anchor:null,{lockPos:this.lockPos}]:void 0!==anchor?[this.posX,this.posY,this.orient,anchor]:this.orient!==Orientation.default?[this.posX,this.posY,this.orient]:[this.posX,this.posY]}doSetOrient(newOrient){super.doSetOrient(newOrient),this.wire.invalidateWirePath()}get unrotatedWidth(){return WAYPOINT_DIAMETER}get unrotatedHeight(){return WAYPOINT_DIAMETER}isOver(x,y){return this.parent.mode>=2&&void 0!==distSquaredToWaypointIfOver(x,y,this.posX,this.posY,!1)}positionChanged(__delta){this.wire.invalidateWirePath()}cursorWhenMouseover(e){var _a;const mode=this.parent.mode;return null!=(_a=null==e?void 0:e.ctrlKey)&&_a&&mode>=2?"context-menu":!this.lockPos&&mode>=2?"grab":void 0}getPrevAndNextAnchors(){var _a;const waypoints=this.wire.waypoints,index=waypoints.indexOf(this);return[index>0?waypoints[index-1]:this.wire.startNode,index<waypoints.length-1?waypoints[index+1]:null!=(_a=this.wire.endNode)?_a:this.wire.startNode]}removeFromParent(){this.wire.removeWaypoint(this)}doDraw(g,ctx){if(this.parent.mode<2)return;if(this.wire.behavesHidden)return;g.globalAlpha=this.wire.isHidden?.3:1;const neutral=this.parent.editor.options.hideWireColors;drawWaypoint(g,ctx,this.posX,this.posY,5,this.wire.startNode.value,ctx.isMouseOver,neutral,!1,!1,!1),g.globalAlpha=1}makeContextMenu(){return[...this.makeOrientationAndPosMenuItems().map((it=>it[1])),MenuData.sep(),MenuData.item("trash",S.Components.Generic.contextMenu.Delete,(()=>{this.removeFromParent()}),"⌫",!0)]}};__name(Waypoint,"Waypoint");var WireStyles={auto:"auto",straight:"straight",hv:"hv",vh:"vh",bezier:"bezier"},Wire=class extends Drawable{constructor(startNode,endNode){super(startNode.parent),this._waypoints=[],this._wirePath=void 0,this._style=void 0,this._isHidden=!1,this._propagatingValues=[],this._waypointBeingDragged=void 0,this.customPropagationDelay=void 0,this.ribbon=void 0,this._startNode=startNode,this._endNode=endNode;const longAgo=Number.MIN_SAFE_INTEGER/2;this._propagatingValues.push([startNode.value,longAgo]),this.setStartNode(startNode),this.setEndNode(endNode)}static get Repr(){const simpleRepr=t7.tuple([t7.number,t7.number]),fullRepr=t7.tuple([t7.number,t7.number,t7.type({ref:typeOrUndefined(t7.string),via:typeOrUndefined(t7.array(Waypoint.Repr)),propagationDelay:typeOrUndefined(t7.number),style:typeOrUndefined(t7.keyof(WireStyles)),hidden:typeOrUndefined(t7.boolean)})]);return t7.union([fullRepr,simpleRepr],"Wire")}setOptions(wireOptions,componentsByRef){this.doSetValidatedId(wireOptions.ref),void 0!==wireOptions.via&&this.setWaypoints(wireOptions.via,componentsByRef),void 0!==wireOptions.propagationDelay&&(this.customPropagationDelay=wireOptions.propagationDelay),void 0!==wireOptions.style&&this.doSetStyle(wireOptions.style),void 0!==wireOptions.hidden&&this.doSetHidden(wireOptions.hidden)}toJSON(){const endID=this._endNode.id;if(0!==this._waypoints.length||void 0!==this.customPropagationDelay||void 0!==this.ref||void 0!==this.style||this.isHidden){const waypoints=this._waypoints.map((w=>w.toJSON()));return[this._startNode.id,endID,{ref:this.ref,via:0===waypoints.length?void 0:waypoints,propagationDelay:this.customPropagationDelay,style:this.style,hidden:!1===this.isHidden?void 0:this.isHidden}]}return[this._startNode.id,endID]}get startNode(){return this._startNode}get endNode(){return this._endNode}isInRect(__rect){return!1}get waypoints(){return this._waypoints}setWaypoints(reprs,componentsByRef){this._waypoints=reprs.map((repr=>{const wp=new Waypoint(this,repr),anchorRef=repr[3];if(isString(anchorRef)){const anchor=componentsByRef[anchorRef];void 0!==anchor?wp.anchor=anchor:console.warn("Couldn't find anchor '".concat(anchorRef,"' for waypoint of wire between ").concat(this._startNode.component.ref," and ").concat(this._endNode.component.ref))}return wp}))}get wirePath(){var _a;if(void 0===this._wirePath){let[startX,startY,prevX,prevY,prevProlong]=this.startNode.drawCoords;const[endLeadX,endLeadY,endNodeX,endNodeY,endNodeProlong]=this.endNode.drawCoords,lastWaypointData={posX:endNodeX,posY:endNodeY,orient:endNodeProlong},allWaypoints=[...this._waypoints,lastWaypointData],pathParts=[[startX,startY,prevX,prevY]],wireStyle=null!=(_a=this.style)?_a:this.startNode.parent.editor.options.wireStyle;for(const waypoint of allWaypoints){const nextX=waypoint.posX,nextY=waypoint.posY,deltaX=nextX-prevX,deltaY=nextY-prevY,nextProlong=waypoint.orient;let c1x,c1y,c2x,c2y;if(wireStyle===WireStyles.straight||wireStyle===WireStyles.auto&&(prevX===nextX||prevY===nextY))pathParts.push([prevX,prevY,nextX,nextY]);else if(wireStyle===WireStyles.hv)prevX!==nextX&&pathParts.push([prevX,prevY,nextX,prevY]),prevY!==nextY&&pathParts.push([nextX,prevY,nextX,nextY]);else if(wireStyle===WireStyles.vh)prevY!==nextY&&pathParts.push([prevX,prevY,prevX,nextY]),prevX!==nextX&&pathParts.push([prevX,nextY,nextX,nextY]);else{const bezierAnchorPointDistX=Math.max(25,Math.abs(deltaX)/3),bezierAnchorPointDistY=Math.max(25,Math.abs(deltaY)/3);[c1x,c1y]=bezierAnchorForWire(prevProlong,prevX,prevY,bezierAnchorPointDistX,bezierAnchorPointDistY),[c2x,c2y]=bezierAnchorForWire(nextProlong,nextX,nextY,bezierAnchorPointDistX,bezierAnchorPointDistY),pathParts.push(makeBezierCoords([prevX,prevY,nextX,nextY,c1x,c1y,c2x,c2y]))}prevX=nextX,prevY=nextY,prevProlong=Orientation.invert(nextProlong)}pathParts.push([prevX,prevY,endLeadX,endLeadY]),this._wirePath=new WirePath(pathParts)}return this._wirePath}invalidateWirePath(){this._wirePath=void 0}get style(){return this._style}doSetStyle(style2){this._style=style2,this.invalidateWirePath(),this.requestRedraw({why:"style changed",invalidateMask:!0})}get isHidden(){return this._isHidden}get behavesHidden(){return this._isHidden&&!this.parent.editor.options.showHiddenWires}doSetHidden(hidden){this._isHidden=hidden,this.requestRedraw({why:"hidden changed",invalidateMask:!0})}setStartNode(startNode,now){void 0!==this._startNode&&this._startNode.removeOutgoingWire(this),this._startNode=startNode,startNode.addOutgoingWire(this),void 0!==now&&this.propagateNewValue(this._startNode.value,now),this.invalidateWirePath()}setEndNode(endNode){void 0!==this._endNode&&(this._endNode.incomingWire=null),this._endNode=endNode,null!==endNode.incomingWire&&void 0!==endNode.incomingWire&&console.warn("Unexpectedly replacing existing incoming wire on node ".concat(this._endNode.id)),endNode.incomingWire=this,endNode.value=this._startNode.value,endNode.doSetColor(this._startNode.color),this.invalidateWirePath()}propagateNewValue(newValue,logicalTime){var _a;this._propagatingValues[this._propagatingValues.length-1][0]!==newValue&&this._propagatingValues.push([newValue,logicalTime]);const propagationDelay=null!=(_a=this.customPropagationDelay)?_a:this.parent.editor.options.propagationDelay;if(0===propagationDelay)this.endNode.value=newValue,this._propagatingValues.splice(0,this._propagatingValues.length-1);else{const desc=S.Components.Wire.timeline.PropagatingValue.expand({val:toLogicValueRepr(newValue)});this.parent.editor.timeline.scheduleAt(logicalTime+propagationDelay,(()=>{this.endNode.value=newValue}),desc,!1)}}destroy(){Node2.isOutput(this._startNode)&&this._startNode.removeOutgoingWire(this),null!==this._endNode&&(this._endNode.incomingWire=null)}get isAlive(){return this.startNode.isAlive&&this.endNode.isAlive}addPassthroughFrom(e){const parent=this.parent,[x,y]=parent.editor.offsetXYForContextMenu(e,!0),endNode=this.endNode,passthrough=PassthroughDef.make(parent,{bits:1});passthrough.setSpawned(),passthrough.setPosition(x,y,!1),this.setEndNode(passthrough.inputs.In[0]);const newWire=parent.linkMgr.addWire(passthrough.outputs.Out[0],endNode,!1);if(void 0!==newWire)return newWire.doSetStyle(this.style),passthrough;console.warn("Couldn't create new wire")}addWaypointFrom(e){const[x,y]=this.parent.editor.offsetXYForContextMenu(e,!1);return this.addWaypointWith(x,y)}addWaypointWith(x,y){const wirePath=this.wirePath;let partIndex=wirePath.partIndexIfMouseover(x,y);void 0===partIndex&&(console.warn("Couldn't find waypoint to insert at for (".concat(x,", ").concat(y,")")),partIndex=1);const[startX,startY,endX,endY]=wirePath.parts[partIndex],deltaX=endX-startX,deltaY=endY-startY;let orient;orient=Math.abs(deltaX)>=Math.abs(deltaY)?endX>=startX?"e":"w":endY>=startY?"s":"n";const waypoint=new Waypoint(this,[x,y,orient]);return this._waypoints.splice(partIndex-1,0,waypoint),this.invalidateWirePath(),waypoint}removeWaypoint(waypoint){const i2=this._waypoints.indexOf(waypoint);-1!==i2&&(this._waypoints.splice(i2,1),this.invalidateWirePath(),this.requestRedraw({why:"waypoint deleted",invalidateMask:!0}))}prunePropagatingValues(now,propagationDelay){let removeBefore=0;for(let i2=1;i2<this._propagatingValues.length&&now>=this._propagatingValues[i2][1]+propagationDelay;i2++)removeBefore=i2;return removeBefore>0&&this._propagatingValues.splice(0,removeBefore),this._propagatingValues[0][0]}doDraw(g,ctx){var _a,_b,_c;const isAnimating=this._propagatingValues.length>1,options=this.parent.editor.options,propagationDelay=null!=(_a=this.customPropagationDelay)?_a:options.propagationDelay,neutral=options.hideWireColors,drawTime=ctx.drawParams.drawTime;if(this.prunePropagatingValues(drawTime,propagationDelay),this.behavesHidden)return;g.globalAlpha=this._isHidden?.3:1;const wirePath=this.wirePath;wirePath.draw(g);const drawParams=ctx.drawParams;void 0!==drawParams.highlightColor&&null!=(_c=null==(_b=drawParams.highlightedItems)?void 0:_b.wires.includes(this))&&_c&&(g.lineWidth=15,g.shadowColor=drawParams.highlightColor,g.shadowBlur=20,g.shadowOffsetX=0,g.shadowOffsetY=0,g.strokeStyle=g.shadowColor,g.stroke(),g.shadowBlur=0);if(strokeWireOutline(g,this._startNode.color,ctx.isMouseOver),1===this._propagatingValues.length){const[value,timeSet]=this._propagatingValues[0],frac=Math.min(1,(drawTime-timeSet)/propagationDelay);frac<1&&console.warn("Propagating value not fully propagated but drawn as such (frac=".concat(frac," < 1.0, drawTime=").concat(drawTime,", timeSet=").concat(timeSet,", propagationDelay=").concat(propagationDelay,")")),strokeWireValue(g,value,void 0,neutral,drawParams.drawTimeAnimationFraction)}else{const totalLength=wirePath.length;for(const[value,timeSet]of this._propagatingValues){strokeWireValue(g,value,[totalLength*Math.min(1,(drawTime-timeSet)/propagationDelay),totalLength],neutral,drawParams.drawTimeAnimationFraction)}}g.globalAlpha=1,isAnimating&&!this.parent.editor.timeline.isPaused&&this.requestRedraw({why:"propagating value",isPropagation:!0})}isOver(x,y){return!(this.parent.mode<2||!this.startNode.isAlive||!this.endNode.isAlive||this.behavesHidden)&&this.wirePath.isOver(x,y)}pointerDown(e){if(e.altKey&&this.parent.mode>=3){const passthrough=this.addPassthroughFrom(e);if(void 0!==passthrough)return passthrough.outputs.Out[0].pointerDown(e)}return super.pointerDown(e)}pointerDragged(e){if(void 0!==this._waypointBeingDragged)this._waypointBeingDragged.pointerDragged(e);else if(this.parent.editor.eventMgr.currentSelectionEmpty()){const waypoint=this.addWaypointFrom(e);this._waypointBeingDragged=waypoint,waypoint.pointerDown(e),waypoint.pointerDragged(e)}}pointerUp(e){return void 0!==this._waypointBeingDragged?(this._waypointBeingDragged.pointerUp(e),this._waypointBeingDragged=void 0,InteractionResult.SimpleChange):InteractionResult.NoChange}makeContextMenu(){const s=S.Components.Wire.contextMenu,currentPropDelayStr=void 0===this.customPropagationDelay?"":" (".concat(this.customPropagationDelay," ms)"),makeItemUseColor=__name(((desc,color)=>{const isCurrent=this._startNode.color===color,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>this._startNode.doSetColor(color),cssColor=COLOR_WIRE[color];return MenuData.item(icon,span(title(desc),style("display: inline-block; width: 140px; height: ".concat(8,"px; background-color: ").concat(cssColor,"; margin-right: 8px"))),action)}),"makeItemUseColor"),makeItemDisplayStyle=__name(((desc,style2)=>{const isCurrent=this.style===style2,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>this.doSetStyle(style2);return MenuData.item(icon,desc,action)}),"makeItemDisplayStyle"),hiddenMenuItem=MenuData.item(this.isHidden?"check":"none",s.HiddenWire,(()=>{this.doSetHidden(!this.isHidden)})),setWireOptionsItems=this.parent.mode<3?[]:[MenuData.sep(),MenuData.item("timer",s.CustomPropagationDelay.expand({current:currentPropDelayStr}),(__itemEvent=>{const currentStr=void 0===this.customPropagationDelay?"":String(this.customPropagationDelay),defaultDelay=String(this.parent.editor.options.propagationDelay),message=s.CustomPropagationDelayDesc.expand({current:defaultDelay}),newValueStr=prompt(message,currentStr);if(null!==newValueStr)if(""===newValueStr)this.customPropagationDelay=void 0;else{const asInt=parseInt(newValueStr);isNaN(asInt)||(this.customPropagationDelay=asInt)}})),MenuData.submenu("palette",s.WireColor,[makeItemUseColor(s.WireColorBlack,WireColor.black),makeItemUseColor(s.WireColorRed,WireColor.red),makeItemUseColor(s.WireColorBlue,WireColor.blue),makeItemUseColor(s.WireColorYellow,WireColor.yellow),makeItemUseColor(s.WireColorGreen,WireColor.green),makeItemUseColor(s.WireColorWhite,WireColor.white)]),MenuData.submenu("wirestyle",s.WireStyle,[makeItemDisplayStyle(s.WireStyleDefault,void 0),MenuData.sep(),makeItemDisplayStyle(s.WireStyleAuto,WireStyles.auto),makeItemDisplayStyle(s.WireStyleStraight,WireStyles.straight),makeItemDisplayStyle(s.WireStyleSquareHV,WireStyles.hv),makeItemDisplayStyle(s.WireStyleSquareVH,WireStyles.vh),makeItemDisplayStyle(s.WireStyleCurved,WireStyles.bezier)]),MenuData.sep(),hiddenMenuItem],setRefItems=this.parent.mode<4?[]:[MenuData.sep(),this.makeSetIdContextMenuItem()];return[MenuData.item("add",s.AddMiddlePoint,((__itemEvent,contextEvent)=>{this.addWaypointFrom(contextEvent)})),MenuData.item("add",s.AddPassthrough,((__itemEvent,contextEvent)=>{this.addPassthroughFrom(contextEvent)})),...setWireOptionsItems,...setRefItems,MenuData.sep(),MenuData.item("trash",S.Components.Generic.contextMenu.Delete,(()=>this.parent.linkMgr.deleteWire(this)),"⌫",!0)]}};__name(Wire,"Wire");var Ribbon=class extends Drawable{constructor(parent,startNodeGroup,endNodeGroup){super(parent),this.startNodeGroup=startNodeGroup,this.endNodeGroup=endNodeGroup,this._startGroupStartIndex=Number.MAX_SAFE_INTEGER,this._startGroupEndIndex=Number.MIN_SAFE_INTEGER,this._endGroupStartIndex=Number.MAX_SAFE_INTEGER,this._endGroupEndIndex=Number.MIN_SAFE_INTEGER,this._coveredWires=[]}isEmpty(){return 0===this._coveredWires.length}addCoveredWire(wire,newNodeGroupStartIndex,newNodeGroupEndIndex){this._coveredWires.push(wire),this.updateIndices(newNodeGroupStartIndex,newNodeGroupEndIndex)}wireWasDeleted(__wire){}updateIndices(newNodeGroupStartIndex,newNodeGroupEndIndex){this._startGroupStartIndex=Math.min(this._startGroupStartIndex,newNodeGroupStartIndex),this._startGroupEndIndex=Math.max(this._startGroupEndIndex,newNodeGroupStartIndex),this._endGroupStartIndex=Math.min(this._endGroupStartIndex,newNodeGroupEndIndex),this._endGroupEndIndex=Math.max(this._endGroupEndIndex,newNodeGroupEndIndex)}doDraw(g,ctx){const[[startX,startY],startOrient]=this.drawRibbonEnd(g,ctx,this.startNodeGroup,this._startGroupStartIndex,this._startGroupEndIndex),[[endX,endY],endOrient]=this.drawRibbonEnd(g,ctx,this.endNodeGroup,this._endGroupStartIndex,this._endGroupEndIndex),deltaX=endX-startX,deltaY=endY-startY,bezierAnchorPointDistX=Math.max(25,Math.abs(deltaX)/3),bezierAnchorPointDistY=Math.max(25,Math.abs(deltaY)/3),[anchor1X,anchor1Y]=bezierAnchorForWire(Orientation.invert(startOrient),startX,startY,bezierAnchorPointDistX,bezierAnchorPointDistY),[anchor2X,anchor2Y]=bezierAnchorForWire(Orientation.invert(endOrient),endX,endY,bezierAnchorPointDistX,bezierAnchorPointDistY),b2=new Bezier(startX,startY,anchor1X,anchor1Y,anchor2X,anchor2Y,endX,endY),values=[];for(let i2=this._startGroupStartIndex;i2<=this._startGroupEndIndex;i2++)values.push(this.startNodeGroup.nodes[i2].value);this.strokeWireBezier(g,b2,values,WireColor.black,ctx.isMouseOver,!1)}strokeWireBezier(g,b2,values,color,isMouseOver,neutral){const numWires=values.length,WIRE_MARGIN_OUTER=1===numWires?1:numWires<=4||numWires>8?2:3,WIRE_WIDTH2=numWires<=8?2:1;if(0===numWires)return;const totalWidth=2*WIRE_MARGIN_OUTER+numWires*WIRE_WIDTH2+1*(numWires-1),addBezierToPath=__name((b3=>{const[p0,a0,a1,p1]=b3.points;g.moveTo(p0.x,p0.y),g.bezierCurveTo(a0.x,a0.y,a1.x,a1.y,p1.x,p1.y)}),"addBezierToPath"),drawBezier=__name((b3=>{g.beginPath(),addBezierToPath(b3),g.stroke()}),"drawBezier"),drawBeziers=__name((bs=>{if(isArray(bs)){g.beginPath();for(const bb of bs)addBezierToPath(bb);g.stroke()}}),"drawBeziers"),oldLineCap=g.lineCap;g.lineCap="butt",isMouseOver?(g.lineWidth=totalWidth+2,g.strokeStyle=COLOR_MOUSE_OVER,drawBezier(b2),g.lineWidth=totalWidth-2*WIRE_MARGIN_OUTER):g.lineWidth=totalWidth,g.strokeStyle=COLOR_WIRE[color],drawBezier(b2),g.lineWidth=WIRE_WIDTH2;let dist=-(numWires-1)/2*(WIRE_WIDTH2+1);for(const value of values){g.strokeStyle=neutral?COLOR_UNKNOWN:colorForLogicValue(value);drawBeziers(b2.offset(dist)),dist+=WIRE_WIDTH2+1}g.lineCap=oldLineCap}drawRibbonEnd(g,ctx,nodeGroup,startIndex,endIndex){const nodes=nodeGroup.nodes,orient=nodes[startIndex].orient,numNodes=endIndex-startIndex+1;let minX=Number.POSITIVE_INFINITY,minY=Number.POSITIVE_INFINITY,maxX=Number.NEGATIVE_INFINITY,maxY=Number.NEGATIVE_INFINITY,sumX=0,sumY=0;for(let i2=startIndex;i2<=endIndex;i2++){const node=nodes[i2],x=node.posX,y=node.posY;minX=Math.min(minX,x),minY=Math.min(minY,y),maxX=Math.max(maxX,x),maxY=Math.max(maxY,y),sumX+=x,sumY+=y}const[[startX,startY],[endX,endY],mid]=(()=>{switch(orient){case"e":return[[maxX,minY],[maxX,maxY],[maxX,sumY/numNodes]];case"w":return[[minX,minY],[minX,maxY],[minX,sumY/numNodes]];case"s":return[[minX,minY],[maxX,minY],[sumX/numNodes,minY]];case"n":return[[minX,maxY],[maxX,maxY],[sumX/numNodes,maxY]]}})();return drawStraightWireLine(g,startX,startY,endX,endY,"Z","black",!0,ctx.drawParams.drawTimeAnimationFraction),[mid,orient]}isOver(__x,__y){return!1}isInRect(__rect){return!1}};__name(Ribbon,"Ribbon");var LinkManager=class{constructor(parent){this._wires=[],this._ribbons=[],this._wireBeingAddedFrom=void 0,this._anchorBeingSetFrom=void 0,this.parent=parent}get wires(){return this._wires}get ribbons(){return this._ribbons}get isAddingWire(){return void 0!==this._wireBeingAddedFrom}get isSettingAnchor(){return void 0!==this._anchorBeingSetFrom}draw(g,drawParams){this.removeDeadWires();const useRibbons=this.parent.editor.options.groupParallelWires;if(useRibbons)for(const ribbon of this._ribbons)ribbon.draw(g,drawParams);for(const wire of this._wires)if(!useRibbons||void 0===wire.ribbon){wire.draw(g,drawParams);for(const waypoint of wire.waypoints)waypoint.draw(g,drawParams)}this.drawWireBeingAdded(g,drawParams),this.drawAnchorBeingSet(g)}drawWireBeingAdded(g,drawParams){const nodeFrom=this._wireBeingAddedFrom;if(void 0!==nodeFrom){const x1=nodeFrom.posX,y1=nodeFrom.posY,editor=this.parent.editor,x2=editor.pointerX,y2=editor.pointerY;if(g.beginPath(),g.moveTo(x1,y1),this.parent.editor.options.wireStyle===WireStyles.straight)g.lineTo(x2,y2);else{const deltaX=x2-x1,deltaY=y2-y1,bezierAnchorPointDistX=Math.max(25,Math.abs(deltaX)/3),bezierAnchorPointDistY=Math.max(25,Math.abs(deltaY)/3),outgoingOrient=Orientation.add(nodeFrom.component.orient,nodeFrom.orient),[a1x,a1y]=bezierAnchorForWire(Orientation.invert(outgoingOrient),x1,y1,bezierAnchorPointDistX,bezierAnchorPointDistY),[a2x,a2y]=bezierAnchorForWire(outgoingOrient,x2,y2,bezierAnchorPointDistX,bezierAnchorPointDistY);g.bezierCurveTo(a1x,a1y,a2x,a2y,x2,y2)}strokeWireOutlineAndSingleValue(g,nodeFrom.value,nodeFrom.color,!1,drawParams.drawTimeAnimationFraction)}}drawAnchorBeingSet(g){const drawable=this._anchorBeingSetFrom;if(void 0!==drawable){const x1=drawable.posX,y1=drawable.posY,editor=this.parent.editor;drawAnchorTo(g,x1,y1,editor.pointerX,editor.pointerY,6,COLOR_ANCHOR_NEW,void 0)}}removeDeadWires(){let i2=0;for(;i2<this._wires.length;){const wire=this._wires[i2];wire.isAlive?i2++:(wire.destroy(),this._wires.splice(i2,1))}}addWire(startNode,endNode,tryOffset){var _a,_b,_c;if(!startNode.acceptsMoreConnections||!endNode.acceptsMoreConnections)return;const wire=new Wire(startNode,endNode);return this._wires.push(wire),tryOffset&&this.offsetWireIfNeeded(wire),this.tryMergeWire(wire),null==(_a=this.parent.ifEditing)||_a.setToolCursor(null),null==(_b=this.parent.ifEditing)||_b.setDirty("added wire"),null==(_c=this.parent.ifEditing)||_c.redrawMgr.requestRedraw({why:"wire added",invalidateMask:!0,invalidateTests:!0}),wire}startSettingAnchorFrom(drawable){var _a;void 0!==this._anchorBeingSetFrom&&console.warn("LinkManager.startSettingAnchorFrom: already setting anchor from a drawable"),this._anchorBeingSetFrom=drawable,null==(_a=this.parent.ifEditing)||_a.setToolCursor("alias")}stopSettingAnchorOn(comp){const anchorBeingSetFrom=this._anchorBeingSetFrom;return anchorBeingSetFrom?this.trySetAnchor(anchorBeingSetFrom,comp):InteractionResult.NoChange}trySetAnchor(from,to){if(this.tryCancelSetAnchor(),void 0===to.ref&&console.warn("LinkManager.stopSettingAnchorOn: component has no ref"),to!==from){let forbidden=!1,current=to;for(;void 0!==current.anchor;)if(current=current.anchor,current===from){forbidden=!0;break}if(!forbidden)return from.anchor=to,this.parent.editor.showMessage(S.Messages.AnchorAdded),InteractionResult.SimpleChange;this.parent.editor.showMessage(S.Messages.CircularAnchorsForbidden)}return InteractionResult.NoChange}tryCancelSetAnchor(){var _a;this._anchorBeingSetFrom=void 0,null==(_a=this.parent.ifEditing)||_a.setToolCursor(null)}startDraggingWireFrom(node){var _a;void 0!==this._wireBeingAddedFrom&&console.warn("LinkManager.startDraggingFrom: already dragging from a node"),node.acceptsMoreConnections&&(this._wireBeingAddedFrom=node,null==(_a=this.parent.ifEditing)||_a.setToolCursor("crosshair"))}stopDraggingWireOn(newNode){const nodes=this.getOutInNodesForNewWire(newNode);if(this._wireBeingAddedFrom=void 0,void 0!==nodes)return this.addWire(nodes[0],nodes[1],!0)}isValidNodeToConnect(node){return void 0!==this.getOutInNodesForNewWire(node)}getOutInNodesForNewWire(newNode){var _a,_b;const otherNode=this._wireBeingAddedFrom;if(void 0!==otherNode&&newNode!==otherNode){if(otherNode.isOutput())return newNode.isOutput()||!newNode.acceptsMoreConnections?void 0:[otherNode,newNode];if(newNode.isOutput())return[newNode,otherNode];{let otherStartNode=null==(_a=newNode.incomingWire)?void 0:_a.startNode;return void 0!==otherStartNode&&otherNode.acceptsMoreConnections?[otherStartNode,otherNode]:(otherStartNode=null==(_b=otherNode.incomingWire)?void 0:_b.startNode,void 0!==otherStartNode&&newNode.acceptsMoreConnections?[otherStartNode,newNode]:void 0)}}}tryCancelWireOrAnchor(){var _a,_b;return void 0!==this._wireBeingAddedFrom?(this._wireBeingAddedFrom=void 0,null==(_a=this.parent.ifEditing)||_a.setToolCursor(null),!0):void 0!==this._anchorBeingSetFrom&&(this._anchorBeingSetFrom=void 0,null==(_b=this.parent.ifEditing)||_b.setToolCursor(null),!0)}offsetWireIfNeeded(wire){const startNode=wire.startNode,endNode=wire.endNode,comp=startNode.component;if(comp!==endNode.component)return;const dx2=(endNode.posX-startNode.posX)/2,dy2=(endNode.posY-startNode.posY)/2,midpointX=startNode.posX+dx2,midpointY=startNode.posY+dy2;if(!comp.isOver(midpointX,midpointY))return;const addToX=dx2>dy2,dir=addToX?startNode.posX<endNode.posX?1:startNode.posX>endNode.posX||startNode.posX<comp.posX?-1:1:startNode.posY<endNode.posY?1:startNode.posY>endNode.posY||startNode.posY<comp.posY?-1:1,calcOffsetFromDim=__name((dim=>dir*(dim/2+2*GRID_STEP)),"calcOffsetFromDim"),isVertical=Orientation.isVertical(comp.orient),waypointX=midpointX+(addToX?calcOffsetFromDim(isVertical?comp.unrotatedHeight:comp.unrotatedWidth):0),waypointY=midpointY+(addToX?0:calcOffsetFromDim(isVertical?comp.unrotatedWidth:comp.unrotatedHeight));wire.addWaypointWith(waypointX,waypointY).anchor=comp}tryMergeWire(wire){const startNode=wire.startNode,endNode=wire.endNode,startGroup=startNode.group,endGroup=endNode.group;if(void 0===startGroup||void 0===endGroup)return;const findWire=__name(((group1,i1,group2,i2)=>{if(!(i1<0||i2<0||i1>=group1.nodes.length||i2>=group2.nodes.length))return group1.nodes[i1].findWireTo(group2.nodes[i2])}),"findWire"),indexStart=startGroup.nodes.indexOf(startNode),indexEnd=endGroup.nodes.indexOf(endNode),wireBefore=findWire(startGroup,indexStart-1,endGroup,indexEnd-1);if(void 0!==wireBefore){let ribbon=wireBefore.ribbon;void 0===ribbon&&(ribbon=new Ribbon(startNode.parent,startGroup,endGroup),this._ribbons.push(ribbon),wireBefore.ribbon=ribbon,ribbon.addCoveredWire(wireBefore,indexStart-1,indexEnd-1)),ribbon.addCoveredWire(wire,indexStart,indexEnd),wire.ribbon=ribbon}}deleteWire(wire){const oldStartNode=wire.startNode,oldEndNode=wire.endNode;return this.doDeleteWire(wire)?tryMakeRepeatableNodeAction(oldStartNode,oldEndNode,((startNode,endNode)=>{const wire2=endNode.incomingWire;return null!==wire2&&wire2.startNode===startNode&&this.doDeleteWire(wire2)})):InteractionResult.NoChange}doDeleteWire(wire){var _a;wire.destroy();const ribbon=wire.ribbon;return void 0!==ribbon&&(ribbon.wireWasDeleted(wire),ribbon.isEmpty()&&this._ribbons.splice(this._ribbons.indexOf(ribbon),1)),this._wires.splice(this._wires.indexOf(wire),1),null==(_a=this.parent.ifEditing)||_a.redrawMgr.requestRedraw({why:"wire deleted",invalidateMask:!0,invalidateTests:!0}),!0}invalidateAllWirePaths(){for(const wire of this._wires)wire.invalidateWirePath()}clearAll(){var _a;for(const wire of this._wires)wire.destroy();this._wires.length=0,null==(_a=this.parent.ifEditing)||_a.redrawMgr.requestRedraw({why:"all wires deleted",invalidateMask:!0,invalidateTests:!0})}};function bezierAnchorForWire(wireProlongDirection,x,y,distX,distY){switch(wireProlongDirection){case"e":return[x-distX,y];case"w":return[x+distX,y];case"s":return[x,y-distY];case"n":return[x,y+distY]}}__name(LinkManager,"LinkManager"),__name(bezierAnchorForWire,"bezierAnchorForWire");var _Serialization=class{saveCircuitToFile(editor){const jsonStr=this.stringifyObject(this.buildCircuitObject(editor),!1),blob=new Blob([jsonStr],{type:"application/json5"}),filename=editor.documentDisplayName+".json";(0,import_file_saver.saveAs)(blob,filename)}saveLibraryToFile(editor){const jsonStr=this.stringifyObject(this.buildLibraryObject(editor),!1),blob=new Blob([jsonStr],{type:"application/json5"}),filename=editor.documentDisplayName+"-lib.json";(0,import_file_saver.saveAs)(blob,filename)}loadCircuitOrLibrary(editor,content,takeSnapshot,opts){let parsed;if(isString(content))try{parsed=JSONParseObject(content)}catch(err){return console.error(err),"can't load this JSON - error “"+err+"”, length = ".concat(content.length,", JSON:\n")+content}else parsed=content;return"lib"===parsed.type?this.doLoadLibrary(editor,parsed):this.loadCircuit(editor,parsed,takeSnapshot,opts)}pasteComponents(parent,content){let parsed,offsetPos;try{parsed=JSONParseObject(content)}catch(err){return console.error(err),"can't load this JSON - error “"+err+"”, length = ".concat(content.length,", JSON:\n")+content}if(isArray(parsed.pos)){const editor=parent.editor,ceil10=__name((x=>10*Math.ceil(x/10)),"ceil10");offsetPos=[ceil10(editor.pointerX-parsed.pos[0]),ceil10(editor.pointerY-parsed.pos[1])]}const compReprs=parsed.components;if(!isArray(compReprs)&&!isRecord(compReprs))return"invalid JSON: 'components' must be an array or an object";const{nodeMapping:nodeMapping,components:components,componentsByRef:componentsByRef}=this.makeComponents(parent,compReprs,offsetPos);return this.makeWires(parent,parsed.wires,nodeMapping,componentsByRef,!1),components}doLoadLibrary(editor,parsed){migrateData(parsed,editor.instanceId);const numLoaded=editor.factory.tryLoadCustomDefsFrom(parsed.defs);editor.updateCustomComponentButtons(),editor.showMessage(S.Messages.LoadedDefinitions.expand({n:numLoaded}))}loadCircuit(parent,parsed_,takeSnapshot,opts){var _a,_b,_c;const componentList=parent.components,parsed={...parsed_};try{null!=(_a=null==opts?void 0:opts.skipMigration)&&_a||migrateData(parsed,parent.editor.instanceId)}catch(err){return console.error(err),"can't migrate JSON - error “"+err+"”, JSON:\n"+stringifySmart(parsed,{maxLength:120})}delete parsed.v,parent.isMainEditor()&&(parent.factory.clearCustomDefs(),parent.factory.tryLoadCustomDefsFrom(parsed.defs),delete parsed.defs);for(const elem of componentList.all())elem.destroy();componentList.clearAll(),parent.linkMgr.clearAll(),parent.nodeMgr.clearAll(),parent.isMainEditor()&&parent.timeline.reset();const compReprs=parsed.components,{nodeMapping:nodeMapping,componentsByRef:componentsByRef}=this.makeComponents(parent,compReprs,void 0);delete parsed.components;const immediateWirePropagation=null!=(_b=null==opts?void 0:opts.immediateWirePropagation)&&_b;if(this.makeWires(parent,parsed.wires,nodeMapping,componentsByRef,immediateWirePropagation),delete parsed.wires,isArray(parsed.tests)){const testSuiteReprs=validateJson(parsed.tests,TestSuite.ReprArray,"tests");if(void 0!==testSuiteReprs){const testSuites=testSuiteReprs.map((ts=>new TestSuite([ts,componentList])));parent.testSuites.set(testSuites),null==(_c=parent.ifEditing)||_c.testsPalette.update()}}if(delete parsed.tests,parent.isMainEditor()){void 0!==parsed.userdata&&("object"==typeof parent.userdata&&"object"==typeof parsed.userdata&&(parent.userdata={...parsed.userdata,...parent.userdata}),delete parsed.userdata),parent.setPartialOptions(parsed.opts),delete parsed.opts,takeSnapshot&&parent.editor.editTools.undoMgr.takeSnapshot(),parent.updateCustomComponentButtons();const scratch=parsed.scratch;let customComp_;if(void 0!==scratch&&isRecord(scratch)&&isString(scratch.id)&&void 0!==(customComp_=parent.components.get(scratch.id))){delete scratch.id;const customComp=customComp_,error=this.loadCircuitForCustomComponent(customComp,scratch);void 0!==error?console.error("Error loading scratch space: "+error):parent.setEditorRoot(customComp)}delete parsed.scratch}const unhandledData=keysOf(parsed);0!==unhandledData.length&&console.warn("Unloaded data fields: "+unhandledData.join(", "))}loadCircuitForCustomComponent(customComp,parsed){const error=this.loadCircuit(customComp,parsed,!1,{immediateWirePropagation:!0,skipMigration:!0});if(void 0!==error)return error;customComp.circuitDidLoad()}makeComponents(parent,compReprs,offsetPos){const components=[],componentsByRef={},anchorsToSet=[],add=__name(((c,repr)=>{if(void 0!==c){let anchor;components.push(c),void 0!==c.ref&&(componentsByRef[c.ref]=c),isRecord(repr)&&"anchor"in repr&&isString(anchor=repr.anchor)&&anchorsToSet.push([c,anchor])}}),"add"),nodeMapping=parent.nodeMgr.recordMappingWhile((()=>{const factory=parent.editor.factory;if(isArray(compReprs))for(const compRepr of compReprs)add(factory.makeFromJSON(parent,compRepr,offsetPos),compRepr);else if(isRecord(compReprs))for(const[id,compRepr]of Object.entries(compReprs))isRecord(compRepr)?(compRepr.ref=id,add(factory.makeFromJSON(parent,compRepr,offsetPos),compRepr)):console.error("Invalid non-object component repr: '".concat(compRepr,"'"))}));for(const[comp,anchorRef]of anchorsToSet){const anchor=componentsByRef[anchorRef];void 0!==anchor?comp.anchor=anchor:console.warn("Anchor '".concat(anchorRef,"' not found for component '").concat(comp.ref,"'"))}return{nodeMapping:nodeMapping,components:components,componentsByRef:componentsByRef}}makeWires(parent,wires,nodeMapping,componentsByRef,immediateWirePropagation){const linkMgr=parent.linkMgr,nodeMgr=parent.nodeMgr,recalcMgr=parent.recalcMgr;recalcMgr.recalcAndPropagateIfNeeded();for(const obj of isArray(wires)?wires:[]){const wireData=validateJson(obj,Wire.Repr,"wire");if(void 0===wireData)return;const[nodeID1,nodeID2,wireOptions]=wireData,node1=nodeMgr.findNode(nodeID1,nodeMapping),node2=nodeMgr.findNode(nodeID2,nodeMapping);if(void 0!==node1&&void 0!==node2&&node1.isOutput()&&!node2.isOutput()){const completedWire=linkMgr.addWire(node1,node2,!1);void 0!==completedWire&&(void 0!==wireOptions&&completedWire.setOptions(wireOptions,componentsByRef),immediateWirePropagation&&(completedWire.customPropagationDelay=0)),recalcMgr.recalcAndPropagateIfNeeded()}}}buildCircuitObject(editor){var _a;const dataObject={v:6,opts:editor.nonDefaultOptions(),defs:editor.factory.customDefReprs(),scratch:void 0,userdata:editor.userdata},editorRoot=editor.editorRoot;if(!(editorRoot instanceof LogicEditor)){const scratch={id:null!=(_a=editorRoot.ref)?_a:"n/a"};this.buildReprsInto(scratch,editorRoot.components.all(),editorRoot.linkMgr.wires,editorRoot.testSuites.suites),dataObject.scratch=scratch}return this.buildReprsInto(dataObject,editor.components.all(),editor.linkMgr.wires,editor.testSuites.suites),dataObject}buildLibraryObject(editor){return{v:6,defs:editor.factory.customDefReprs(),type:"lib"}}buildComponentsAndWireObject(components,testSuites,sourcePos){const dataObject={};void 0!==sourcePos&&(dataObject.pos=sourcePos);const wires=[];for(const comp of components)for(const nodeIn of comp.inputs._all){const wire=nodeIn.incomingWire;null!==wire&&components.includes(wire.startNode.component)&&wires.push(wire)}return this.buildReprsInto(dataObject,components,wires,testSuites),dataObject}buildReprsInto(dataObject,components,wires,testSuites){for(const comp of components){void 0===dataObject.components&&(dataObject.components={});const id=comp.ref;if(void 0===id){console.error("Skipping component with no id: "+comp);continue}void 0!==dataObject.components[id]&&console.error("Skipping component with duplicate id: "+comp);const compRepr=comp.toJSON();dataObject.components[id]=compRepr}0!==wires.length&&(dataObject.wires=wires.map((w=>w.toJSON()))),0!==testSuites.length&&(dataObject.tests=testSuites.map((ts=>ts.toJSON())))}removeShowOnlyFrom(dataObject){if(void 0!==dataObject.opts){const showOnly=dataObject.opts.showOnly;if(delete dataObject.opts.showOnly,0===Object.keys(dataObject.opts).length&&delete dataObject.opts,isArray(showOnly)&&showOnly.every(isString))return showOnly}}stringifyObject(_dataObject,compact){if(compact)return import_json53.default.stringify(_dataObject);const dataObject={..._dataObject},parts=[];stringifyCompactReprTo(parts,dataObject,"v"),stringifyCompactReprTo(parts,dataObject,"type"),stringifyCompactReprTo(parts,dataObject,"opts"),stringifyCompactReprTo(parts,dataObject,"userdata"),stringifyCompactReprTo(parts,dataObject,"pos");const defs=dataObject.defs;if(void 0!==defs&&isArray(defs)){const defparts=[];for(const def of defs){const circuit=def.circuit;delete def.circuit;let subpart=stringifySmart(def,{maxLength:1/0});def.circuit=circuit;const compparts=[];stringifyComponentWiresTestsReprsTo(compparts,{...circuit},3,!0);const circuitRepr=0===compparts.length?"{}":"{\n      "+compparts.join(",\n      ")+"\n    }";subpart=subpart.slice(0,subpart.length-1)+", circuit: "+circuitRepr+"}",defparts.push(subpart)}parts.push("defs: [\n    "+defparts.join(",\n    ")+"\n  ]")}delete dataObject.defs;const scratch=dataObject.scratch;if(void 0!==scratch){const scratchparts=[];scratchparts.push("id: ".concat(stringifySmart(scratch.id))),stringifyComponentWiresTestsReprsTo(scratchparts,{...scratch},2,!1),parts.push("scratch: {\n    "+scratchparts.join(",\n    ")+"\n  }")}delete dataObject.scratch,stringifyComponentWiresTestsReprsTo(parts,dataObject,1,!1);const unprocessedFields=keysOf(dataObject);return 0!==unprocessedFields.length&&console.error("ERROR: unprocessed fields in stringified JSON: "+unprocessedFields.join(", ")),"{ // JSON5\n  "+parts.join(",\n  ")+"\n}"}};__name(_Serialization,"_Serialization");var Serialization=new _Serialization;function stringifyCompactReprTo(parts,container,key){const value=container[key];void 0!==value&&parts.push("".concat(stringifyKey(key),": ").concat(stringifySmart(value,{maxLength:1/0}))),delete container[key]}function stringifyComponentWiresTestsReprsTo(parts,container,outerLevel,noWireDelay){const outerIndent="  ".repeat(outerLevel),innerIndent=outerIndent+"  ";let entries;const comps=container.components;if(void 0!==comps)if(isArray(comps)&&0!==comps.length){const subparts=[];for(const compRepr of comps)subparts.push(stringifySmart(compRepr,{maxLength:1/0}));parts.push("components: [\n".concat(innerIndent)+subparts.join(",\n".concat(innerIndent))+",\n".concat(outerIndent,"]"))}else if(0!==(entries=Object.entries(comps)).length){const subparts=[];for(const[id,compRepr]of entries)delete compRepr.ref,subparts.push("".concat(stringifyKey(id),": ").concat(stringifySmart(compRepr,{maxLength:1/0})));parts.push("components: {\n".concat(innerIndent)+subparts.join(",\n".concat(innerIndent))+",\n".concat(outerIndent,"}"))}if(delete container.components,noWireDelay&&void 0!==container.wires)for(const wire of container.wires){const wireOpts=wire[2];void 0!==wireOpts&&(delete wireOpts.propagationDelay,allValuesUndefined(wireOpts)&&wire.splice(2,1))}stringifyCompactReprTo(parts,container,"wires");const tests=container.tests;if(void 0!==tests&&0!==tests.length){const innerIndent2=innerIndent+"  ",subparts=[];for(const testSuiteRepr of tests){const Cases="cases",testCases=testSuiteRepr[Cases],testCasesReprStrs=testCases.map((testCase=>stringifySmart(testCase,{maxLength:1/0}))).filter((s=>0!==s.length));testSuiteRepr.cases=void 0;const baseSuiteRepr=stringifySmart(testSuiteRepr,{maxLength:1/0}).slice(1,-1),sep=0===baseSuiteRepr.length?"":", ";testSuiteRepr.cases=testCases;const casesRepr=0===testCasesReprStrs.length?"".concat(Cases,": []"):"".concat(Cases,": [\n").concat(innerIndent2)+testCasesReprStrs.join(",\n".concat(innerIndent2))+",\n".concat(innerIndent,"]");subparts.push("{".concat(baseSuiteRepr).concat(sep).concat(casesRepr,"}"))}parts.push("tests: [\n".concat(innerIndent)+subparts.join("\n".concat(innerIndent))+"\n".concat(outerIndent,"]"))}delete container.tests}function allValuesUndefined(obj){for(const value of Object.values(obj))if(void 0!==value)return!1;return!0}__name(stringifyCompactReprTo,"stringifyCompactReprTo"),__name(stringifyComponentWiresTestsReprsTo,"stringifyComponentWiresTestsReprsTo"),__name(allValuesUndefined,"allValuesUndefined");var stringOrChar=/("([^\\"]|\\.)*")|[:,]/g;function stringifySmart(passedObj,options){var _a,_b;null!=options||(options={});const indent=JSON.stringify([1],void 0,null!=(_a=options.indent)?_a:2).slice(2,-3),maxLength=""===indent?1/0:null!=(_b=options.maxLength)?_b:80;let replacer=options.replacer;return __name((function _stringify(obj,currentIndent,reserved){void 0!==obj&&"function"==typeof obj.toJSON&&(obj=obj.toJSON());const string12=import_json53.default.stringify(obj,replacer);if(void 0===string12)return string12;let length=maxLength-currentIndent.length-reserved;if(string12.length<=length){const prettified=string12.replace(stringOrChar,(function(match,stringLiteral){return null!=stringLiteral?stringLiteral:match+" "}));if(prettified.length<=length)return prettified}if(null!==replacer&&(obj=import_json53.default.parse(string12),replacer=void 0),"object"==typeof obj&&null!==obj){const nextIndent=currentIndent+indent,items=[];let start2,end2,index=0;if(Array.isArray(obj))for(start2="[",end2="]",length=obj.length;index<length;index++)items.push(_stringify(obj[index],nextIndent,index===length-1?0:1)||"null");else{start2="{",end2="}";const keys=Object.keys(obj);for(length=keys.length;index<length;index++){const key=keys[index],keyPart=stringifyKey(key)+": ",value=_stringify(obj[key],nextIndent,keyPart.length+(index===length-1?0:1));void 0!==value&&items.push(keyPart+value)}}if(items.length>0)return[start2,indent+items.join(",\n"+nextIndent),end2].join("\n"+currentIndent)}return string12}),"_stringify")(passedObj,"",0)}function stringifyKey(key){if(0===key.length)return quoteString(key);const firstChar=String.fromCodePoint(key.codePointAt(0));if(!json5util.isIdStartChar(firstChar))return quoteString(key);for(let i2=firstChar.length;i2<key.length;i2++)if(!json5util.isIdContinueChar(String.fromCodePoint(key.codePointAt(i2))))return quoteString(key);return key}__name(stringifySmart,"stringifySmart"),__name(stringifyKey,"stringifyKey");var replacements={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};function quoteString(value){const quotes={"'":.1,'"':.2};let product="";for(let i2=0;i2<value.length;i2++){const c=value[i2];switch(c){case"'":case'"':quotes[c]++,product+=c;continue;case"\0":if(json5util.isDigit(value[i2+1])){product+="\\x00";continue}}if(void 0===replacements[c])if(c<" "){const hexString=c.charCodeAt(0).toString(16);product+="\\x"+("00"+hexString).substring(hexString.length)}else product+=c;else product+=replacements[c]}const quoteChar=keysOf(quotes).reduce((function(a2,b2){return quotes[a2]<quotes[b2]?a2:b2}));return product=product.replace(new RegExp(quoteChar,"g"),replacements[quoteChar]),quoteChar+product+quoteChar}__name(quoteString,"quoteString");var t9=__toESM(require_lib()),t8=__toESM(require_lib()),Gate1Types=RichStringEnum.withProps()({not:{out:_ref19=>{let[in_]=_ref19;return!1===in_||!0!==in_&&Unknown},includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.not},buf:{out:_ref20=>{let[in_]=_ref20;return!0===in_||!1!==in_&&Unknown},includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.buf}}),Gate1TypeRepr=t8.keyof(Gate1Types.props),Gate2toNTypes=RichStringEnum.withProps()({and:{out:logicAnd,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.and},or:{out:logicOr,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.or},xor:{out:logicXor,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.xor},nand:{out:ins=>LogicValue.invert(logicAnd(ins)),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.nand},nor:{out:ins=>LogicValue.invert(logicOr(ins)),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.nor},xnor:{out:ins=>LogicValue.invert(logicXor(ins)),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.xnor}}),Gate2toNTypeRepr=t8.keyof(Gate2toNTypes.props),Gate2OnlyTypes=RichStringEnum.withProps()({imply:{out:ins=>logicImply(ins[0],ins[1]),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.imply},rimply:{out:ins=>logicImply(ins[1],ins[0]),includeInContextMenu:!1,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.rimply},nimply:{out:ins=>LogicValue.invert(logicImply(ins[0],ins[1])),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.nimply},rnimply:{out:ins=>LogicValue.invert(logicImply(ins[1],ins[0])),includeInContextMenu:!1,includeInPoseAs:!0,fullShortDesc:()=>S.Components.Gate.rnimply},txa:{out:ins=>ins[0],includeInContextMenu:!0,includeInPoseAs:!1,fullShortDesc:()=>S.Components.Gate.txa},txb:{out:ins=>ins[1],includeInContextMenu:!1,includeInPoseAs:!1,fullShortDesc:()=>S.Components.Gate.txb},txna:{out:ins=>LogicValue.invert(ins[0]),includeInContextMenu:!1,includeInPoseAs:!1,fullShortDesc:()=>S.Components.Gate.txna},txnb:{out:ins=>LogicValue.invert(ins[1]),includeInContextMenu:!1,includeInPoseAs:!1,fullShortDesc:()=>S.Components.Gate.txnb}}),Gate2OnlyTypeRepr=t8.keyof(Gate2OnlyTypes.props),GateNTypes=RichStringEnum.withProps()({...Gate2toNTypes.props,...Gate2OnlyTypes.props}),GateNTypeRepr=t8.union([Gate2toNTypeRepr,Gate2OnlyTypeRepr]);function logicAnd(ins){return!ins.includes(!1)&&(!ins.includes(Unknown)&&!ins.includes(HighImpedance)||Unknown)}function logicOr(ins){return!!ins.includes(!0)||!(!ins.includes(Unknown)&&!ins.includes(HighImpedance))&&Unknown}function logicXor(ins){let count=0;for(const in1 of ins)if(!0===in1)count++;else if(in1===Unknown||in1===HighImpedance)return Unknown;return count%2==1}function logicImply(in0,in1){return logicOr([LogicValue.invert(in0),in1])}__name(logicAnd,"logicAnd"),__name(logicOr,"logicOr"),__name(logicXor,"logicXor"),__name(logicImply,"logicImply");var ALUDef=defineParametrizedComponent("alu",!0,!0,{variantName:_ref21=>{let{bits:bits,ext:ext}=_ref21;return"alu-".concat(bits).concat(ext?"e":"")},idPrefix:"alu",button:{imgWidth:50},repr:{bits:typeOrUndefined(t9.number),ext:typeOrUndefined(t9.boolean),showOp:typeOrUndefined(t9.boolean)},valueDefaults:{showOp:!0},params:{bits:param(4,[2,4,8,16]),ext:paramBool()},validateParams:_ref22=>{let{bits:bits,ext:ext}=_ref22;return{numBits:bits,usesExtendedOpcode:ext}},size:_ref23=>{let{numBits:numBits}=_ref23;return{gridWidth:7,gridHeight:19+2*Math.max(0,numBits-8)}},makeNodes:_ref24=>{let{numBits:numBits,usesExtendedOpcode:usesExtendedOpcode,gridWidth:gridWidth,gridHeight:gridHeight}=_ref24;const inputCenterY=5+Math.max(0,(numBits-8)/2),outputX=gridWidth/2+1,bottom2=(gridHeight+1)/2,topGroup=groupHorizontal("n",0,-bottom2,usesExtendedOpcode?5:3,void 0,{leadLength:20}),cin=topGroup.pop(),opMode=topGroup.pop();return{ins:{A:groupVertical("w",-outputX,-inputCenterY,numBits),B:groupVertical("w",-outputX,inputCenterY,numBits),Op:topGroup,Mode:opMode,Cin:[cin[0],cin[1],"n","Cin (".concat(S.Components.ALU.InputCinDesc,")"),{leadLength:10}]},outs:{S:groupVertical("e",outputX,0,numBits),V:[0,bottom2,"s","V (oVerflow)",{leadLength:20}],Z:[2,bottom2,"s","Z (Zero)",{leadLength:20}],Cout:[-2,bottom2,"s","Cout (".concat(S.Components.ALU.OutputCoutDesc,")"),{leadLength:20}]}}},initialValue:(saved,_ref25)=>{let{numBits:numBits}=_ref25;return{s:ArrayFillWith(false,numBits),v:false,cout:false}}}),ALUOp={shortName:op=>S.Components.ALU[op][0],fullName:op=>S.Components.ALU[op][1]},ALUOps=["A+B","A-B","A+1","A-1","-A","B-A","A*2","A/2","A|B","A&B","A|~B","A&~B","~A","A^B","A<<","A>>"],ALUOpsReduced=["A+B","A-B","A|B","A&B"],ALU=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a;super(parent,ALUDef.with(params),saved),this.numBits=params.numBits,this.usesExtendedOpcode=params.usesExtendedOpcode,this._showOp=null!=(_a=null==saved?void 0:saved.showOp)?_a:ALUDef.aults.showOp}toJSON(){return{bits:this.numBits===ALUDef.aults.bits?void 0:this.numBits,ext:this.usesExtendedOpcode===ALUDef.aults.ext?void 0:this.usesExtendedOpcode,...this.toJSONBase(),showOp:this._showOp!==ALUDef.aults.showOp?this._showOp:void 0}}makeTooltip(){const op=this.op,s=S.Components.ALU.tooltip,opDesc=isUnknown(op)?s.SomeUnknownOperation:s.ThisOperation+" "+ALUOp.fullName(op);return tooltipContent(s.title,mods(div("".concat(s.CurrentlyCarriesOut," ").concat(opDesc,"."))))}get op(){const opValues=this.inputValues(this.inputs.Op);opValues.push(this.inputs.Mode.value);const opIndex=displayValuesFromArray(opValues,!1)[1];return isUnknown(opIndex)?Unknown:(this.usesExtendedOpcode?ALUOps:ALUOpsReduced)[opIndex]}doRecalcValue(){const op=this.op;if(isUnknown(op))return{s:ArrayFillWith(Unknown,this.numBits),v:Unknown,cout:Unknown};return doALUOp(op,this.inputValues(this.inputs.A),this.inputValues(this.inputs.B),this.inputs.Cin.value)}propagateValue(newValue){this.outputValues(this.outputs.S,newValue.s),this.outputs.V.value=newValue.v,this.outputs.Z.value=allZeros(newValue.s),this.outputs.Cout.value=newValue.cout}doDraw(g,ctx){const bounds=this.bounds(),{left:left2,top:top2,right:right2,bottom:bottom2}=bounds,lowerTop=top2+2*GRID_STEP;for(const input2 of this.inputs.A)drawWireLineToComponent(g,input2);for(const input2 of this.inputs.B)drawWireLineToComponent(g,input2);for(const input2 of this.inputs.Op)drawWireLineToComponent(g,input2);drawWireLineToComponent(g,this.inputs.Mode),drawWireLineToComponent(g,this.inputs.Cin);for(const output of this.outputs.S)drawWireLineToComponent(g,output);drawWireLineToComponent(g,this.outputs.Z),drawWireLineToComponent(g,this.outputs.V),drawWireLineToComponent(g,this.outputs.Cout),g.fillStyle=COLOR_BACKGROUND,g.lineWidth=3,g.strokeStyle=ctx.borderColor,g.beginPath(),g.moveTo(left2,top2),g.lineTo(right2,lowerTop),g.lineTo(right2,bottom2-2*GRID_STEP),g.lineTo(left2,bottom2),g.lineTo(left2,this.posY+1*GRID_STEP),g.lineTo(left2+2*GRID_STEP,this.posY),g.lineTo(left2,this.posY-1*GRID_STEP),g.closePath(),g.fill(),g.stroke(),this.drawGroupBox(g,this.inputs.A.group,bounds),this.drawGroupBox(g,this.inputs.B.group,bounds),this.drawGroupBox(g,this.outputs.S.group,bounds),g.beginPath();const opGroupLeft=this.inputs.Mode.posXInParentTransform-2,opGroupRight=this.inputs.Op[0].posXInParentTransform+2,opGroupLeftTop=top2+(this.usesExtendedOpcode?8:11),opGroupRightTop=top2+18;g.moveTo(opGroupLeft,opGroupLeftTop),g.lineTo(opGroupRight,opGroupRightTop),g.lineTo(opGroupRight,opGroupRightTop+8),g.lineTo(opGroupLeft,opGroupLeftTop+8),g.closePath(),g.fillStyle=COLOR_GROUP_SPAN,g.fill(),ctx.inNonTransformedFrame((ctx2=>{g.fillStyle=COLOR_COMPONENT_INNER_LABELS,g.font="11px sans-serif";const carryHOffsetF=Orientation.isVertical(this.orient)?0:1;if(drawLabel(ctx2,this.orient,"Z","s",this.outputs.Z,bottom2-16),drawLabel(ctx2,this.orient,"V","s",this.outputs.V.posXInParentTransform+2*carryHOffsetF,bottom2-10,this.outputs.V),drawLabel(ctx2,this.orient,"Cout","s",this.outputs.Cout.posXInParentTransform+4*carryHOffsetF,bottom2-7,this.outputs.Cout),drawLabel(ctx2,this.orient,"Cin","n",this.inputs.Cin.posXInParentTransform,top2+4,this.inputs.Cin),g.font="bold 11px sans-serif",drawLabel(ctx2,this.orient,"Op","n",(opGroupLeft+opGroupRight)/2,top2+12,this.inputs.Op),g.font="bold 12px sans-serif",drawLabel(ctx2,this.orient,"A","w",left2,this.inputs.A),drawLabel(ctx2,this.orient,"B","w",left2,this.inputs.B),drawLabel(ctx2,this.orient,"S","e",right2,this.outputs.S),this._showOp){const opName=isUnknown(this.op)?"??":ALUOp.shortName(this.op),size=1===opName.length?25:2===opName.length?17:13;g.font="bold ".concat(size,"px sans-serif"),g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,opName,...ctx2.rotatePoint(this.posX+5,this.posY))}}))}doSetShowOp(showOp){this._showOp=showOp,this.requestRedraw({why:"show op changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.ALU.contextMenu,icon=this._showOp?"check":"none";return[["mid",MenuData.item(icon,s.toggleShowOp,(()=>{this.doSetShowOp(!this._showOp)}))],["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("inputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),this.makeChangeBooleanParamsContextMenuItem(s.ParamUseExtendedOpcode,this.usesExtendedOpcode,"ext"),["mid",MenuData.sep()],...this.makeForceOutputsContextMenuItem()]}};function allZeros(vals){for(const v of vals){if(isUnknown(v)||isHighImpedance(v))return Unknown;if(!0===v)return!1}return!0}function doALUOp(op,a2,b2,cin){const numBits=a2.length;switch(op){case"A+B":return doALUAdd(a2,b2,cin);case"A*2":return doALUAdd(a2,a2,cin);case"A+1":return doALUAdd(a2,[!0,...ArrayFillWith(!1,numBits-1)],cin);case"A/2":return doALUSub([...a2.slice(1),a2[numBits-1]],ArrayFillWith(!1,numBits),cin);case"A-1":return doALUSub(a2,[!0,...ArrayFillWith(!1,numBits-1)],cin);case"A-B":return doALUSub(a2,b2,cin);case"B-A":return doALUSub(b2,a2,cin);case"-A":return doALUSub(ArrayFillWith(!1,numBits),a2,cin);default:{let cout=!1;return{s:(()=>{switch(op){case"A|B":return doALUBinOp("or",a2,b2);case"A&B":return doALUBinOp("and",a2,b2);case"A^B":return doALUBinOp("xor",a2,b2);case"A|~B":return doALUBinOp("or",a2,doALUNot(b2));case"A&~B":return doALUBinOp("and",a2,doALUNot(b2));case"~A":return doALUNot(a2);case"A>>":return[...a2.slice(1),cin];case"A<<":return cout=a2[a2.length-1],[cin,...a2.slice(0,a2.length-1)]}})(),v:!1,cout:cout}}}}function doALUAdd(a2,b2,cin){const numBits=a2.length,sum3bits=__name(((a3,b3,c)=>{const asNumber=__name((v2=>!0===v2?1:0),"asNumber"),numUnset=(isUnknown(a3)||isHighImpedance(a3)?1:0)+(isUnknown(b3)||isHighImpedance(a3)?1:0)+(isUnknown(c)||isHighImpedance(a3)?1:0),sum=asNumber(a3)+asNumber(b3)+asNumber(c);return 0===numUnset?[sum%2==1,sum>=2]:1===numUnset&&sum>=2?[Unknown,!0]:[Unknown,Unknown]}),"sum3bits"),s=ArrayFillWith(Unknown,numBits),cins=ArrayFillWith(Unknown,numBits+1);cins[0]=cin;for(let i2=0;i2<numBits;i2++){const[ss,cout2]=sum3bits(cins[i2],a2[i2],b2[i2]);s[i2]=ss,cins[i2+1]=cout2}const cout=cins[numBits];return{s:s,cout:cout,v:isBoolean(cout)&&isBoolean(cins[numBits-2])?cout!==cins[numBits-1]:Unknown}}function doALUSub(a2,b2,cin){const numBits=a2.length,s=ArrayFillWith(Unknown,numBits),toInt=__name((vs=>{let s2=0,col=1;for(const v2 of vs){if(isUnknown(v2))return;s2+=Number(v2)*col,col*=2}return s2}),"toInt"),aInt=toInt(a2),bInt=toInt(b2);let cout=Unknown,v=Unknown;if(void 0!==aInt&&void 0!==bInt&&isBoolean(cin)){let yInt=aInt-bInt-(cin?1:0);yInt<0&&(yInt+=Math.pow(2,numBits));const yBinStr=(yInt>>>0).toString(2).padStart(numBits,"0"),lastIdx=numBits-1;for(let i2=0;i2<numBits;i2++)s[i2]="1"===yBinStr[lastIdx-i2];cout=bInt>aInt-(cin?1:0);const aNeg=!0===a2[lastIdx],bNeg=!0===b2[lastIdx],yNeg=!0===s[lastIdx];v=aNeg!==bNeg&&aNeg!==yNeg}return{s:s,cout:cout,v:v}}function doALUNot(a2){const not=Gate1Types.props.not.out;return ArrayFillUsing((i2=>not([a2[i2]])),a2.length)}function doALUBinOp(op,a2,b2){const func=Gate2toNTypes.props[op].out;return ArrayFillUsing((i2=>func([a2[i2],b2[i2]])),a2.length)}__name(ALU,"ALU"),ALUDef.impl=ALU,__name(allZeros,"allZeros"),__name(doALUOp,"doALUOp"),__name(doALUAdd,"doALUAdd"),__name(doALUSub,"doALUSub"),__name(doALUNot,"doALUNot"),__name(doALUBinOp,"doALUBinOp");var AdderDef=defineComponent("adder",{idPrefix:"adder",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:7,gridHeight:5},makeNodes:()=>{const s=S.Components.Generic;return{ins:{A:[-2,-4,"n","A",{hasTriangle:!0}],B:[2,-4,"n","B",{hasTriangle:!0}],Cin:[5,0,"e",s.InputCarryInDesc,{hasTriangle:!0}]},outs:{S:[0,4,"s",s.OutputSumDesc,{hasTriangle:!0}],Cout:[-5,0,"w",s.OutputCarryOutDesc,{hasTriangle:!0}]}}},initialValue:()=>({s:!1,cout:!1})}),Adder=class extends ComponentBase{constructor(parent,saved){super(parent,AdderDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.Adder.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValue(){const a2=this.inputs.A.value,b2=this.inputs.B.value,cIn=this.inputs.Cin.value;if(isUnknown(a2)||isUnknown(b2)||isUnknown(cIn)||isHighImpedance(a2)||isHighImpedance(b2)||isHighImpedance(cIn))return{s:Unknown,cout:Unknown};switch(+a2+ +b2+ +cIn){case 0:return{s:!1,cout:!1};case 1:return{s:!0,cout:!1};case 2:return{s:!1,cout:!0};case 3:return{s:!0,cout:!0};default:return console.log("ERROR: sum of adder is > 3"),{s:!1,cout:!1}}}propagateValue(newValue){this.outputs.S.value=newValue.s,this.outputs.Cout.value=newValue.cout}doDraw(g,ctx){this.doDrawDefault(g,ctx,(()=>{g.fillStyle=COLOR_COMPONENT_BORDER,g.font="bold 30px sans-serif",g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"+",this.posX,this.posY-2)}))}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};__name(Adder,"Adder"),AdderDef.impl=Adder;var t10=__toESM(require_lib()),AdderArrayDef=defineParametrizedComponent("adder-array",!0,!0,{variantName:_ref26=>{let{bits:bits}=_ref26;return"adder-array-".concat(bits)},idPrefix:"adder",button:{imgWidth:50},repr:{bits:typeOrUndefined(t10.number)},valueDefaults:{},params:{bits:param(4,[2,4,8,16])},validateParams:_ref27=>{let{bits:bits}=_ref27;return{numBits:bits}},size:_ref28=>{let{numBits:numBits}=_ref28;return{gridWidth:4,gridHeight:ALUDef.size({numBits:numBits,usesExtendedOpcode:!1}).gridHeight}},makeNodes:_ref29=>{let{numBits:numBits,gridHeight:gridHeight}=_ref29;const inputCenterY=5+Math.max(0,(numBits-8)/2),coutY=Math.floor(gridHeight/2)+1,cinY=-coutY;return{ins:{A:groupVertical("w",-3,-inputCenterY,numBits),B:groupVertical("w",-3,inputCenterY,numBits),Cin:[0,cinY,"n"]},outs:{S:groupVertical("e",3,0,numBits),Cout:[0,coutY,"s"]}}},initialValue:(saved,_ref30)=>{let{numBits:numBits}=_ref30;return{s:ArrayFillWith(!1,numBits),cout:!1}}}),AdderArray=class extends ParametrizedComponentBase{constructor(parent,params,saved){super(parent,AdderArrayDef.with(params),saved),this.numBits=params.numBits}toJSON(){return{...this.toJSONBase(),bits:this.numBits===AdderArrayDef.aults.bits?void 0:this.numBits}}makeTooltip(){const s=S.Components.AdderArray.tooltip;return tooltipContent(s.title.expand({numBits:this.numBits}),mods(div(s.desc)))}doRecalcValue(){return doALUAdd(this.inputValues(this.inputs.A),this.inputValues(this.inputs.B),this.inputs.Cin.value)}propagateValue(newValue){this.outputValues(this.outputs.S,newValue.s),this.outputs.Cout.value=newValue.cout}doDraw(g,ctx){this.doDrawDefault(g,ctx,(ctx2=>{g.font="bold 25px sans-serif",g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"+",...ctx2.rotatePoint(this.posX-4,this.posY-2))}))}makeComponentSpecificContextMenuItems(){return[this.makeChangeParamsContextMenuItem("inputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}};__name(AdderArray,"AdderArray"),AdderArrayDef.impl=AdderArray;var t12=__toESM(require_lib()),t11=__toESM(require_lib()),InputBase=class extends ParametrizedComponentBase{constructor(parent,SubclassDef,saved){var _a;super(parent,SubclassDef,saved),this._name=null!=(_a=null==saved?void 0:saved.name)?_a:void 0}toJSONBase(){return{...super.toJSONBase(),name:this._name}}isOver(x,y){return 1===this.numBits?distSquared(x,y,this.posX,this.posY)<169:inRect(this.posX,this.posY,this.width,this.height,x,y)}get allowsForcedOutputs(){return!1}get name(){return this._name}doRecalcValue(){return this.value}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}shouldDrawBorder(){return!0}doDraw(g,ctx){1===this.numBits?this.doDrawSingle(g,ctx,this.outputs.Out[0]):this.doDrawMulti(g,ctx,this.outputs.Out)}doDrawSingle(g,ctx,output){drawWireLineToComponent(g,output);const displayValue=this.parent.editor.options.hideInputColors?Unknown:output.value,shouldDrawBorder=this.shouldDrawBorder();if(shouldDrawBorder){ctx.isMouseOver&&0!==this.parent.mode?(g.strokeStyle=ctx.borderColor,g.fillStyle=ctx.borderColor):(g.strokeStyle=COLOR_COMPONENT_BORDER,g.fillStyle=COLOR_COMPONENT_BORDER),g.lineWidth=3,g.beginPath();const triangleLeft=this.posX+13-1,triangleRight=this.posX+13+5,triangleVOffset=6.75;triangle(g,triangleLeft,this.posY+triangleVOffset,triangleRight,this.posY,triangleLeft,this.posY-triangleVOffset),g.lineWidth=2,g.fill(),g.stroke(),g.fillStyle=colorForLogicValue(displayValue),g.lineWidth=4,g.beginPath(),circle(g,this.posX,this.posY,26),g.fill(),g.stroke()}ctx.inNonTransformedFrame((ctx2=>{void 0!==this._name&&drawComponentName(g,ctx2,this._name,toLogicValueRepr(displayValue),this,!1);const forcedFillStyle=shouldDrawBorder?void 0:g.fillStyle=COLOR_COMPONENT_BORDER;drawValueTextCentered(g,displayValue,this,{fillStyle:forcedFillStyle})}))}doDrawMulti(g,ctx,outputs){const bounds=this.bounds(),{left:left2,top:top2,width:width}=bounds,outline=bounds.outline(g);g.fillStyle=COLOR_BACKGROUND,g.fill(outline);for(const output of outputs)drawWireLineToComponent(g,output);const displayValues=this.parent.editor.options.hideInputColors?ArrayFillWith(Unknown,this.numBits):this.value,drawMouseOver=ctx.isMouseOver&&0!==this.parent.mode;g.strokeStyle=drawMouseOver?ctx.borderColor:COLOR_COMPONENT_BORDER,g.lineWidth=1;const cellHeight=useCompact(this.numBits)?GRID_STEP:2*GRID_STEP;for(let i2=0;i2<this.numBits;i2++){const y=top2+i2*cellHeight;g.fillStyle=colorForLogicValue(displayValues[i2]),g.beginPath(),g.rect(left2,y,width,cellHeight),g.fill(),g.stroke()}g.lineWidth=3,g.stroke(outline),ctx.inNonTransformedFrame((ctx2=>{if(void 0!==this._name){const valueString=displayValues.map(toLogicValueRepr).reverse().join("");drawComponentName(g,ctx2,this._name,valueString,this,!1)}for(let i2=0;i2<this.numBits;i2++){const y=top2+cellHeight/2+i2*cellHeight;drawValueText(g,displayValues[i2],...ctx2.rotatePoint(this.posX,y),{small:useCompact(this.numBits)})}}))}autoConnected(newLinks){if(1!==newLinks.length)return;const[outNode,comp,inNode]=newLinks[0];if(inNode instanceof NodeIn&&(inNode.prefersSpike&&this.doSetIsPushButton(!0),void 0!==this._name||isTrivialNodeName(inNode.shortName)||this.doSetName(inNode.shortName)),"e"===outNode.orient)switch(Orientation.add(comp.orient,inNode.orient)){case"w":return;case"e":return this.doSetOrient("w"),void this.setPosition(this.posX+6*GRID_STEP,this.posY,!1);case"s":return this.doSetOrient("n"),void this.setPosition(this.posX+3*GRID_STEP,this.posY+3*GRID_STEP,!1);case"n":return this.doSetOrient("s"),void this.setPosition(this.posX+3*GRID_STEP,this.posY-3*GRID_STEP,!1)}}doSetIsPushButton(__isPushButton){}doSetName(name2){this._name=name2,this.requestRedraw({why:"name changed"})}makeComponentSpecificContextMenuItems(){return[["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetNameDialog(this._name,this.doSetName.bind(this))}};__name(InputBase,"InputBase");var InputDef=defineParametrizedComponent("in",!1,!0,{variantName:_ref31=>{let{bits:bits}=_ref31;return"in-".concat(bits)},idPrefix:"in",button:{imgWidth:32},repr:{bits:typeOrUndefined(t11.number),val:typeOrUndefined(InputOutputValueRepr),isPushButton:typeOrUndefined(t11.boolean),isConstant:typeOrUndefined(t11.boolean),name:ComponentNameRepr},valueDefaults:{isPushButton:!1,isConstant:!1},params:{bits:param(1,[1,2,3,4,5,6,7,8,12,16,24,32])},validateParams:_ref32=>{let{bits:bits}=_ref32;return{numBits:bits}},size:_ref33=>{let{numBits:numBits}=_ref33;if(1===numBits){const d=26/GRID_STEP;return{gridWidth:d,gridHeight:d}}return{gridWidth:2,gridHeight:useCompact(numBits)?numBits:2*numBits}},makeNodes:_ref34=>{let{numBits:numBits}=_ref34;return{outs:{Out:groupVertical("e",1===numBits?3:2,0,numBits,void 0,{hasTriangle:1!==numBits})}}},initialValue:(saved,_ref35)=>{let{numBits:numBits}=_ref35;return valuesFromReprForInput(null==saved?void 0:saved.val,numBits)}}),Input=class extends InputBase{constructor(parent,params,saved){var _a,_b;super(parent,InputDef.with(params),saved),this.isCustomComponentInput=!1,this.numBits=params.numBits,this._isPushButton=null!=(_a=null==saved?void 0:saved.isPushButton)?_a:InputDef.aults.isPushButton,this._isConstant=null!=(_b=null==saved?void 0:saved.isConstant)?_b:InputDef.aults.isConstant}toJSON(){return{...this.toJSONBase(),bits:this.numBits===InputDef.aults.bits?void 0:this.numBits,val:this.contentRepr(!0),isPushButton:this._isPushButton!==InputDef.aults.isPushButton?this._isPushButton:void 0,isConstant:this._isConstant!==InputDef.aults.isConstant?this._isConstant:void 0}}get isConstant(){return this._isConstant}contentRepr(undefinedIfTrivial){return reprForLogicValues(this.value,undefinedIfTrivial)}cursorWhenMouseover(e){var _a,_b;const mode=this.parent.mode;return 0===mode?"not-allowed":null!=(_a=null==e?void 0:e.ctrlKey)&&_a&&mode>=2?"context-menu":null!=(_b=null==e?void 0:e.altKey)&&_b&&mode>=3?"copy":this.isCustomComponentInput?"grab":this._isConstant?mode>=3&&!this.lockPos?"grab":void 0:"pointer"}makeTooltip(){return tooltipContent(void 0,mods(S.Components.Input.tooltip.title.expand({numBits:this.numBits})))}get isLinkedToSomeClock(){return this.outputs._all.some((out=>out.outgoingWires.some((w=>w.endNode.isClock))))}get isPushButton(){return this._isPushButton}shouldDrawBorder(){return!this._isConstant}pointerClicked(e){let result;if((result=super.pointerClicked(e)).isChange)return result;if(0===this.parent.mode||this._isPushButton||this._isConstant)return InteractionResult.NoChange;if(this.isCustomComponentInput)return this.parent.editor.showMessage(S.Components.Input.contextMenu.InputSetFromOutside),InteractionResult.NoChange;const i2=this.clickedBitIndex(e);if(-1===i2)return InteractionResult.SimpleChange;const altKey=e.altKey,doChange=__name((()=>(this.doSetValueChangingBit(i2,nextValue(this.value[i2],this.parent.mode,altKey)),!0)),"doChange");return doChange(),InteractionResult.RepeatableChange(doChange)}pointerDown(e){return this.trySetPushButtonBit(!0,e),super.pointerDown(e)}pointerUp(e){const result=super.pointerUp(e);return this.trySetPushButtonBit(!1,e),result}clickedBitIndex(e){const h=this.unrotatedHeight,y=this.parent.editor.offsetXYForComponent(e,this)[1]-this.posY+h/2,i2=Math.floor(y*this.numBits/h);return i2>=0&&i2<this.numBits?i2:-1}trySetPushButtonBit(v,e){let i2;0!==this.parent.mode&&this._isPushButton&&!this._isConstant&&this.parent.editor.eventMgr.currentSelectionEmpty()&&-1!==(i2=this.clickedBitIndex(e))&&(this.isCustomComponentInput?!1!==v&&this.parent.editor.showMessage(S.Components.Input.contextMenu.InputSetFromOutside):this.doSetValueChangingBit(i2,v))}doSetValueChangingBit(i2,v){const newValues=[...this.value];newValues[i2]=v,this.doSetValue(newValues)}setValue(values){values.length===this.numBits?this.doSetValue(values):console.warn("Expected ".concat(this.numBits," values, got ").concat(values.length," for input ").concat(this.ref))}doSetIsPushButton(isPushButton){this._isPushButton=isPushButton,isPushButton&&this.doSetValue(ArrayFillWith(!1,this.numBits))}doSetIsConstant(isConstant){this._isConstant=isConstant,this.requestRedraw({why:"constant changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.Input.contextMenu,makeItemBehaveAs=__name(((desc,value)=>{const isCurrent=this._isPushButton===value,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>this.doSetIsPushButton(value);return MenuData.item(icon,desc,action)}),"makeItemBehaveAs"),newItems=[["mid",makeItemBehaveAs(s.ToggleButton,!1)],["mid",makeItemBehaveAs(s.PushButton,!0)],["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("outputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),["mid",MenuData.sep()]];if(1===this.numBits){const makeToggleConstantItem=__name((()=>{const icon=this._isConstant?"check":"none",action=__name((()=>this.doSetIsConstant(!this._isConstant)),"action");return MenuData.item(icon,s.LockValue+" (".concat(toLogicValueRepr(this.value[0]),")"),action)}),"makeToggleConstantItem"),replaceWithClockItem=MenuData.item("timer",s.ReplaceWithClock,(()=>{this.replaceWithComponent(ClockDef.make(this.parent))}));newItems.push(["mid",makeToggleConstantItem()],["mid",MenuData.sep()],["mid",replaceWithClockItem],["mid",MenuData.sep()])}return newItems.push(...super.makeComponentSpecificContextMenuItems()),newItems}};function nextValue(value,mode,altKey){switch(value){case!0:return!!(mode>=4&&altKey)&&Unknown;case!1:return!(mode>=4&&altKey)||Unknown;case Unknown:return mode>=4?!!altKey&&HighImpedance:Unknown;case HighImpedance:return mode>=4?!!altKey&&Unknown:HighImpedance}}__name(Input,"Input"),InputDef.impl=Input,__name(nextValue,"nextValue");var ClockDef=defineComponent("clock",{idPrefix:"clock",button:{imgWidth:50},repr:{name:ComponentNameRepr,period:t12.number,dutycycle:typeOrUndefined(t12.number),phase:typeOrUndefined(t12.number),showLabel:typeOrUndefined(t12.boolean)},valueDefaults:{period:2e3,dutycycle:50,phase:0,showLabel:!0},size:{gridWidth:2,gridHeight:2},makeNodes:()=>({outs:{Out:[[3,0,"e"]]}}),initialValue:()=>[!1]}),Clock=class extends InputBase{constructor(parent,saved){var _a,_b;super(parent,[ClockDef,void 0],saved),this._period=null!=(_a=null==saved?void 0:saved.period)?_a:ClockDef.aults.period,this._dutycycle=void 0!==(null==saved?void 0:saved.dutycycle)?saved.dutycycle%100:ClockDef.aults.dutycycle,this._phase=void 0!==(null==saved?void 0:saved.phase)?saved.phase%this._period:ClockDef.aults.phase,this._showLabel=null!=(_b=null==saved?void 0:saved.showLabel)?_b:ClockDef.aults.showLabel,this.tickCallback()}get numBits(){return 1}toJSON(){return{...this.toJSONBase(),period:this._period,dutycycle:this._dutycycle===ClockDef.aults.dutycycle?void 0:this._dutycycle,phase:this._phase===ClockDef.aults.phase?void 0:this._phase,showLabel:this._showLabel===ClockDef.aults.showLabel?void 0:this._showLabel}}toStringDetails(){return"period=".concat(this._period," duty=").concat(this._dutycycle," phase=").concat(this._phase)}makeTooltip(){const s=S.Components.Clock.tooltip;return tooltipContent(s.title,mods(s.period[0]+this._period+s.period[1],br,s.dutycycle[0]+this._dutycycle+s.dutycycle[1],0===this._phase?emptyMod:mods(br,s.phase[0]+this._phase+s.phase[1])))}currentClockValue(logicalTime){let timeOverPeriod=(logicalTime-this._phase)%this._period;timeOverPeriod<0&&(timeOverPeriod+=this._period);const onDuration=this._period*this._dutycycle/100,offDuration=this._period-onDuration;let value,timeOverLastTick;timeOverPeriod<onDuration?(value=!0,timeOverLastTick=timeOverPeriod):(value=!1,timeOverLastTick=timeOverPeriod-onDuration);return[value,logicalTime-timeOverLastTick+(value?onDuration:offDuration)]}tickCallback(){const timeline=this.parent.editor.timeline,[value,nextTick]=this.currentClockValue(timeline.logicalTime());if(this.doSetValue([value]),2!==this.state){const s=S.Components.Clock.timeline,desc=value?s.NextFallingEdge:s.NextRisingEdge;timeline.scheduleAt(nextTick,(()=>{this.tickCallback()}),desc,!0)}}doDraw(g,ctx){super.doDraw(g,ctx),this._showLabel&&ctx.inNonTransformedFrame((()=>{const offsetY="s"===this.orient?-36:26;g.strokeStyle=COLOR_COMPONENT_BORDER,g.lineWidth=1;const left2=this.posX-20,mid1=left2+40*this._phase/this._period,mid2=mid1+40*this._dutycycle/100,right2=this.posX+20,bottom2=this.posY+offsetY+5,top2=this.posY+offsetY-5;g.beginPath(),g.moveTo(left2,bottom2),g.lineTo(mid1,bottom2),g.lineTo(mid1,top2),g.lineTo(mid2,top2),g.lineTo(mid2,bottom2),g.lineTo(right2,bottom2),g.stroke(),g.fillStyle=COLOR_COMPONENT_BORDER,g.font="10px sans-serif";const periodStr=this._period>=1e3?this._period/1e3+" s":this._period+" ms";g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,periodStr,this.posX,bottom2+8)}))}doSetPeriod(period){this._period=period,this.requestRedraw({why:"period changed",invalidateTests:!0})}makeComponentSpecificContextMenuItems(){const s=S.Components.Clock.contextMenu;let matchesSomePreset=!1;const makeItemSetPeriod=__name((data2=>{const[period,desc]=data2,isCurrent=this._period===period;matchesSomePreset=matchesSomePreset||isCurrent;const icon=isCurrent?"check":"none";return MenuData.item(icon,desc,(()=>this.doSetPeriod(period)))}),"makeItemSetPeriod"),presetPeriodItems=[[100,"100 ms (10 Hz)"],[250,"250 ms (4 Hz)"],[500,"500 ms (2 Hz)"],[1e3,"1 s (1 Hz)"],[2e3,"2 s (0.5 Hz)"],[4e3,"4 s (0.25 Hz)"],[8e3,"8 s (0.125 Hz)"],[16e3,"16 s (0.0625 Hz)"]].map(makeItemSetPeriod),customPeriodItem=MenuData.item(matchesSomePreset?"none":"check",s.CustomPeriod+(matchesSomePreset?"…":" ("+this._period+" ms, "+Math.round(1e6/this._period)/1e3+" Hz)…"),(()=>this.runSetPeriodDialog())),replaceWithInputItem=MenuData.item("replace",s.ReplaceWithInput,(()=>{this.replaceWithComponent(InputDef.make(this.parent,{bits:1}))}));return[...super.makeComponentSpecificContextMenuItems(),["mid",MenuData.sep()],["mid",MenuData.submenu("timer",s.Period,[...presetPeriodItems,MenuData.sep(),customPeriodItem])],["mid",MenuData.sep()],["mid",replaceWithInputItem]]}runSetPeriodDialog(){const s=S.Components.Clock.contextMenu,newPeriodStr=window.prompt(s.SetPeriodMillis,String(this._period));if(null===newPeriodStr||0===newPeriodStr.length)return;const newPeriod=parseInt(newPeriodStr);if(isNaN(newPeriod)||newPeriod<1)return window.alert(s.InvalidPeriod),void this.runSetPeriodDialog();this.doSetPeriod(newPeriod)}};__name(Clock,"Clock"),ClockDef.impl=Clock;var ComparatorDef=defineComponent("comp",{idPrefix:"comp",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:5,gridHeight:7},makeNodes:()=>({ins:{A:[-4,2,"w","A",{hasTriangle:!0}],B:[-4,-2,"w","B",{hasTriangle:!0}],E:[0,5,"s","E",{hasTriangle:!0}]},outs:{G:[4,0,"e",">",{hasTriangle:!0,labelName:">"}],Eq:[0,-5,"n","=",{hasTriangle:!0,labelName:"="}]}}),initialValue:()=>({g:!1,eq:!1})}),Comparator=class extends ComponentBase{constructor(parent,saved){super(parent,ComparatorDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.Comparator.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValue(){const a2=this.inputs.A.value,b2=this.inputs.B.value,e=this.inputs.E.value;if(isUnknown(a2)||isUnknown(b2)||isUnknown(e)||isHighImpedance(a2)||isHighImpedance(b2)||isHighImpedance(e))return{g:Unknown,eq:Unknown};if(0==+e)return{g:!1,eq:!1};return{g:+a2>+b2,eq:+a2==+b2}}propagateValue(newValue){this.outputs.G.value=newValue.g,this.outputs.Eq.value=newValue.eq}doDraw(g,ctx){this.doDrawDefault(g,ctx,(()=>{g.fillStyle=COLOR_COMPONENT_BORDER,g.font="bold 11px sans-serif",g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"CMP",this.posX,this.posY)}))}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};__name(Comparator,"Comparator"),ComparatorDef.impl=Comparator;var t13=__toESM(require_lib()),ControlledInverterDef=defineParametrizedComponent("cnot-array",!0,!0,{variantName:_ref36=>{let{bits:bits,bottom:bottom2}=_ref36;return"cnot-array-".concat(bits).concat(bottom2?"b":"")},idPrefix:"cnot",button:{imgWidth:50},repr:{bits:typeOrUndefined(t13.number),bottom:typeOrUndefined(t13.boolean)},valueDefaults:{},params:{bits:param(4,[2,4,8,16]),bottom:paramBool()},validateParams:_ref37=>{let{bits:bits,bottom:bottom2}=_ref37;return{numBits:bits,controlPinsAtBottom:bottom2}},size:_ref38=>{let{numBits:numBits}=_ref38;return{gridWidth:4,gridHeight:8+Math.max(0,numBits-8)}},makeNodes:_ref39=>{let{numBits:numBits,controlPinsAtBottom:controlPinsAtBottom,gridHeight:gridHeight}=_ref39;return{ins:{In:groupVertical("w",-3,0,numBits),S:[0,-(gridHeight/2+1)*(controlPinsAtBottom?-1:1),controlPinsAtBottom?"s":"n"]},outs:{Out:groupVertical("e",3,0,numBits)}}},initialValue:(saved,_ref40)=>{let{numBits:numBits}=_ref40;return ArrayFillWith(!1,numBits)}}),ControlledInverter=class extends ParametrizedComponentBase{constructor(parent,params,saved){super(parent,ControlledInverterDef.with(params),saved),this.numBits=params.numBits,this.controlPinsAtBottom=params.controlPinsAtBottom}toJSON(){return{...this.toJSONBase(),bits:this.numBits===ControlledInverterDef.aults.bits?void 0:this.numBits,bottom:this.controlPinsAtBottom===ControlledInverterDef.aults.bottom?void 0:this.controlPinsAtBottom}}makeTooltip(){const s=S.Components.ControlledInverter.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValue(){const input2=this.inputValues(this.inputs.In),switch_=this.inputs.S.value;return isUnknown(switch_)||isHighImpedance(switch_)?ArrayFillWith(Unknown,this.numBits):switch_?input2.map(LogicValue.invert):input2}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}doDraw(g,ctx){this.doDrawDefault(g,ctx,{skipLabels:!0,drawInside:_ref41=>{let{top:top2,bottom:bottom2,left:left2,right:right2}=_ref41;const invert=this.inputs.S.value;g.lineWidth=2,g.strokeStyle=colorForLogicValue(invert),g.beginPath(),this.controlPinsAtBottom?(g.moveTo(this.posX,bottom2),g.lineTo(this.posX,this.posY+4)):(g.moveTo(this.posX,top2),g.lineTo(this.posX,this.posY-4)),g.stroke(),g.strokeStyle=!0===invert?COLOR_COMPONENT_BORDER:COLOR_UNKNOWN,g.beginPath(),g.moveTo(left2+12,this.posY-8),g.lineTo(right2-13,this.posY),g.lineTo(left2+12,this.posY+8),g.closePath(),g.stroke(),g.beginPath(),circle(g,right2-10,this.posY,5),g.stroke()}})}makeComponentSpecificContextMenuItems(){const s=S.Components.Generic.contextMenu;return[this.makeChangeParamsContextMenuItem("inputs",s.ParamNumBits,this.numBits,"bits"),this.makeChangeBooleanParamsContextMenuItem(s.ParamControlBitAtBottom,this.controlPinsAtBottom,"bottom"),...this.makeForceOutputsContextMenuItem(!0)]}};__name(ControlledInverter,"ControlledInverter"),ControlledInverterDef.impl=ControlledInverter;var t15=__toESM(require_lib()),t14=__toESM(require_lib()),FlipflopOrLatchDef=defineAbstractComponent({button:{imgWidth:50},repr:{state:typeOrUndefined(LogicValueRepr),showContent:typeOrUndefined(t14.boolean)},valueDefaults:{state:!1,showContent:!0},size:{gridWidth:5,gridHeight:7},makeNodes:()=>{const s=S.Components.Generic;return{outs:{Q:[4,-2,"e",s.OutputQDesc],"Q̅":[4,2,"e",s.OutputQBarDesc]}}},initialValue:(saved,defaults)=>{if(void 0===saved)return[!1,!0];const state=void 0===saved.state?defaults.state:toLogicValue(saved.state);return[state,LogicValue.invert(state)]}}),FlipflopOrLatch=class extends ComponentBase{constructor(parent,SubclassDef,saved){var _a;super(parent,SubclassDef,saved),this._isInInvalidState=!1,this._showContent=null!=(_a=null==saved?void 0:saved.showContent)?_a:FlipflopOrLatchDef.aults.showContent}toJSONBase(){const state=this.value[0];return{...super.toJSONBase(),state:state!==FlipflopOrLatchDef.aults.state?toLogicValueRepr(state):void 0,showContent:this._showContent!==FlipflopOrLatchDef.aults.showContent?this._showContent:void 0}}propagateValue(newValue){this.outputs.Q.value=newValue[0],this.outputs.Q̅.value=newValue[1]}doSetShowContent(showContent){this._showContent=showContent,this.requestRedraw({why:"show content changed"})}doDraw(g,ctx){this.doDrawDefault(g,ctx,{background:this._isInInvalidState?COLOR_BACKGROUND_INVALID:void 0,drawLabels:()=>{this._showContent&&!this.parent.editor.options.hideMemoryContent&&FlipflopOrLatch.drawStoredValue(g,this.value[0],this.posX,this.posY,26,!1)}})}static drawStoredValueFrame(g,x,y,width,height,swapHeightWidth){swapHeightWidth&&([width,height]=[height,width]),g.strokeStyle=COLOR_COMPONENT_BORDER,g.lineWidth=2,g.beginPath(),g.rect(x-width/2,y-height/2,width,height),g.fill(),g.stroke()}static drawStoredValue(g,value,x,y,cellHeight,swapHeightWidth){g.fillStyle=colorForLogicValue(value),FlipflopOrLatch.drawStoredValueFrame(g,x,y,20,cellHeight,swapHeightWidth),drawValueText(g,value,x,y,{small:cellHeight<18})}};__name(FlipflopOrLatch,"FlipflopOrLatch");var FlipflopBaseDef=defineAbstractComponent({button:FlipflopOrLatchDef.button,repr:{...FlipflopOrLatchDef.repr,trigger:typeOrUndefined(t14.keyof(EdgeTrigger))},valueDefaults:{...FlipflopOrLatchDef.valueDefaults,trigger:EdgeTrigger.rising},size:FlipflopOrLatchDef.size,makeNodes:clockYOffset=>{const base=FlipflopOrLatchDef.makeNodes(),s=S.Components.Generic;return{ins:{Clock:[-4,clockYOffset,"w",s.InputClockDesc,{isClock:!0}],Pre:[0,-4,"n",s.InputPresetDesc,{prefersSpike:!0}],Clr:[0,4,"s",s.InputClearDesc,{prefersSpike:!0}]},outs:base.outs}},initialValue:FlipflopOrLatchDef.initialValue}),Flipflop=class extends FlipflopOrLatch{constructor(parent,SubclassDef,saved){var _a;super(parent,SubclassDef,saved),this._lastClock=Unknown,this._trigger=null!=(_a=null==saved?void 0:saved.trigger)?_a:FlipflopBaseDef.aults.trigger}toJSONBase(){return{...super.toJSONBase(),trigger:this._trigger!==FlipflopBaseDef.aults.trigger?this._trigger:void 0}}get trigger(){return this._trigger}static doRecalcValueForSyncComponent(comp,prevClock,clock,preset,clear){return!0===preset?!0===clear?{isInInvalidState:!0,newState:comp.makeInvalidState()}:{isInInvalidState:!1,newState:comp.makeStateFromMainValue(!0)}:!0===clear?{isInInvalidState:!1,newState:comp.makeStateFromMainValue(!1)}:Flipflop.isClockTrigger(comp.trigger,prevClock,clock)?{isInInvalidState:!1,newState:comp.makeStateAfterClock()}:{isInInvalidState:!1,newState:comp.value}}static isClockTrigger(trigger,prevClock,clock){return trigger===EdgeTrigger.rising&&!1===prevClock&&!0===clock||trigger===EdgeTrigger.falling&&!0===prevClock&&!1===clock}doRecalcValue(){const prevClock=this._lastClock,clock=this._lastClock=this.inputs.Clock.value,{isInInvalidState:isInInvalidState,newState:newState}=Flipflop.doRecalcValueForSyncComponent(this,prevClock,clock,this.inputs.Pre.value,this.inputs.Clr.value);return this._isInInvalidState=isInInvalidState,newState}makeInvalidState(){return[!1,!1]}makeStateFromMainValue(val){return[val,LogicValue.invert(val)]}makeStateAfterClock(){return this.makeStateFromMainValue(LogicValue.filterHighZ(this.doRecalcValueAfterClock()))}doSetTrigger(trigger){this._trigger=trigger,this.requestRedraw({why:"trigger changed",invalidateTests:!0})}makeComponentSpecificContextMenuItems(){const icon=this._showContent?"check":"none",toggleShowContentItem=MenuData.item(icon,S.Components.Generic.contextMenu.ShowContent,(()=>this.doSetShowContent(!this._showContent)));return[...makeTriggerItems(this._trigger,this.doSetTrigger.bind(this)),["mid",MenuData.sep()],["mid",toggleShowContentItem],...this.makeForceOutputsContextMenuItem(!0)]}};function makeTriggerItems(currentTrigger,handler){const s=S.Components.Generic.contextMenu,makeTriggerItem=__name(((trigger,desc)=>{const isCurrent=currentTrigger===trigger,icon=isCurrent?"check":"none",caption=s.TriggerOn+" "+desc,action=isCurrent?()=>{}:()=>handler(trigger);return MenuData.item(icon,caption,action)}),"makeTriggerItem");return[["mid",makeTriggerItem(EdgeTrigger.rising,s.TriggerRisingEdge)],["mid",makeTriggerItem(EdgeTrigger.falling,s.TriggerFallingEdge)]]}__name(Flipflop,"Flipflop"),__name(makeTriggerItems,"makeTriggerItems");var CounterDef=defineParametrizedComponent("counter",!0,!0,{variantName:_ref42=>{let{bits:bits}=_ref42;return"counter-".concat(bits)},idPrefix:"counter",button:{imgWidth:50},repr:{bits:typeOrUndefined(t15.number),count:typeOrUndefined(t15.number),trigger:typeOrUndefined(t15.keyof(EdgeTrigger)),displayRadix:typeOrUndefined(typeOrNull(t15.number))},valueDefaults:{trigger:EdgeTrigger.rising,displayRadix:10},params:{bits:param(4,[2,3,4,7,8,16])},validateParams:_ref43=>{let{bits:bits}=_ref43;return{numBits:bits}},size:_ref44=>{let{numBits:numBits}=_ref44;return{gridWidth:numBits<=6?5:numBits<=8?6:7,gridHeight:Math.max(11,1+(numBits+1)*(useCompact(numBits)?1:2))}},makeNodes:_ref45=>{let{numBits:numBits,gridWidth:gridWidth,gridHeight:gridHeight}=_ref45;const s=S.Components.Generic,outX=1+gridWidth/2,groupQ=groupVertical("e",outX,-1,numBits),lastQY=groupQ[numBits-1][1],clockVY=lastQY+(lastQY-groupQ[numBits-2][1]),clearY=(gridHeight+1)/2;return{ins:{Clock:[-outX,clockVY,"w",s.InputClockDesc,{isClock:!0}],Clr:[0,clearY,"s",s.InputClearDesc,{prefersSpike:!0}]},outs:{Q:groupQ,V:[outX,clockVY,"e","V (oVerflow)"]}}},initialValue:(saved,_ref46)=>{let{numBits:numBits}=_ref46;return void 0===saved||void 0===saved.count?Counter.emptyValue(numBits):[Counter.decimalToNBits(saved.count,numBits),!1]}}),Counter=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a;super(parent,CounterDef.with(params),saved),this._lastClock=Unknown,this.numBits=params.numBits,this._trigger=null!=(_a=null==saved?void 0:saved.trigger)?_a:CounterDef.aults.trigger,this._displayRadix=void 0===(null==saved?void 0:saved.displayRadix)?CounterDef.aults.displayRadix:null===saved.displayRadix?void 0:saved.displayRadix}static emptyValue(numBits){return[ArrayFillWith(!1,numBits),!1]}static decimalToNBits(value,width){const binStr=value.toString(2).padStart(width,"0"),asBits=ArrayFillWith(!1,width);for(let i2=0;i2<width;i2++)asBits[i2]="1"===binStr[width-i2-1];return asBits}toJSON(){const[__,currentCountOrUnknown]=displayValuesFromArray(this.value[0],!1),currentCount=isUnknown(currentCountOrUnknown)?0:currentCountOrUnknown,displayRadix=void 0===this._displayRadix?null:this._displayRadix;return{...this.toJSONBase(),bits:this.numBits===CounterDef.aults.bits?void 0:this.numBits,count:0===currentCount?void 0:currentCount,trigger:this._trigger!==CounterDef.aults.trigger?this._trigger:void 0,displayRadix:displayRadix!==CounterDef.aults.displayRadix?displayRadix:void 0}}get trigger(){return this._trigger}makeTooltip(){const s=S.Components.Counter.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValue(){if(!0===this.inputs.Clr.value)return Counter.emptyValue(this.numBits);const prevClock=this._lastClock,clock=this._lastClock=this.inputs.Clock.value,activeOverflowValue=this._trigger===EdgeTrigger.rising;if(Flipflop.isClockTrigger(this._trigger,prevClock,clock)){const[__,value]=displayValuesFromArray(this.value[0],!1);if(isUnknown(value))return[ArrayFillWith(Unknown,this.numBits),Unknown];const newValue=value+1;return newValue>=Math.pow(2,this.numBits)?[ArrayFillWith(!1,this.numBits),activeOverflowValue]:[Counter.decimalToNBits(newValue,this.numBits),!activeOverflowValue]}return[this.value[0],!activeOverflowValue]}propagateValue(newValue){const[counter,overflow]=newValue;this.outputValues(this.outputs.Q,counter),this.outputs.V.value=overflow}doSetTrigger(trigger){this._trigger=trigger,this.requestRedraw({why:"trigger changed",invalidateTests:!0})}doDraw(g,ctx){this.doDrawDefault(g,ctx,((ctx2,_ref47)=>{let{width:width}=_ref47;if(void 0!==this._displayRadix){g.font="bold 20px sans-serif";const[__,currentCount]=displayValuesFromArray(this.value[0],!1),stringRep=formatWithRadix(currentCount,this._displayRadix,this.numBits,!1),labelMargin=10,valueCenter=ctx2.rotatePoint(this.posX-labelMargin/2,this.outputs.Q.group.posYInParentTransform);g.fillStyle=COLOR_EMPTY;const frameWidth=width-labelMargin-12;FlipflopOrLatch.drawStoredValueFrame(g,...valueCenter,frameWidth,28,!1),g.fillStyle=COLOR_LABEL_OFF,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,stringRep,...valueCenter)}}))}doSetDisplayRadix(displayRadix){this._displayRadix=displayRadix,this.requestRedraw({why:"display radix changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.Counter.contextMenu,makeItemShowRadix=__name(((displayRadix,desc)=>{const icon=this._displayRadix===displayRadix?"check":"none",caption=s.DisplayTempl.expand({desc:desc}),action=__name((()=>this.doSetDisplayRadix(displayRadix)),"action");return MenuData.item(icon,caption,action)}),"makeItemShowRadix");return[...makeTriggerItems(this._trigger,this.doSetTrigger.bind(this)),["mid",MenuData.sep()],["mid",makeItemShowRadix(void 0,s.DisplayNone)],["mid",makeItemShowRadix(10,s.DisplayDecimal)],["mid",makeItemShowRadix(16,s.DisplayHex)],["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("outputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}};__name(Counter,"Counter"),CounterDef.impl=Counter;var t17=__toESM(require_lib()),ComponentList=class{constructor(){this._componentsByZIndex=ArrayFillUsing((()=>[]),3),this._componentsById=new Map}*all(){for(const compList of this._componentsByZIndex)for(const comp of compList)yield comp}*allInReversedZIndexOrder(){for(let i2=this._componentsByZIndex.length-1;i2>=0;i2--){const compList=this._componentsByZIndex[i2];for(const comp of compList)yield comp}}*withZIndex(zIndex){for(const comp of this._componentsByZIndex[zIndex])yield comp}add(comp){const z=comp.drawZIndex;this._componentsByZIndex[z].push(comp);let oldComp,id=comp.ref;if(void 0===id)id=this.generateIdFor(comp),comp.doSetValidatedId(id);else if(void 0!==(oldComp=this._componentsById.get(id))){console.error("Component with id '".concat(id,"' already exists and will be renamed"));const idForOldComp=this.generateIdFor(oldComp);oldComp.doSetValidatedId(idForOldComp),this._componentsById.set(idForOldComp,oldComp)}this._componentsById.set(id,comp)}contains(type7){for(const comp of this.all())if(comp.def.type===type7)return!0;return!1}updateCustomComponents(type7){for(const comp of[...this.all()])comp.def.type===type7&&comp instanceof CustomComponent&&comp.updateFromDef()}changeIdOf(comp,newId){const oldId=comp.ref;if(void 0!==oldId){this._componentsById.delete(oldId)||console.warn("Component with id '".concat(oldId,"' not found"))}if(this._componentsById.has(newId))throw new Error("Component with id '".concat(newId,"' already exists"));comp.doSetValidatedId(newId),this._componentsById.set(newId,comp)}regenerateIdOf(comp){const newId=this.generateIdFor(comp);this.changeIdOf(comp,newId)}swapIdsOf(comp1,comp2){const id1=comp1.ref,id2=comp2.ref;if(void 0===id1||void 0===id2)throw new Error("Cannot swap ids of components without ids");comp1.doSetValidatedId(id2),comp2.doSetValidatedId(id1),this._componentsById.set(id1,comp2),this._componentsById.set(id2,comp1)}get(id){return this._componentsById.get(id)}looksLikeAutoGeneratedId(comp){const ref=comp.ref;if(void 0===ref)return!1;const prefix=ComponentList.idPrefixFor(comp);if(!ref.startsWith(prefix))return!1;const suffix=ref.slice(prefix.length);return!isNaN(Number(suffix))}generateIdFor(comp){const prefix=ComponentList.idPrefixFor(comp);let id,i2=0;for(;this._componentsById.has(id="".concat(prefix).concat(i2));)i2++;return id}static idPrefixFor(comp){const prefixFromDef=comp.def.idPrefix;return isString(prefixFromDef)?prefixFromDef:prefixFromDef(comp)}tryDelete(comp){return this.tryDeleteWhere((c=>c===comp),!0).length>0}tryDeleteWhere(cond,onlyOne){const deletedComps=[];outer:for(const compList of this._componentsByZIndex)for(let i2=0;i2<compList.length;i2++){const comp=compList[i2];if(cond(comp)&&(comp.destroy(),compList.splice(i2,1),deletedComps.push(comp),onlyOne))break outer}for(const comp of deletedComps){const id=comp.ref;void 0===id?console.warn("Removing component without id"):this._componentsById.has(id)?this._componentsById.delete(id):console.warn("Removing component with id '".concat(id,"' but no component with that id exists"))}for(const comp of deletedComps)for(const anchored of comp.anchoredDrawables)anchored.anchor=void 0;return deletedComps}clearAll(){for(const compList of this._componentsByZIndex)compList.length=0;this._componentsById.clear()}};__name(ComponentList,"ComponentList");var NodeManager=class{constructor(){this._lastGivenNodeID=-1,this._usedIDs=new Set,this._allLiveNodes=[],this._currentMapping=void 0}getFreeId(){for(;this._usedIDs.has(++this._lastGivenNodeID););return this._usedIDs.add(this._lastGivenNodeID),this._lastGivenNodeID}getFreeIdFrom(sourceId){if(!this._usedIDs.has(sourceId))return this._usedIDs.add(sourceId),sourceId;if(void 0!==this._currentMapping){const newId=this.getFreeId();return this._currentMapping.set(sourceId,newId),newId}return console.error("Loaded node with id ".concat(sourceId,", which is already taken, with no NodeMapping being built")),sourceId}addLiveNode(node){this._usedIDs.has(node.id)||console.error("Inserting live node with unreserved id ".concat(node.id)),this._allLiveNodes[node.id]=node}removeLiveNode(node){delete this._allLiveNodes[node.id],this._usedIDs.delete(node.id)}clearAll(){this._allLiveNodes.length=0,this._usedIDs.clear(),this._lastGivenNodeID=-1,this._currentMapping=void 0}findNode(id,mapping){var _a;const mappedId=null!=(_a=mapping.get(id))?_a:id;return this._allLiveNodes[mappedId]}recordMappingWhile(f){void 0!==this._currentMapping&&console.warn("NodeManager.recordMappingWhile called while already recording a mapping"),this._currentMapping=new Map,f();const mapping=this._currentMapping;return this._currentMapping=void 0,mapping}tryConnectNodesOf(comp){const linkMgr=comp.parent.linkMgr,addedConnections=[];for(const node of comp.allNodes())if(node.acceptsMoreConnections){const nodeX=node.posX,nodeY=node.posY,component=node.component;for(const other of this._allLiveNodes)if(void 0!==other&&other.component!==component&&other.acceptsMoreConnections&&other.posX===nodeX&&other.posY===nodeY){linkMgr.startDraggingWireFrom(node);void 0!==linkMgr.stopDraggingWireOn(other)&&addedConnections.push([node,other.component,other])}}return addedConnections}};__name(NodeManager,"NodeManager");var RedrawManager=class{constructor(){this._canvasRedrawReasons={},this._maskWasInvalidated=!1,this._testsInvalidationReasons=[],this._isPropagating=!1,this._isEmpty=!0}requestRedraw(req){var _a,_b,_c,_d;const compObj=null!=(_a=req.component)?_a:null,compList=this._canvasRedrawReasons[req.why];void 0===compList?this._canvasRedrawReasons[req.why]=[compObj]:compList.push(compObj),null!=(_b=req.invalidateMask)&&_b&&(this._maskWasInvalidated=!0),null!=(_c=req.invalidateTests)&&_c&&this._testsInvalidationReasons.push([req.why,compObj]),null!=(_d=req.isPropagation)&&_d&&(this._isPropagating=!0),this._isEmpty=!1}getReasonsAndClear(){if(this._isEmpty)return;const redrawReasons=this._canvasRedrawReasons,getReasons=__name((()=>{var _a,_b;const reasonParts=[];for(const reason of Object.keys(redrawReasons)){reasonParts.push(reason);const linkedComps=redrawReasons[reason];reasonParts.push(" (",String(linkedComps.length),"×)",": ");for(const comp of linkedComps)if(null!==comp){const compAny=comp;reasonParts.push(null!=(_b=null==(_a=compAny.constructor)?void 0:_a.name)?_b:"Component"),void 0!==compAny.type&&reasonParts.push("_",compAny.type),void 0!==compAny.name&&reasonParts.push("('",compAny.name,"')"),reasonParts.push("; ")}reasonParts.pop(),reasonParts.push("\n    ")}return reasonParts.pop(),reasonParts.join("")}),"getReasons"),redrawMask=this._maskWasInvalidated,invalidateTests=this._testsInvalidationReasons.length>0;return this._canvasRedrawReasons={},this._isPropagating=!1,this._maskWasInvalidated=!1,this._testsInvalidationReasons.length=0,this._isEmpty=!0,{getReasons:getReasons,redrawMask:redrawMask,invalidateTests:invalidateTests}}hasReasons(){return!this._isEmpty}isAnyValuePropagating(){return this._isPropagating}};__name(RedrawManager,"RedrawManager");var RecalcManager=class{constructor(){this._propagateQueue=[],this._recalcQueue=[],this.debug=!1}enqueueForPropagate(comp){this._propagateQueue.push(comp),this.log("Enqueued for propagate: "+comp)}enqueueForRecalc(comp,forcePropagate){this._recalcQueue.push([comp,forcePropagate]),this.log("Enqueued for recalc: "+comp)}queueIsEmpty(){return 0===this._propagateQueue.length&&0===this._recalcQueue.length}recalcAndPropagateIfNeeded(){return!this.queueIsEmpty()&&(this.recalcAndPropagate(),!0)}recalcAndPropagate(){let round2=0;do{if(round2++,round2>=1e3){console.warn("ERROR: Circular dependency; suspending updates after ".concat(1e3," recalc/propagate rounds"));for(const comp of[...this._propagateQueue,...this._recalcQueue.map((r=>r[0]))])comp.setInvalid();this._propagateQueue=[],this._recalcQueue=[];break}this.log("Recalc/propagate round ".concat(round2,": ").concat(this._propagateQueue.length," propagate, ").concat(this._recalcQueue.length," recalc."));const propagateQueue=this._propagateQueue;this._propagateQueue=[],this.log("  PROPAG (".concat(propagateQueue.length,") – ")+propagateQueue.map((c=>c.toString())).join("; "));for(const comp of propagateQueue)try{comp.propagateCurrentValue()}catch(e){console.error("Error while propagating value of "+comp,e),comp.setInvalid()}const recalcQueue=this._recalcQueue;this._recalcQueue=[],this.log("  RECALC (".concat(recalcQueue.length,") – ")+recalcQueue.map((c=>c.toString())).join("; "));for(const[comp,forcePropagate]of recalcQueue)try{comp.recalcValue(forcePropagate)}catch(e){console.error("Error while recalculating value of "+comp,e),comp.setInvalid()}}while(!this.queueIsEmpty());this.log("Recalc/propagate done in ".concat(round2," rounds."))}log(msg){this.debug&&console.log(msg)}};__name(RecalcManager,"RecalcManager");var SVGRenderingContext=class{constructor(optionsOrWidth,height){var _a,_b,_c,_d;let options;if(this.strokeStyle="#000000",this.fillStyle="#000000",this.lineCap="butt",this.lineJoin="miter",this.miterLimit=10,this.lineWidth=1,this.globalAlpha=1,this.font="10px sans-serif",this.shadowColor="#000000",this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.textAlign="start",this.textBaseline="alphabetic",this.lineDash=null,this.lineDashOffset=0,this.fontUnderline="",this._groupStack=[],this._transformMatrixStack=[],this._currentPath=new Path2DSVG(this),this._transformMatrix=new DOMMatrix,options=void 0!==height?{width:optionsOrWidth,height:height}:void 0!==optionsOrWidth?optionsOrWidth:{},this.width=null!=(_a=options.width)?_a:500,this.height=null!=(_b=options.height)?_b:500,this.enableMirroring=null!=(_c=options.enableMirroring)&&_c,this.canvas=this,this._document=null!=(_d=options.document)?_d:document,options.ctx?this._g=options.ctx:(this._helperCanvas=this._document.createElement("canvas"),this._g=this._helperCanvas.getContext("2d")),this._styleStack=[this._getStyleState()],this._svg=this._document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.setAttribute("version","1.1"),this._svg.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this._svg.setAttribute("width",String(this.width)),this._svg.setAttribute("height",String(this.height)),this._ids={},void 0!==options.metadata){const metadata=this._document.createElementNS("http://www.w3.org/2000/svg","metadata"),textNode=this._document.createTextNode(options.metadata);metadata.appendChild(textNode),this._svg.appendChild(metadata)}this._defs=this._document.createElementNS("http://www.w3.org/2000/svg","defs"),this._svg.appendChild(this._defs),this._currentElement=this._document.createElementNS("http://www.w3.org/2000/svg","g"),this._svg.appendChild(this._currentElement),this.resetTransform()}_createElement(elementName,properties){let resetFill=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const element=this._document.createElementNS("http://www.w3.org/2000/svg",elementName);if(resetFill&&(element.setAttribute("fill","none"),element.setAttribute("stroke","none")),void 0!==properties)for(const[key,value]of Object.entries(properties))element.setAttribute(key,String(value));return element}_closestGroupOrSvg(node){return"g"===(node=null!=node?node:this._currentElement).nodeName||"svg"===node.nodeName?node:this._closestGroupOrSvg(node.parentNode)}_applyStyleState(styleState){for(const[key,value]of Object.entries(styleState))this[key]=value}_getStyleState(){const styleState={};for(const key of Object.keys(STYLES))styleState[key]=this[key];return styleState}_applyTransformation(element,matrix){const{a:a2,b:b2,c:c,d:d,e:e,f:f}=null!=matrix?matrix:this.getTransform();1===a2&&0===b2&&0===c&&1===d&&0===e&&0===f||element.setAttribute("transform","matrix(".concat(a2," ").concat(b2," ").concat(c," ").concat(d," ").concat(e," ").concat(f,")"))}_applyStyleToElement(elem,type7){for(const[key,style2]of Object.entries(STYLES)){let value=this[key];if("apply"in style2&&style2.apply)if(value instanceof CanvasPatternSVG){for(const node of value._ctx._defs.children){const id=node.getAttribute("id");this._ids[id]=id,this._defs.appendChild(node)}elem.setAttribute(style2.apply,"url(#".concat(value.patternElem.getAttribute("id"),")"))}else if(value instanceof CanvasGradientSVG)elem.setAttribute(style2.apply,"url(#".concat(value.gradientElem.getAttribute("id"),")"));else if(-1!==style2.apply.indexOf(type7)&&style2.svg!==value)if("stroke"!==style2.svgAttr&&"fill"!==style2.svgAttr||-1===value.indexOf("rgba")){let attr2=style2.svgAttr;if("globalAlpha"===key){if(attr2=type7+"-"+style2.svgAttr,null!==elem.getAttribute(attr2))continue}else if("lineWidth"===key){const scale=this._getTransformScale();value*=Math.max(scale.x,scale.y)}elem.setAttribute(attr2,value)}else{const matches=/rgba\(\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(value);elem.setAttribute(style2.svgAttr,"rgb(".concat(matches[1],",").concat(matches[2],",").concat(matches[3],")"));const opacity=parseFloat(matches[4])*this.globalAlpha;elem.setAttribute(style2.svgAttr+"-opacity",String(opacity))}}}getSerializedSvg(){let fixNamedEntities=arguments.length>0&&void 0!==arguments[0]&&arguments[0],serialized=(new XMLSerializer).serializeToString(this._svg);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(serialized)&&(serialized=serialized.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),fixNamedEntities)for(const[key,value]of Object.entries(namedEntities)){const regexp=new RegExp(key,"gi");regexp.test(serialized)&&(serialized=serialized.replace(regexp,value))}return serialized}getSvg(){return this._svg}beginGroup(className){const group2=this._createElement("g");void 0!==className&&group2.setAttribute("class",className);const parent=this._closestGroupOrSvg();this._groupStack.push(parent),parent.appendChild(group2),this._currentElement=group2}endGroup(){var _a;this._currentElement=null!=(_a=this._groupStack.pop())?_a:this._svg.children[1]}save(){this.beginGroup(void 0),this._styleStack.push(this._getStyleState()),this._transformMatrixStack.push(this.getTransform())}restore(){this.endGroup(),this._applyStyleState(this._styleStack.pop()),this.setTransform(this._transformMatrixStack.pop())}_createPathElement(){const path=this._createElement("path",{},!0);return this._closestGroupOrSvg().appendChild(path),path}beginPath(){this._currentPath=new Path2DSVG(this)}closePath(){this._currentPath.closePath()}moveTo(x,y){this._currentPath.moveTo(x,y)}lineTo(x,y){this._currentPath.lineTo(x,y)}rect(x,y,width,height){this._currentPath.rect(x,y,width,height)}bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y){this._currentPath.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)}quadraticCurveTo(cpx,cpy,x,y){this._currentPath.quadraticCurveTo(cpx,cpy,x,y)}arc(x,y,radius,startAngle,endAngle){let counterClockwise=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this._currentPath.arc(x,y,radius,startAngle,endAngle,counterClockwise)}arcTo(x1,y1,x2,y2,radius){this._currentPath.arcTo(x1,y1,x2,y2,radius)}ellipse(x,y,radiusX,radiusY,rotation,startAngle,endAngle){let counterClockwise=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this._currentPath.ellipse(x,y,radiusX,radiusY,rotation,startAngle,endAngle,counterClockwise)}stroke(path2d){this._strokeOrFill("stroke",path2d)}fill(path2d){this._strokeOrFill("fill",path2d)}_strokeOrFill(action,path2d){let path;if(path2d){if(!(path2d instanceof Path2DSVG))throw new Error("Path2D is not a Path2DSVG");path=path2d}else path=this._currentPath;const pathElement=this._createPathElement();this._applyStyleToElement(pathElement,action),pathElement.setAttribute("paint-order","fill stroke markers"),pathElement.setAttribute("d",path.d)}fillRect(x,y,width,height){const{a:a2,b:b2,c:c,d:d,e:e,f:f}=this.getTransform();1===a2&&0===b2&&0===c&&1===d&&0===e&&0===f&&0===x&&0===y&&width===this.width&&height===this.height&&this._clearCanvas();const rect=this._createElement("rect",{x:x,y:y,width:width,height:height},!0);this._closestGroupOrSvg().appendChild(rect),this._currentElement=rect,this._applyTransformation(rect),this._applyStyleToElement(this._currentElement,"fill")}strokeRect(x,y,width,height){const rect=this._createElement("rect",{x:x,y:y,width:width,height:height},!0);this._closestGroupOrSvg().appendChild(rect),this._currentElement=rect,this._applyTransformation(rect),this._applyStyleToElement(this._currentElement,"stroke")}_clearCanvas(){const rootGroup=this._svg.children[1];this._svg.removeChild(rootGroup),this._currentElement=this._document.createElementNS("http://www.w3.org/2000/svg","g"),this._svg.appendChild(this._currentElement),this._groupStack.length=0}clearRect(x,y,width,height){const{a:a2,b:b2,c:c,d:d,e:e,f:f}=this.getTransform();if(1===a2&&0===b2&&0===c&&1===d&&0===e&&0===f&&0===x&&0===y&&width===this.width&&height===this.height)return void this._clearCanvas();const parent=this._closestGroupOrSvg(),rect=this._createElement("rect",{x:x,y:y,width:width,height:height,fill:"#FFFFFF"},!0);this._applyTransformation(rect),parent.appendChild(rect)}setLineDash(dashArray){dashArray&&dashArray.length>0?this.lineDash=dashArray.join(","):this.lineDash=null}getLineDash(){return null===this.lineDash?[]:this.lineDash.split(",").map((s=>parseFloat(s)))}clip(fillRule){const group2=this._closestGroupOrSvg(),clipPath=this._createElement("clipPath"),id=randomString2(this._ids),pathElement=this._createPathElement();pathElement.setAttribute("d",this._currentPath.d),clipPath.setAttribute("id",id),void 0!==fillRule&&clipPath.setAttribute("clip-rule",fillRule),clipPath.appendChild(pathElement),this._defs.appendChild(clipPath),group2.setAttribute("clip-path","url(#".concat(id,")")),this._currentElement=group2}drawImage(){const args=Array.prototype.slice.call(arguments);let dx,dy,dw,dh,sw,sh,image=args[0],sx=0,sy=0;if(3===args.length)dx=args[1],dy=args[2],sw=image.width,sh=image.height,dw=sw,dh=sh;else if(5===args.length)dx=args[1],dy=args[2],dw=args[3],dh=args[4],sw=image.width,sh=image.height;else{if(9!==args.length)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);sx=args[1],sy=args[2],sw=args[3],sh=args[4],dx=args[5],dy=args[6],dw=args[7],dh=args[8]}const parent=this._closestGroupOrSvg(),matrix=this.getTransform().translate(dx,dy);if(image instanceof SVGRenderingContext){const svg=image.getSvg().cloneNode(!0);if(svg.childNodes.length>1){const defs=svg.childNodes[0];for(;defs.childNodes.length;){const id=defs.childNodes[0].getAttribute("id");this._ids[id]=id,this._defs.appendChild(defs.childNodes[0])}const group2=svg.children[1];void 0!==group2&&(this._applyTransformation(group2,matrix),parent.appendChild(group2))}}else if("CANVAS"===image.nodeName||"IMG"===image.nodeName){const svgImage=this._createElement("image");if(svgImage.setAttribute("width",String(dw)),svgImage.setAttribute("height",String(dh)),svgImage.setAttribute("preserveAspectRatio","none"),sx||sy||sw!==image.width||sh!==image.height){const canvas2=this._document.createElement("canvas");canvas2.width=dw,canvas2.height=dh;canvas2.getContext("2d").drawImage(image,sx,sy,sw,sh,0,0,dw,dh),image=canvas2}this._applyTransformation(svgImage,matrix),svgImage.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===image.nodeName?image.toDataURL():image.getAttribute("src")),parent.appendChild(svgImage)}}_applyText(text,x,y,action){const el=document.createElement("span");el.setAttribute("style","font:"+this.font);const style2=el.style,parent=this._closestGroupOrSvg(),valign=getDominantBaseline(this.textBaseline),textElement=this._createElement("text",{"font-family":style2.fontFamily,"font-size":style2.fontSize,"font-style":style2.fontStyle,"font-weight":style2.fontWeight,"text-decoration":this.fontUnderline,x:x,y:y,"text-anchor":getTextAnchor(this.textAlign),"dominant-baseline":valign},!0);if(textElement.appendChild(this._document.createTextNode(text)),this._currentElement=textElement,this._applyTransformation(textElement),this._applyStyleToElement(this._currentElement,action),void 0!==this.fontHref){const a2=this._createElement("a");a2.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.fontHref),a2.appendChild(textElement),parent.appendChild(a2)}else parent.appendChild(textElement)}fillText(text,x,y){this._applyText(text,x,y,"fill")}strokeText(text,x,y){this._applyText(text,x,y,"stroke")}measureText(text){return this._g.font=this.font,this._g.measureText(text)}createPath(arg){return new Path2DSVG(this,arg)}createLinearGradient(x1,y1,x2,y2){const grad=this._createElement("linearGradient",{id:randomString2(this._ids),x1:x1+"px",x2:x2+"px",y1:y1+"px",y2:y2+"px",gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(grad),new CanvasGradientSVG(grad,this)}createRadialGradient(x0,y0,r0,x1,y1,r1){const grad=this._createElement("radialGradient",{id:randomString2(this._ids),cx:x1+"px",cy:y1+"px",r:r1+"px",fx:x0+"px",fy:y0+"px",gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(grad),new CanvasGradientSVG(grad,this)}createPattern(image,__repetition){const pattern=this._document.createElementNS("http://www.w3.org/2000/svg","pattern"),id=randomString2(this._ids);if(pattern.setAttribute("id",id),pattern.setAttribute("width",String(image.width)),pattern.setAttribute("height",String(image.height)),pattern.setAttribute("patternUnits","userSpaceOnUse"),!("nodeName"in image)||"CANVAS"!==image.nodeName&&"IMG"!==image.nodeName)image instanceof SVGRenderingContext&&(pattern.appendChild(image._svg.children[1]),this._defs.appendChild(pattern));else{const img2=this._document.createElementNS("http://www.w3.org/2000/svg","image");img2.setAttribute("width",String(image.width)),img2.setAttribute("height",String(image.height)),img2.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===image.nodeName?image.toDataURL():image.getAttribute("src")),pattern.appendChild(img2),this._defs.appendChild(pattern)}return new CanvasPatternSVG(pattern,this)}setTransform(am,b2,c,d,e,f){if(void 0===b2){const m=am;this._transformMatrix=new DOMMatrix([m.a,m.b,m.c,m.d,m.e,m.f])}else{const a2=am;this._transformMatrix=new DOMMatrix([a2,b2,c,d,e,f])}}getTransform(){const{a:a2,b:b2,c:c,d:d,e:e,f:f}=this._transformMatrix;return new DOMMatrix([a2,b2,c,d,e,f])}resetTransform(){this.setTransform(1,0,0,1,0,0)}transform(a2,b2,c,d,e,f){const matrix=this.getTransform().multiply(new DOMMatrix([a2,b2,c,d,e,f]));this.setTransform(matrix)}scale(x,y){if(void 0===y&&(y=x),isNaN(x)||isNaN(y)||!isFinite(x)||!isFinite(y))return;const matrix=this.getTransform().scale(x,y);this.setTransform(matrix)}rotate(angle){const matrix=this.getTransform().multiply(new DOMMatrix([Math.cos(angle),Math.sin(angle),-Math.sin(angle),Math.cos(angle),0,0]));this.setTransform(matrix)}translate(x,y){const matrix=this.getTransform().translate(x,y);this.setTransform(matrix)}_matrixTransform(x,y){const{a:a2,b:b2,c:c,d:d,e:e,f:f}=this._transformMatrix;return[a2*x+c*y+e,b2*x+d*y+f]}_getTransformScale(){return{x:Math.hypot(this._transformMatrix.a,this._transformMatrix.b),y:Math.hypot(this._transformMatrix.c,this._transformMatrix.d)}}_getTransformRotation(){return Math.atan2(this._transformMatrix.b,this._transformMatrix.a)}};__name(SVGRenderingContext,"SVGRenderingContext");var Path2DSVG=class{constructor(g,path){this._posX=void 0,this._posY=void 0,this.g=g,void 0===path?(this._parts=[],this._hasMoved=!1):isString(path)?(this._parts=[path],this._hasMoved=path.indexOf("M")>=0):(this._parts=[...path._parts],this._hasMoved=this._parts.some((path2=>path2.indexOf("M")>=0)))}get d(){return this._parts.join(" ")}addPath(path,transform){transform&&console.error("transform argument to addPath is not supported"),this._parts.push(path),this._hasMoved||(this._hasMoved=path.indexOf("M")>=0)}closePath(){this.addPath("Z")}moveTo(x,y){this._posX=x,this._posY=y;const[tx,ty]=this.g._matrixTransform(x,y);this.addPath("M ".concat(tx," ").concat(ty))}lineTo(x,y){this._posX=x,this._posY=y;const cmd=this._hasMoved?"L":"M",[tx,ty]=this.g._matrixTransform(x,y);this.addPath("".concat(cmd," ").concat(tx," ").concat(ty))}bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y){this._posX=x,this._posY=y;const g=this.g,[tcp1x,tcp1y]=g._matrixTransform(cp1x,cp1y),[tcp2x,tcp2y]=g._matrixTransform(cp2x,cp2y),[tx,ty]=g._matrixTransform(x,y);this.addPath("C ".concat(tcp1x," ").concat(tcp1y," ").concat(tcp2x," ").concat(tcp2y," ").concat(tx," ").concat(ty))}quadraticCurveTo(cpx,cpy,x,y){this._posX=x,this._posY=y;const g=this.g,[tcpx,tcpy]=g._matrixTransform(cpx,cpy),[tx,ty]=g._matrixTransform(x,y);this.addPath("Q ".concat(tcpx," ").concat(tcpy," ").concat(tx," ").concat(ty))}rect(x,y,width,height){this.moveTo(x,y),this.lineTo(x+width,y),this.lineTo(x+width,y+height),this.lineTo(x,y+height),this.closePath()}arc(x,y,radius,startAngle,endAngle){let counterClockwise=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(startAngle===endAngle)return;const g=this.g;(startAngle%=2*Math.PI)===(endAngle%=2*Math.PI)&&(endAngle=(endAngle+2*Math.PI-.001*(counterClockwise?-1:1))%(2*Math.PI));const endX=x+radius*Math.cos(endAngle),endY=y+radius*Math.sin(endAngle),startX=x+radius*Math.cos(startAngle),startY=y+radius*Math.sin(startAngle),sweepFlag=counterClockwise?0:1;let largeArcFlag=0,diff=endAngle-startAngle;diff<0&&(diff+=2*Math.PI),largeArcFlag=counterClockwise?diff>Math.PI?0:1:diff>Math.PI?1:0;const scaleX=Math.hypot(g._transformMatrix.a,g._transformMatrix.b),scaleY=Math.hypot(g._transformMatrix.c,g._transformMatrix.d);this.lineTo(startX,startY);const[endx,endy]=g._matrixTransform(endX,endY);this.addPath("A ".concat(radius*scaleX," ").concat(radius*scaleY," ",0," ").concat(largeArcFlag," ").concat(sweepFlag," ").concat(endx," ").concat(endy)),this._posX=x,this._posY=y}arcTo(x1,y1,x2,y2,radius){const x0=this._posX,y0=this._posY;if(void 0===x0||void 0===y0)return;if(radius<0)throw new Error("IndexSizeError: The radius provided ("+radius+") is negative.");if(x0===x1&&y0===y1||x1===x2&&y1===y2||0===radius)return void this.lineTo(x1,y1);const p1p0=[x0-x1,y0-y1],p1p2=[x2-x1,y2-y1],p1p0_length=Math.hypot(p1p0[0],p1p0[1]),p1p2_length=Math.hypot(p1p2[0],p1p2[1]),cos_phi=(p1p0[0]*p1p2[0]+p1p0[1]*p1p2[1])/(p1p0_length*p1p2_length);if(-1===cos_phi)return void this.lineTo(x1,y1);if(1===cos_phi){const factor_max=65535/p1p0_length,ep=[x0+factor_max*p1p0[0],y0+factor_max*p1p0[1]];return void this.lineTo(ep[0],ep[1])}const tangent=radius/Math.tan(Math.acos(cos_phi)/2),factor_p1p0=tangent/p1p0_length,t_p1p0=[x1+factor_p1p0*p1p0[0],y1+factor_p1p0*p1p0[1]];let orth_p1p0=[p1p0[1],-p1p0[0]];const orth_p1p0_length=Math.hypot(orth_p1p0[0],orth_p1p0[1]),factor_ra=radius/orth_p1p0_length;(orth_p1p0[0]*p1p2[0]+orth_p1p0[1]*p1p2[1])/(orth_p1p0_length*p1p2_length)<0&&(orth_p1p0=[-orth_p1p0[0],-orth_p1p0[1]]);const p=[t_p1p0[0]+factor_ra*orth_p1p0[0],t_p1p0[1]+factor_ra*orth_p1p0[1]];orth_p1p0=[-orth_p1p0[0],-orth_p1p0[1]];let sa=Math.acos(orth_p1p0[0]/orth_p1p0_length);orth_p1p0[1]<0&&(sa=2*Math.PI-sa);let anticlockwise=!1;const factor_p1p2=tangent/p1p2_length,t_p1p2=[x1+factor_p1p2*p1p2[0],y1+factor_p1p2*p1p2[1]],orth_p1p2=[t_p1p2[0]-p[0],t_p1p2[1]-p[1]],orth_p1p2_length=Math.hypot(orth_p1p2[0],orth_p1p2[1]);let ea=Math.acos(orth_p1p2[0]/orth_p1p2_length);orth_p1p2[1]<0&&(ea=2*Math.PI-ea),sa>ea&&sa-ea<Math.PI&&(anticlockwise=!0),sa<ea&&ea-sa>Math.PI&&(anticlockwise=!0),this.lineTo(t_p1p0[0],t_p1p0[1]),this.arc(p[0],p[1],radius,sa,ea,anticlockwise)}ellipse(x,y,radiusX,radiusY,rotation,startAngle,endAngle){let counterClockwise=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(startAngle===endAngle)return;const g=this.g;[x,y]=g._matrixTransform(x,y);const scale=g._getTransformScale();radiusX*=scale.x,radiusY*=scale.y,rotation+=g._getTransformRotation(),(startAngle%=2*Math.PI)===(endAngle%=2*Math.PI)&&(endAngle=(endAngle+2*Math.PI-.001*(counterClockwise?-1:1))%(2*Math.PI));const endX=x+Math.cos(-rotation)*radiusX*Math.cos(endAngle)+Math.sin(-rotation)*radiusY*Math.sin(endAngle),endY=y-Math.sin(-rotation)*radiusX*Math.cos(endAngle)+Math.cos(-rotation)*radiusY*Math.sin(endAngle),startX=x+Math.cos(-rotation)*radiusX*Math.cos(startAngle)+Math.sin(-rotation)*radiusY*Math.sin(startAngle),startY=y-Math.sin(-rotation)*radiusX*Math.cos(startAngle)+Math.cos(-rotation)*radiusY*Math.sin(startAngle),sweepFlag=counterClockwise?0:1;let largeArcFlag=0,diff=endAngle-startAngle;diff<0&&(diff+=2*Math.PI),largeArcFlag=counterClockwise?diff>Math.PI?0:1:diff>Math.PI?1:0;const currentTransform=g._transformMatrix;g.resetTransform(),this.lineTo(startX,startY),g._transformMatrix=currentTransform,this.addPath("A ".concat(radiusX," ").concat(radiusY," ").concat(rotation*(180/Math.PI)," ").concat(largeArcFlag," ").concat(sweepFlag," ").concat(endX," ").concat(endY)),this._posX=endX,this._posY=endY}};__name(Path2DSVG,"Path2DSVG");var CanvasGradientSVG=class{constructor(gradientElem,_ctx){this.gradientElem=gradientElem,this._ctx=_ctx}addColorStop(offset2,color){const stop=this._ctx._createElement("stop");if(stop.setAttribute("offset",String(offset2)),-1!==color.indexOf("rgba")){const matches=/rgba\(\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(color);matches?(stop.setAttribute("stop-color","rgb(".concat(matches[1],",").concat(matches[2],",").concat(matches[3],")")),stop.setAttribute("stop-opacity",matches[4])):stop.setAttribute("stop-color",color)}else stop.setAttribute("stop-color",color);this.gradientElem.appendChild(stop)}};__name(CanvasGradientSVG,"CanvasGradientSVG");var CanvasPatternSVG=class{constructor(patternElem,_ctx){this.patternElem=patternElem,this._ctx=_ctx}};function randomString2(holder){if(!holder)throw new Error("cannot create a random attribute name for an undefined object");const chars="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";let randomstring="";do{randomstring="";for(let i2=0;i2<12;i2++)randomstring+=chars[Math.floor(Math.random()*chars.length)]}while(void 0!==holder[randomstring]);return randomstring}__name(CanvasPatternSVG,"CanvasPatternSVG"),__name(randomString2,"randomString");var STYLES={strokeStyle:{svgAttr:"stroke",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",svg:1,apply:"fill stroke"},lineDash:{svgAttr:"stroke-dasharray",svg:null,apply:"stroke"}},_textAnchorMapping={left:"start",right:"end",center:"middle",start:"start",end:"end"};function getTextAnchor(textAlign){var _a;return null!=(_a=_textAnchorMapping[textAlign])?_a:_textAnchorMapping.start}__name(getTextAnchor,"getTextAnchor");var _dominantBaselineMapping={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};function getDominantBaseline(textBaseline){var _a;return null!=(_a=_dominantBaselineMapping[textBaseline])?_a:_dominantBaselineMapping.alphabetic}function createNamedToNumberedLookup(itemsStr,radix){const lookup={},items=itemsStr.split(",");radix=null!=radix?radix:10;for(let i2=0;i2<items.length;i2+=2){const entity="&"+items[i2+1]+";",base10=parseInt(items[i2],radix);lookup[entity]="&#"+base10+";"}return lookup["\\xa0"]="&#160;",lookup}__name(getDominantBaseline,"getDominantBaseline"),__name(createNamedToNumberedLookup,"createNamedToNumberedLookup");var namedEntities=createNamedToNumberedLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),t16=__toESM(require_lib()),OutputDef=defineParametrizedComponent("out",!0,!1,{variantName:_ref48=>{let{bits:bits}=_ref48;return"out-".concat(bits)},idPrefix:"out",button:{imgWidth:32},repr:{bits:typeOrUndefined(t16.number),name:ComponentNameRepr},valueDefaults:{},params:InputDef.paramDefs,validateParams:_ref49=>{let{bits:bits}=_ref49;return{numBits:bits}},size:_ref50=>{let{numBits:numBits}=_ref50;if(1===numBits){const d=26/GRID_STEP;return{gridWidth:d,gridHeight:d}}return{gridWidth:2,gridHeight:useCompact(numBits)?numBits:2*numBits}},makeNodes:_ref51=>{let{numBits:numBits}=_ref51;return{ins:{In:groupVertical("w",1===numBits?-3:-2,0,numBits,void 0,{hasTriangle:1!==numBits})}}},initialValue:(saved,_ref52)=>{let{numBits:numBits}=_ref52;return ArrayFillWith(!1,numBits)}}),Output=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a;super(parent,OutputDef.with(params),saved),this.numBits=params.numBits,this._name=null!=(_a=null==saved?void 0:saved.name)?_a:void 0}toJSON(){return{...this.toJSONBase(),bits:this.numBits===OutputDef.aults.bits?void 0:this.numBits,name:this._name}}isOver(x,y){return 1===this.numBits?this.parent.mode>=2&&distSquared(x,y,this.posX,this.posY)<169:super.isOver(x,y)}get name(){return this._name}contentRepr(undefinedIfTrivial){return reprForLogicValues(this.value,undefinedIfTrivial)}makeTooltip(){return tooltipContent(void 0,mods(S.Components.Output.tooltip.title.expand({numBits:this.numBits})))}doRecalcValue(){return this.inputValues(this.inputs.In)}doDraw(g,ctx){1===this.numBits?this.doDrawSingle(g,ctx,this.inputs.In[0]):this.doDrawMulti(g,ctx,this.inputs.In)}doDrawSingle(g,ctx,input2){drawWireLineToComponent(g,input2),g.strokeStyle=ctx.borderColor,g.fillStyle=ctx.borderColor,g.beginPath(),triangle(g,this.posX-13-5,this.posY-5,this.posX-13-5,this.posY+5,this.posX-13-1,this.posY),g.lineWidth=2,g.fill(),g.stroke();const valueToShow=this.parent.editor.options.hideOutputColors?Unknown:input2.value;g.fillStyle=colorForLogicValue(valueToShow),g.lineWidth=4,g.beginPath(),circle(g,this.posX,this.posY,26),g.fill(),g.stroke(),ctx.inNonTransformedFrame((ctx2=>{void 0!==this._name&&drawComponentName(g,ctx2,this._name,toLogicValueRepr(valueToShow),this,!0),drawValueTextCentered(g,valueToShow,this)}))}doDrawMulti(g,ctx,inputs){const bounds=this.bounds(),{left:left2,top:top2,width:width}=bounds,outline=bounds.outline(g);g.fillStyle=COLOR_BACKGROUND,g.fill(outline);for(const input2 of inputs)drawWireLineToComponent(g,input2);const displayValues=this.parent.editor.options.hideOutputColors?ArrayFillWith(Unknown,this.numBits):this.value,drawMouseOver=ctx.isMouseOver&&0!==this.parent.mode;g.strokeStyle=drawMouseOver?ctx.borderColor:COLOR_COMPONENT_BORDER,g.lineWidth=1;const cellHeight=useCompact(this.numBits)?GRID_STEP:2*GRID_STEP;for(let i2=0;i2<this.numBits;i2++){const y=top2+i2*cellHeight;g.fillStyle=colorForLogicValue(displayValues[i2]),g.beginPath(),g.rect(left2,y,width,cellHeight),g.fill(),g.stroke()}g.lineWidth=3,g.stroke(outline),ctx.inNonTransformedFrame((ctx2=>{if(void 0!==this._name){const valueString=displayValues.map(toLogicValueRepr).reverse().join("");drawComponentName(g,ctx2,this._name,valueString,this,!0)}for(let i2=0;i2<this.numBits;i2++){const y=top2+cellHeight/2+i2*cellHeight;drawValueText(g,displayValues[i2],...ctx2.rotatePoint(this.posX,y),{small:useCompact(this.numBits)})}}))}autoConnected(newLinks){if(1!==newLinks.length)return;const[inNode,comp,outNode]=newLinks[0];if(outNode instanceof NodeOut){let group2;void 0===(group2=outNode.group)||1!==group2.nodes.length||isTrivialNodeName(group2.name)?void 0!==this._name||isTrivialNodeName(outNode.shortName)||this.doSetName(outNode.shortName):this.doSetName(group2.name)}if("w"===inNode.orient)switch(Orientation.add(comp.orient,outNode.orient)){case"e":return;case"w":return this.doSetOrient("w"),void this.setPosition(this.posX-6*GRID_STEP,this.posY,!1);case"s":return this.doSetOrient("s"),void this.setPosition(this.posX-3*GRID_STEP,this.posY+3*GRID_STEP,!1);case"n":return this.doSetOrient("n"),void this.setPosition(this.posX-3*GRID_STEP,this.posY-3*GRID_STEP,!1)}}doSetName(name2){this._name=name2,this.requestRedraw({why:"name changed"})}makeComponentSpecificContextMenuItems(){return[["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))],["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("inputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits")]}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetNameDialog(this._name,this.doSetName.bind(this))}};__name(Output,"Output"),OutputDef.impl=Output;var CustomComponentDefRepr=t17.type({id:t17.string,caption:t17.string,circuit:t17.type({components:typeOrUndefined(t17.record(t17.string,t17.record(t17.string,t17.unknown))),wires:typeOrUndefined(t17.array(Wire.Repr))})}),CustomComponentDef=class{constructor(data2){var _a,_b,_c;this.numBySide={n:0,e:0,s:0,w:0},this.customId=data2.id,this._caption=data2.caption,this.circuit=data2.circuit,this.insOuts=[];let totalIn=0,totalOut=0;const components=null!=(_a=this.circuit.components)?_a:{};for(const[id,repr_]of Object.entries(components)){const repr=repr_,isIn="in"===repr.type&&!(null!=(_b=repr.isConstant)&&_b),isOut="out"===repr.type;if(isIn||isOut){const inOutRepr=repr,name2=isString(inOutRepr.name)?inOutRepr.name:isIn?"In":"Out";let orient=Orientations.includes(inOutRepr.orient)?inOutRepr.orient:Orientation.default;orient=isIn?Orientation.invert(orient):orient;const numBits=Number(null!=(_c=inOutRepr.bits)?_c:1);this.numBySide[orient]+=numBits;const sourcePos=isArray(inOutRepr.pos)&&2===inOutRepr.pos.length?inOutRepr.pos.map(Number):[0,0];this.insOuts.push({isIn:isIn,id:id,name:name2,orient:orient,numBits:numBits,sourcePos:sourcePos,sourceRepr:inOutRepr}),delete components[id],isIn?totalIn+=numBits:totalOut+=numBits}}sortInputsOutputs(this.insOuts);for(const spec of this.insOuts)components[spec.id]=spec.sourceRepr;this.numInputs=totalIn,this.numOutputs=totalOut,this.recalcSize()}toJSON(){return{id:this.customId,caption:this._caption,circuit:this.circuit}}get id(){return"custom-"+this.customId}get caption(){return this._caption}doSetCaption(caption){this._caption=caption,this.recalcSize()}recalcSize(){const minSize=1*this._caption.length+2;this.gridWidth=Math.ceil(Math.max(minSize,2*(Math.max(this.numBySide.s,this.numBySide.n)-1)+3)),this.gridHeight=Math.ceil(Math.max(minSize,2*(Math.max(this.numBySide.e,this.numBySide.w)-1)+3))}isValid(){return!0}get type(){return"custom-"+this.customId}uses(type7,alsoIndirect){var _a,_b;const compReprs=this.circuit.components;if(void 0===compReprs)return!1;const whitelist=[];for(const compRepr of Object.values(compReprs)){const compType=String(compRepr.type);if(compType===type7)return!0;if(!1!==alsoIndirect&&compType.startsWith("custom-")&&!whitelist.includes(compType)){const factory=alsoIndirect[1],customId=compType.substring("custom-".length);if(null!=(_b=null==(_a=factory.getCustomDef(customId))?void 0:_a.uses(type7,alsoIndirect))&&_b)return!0;whitelist.push(compType)}}return!1}make(parent){const comp=new CustomComponent(parent,this);return parent.components.add(comp),comp}makeFromJSON(parent,data2){const validated=validateJson(data2,CustomComponentRepr,"CustomComponent");if(void 0===validated)return;const comp=new CustomComponent(parent,this,validated);return parent.components.add(comp),comp}makeButtonSVG(){const g=new SVGRenderingContext(50,34);g.rect(10,2,30,30),g.strokeStyle="currentColor",g.lineWidth=2,g.stroke();const drawInsOuts=__name(((n,left2,right2)=>{const sep=6*(n-1)<=24?6:24/(n-1),top2=17-(n-1)*sep/2;for(let i2=0;i2<n;i2++){const y=top2+i2*sep;g.moveTo(left2,y),g.lineTo(right2,y)}}),"drawInsOuts");g.lineWidth=1;drawInsOuts(Math.min(10,this.numInputs),2,10),drawInsOuts(Math.min(10,this.numOutputs),40,48),g.stroke();let drawCaption=this._caption,shortened=!1;for(;;){let fontSize=15;g.font="".concat(fontSize,"px sans-serif");const scale=26/g.measureText(drawCaption).width;if(scale<1&&(fontSize=Math.floor(scale*fontSize),g.font="".concat(fontSize,"px sans-serif")),fontSize>=8){g.fillStyle="currentColor",g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,drawCaption+(shortened?".":""),25,17);break}drawCaption=drawCaption.slice(0,-1),shortened=!0}return g.getSvg()}toStandardDef(){return defineComponent("custom-"+this.customId,{idPrefix:this.customId,button:{imgWidth:50},valueDefaults:{},size:{gridWidth:this.gridWidth,gridHeight:this.gridHeight},makeNodes:_ref53=>{let{gridWidth:gridWidth,gridHeight:gridHeight}=_ref53;const right2=gridWidth/2+1,left2=-right2,bottom2=gridHeight/2+1,top2=-bottom2,starts={n:this.numBySide.n-1,e:-(this.numBySide.e-1),s:this.numBySide.s-1,w:-(this.numBySide.w-1)},counts={n:0,e:0,s:0,w:0},make=__name((spec=>{const{orient:orient,numBits:numBits}=spec,[x,y]=(()=>{const f=Orientation.isVertical(orient)?-1:1,nextPos=starts[orient]+f*(counts[orient]+(numBits-1)/2)*2;switch(orient){case"e":return[right2,nextPos];case"w":return[left2,nextPos];case"n":return[nextPos,top2];case"s":return[nextPos,bottom2]}})();return counts[orient]+=numBits,1===numBits?[x,y,orient]:Orientation.isVertical(orient)?groupHorizontal(orient,x,y,numBits):groupVertical(orient,x,y,numBits)}),"make"),ins={},outs={};for(const spec of this.insOuts)(spec.isIn?ins:outs)[spec.name]=make(spec);return{ins:ins,outs:outs}},initialValue:()=>ArrayFillWith(!1,this.numOutputs)})}};__name(CustomComponentDef,"CustomComponentDef");var CustomComponentRepr=ComponentRepr(!0,!0),CustomComponent=class extends ComponentBase{constructor(parent,customDef,saved){super(parent,customDef.toStandardDef(),saved),this.components=new ComponentList,this.testSuites=new TestSuites(this),this.nodeMgr=new NodeManager,this.linkMgr=new LinkManager(this),this.recalcMgr=new RecalcManager,this._ifEditing=void 0,this._subcircuitInputs=[],this._subcircuitOutputs=[],this._customDef=customDef,this.numInputs=this.inputs._all.length,this.numOutputs=this.outputs._all.length;const error=Serialization.loadCircuitForCustomComponent(this,customDef.circuit);void 0!==error&&(console.error("Failed to load custom component:",error),this.setInvalid())}get customDef(){return this._customDef}isMainEditor(){return!1}get editor(){return this.parent.editor}get mode(){return this.parent.mode}get ifEditing(){return this._ifEditing}stopEditingThis(){this._ifEditing=void 0}startEditingThis(tools){this._ifEditing=tools}circuitDidLoad(){this._subcircuitInputs.length=0,this._subcircuitOutputs.length=0;let iIn=0;for(const comp of this.components.all())if(comp instanceof Input&&!comp.isConstant){this._subcircuitInputs.push(comp),comp.isCustomComponentInput=!0;const num=comp.outputs._all.length;1===num&&comp.isLinkedToSomeClock&&(this.inputs._all[iIn].isClock=!0);for(let i2=0;i2<num;i2++){const j=iIn+i2;if(j>=this.numInputs)break;this.inputs._all[j].prefersSpike=comp.isPushButton}iIn+=num}else comp instanceof Output&&this._subcircuitOutputs.push(comp)}toStringDetails(){var _a,_b;return null!=(_b=null==(_a=this.customDef)?void 0:_a.customId)?_b:""}toJSON(){return this.toJSONBase()}jsonType(){return"custom-"+this.customDef.customId}makeClone(setSpawning){const repr=this.toNodelessJSON(),clone=new CustomComponent(this.parent,this.customDef,repr);return this.parent.components.add(clone),setSpawning&&clone.setSpawning(),clone}updateFromDef(){const newDef=this.editor.factory.getCustomDef(this._customDef.customId);void 0===newDef?console.warn("New custom component definition not found, using old one, but trouble is ahead"):this._customDef=newDef,this.replaceWithComponent(this.makeClone(!1))}doRecalcValue(){let bitOffset=0;for(const inputComp of this._subcircuitInputs){const numBits=inputComp.numBits;if(bitOffset+numBits>this.numInputs)break;inputComp.setValue(ArrayFillUsing((i2=>this.inputs._all[bitOffset+i2].value),numBits)),inputComp.propagateCurrentValue(),bitOffset+=numBits}this.recalcMgr.recalcAndPropagateIfNeeded();const outputs=[];for(const outputComp of this._subcircuitOutputs)outputs.push(...outputComp.value);return outputs}propagateValue(newValue){this.outputValues(this.outputs._all,newValue)}makeTooltip(){const s=S.Components.Custom.tooltip;return tooltipContent(mods(b(this.customDef.caption),span(s.titleSuffix)),mods(div(s.desc)))}doDraw(g,ctx){super.doDrawDefault(g,ctx,(()=>{g.font="bold 18px sans-serif",g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,this.customDef.caption,this.posX,this.posY)}))}makeComponentSpecificContextMenuItems(){const s=S.Components.Custom.contextMenu;return[...this.makeForceOutputsContextMenuItem(),["mid",MenuData.item("connect",s.ChangeCircuit,(()=>{this.tryOpenEditor()}),"↩︎")]]}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.tryOpenEditor()}pointerDoubleClicked(e){const result=super.pointerDoubleClicked(e);return result.isChange?result:this.tryOpenEditor()}tryOpenEditor(){const s=S.Components.Custom.messages;let showOnly;return!UIPermissions.canModifyCustomComponents(this.editor)||void 0!==(showOnly=this.editor.options.showOnly)&&!showOnly.includes(this._customDef.id)?(alert(s.CannotBeModified),InteractionResult.NoChange):this.editor.editorRoot instanceof LogicEditor?(this.editor.setEditorRoot(this),this.editor.editTools.undoMgr.takeSnapshot(),InteractionResult.SimpleChange):(alert(s.NotInMainEditor),InteractionResult.NoChange)}};function sortInputsOutputs(insOuts){const orientValue={e:0,w:1,n:2,s:3},criterion=__name((spec=>Orientation.isVertical(spec.orient)?-spec.sourcePos[0]:spec.sourcePos[1]),"criterion");insOuts.sort(((a2,b2)=>orientValue[a2.orient]-orientValue[b2.orient]||criterion(a2)-criterion(b2)))}__name(CustomComponent,"CustomComponent"),__name(sortInputsOutputs,"sortInputsOutputs");var t18=__toESM(require_lib()),DecoderDef=defineParametrizedComponent("dec",!0,!0,{variantName:_ref54=>{let{bits:bits}=_ref54;return"dec-".concat(bits)},idPrefix:"dec",button:{imgWidth:50},repr:{bits:typeOrUndefined(t18.number)},valueDefaults:{},params:{bits:param(2,[2,3,4,5])},validateParams:_ref55=>{let{bits:bits}=_ref55;return{numFrom:bits,numTo:2**bits}},size:_ref56=>{let{numTo:numTo}=_ref56;return{gridWidth:4,gridHeight:Math.max(8,1+numTo)}},makeNodes:_ref57=>{let{numFrom:numFrom,numTo:numTo}=_ref57;return{ins:{In:groupVertical("w",-3,0,numFrom)},outs:{Out:groupVertical("e",3,0,numTo)}}},initialValue:(saved,_ref58)=>{let{numTo:numTo}=_ref58;return ArrayFillWith(!1,numTo)}}),Decoder=class extends ParametrizedComponentBase{constructor(parent,params,saved){super(parent,DecoderDef.with(params),saved),this.numFrom=params.numFrom,this.numTo=params.numTo}toJSON(){return{...this.toJSONBase(),bits:this.numFrom===DecoderDef.aults.bits?void 0:this.numFrom}}makeTooltip(){const s=S.Components.Decoder.tooltip;return tooltipContent(s.title,mods(div(s.desc.expand({numFrom:this.numFrom,numTo:this.numTo,n:this.currentAddr()}))))}currentAddr(){return displayValuesFromArray(this.inputValues(this.inputs.In),!1)[1]}doRecalcValue(){const addr=this.currentAddr();if(isUnknown(addr))return ArrayFillWith(Unknown,this.numTo);const output=ArrayFillWith(!1,this.numTo);return output[addr]=!0,output}doDraw(g,ctx){this.doDrawDefault(g,ctx,{skipLabels:!0,drawLabels:()=>{g.font="bold 14px sans-serif",g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"Dec.",this.posX,this.posY)}})}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}makeComponentSpecificContextMenuItems(){const s=S.Components.Generic.contextMenu;return[this.makeChangeParamsContextMenuItem("outputs",s.ParamNumBits,this.numFrom,"bits"),["mid",MenuData.sep()],...this.makeForceOutputsContextMenuItem()]}};__name(Decoder,"Decoder"),DecoderDef.impl=Decoder;var Decoder16SegDef=defineComponent("dec-16seg",{idPrefix:"dec",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:4,gridHeight:10},makeNodes:()=>({ins:{In:group("w",[[-3,-3],[-3,-2],[-3,-1],[-3,0],[-3,1],[-3,2],[-3,3]])},outs:{Out:group("e",[[4,-4,"a1"],[3,-3.5,"a2"],[4,-3,"b"],[3,-2.5,"c"],[4,-2,"d2"],[3,-1.5,"d1"],[4,-1,"e"],[3,-.5,"f"],[4,0,"g1"],[3,.5,"g2"],[4,1,"h"],[3,1.5,"i"],[4,2,"j"],[3,2.5,"k"],[4,3,"l"],[3,3.5,"m"],[4,4,"p"]])}}),initialValue:()=>FixedArrayFillWith(!1,17)}),Decoder16Seg=class extends ComponentBase{constructor(parent,saved){super(parent,Decoder16SegDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.Decoder16Seg.tooltip)))}doRecalcValue(){const input2=this.inputValues(this.inputs.In),[__,value]=displayValuesFromArray(input2,!1);let output;if(isUnknown(value))output=FixedArrayFillWith(Unknown,17);else if(value<32)output=FixedArrayFillWith(!1,17);else{const line=DECODER_MAPPING[value-32];output=FixedArrayFillWith(!1,17);for(let i2=0;i2<line.length;i2++)output[i2]="1"===line.charAt(i2)}return output}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}doDraw(g,ctx){this.doDrawDefault(g,ctx,{skipLabels:!0,drawInside:bounds=>{this.drawGroupBox(g,this.inputs.In.group,bounds)},drawLabels:(ctx2,_ref59)=>{let{left:left2,right:right2}=_ref59;g.fillStyle=COLOR_COMPONENT_INNER_LABELS,g.font="bold 11px sans-serif",drawLabel(ctx2,this.orient,"C","w",left2,this.inputs.In),g.font="7px sans-serif",this.outputs._all.forEach((output=>{drawLabel(ctx2,this.orient,output.shortName,"e",right2,output)}))}})}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};__name(Decoder16Seg,"Decoder16Seg"),Decoder16SegDef.impl=Decoder16Seg;var DECODER_MAPPING=["00000000000000000","00110000000000001","00100000000100000","00111100110100100","11011101110100100","10011001110111100","10001110101100010","00000000000100000","00000000000010010","00000000001001000","00000000111111110","00000000110100100","00000000000001000","00000000110000000","00000000000000001","00000000000011000","11111111000011000","00110000000010000","11101110110000000","11111100010000000","00110001110000000","11001101100000010","11011111110000000","11110000000000000","11111111110000000","11111101110000000","00000000000100100","00000000000101000","00000000100010010","00001100110000000","00000000011001000","11100000010000101","11101111010100000","11110011110000000","11111100010100100","11001111000000000","11111100000100100","11001111100000000","11000011100000000","11011111010000000","00110011110000000","11001100000100100","00111110000000000","00000011100010010","00001111000000000","00110011001010000","00110011001000010","11111111000000000","11100011110000000","11111111000000010","11100011110000010","11011101110000000","11000000000100100","00111111000000000","00000011000011000","00110011000001010","00000000001011010","00111101110000000","11001100000011000","01001000000100100","00000000001000010","10000100000100100","00000000000001010","00001100000000000","00000000001000000","00001110100000100","00000111100000100","00000110100000000","00000110100100100","00000110100001000","10000011100000000","10000101100100100","00000011100000100","00000000000000100","00000100000100100","00000000000110110","00000000000100100","00010010110000100","00000010100000100","00000110100000100","10000011100100000","10000001100100100","00000010100000000","10000101100000100","00000111100000000","00000110000000100","00000010000001000","00010010000001010","00000000001011010","00000101100100100","00000100100001000","01001000100100100","00000000000100100","10000100010100100","00000000110011000","00000000000000000"],Decoder7SegDef=defineComponent("dec-7seg",{idPrefix:"dec",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:4,gridHeight:8},makeNodes:()=>({ins:{In:group("w",[[-3,-3,"A"],[-3,-1,"B"],[-3,1,"C"],[-3,3,"D"]])},outs:{Out:group("e",[[3,-3,"a"],[3,-2,"b"],[3,-1,"c"],[3,0,"d"],[3,1,"e"],[3,2,"f"],[3,3,"g"]])}}),initialValue:()=>FixedArrayFillWith(!1,7)}),Decoder7Seg=class extends ComponentBase{constructor(parent,saved){super(parent,Decoder7SegDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.Decoder7Seg.tooltip)))}doRecalcValue(){const input2=this.inputValues(this.inputs.In),[__,value]=displayValuesFromArray(input2,!1);let output;return output=isUnknown(value)?FixedArrayFillWith(Unknown,7):(()=>{switch(value){case 0:return[!0,!0,!0,!0,!0,!0,!1];case 1:return[!1,!0,!0,!1,!1,!1,!1];case 2:return[!0,!0,!1,!0,!0,!1,!0];case 3:return[!0,!0,!0,!0,!1,!1,!0];case 4:return[!1,!0,!0,!1,!1,!0,!0];case 5:return[!0,!1,!0,!0,!1,!0,!0];case 6:return[!0,!1,!0,!0,!0,!0,!0];case 7:return[!0,!0,!0,!1,!1,!1,!1];case 8:return[!0,!0,!0,!0,!0,!0,!0];case 9:return[!0,!0,!0,!0,!1,!0,!0];case 10:return[!0,!0,!0,!1,!0,!0,!0];case 11:return[!1,!1,!0,!0,!0,!0,!0];case 12:return[!0,!1,!1,!0,!0,!0,!1];case 13:return[!1,!0,!0,!0,!0,!1,!0];case 14:return[!0,!1,!1,!0,!0,!0,!0];case 15:return[!0,!1,!1,!1,!0,!0,!0];default:return FixedArrayFillWith(Unknown,7)}})(),output}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};__name(Decoder7Seg,"Decoder7Seg"),Decoder7SegDef.impl=Decoder7Seg;var DecoderBCD4Def=defineComponent("dec-bcd4",{idPrefix:"bcd",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:5,gridHeight:10},makeNodes:()=>({ins:{In:group("w",[[-4,-3,"A"],[-4,-1,"B"],[-4,1,"C"],[-4,3,"D"]])},outs:{Out:groupVertical("e",4,0,5,2)}}),initialValue:()=>FixedArrayFillWith(!1,5)}),DecoderBCD4=class extends ComponentBase{constructor(parent,saved){super(parent,DecoderBCD4Def,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.DecoderBCD4.tooltip)))}doRecalcValue(){const input2=this.inputValues(this.inputs.In),[__,value]=displayValuesFromArray(input2,!1);let output;return output=isUnknown(value)?FixedArrayFillWith(Unknown,5):(()=>{switch(value){case 0:return[!1,!1,!1,!1,!1];case 1:return[!1,!1,!1,!1,!0];case 2:return[!1,!1,!1,!0,!1];case 3:return[!1,!1,!1,!0,!0];case 4:return[!1,!1,!0,!1,!1];case 5:return[!1,!1,!0,!1,!0];case 6:return[!1,!1,!0,!0,!1];case 7:return[!1,!1,!0,!0,!0];case 8:return[!1,!0,!1,!1,!1];case 9:return[!1,!0,!1,!1,!0];case 10:return[!0,!1,!1,!1,!1];case 11:return[!0,!1,!1,!1,!0];case 12:return[!0,!1,!1,!0,!1];case 13:return[!0,!1,!1,!0,!0];case 14:return[!0,!1,!0,!1,!1];case 15:return[!0,!1,!0,!1,!0];default:return FixedArrayFillWith(Unknown,5)}})(),output}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue,!0)}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};__name(DecoderBCD4,"DecoderBCD4"),DecoderBCD4Def.impl=DecoderBCD4;var t19=__toESM(require_lib()),DemuxDef=defineParametrizedComponent("demux",!0,!0,{variantName:_ref60=>{let{from:from,to:to,bottom:bottom2}=_ref60;return"demux-".concat(from,"to").concat(to).concat(bottom2?"b":"")},idPrefix:"demux",button:{imgWidth:50},repr:{from:typeOrUndefined(t19.number),to:typeOrUndefined(t19.number),bottom:typeOrUndefined(t19.boolean),showWiring:typeOrUndefined(t19.boolean),disconnectedAsHighZ:typeOrUndefined(t19.boolean)},valueDefaults:{showWiring:!0,disconnectedAsHighZ:!1},params:{from:param(2,[1,2,4,8,16]),to:param(4),bottom:paramBool()},validateParams:_ref61=>{let{from:from,to:to,bottom:bottom2}=_ref61;const numTo=Math.min(16*from,Math.max(2*from,to)),numGroups=Math.ceil(numTo/from);return{numFrom:from,numTo:numTo,numGroups:numGroups,numSel:Math.ceil(Math.log2(numGroups)),controlPinsAtBottom:bottom2}},size:_ref62=>{let{numFrom:numFrom,numTo:numTo,numGroups:numGroups,numSel:numSel}=_ref62;return{gridWidth:2*numSel,gridHeight:(useCompact(1===numFrom?numTo:numFrom)?1:2)*(numTo+(numGroups-1)*(numFrom>1?1:0))}},makeNodes:_ref63=>{let{numFrom:numFrom,numGroups:numGroups,numSel:numSel,controlPinsAtBottom:controlPinsAtBottom}=_ref63;const outX=1+numSel,inX=-outX,groupOfOutputs=groupVerticalMulti("e",outX,0,numGroups,numFrom),firstInputY=groupOfOutputs[0][0][1],lastGroup=groupOfOutputs[groupOfOutputs.length-1],lastInputY=lastGroup[lastGroup.length-1][1],selY=controlPinsAtBottom?lastInputY+2:firstInputY-2;return{ins:{In:groupVertical("w",inX,0,numFrom),S:groupHorizontal(controlPinsAtBottom?"s":"n",0,selY,numSel,void 0,{leadLength:35})},outs:{Z:groupOfOutputs}}},initialValue:(saved,_ref64)=>{let{numTo:numTo}=_ref64;return ArrayFillWith(!1,numTo)}}),Demux=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a,_b;super(parent,DemuxDef.with(params),saved),this.numFrom=params.numFrom,this.numTo=params.numTo,this.numGroups=params.numGroups,this.numSel=params.numSel,this.controlPinsAtBottom=params.controlPinsAtBottom,this._showWiring=null!=(_a=null==saved?void 0:saved.showWiring)?_a:DemuxDef.aults.showWiring,this._disconnectedAsHighZ=null!=(_b=null==saved?void 0:saved.disconnectedAsHighZ)?_b:DemuxDef.aults.disconnectedAsHighZ}toJSON(){return{...super.toJSONBase(),from:this.numFrom,to:this.numTo,bottom:this.controlPinsAtBottom===DemuxDef.aults.bottom?void 0:this.controlPinsAtBottom,showWiring:this._showWiring!==DemuxDef.aults.showWiring?this._showWiring:void 0,disconnectedAsHighZ:this._disconnectedAsHighZ!==DemuxDef.aults.disconnectedAsHighZ?this._disconnectedAsHighZ:void 0}}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.Demux.tooltip.expand({from:this.numFrom,to:this.numTo}))))}doRecalcValue(){const sel=displayValuesFromArray(this.inputValues(this.inputs.S),!1)[1];if(isUnknown(sel))return ArrayFillWith(Unknown,this.numTo);const values=[],disconnected=!!this._disconnectedAsHighZ&&HighImpedance;for(let g=0;g<this.numGroups;g++)if(g===sel){const inputs=this.inputValues(this.inputs.In);for(const input2 of inputs)values.push(input2)}else for(let i2=0;i2<this.numFrom;i2++)values.push(disconnected);return values}propagateValue(newValues){this.outputValues(this.outputs._all,newValues)}doDraw(g,ctx){const{top:top2,left:left2,bottom:bottom2,right:right2}=this.bounds(),dy=(right2-left2)/3;for(const input2 of this.inputs.In)drawWireLineToComponent(g,input2);for(const sel of this.inputs.S)drawWireLineToComponent(g,sel);for(const outputGroup of this.outputs.Z)for(const output of outputGroup)drawWireLineToComponent(g,output);const outline=g.createPath();if(outline.moveTo(left2,top2+dy),outline.lineTo(right2,top2),outline.lineTo(right2,bottom2),outline.lineTo(left2,bottom2-dy),outline.closePath(),g.fillStyle=COLOR_BACKGROUND,g.fill(outline),this._showWiring){const neutral=this.parent.editor.options.hideWireColors,sel=displayValuesFromArray(this.inputValues(this.inputs.S),!1)[1];if(!isUnknown(sel)){const selectedOutputs=this.outputs.Z[sel],anchorDiffX=(right2-left2)/3,wireStyle=this.parent.editor.options.wireStyle,wireStyleBezier=wireStyle===WireStyles.bezier||wireStyle===WireStyles.auto,timeFraction=ctx.drawParams.drawTimeAnimationFraction;for(let i2=0;i2<this.inputs.In.length;i2++){g.beginPath();const fromNode=this.inputs.In[i2],fromY=fromNode.posYInParentTransform,toY=selectedOutputs[i2].posYInParentTransform;g.moveTo(left2+1,fromY),wireStyleBezier?g.bezierCurveTo(left2+anchorDiffX,fromY,right2-anchorDiffX,toY,right2-1,toY):(g.lineTo(left2+3,fromY),g.lineTo(right2-3,toY),g.lineTo(right2-1,toY)),strokeWireOutlineAndSingleValue(g,this.inputs.In[i2].value,fromNode.color,neutral,timeFraction)}}}g.lineWidth=3,g.strokeStyle=ctx.borderColor,g.stroke(outline)}doSetShowWiring(showWiring){this._showWiring=showWiring,this.requestRedraw({why:"show wiring changed"})}doSetDisconnectedAsHighZ(disconnectedAsHighZ){this._disconnectedAsHighZ=disconnectedAsHighZ,this.setNeedsRecalc()}makeComponentSpecificContextMenuItems(){const s=S.Components.MuxDemux.contextMenu;let icon=this._showWiring?"check":"none";const toggleShowWiringItem=MenuData.item(icon,s.ShowWiring,(()=>{this.doSetShowWiring(!this._showWiring)}));icon=this._disconnectedAsHighZ?"check":"none";const toggleUseHighZItem=MenuData.item(icon,s.UseZForDisconnected,(()=>{this.doSetDisconnectedAsHighZ(!this._disconnectedAsHighZ)}));return[this.makeChangeParamsContextMenuItem("inputs",s.ParamNumFrom,this.numFrom,"from"),this.makeChangeParamsContextMenuItem("outputs",s.ParamNumTo,this.numTo,"to",[2,4,8,16].map((x=>x*this.numFrom))),["mid",MenuData.sep()],this.makeChangeBooleanParamsContextMenuItem(1===this.numSel?S.Components.Generic.contextMenu.ParamControlBitAtBottom:S.Components.Generic.contextMenu.ParamControlBitsAtBottom,this.controlPinsAtBottom,"bottom"),["mid",toggleShowWiringItem],["mid",toggleUseHighZItem],...this.makeForceOutputsContextMenuItem(!0)]}};__name(Demux,"Demux"),DemuxDef.impl=Demux;var t20=__toESM(require_lib()),DisplayDef=defineParametrizedComponent("display",!0,!1,{variantName:_ref65=>{let{bits:bits}=_ref65;return"display-".concat(bits)},idPrefix:"disp",button:{imgWidth:32},repr:{bits:typeOrUndefined(t20.number),name:ComponentNameRepr,radix:typeOrUndefined(t20.number),showAsUnknown:typeOrUndefined(t20.boolean)},valueDefaults:{radix:10,showAsUnknown:!1},params:{bits:param(4,[3,4,8,16])},validateParams:_ref66=>{let{bits:bits}=_ref66;return{numBits:bits}},size:_ref67=>{let{numBits:numBits}=_ref67;return{gridWidth:2+Math.ceil(numBits/2),gridHeight:useCompact(numBits)?numBits:2*numBits}},makeNodes:_ref68=>{let{numBits:numBits,gridWidth:gridWidth}=_ref68;return{ins:{In:groupVertical("w",-gridWidth/2-1,0,numBits)}}},initialValue:(saved,_ref69)=>{let{numBits:numBits}=_ref69;return[repeatString2("0",numBits),0]}}),Display=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a,_b,_c;super(parent,DisplayDef.with(params),saved),this.numBits=params.numBits,this._name=null!=(_a=null==saved?void 0:saved.name)?_a:void 0,this._radix=null!=(_b=null==saved?void 0:saved.radix)?_b:DisplayDef.aults.radix,this._showAsUnknown=null!=(_c=null==saved?void 0:saved.showAsUnknown)?_c:DisplayDef.aults.showAsUnknown}toJSON(){return{...this.toJSONBase(),bits:this.numBits===DisplayDef.aults.bits?void 0:this.numBits,name:this._name,radix:this._radix===DisplayDef.aults.radix?void 0:this._radix,showAsUnknown:this._showAsUnknown===DisplayDef.aults.showAsUnknown?void 0:this._showAsUnknown}}get showAsUnknown(){return this._showAsUnknown||this.parent.editor.options.hideOutputColors}makeTooltip(){const s=S.Components.Display.tooltip,radixStr=(()=>{switch(this._radix){case 2:return s.RadixBinary;case 10:return s.RadixDecimal;case-10:return s.RadixSignedDecimal;case 16:return s.RadixHexadecimal;default:return s.RadixGeneric.expand({radix:this._radix})}})(),[binaryStringRep,value]=this.value,sParams={numBits:this.numBits,radixStr:radixStr};return tooltipContent(s.title.expand(sParams),mods(div(s.desc[0].expand(sParams)+" ",b(binaryStringRep),s.desc[1]),!isUnknown(value)||this.showAsUnknown?emptyMod:div(s.CurrentlyUndefined)))}doRecalcValue(){return displayValuesFromArray(this.inputValues(this.inputs.In),!1)}doDraw(g,ctx){const[binaryStringRep,value]=this.value,maxValue=(1<<this.inputs.In.length)-1,background=isUnknown(value)||this.showAsUnknown?COLOR_UNKNOWN:colorForFraction(value/maxValue);this.doDrawDefault(g,ctx,{background:background,skipLabels:!0,componentName:[this._name,!0,value],drawLabels:(ctx2,_ref70)=>{let{width:width,height:height}=_ref70;const isVertical=Orientation.isVertical(this.orient),backColorComps=colorCompsRGB(background),textColor=ColorString2(backColorComps[0]+backColorComps[1]+backColorComps[2]>381?0:255);if(g.fillStyle=textColor,g.textAlign="center",!this.showAsUnknown){const[hasSpaces,spacedStringRep]=insertSpaces(binaryStringRep,this._radix);g.font="".concat(hasSpaces?9:10,"px sans-serif"),fillTextVAlign(g,TextVAlign_middle,spacedStringRep,this.posX,this.posY+(isVertical?-width/2+7:-height/2+8))}const mainSize=4===this.numBits&&8===this._radix?16:18;g.font="bold ".concat(mainSize,"px sans-serif");const stringRep=this.showAsUnknown?Unknown:formatWithRadix(value,this._radix,this.numBits);fillTextVAlign(g,TextVAlign_middle,stringRep,this.posX,this.posY+(isVertical?6:0))}})}pointerDoubleClicked(e){const superChange=super.pointerDoubleClicked(e);if(superChange.isChange)return superChange;const mode=this.parent.mode;return mode>=4&&e.altKey?(this.doSetShowAsUnknown(!this._showAsUnknown),InteractionResult.SimpleChange):mode>=3?(this.doSetRadix(10===this._radix?16:10),InteractionResult.SimpleChange):InteractionResult.NoChange}doSetName(name2){this._name=name2,this.requestRedraw({why:"name changed"})}doSetShowAsUnknown(showAsUnknown){this._showAsUnknown=showAsUnknown,this.requestRedraw({why:"display as unknown changed"})}doSetRadix(radix){this._radix=radix,this.requestRedraw({why:"radix changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.Display.contextMenu,makeItemShowAs=__name(((desc,handler,isCurrent)=>{const icon=isCurrent?"check":"none",caption=s.DisplayAs+" "+desc,action=isCurrent?()=>{}:handler;return MenuData.item(icon,caption,action)}),"makeItemShowAs"),makeItemShowRadix=__name(((radix,desc)=>makeItemShowAs(desc,(()=>{this._showAsUnknown&&this.doSetShowAsUnknown(!1),this.doSetRadix(radix)}),!this._showAsUnknown&&this._radix===radix)),"makeItemShowRadix");return[["mid",makeItemShowRadix(10,s.DisplayAsDecimal)],["mid",makeItemShowRadix(-10,s.DisplayAsSignedDecimal)],["mid",makeItemShowRadix(8,s.DisplayAsOctal)],["mid",makeItemShowRadix(16,s.DisplayAsHexadecimal)],["mid",makeItemShowAs(s.DisplayAsUnknown,(()=>this.doSetShowAsUnknown(!this._showAsUnknown)),this._showAsUnknown)],["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("inputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),["mid",MenuData.sep()],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetNameDialog(this._name,this.doSetName.bind(this))}};function repeatString2(s,n){let result="";for(let i2=0;i2<n;i2++)result+=s;return result}function insertSpaces(binaryStringRep,radix){let n=-1;if(16===radix?n=4:8===radix&&(n=3),n<0)return[!1,binaryStringRep];const re=new RegExp("(.{".concat(n,"})"),"g");return[!0,reverseString(reverseString(binaryStringRep).replace(re,"$1 "))]}function reverseString(str){return str.split("").reverse().join("")}__name(Display,"Display"),DisplayDef.impl=Display,__name(repeatString2,"repeatString"),__name(insertSpaces,"insertSpaces"),__name(reverseString,"reverseString");var t22=__toESM(require_lib()),t21=__toESM(require_lib()),LedColors={green:null,red:null,yellow:null};function ledColorForLogicValue(v,onColor){return isUnknown(v)?COLOR_UNKNOWN:isHighImpedance(v)?COLOR_HIGH_IMPEDANCE:v?COLOR_LED_ON[onColor]:COLOR_WIRE_BORDER}__name(ledColorForLogicValue,"ledColorForLogicValue");var DisplayBarBase=class extends ComponentBase{constructor(parent,SubclassDef,transparentDefault,saved){var _a,_b,_c;super(parent,SubclassDef,saved),this.transparentDefault=transparentDefault,this._color=null!=(_a=null==saved?void 0:saved.color)?_a:DisplayBarDef.aults.color,this._transparent=null!=(_b=null==saved?void 0:saved.transparent)?_b:transparentDefault,this._name=null!=(_c=null==saved?void 0:saved.name)?_c:void 0}toJSONBase(){return{...super.toJSONBase(),color:this._color===DisplayBarDef.aults.color?void 0:this._color,transparent:this._transparent===this.transparentDefault?void 0:this._transparent,name:this._name}}doSetName(name2){this._name=name2,this.requestRedraw({why:"name changed"})}doSetColor(color){this._color=color,this.requestRedraw({why:"color changed"})}doSetTransparent(transparent){this._transparent=transparent,this.requestRedraw({why:"transparent changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.DisplayBar.contextMenu,makeItemUseColor=__name(((desc,color)=>{const isCurrent=this._color===color,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>this.doSetColor(color),cssColor=COLOR_LED_ON[color];return MenuData.item(icon,span(title(desc),style("display: inline-block; width: 140px; height: 16px; background-color: ".concat(cssColor,"; margin-right: 8px"))),action)}),"makeItemUseColor"),itemTransparent=MenuData.item(this._transparent?"check":"none",s.TransparentWhenOff,(()=>this.doSetTransparent(!this._transparent)));return[["mid",MenuData.submenu("palette",s.Color,[makeItemUseColor(s.ColorGreen,"green"),makeItemUseColor(s.ColorRed,"red"),makeItemUseColor(s.ColorYellow,"yellow"),MenuData.sep(),itemTransparent])],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetNameDialog(this._name,this.doSetName.bind(this))}};__name(DisplayBarBase,"DisplayBarBase");var DisplayBarDef=defineComponent("bar",{idPrefix:"bar",button:{imgWidth:32},repr:{display:t21.keyof({v:null,h:null,px:null,PX:null},"OutputBarType"),color:typeOrUndefined(t21.keyof(LedColors,"LedColor")),transparent:typeOrUndefined(t21.boolean),name:ComponentNameRepr},valueDefaults:{display:"h",color:"green",transparent:!0},size:{gridWidth:1,gridHeight:1},makeNodes:()=>({ins:{I:[0,0,"w"]}}),initialValue:()=>!1}),DisplayBar=class extends DisplayBarBase{constructor(parent,saved){var _a;super(parent,DisplayBarDef,!1,saved),this.doSetDisplay(null!=(_a=null==saved?void 0:saved.display)?_a:DisplayBarDef.aults.display)}toJSON(){return{...super.toJSONBase(),display:this._display}}get unrotatedWidth(){return this.getWidthAndHeight()[0]}get unrotatedHeight(){return this.getWidthAndHeight()[1]}makeTooltip(){const s=S.Components.DisplayBar.tooltip,expl=(()=>{switch(this.value){case Unknown:case HighImpedance:return s.ValueUnknown;case!0:return mods(s.Value1[0],asValue(this.value),s.Value1[1]);case!1:return mods(s.Value0[0],asValue(this.value),s.Value0[1])}})();return tooltipContent(s.title,expl)}get display(){return this._display}doRecalcValue(){return this.inputs.I.value}doDraw(g,ctx){const valueToShow=this.parent.editor.options.hideOutputColors?Unknown:this.value,background=this._transparent&&!1===valueToShow?"rgba(0,0,0,0)":ledColorForLogicValue(valueToShow,this._color);this.doDrawDefault(g,ctx,{background:background,skipLabels:!0,componentName:[this._name,!0,toLogicValueRepr(valueToShow)]})}getWidthAndHeight(){var _a;switch(null!=(_a=this._display)?_a:DisplayBarDef.aults.display){case"h":return[10*GRID_STEP,2*GRID_STEP];case"v":return[2*GRID_STEP,10*GRID_STEP];case"px":return[2*GRID_STEP,2*GRID_STEP];case"PX":return[10*GRID_STEP,10*GRID_STEP]}}pointerDoubleClicked(e){const superChange=super.pointerDoubleClicked(e);return superChange.isChange?superChange:(this.doSetDisplay((()=>{switch(this.display){case"h":return"v";case"v":return"px";case"px":return"PX";case"PX":return"h"}})()),InteractionResult.SimpleChange)}doSetDisplay(newDisplay){this._display=newDisplay,this.updateInputOffsetX(),this.requestRedraw({why:"display mode changed",invalidateMask:!0})}updateInputOffsetX(){const width=this.getWidthAndHeight()[0],input2=this.inputs.I;input2.gridOffsetX=-pxToGrid(width/2)-1,input2.updateLeadLength()}makeComponentSpecificContextMenuItems(){const s=S.Components.DisplayBar.contextMenu,makeItemShowAs=__name(((desc,display)=>{const isCurrent=this._display===display,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>{this.doSetDisplay(display)};return MenuData.item(icon,desc,action)}),"makeItemShowAs");return[["mid",MenuData.submenu("eye",s.Display,[makeItemShowAs(s.DisplayVerticalBar,"v"),makeItemShowAs(s.DisplayHorizontalBar,"h"),makeItemShowAs(s.DisplaySmallSquare,"px"),makeItemShowAs(s.DisplayLargeSquare,"PX"),MenuData.sep(),MenuData.text(s.DisplayChangeDesc)])],...super.makeComponentSpecificContextMenuItems()]}};__name(DisplayBar,"DisplayBar"),DisplayBarDef.impl=DisplayBar;var Display16SegDef=defineComponent("16seg",{idPrefix:"16seg",button:{imgWidth:32},repr:{color:typeOrUndefined(t22.keyof(LedColors,"LedColor")),transparent:typeOrUndefined(t22.boolean),name:ComponentNameRepr},valueDefaults:{},size:{gridWidth:8,gridHeight:10},makeNodes:()=>({ins:{In:group("w",[[-5,-4,"a1"],[-6,-3.5,"a2"],[-5,-3,"b"],[-6,-2.5,"c"],[-5,-2,"d2"],[-6,-1.5,"d1"],[-5,-1,"e"],[-6,-.5,"f"],[-5,0,"g1"],[-6,.5,"g2"],[-5,1,"h"],[-6,1.5,"i"],[-5,2,"j"],[-6,2.5,"k"],[-5,3,"l"],[-6,3.5,"m"],[-5,4,"p"]])}}),initialValue:()=>ArrayFillWith(!1,17)}),Display16Seg=class extends DisplayBarBase{constructor(parent,saved){super(parent,Display16SegDef,!0,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.Display16Seg.tooltip)))}doRecalcValue(){return this.inputValues(this.inputs.In)}doDraw(g,ctx){this.doDrawDefault(g,ctx,{labelSize:7,componentName:[this._name,!0,()=>this.value.map(toLogicValueRepr).reverse().join("")],drawInside:_ref71=>{let{left:left2,right:right2,top:top2,bottom:bottom2}=_ref71;const[a1,a2,b2,c,d2,d1,e,f,g1,g2,h,i2,j,k,l,m,p]=this.value,drawLeft=left2+18,drawRight=right2-10,drawCenterX=(drawLeft+drawRight)/2,drawTop=top2+10,drawBottom=bottom2-10,doFill=__name((v=>{this._transparent&&!1===v||(g.fillStyle=ledColorForLogicValue(v,this._color),g.fill())}),"doFill"),drawH=__name(((v,xLeft,xRight,y)=>{g.beginPath(),g.moveTo(xLeft,y),g.lineTo(xLeft+3,y-3),g.lineTo(xRight-3,y-3),g.lineTo(xRight,y),g.lineTo(xRight-3,y+3),g.lineTo(xLeft+3,y+3),g.closePath(),g.stroke(),doFill(v)}),"drawH"),drawV=__name(((v,x,yTop,yBottom)=>{g.beginPath(),g.moveTo(x,yTop),g.lineTo(x+3,yTop+3),g.lineTo(x+3,yBottom-3),g.lineTo(x,yBottom),g.lineTo(x-3,yBottom-3),g.lineTo(x-3,yTop+3),g.closePath(),g.stroke(),doFill(v)}),"drawV"),dx=3*1.41,dy=3*1.41,drawBackslash=__name(((v,xLeft,yTop,xRight,yBottom)=>{g.beginPath(),g.moveTo(xLeft,yTop),g.lineTo(xLeft+dx,yTop),g.lineTo(xRight,yBottom-dy),g.lineTo(xRight,yBottom),g.lineTo(xRight-dx,yBottom),g.lineTo(xLeft,yTop+dy),g.closePath(),g.stroke(),doFill(v)}),"drawBackslash"),drawSlash=__name(((v,xLeft,yBottom,xRight,yTop)=>{g.beginPath(),g.moveTo(xLeft,yBottom),g.lineTo(xLeft,yBottom-dy),g.lineTo(xRight-dx,yTop),g.lineTo(xRight,yTop),g.lineTo(xRight,yTop+dy),g.lineTo(xLeft+dx,yBottom),g.closePath(),g.stroke(),doFill(v)}),"drawSlash");g.strokeStyle=COLOR_OFF_BACKGROUND,g.lineWidth=1,drawH(a1,drawLeft+3,drawCenterX,drawTop+3),drawH(a2,drawCenterX,drawRight-3,drawTop+3),drawV(b2,drawRight-3,drawTop+3,this.posY),drawV(c,drawRight-3,this.posY,drawBottom-3),drawH(d1,drawLeft+3,drawCenterX,drawBottom-3),drawH(d2,drawCenterX,drawRight-3,drawBottom-3),drawV(e,drawLeft+3,this.posY,drawBottom-3),drawV(f,drawLeft+3,drawTop+3,this.posY),drawH(g1,drawLeft+3,drawCenterX,this.posY),drawH(g2,drawCenterX,drawRight-3,this.posY),drawV(i2,drawCenterX,drawTop+3,this.posY),drawV(l,drawCenterX,this.posY,drawBottom-3);const slashTop=drawTop+3+3,slashBottom=drawBottom-3-3;drawBackslash(h,drawLeft+3+3,slashTop,drawCenterX-3,this.posY-3),drawSlash(j,drawCenterX+3,this.posY-3,drawRight-3-3,slashTop),drawSlash(k,drawLeft+3+3,slashBottom,drawCenterX-3,this.posY+3),drawBackslash(m,drawCenterX+3,this.posY+3,drawRight-3-3,slashBottom),g.beginPath();g.arc(right2-8,bottom2-7-1.9500000000000002,3.9000000000000004,0,2*Math.PI),g.stroke(),doFill(p)}})}};__name(Display16Seg,"Display16Seg"),Display16SegDef.impl=Display16Seg;var t23=__toESM(require_lib()),Display7SegDef=defineComponent("7seg",{idPrefix:"7seg",button:{imgWidth:32},repr:{color:typeOrUndefined(t23.keyof(LedColors,"LedColor")),transparent:typeOrUndefined(t23.boolean),name:ComponentNameRepr},valueDefaults:{},size:{gridWidth:8,gridHeight:10},makeNodes:()=>({ins:{In:group("w",[[-5,-4,"a"],[-5,-3,"b"],[-5,-2,"c"],[-5,-1,"d"],[-5,0,"e"],[-5,1,"f"],[-5,2,"g"],[-5,4,"p"]])}}),initialValue:()=>ArrayFillWith(!1,8)}),Display7Seg=class extends DisplayBarBase{constructor(parent,saved){super(parent,Display7SegDef,!0,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.Display7Seg.tooltip)))}doRecalcValue(){return this.inputValues(this.inputs.In)}doDraw(g,ctx){this.doDrawDefault(g,ctx,{labelSize:9,componentName:[this._name,!0,()=>this.value.map(toLogicValueRepr).reverse().join("")],drawInside:_ref72=>{let{left:left2,right:right2,top:top2,bottom:bottom2}=_ref72;const[a2,b2,c,d,e,f,gg,p]=this.value,drawLeft=left2+20,drawRight=right2-20,drawTop=top2+10,drawBottom=bottom2-10,doFill=__name((v=>{this._transparent&&!1===v||(g.fillStyle=ledColorForLogicValue(v,this._color),g.fill())}),"doFill"),drawH=__name(((v,y)=>{g.beginPath(),g.moveTo(drawLeft+4,y),g.lineTo(drawLeft+4+4,y-4),g.lineTo(drawRight-4-4,y-4),g.lineTo(drawRight-4,y),g.lineTo(drawRight-4-4,y+4),g.lineTo(drawLeft+4+4,y+4),g.closePath(),g.stroke(),doFill(v)}),"drawH"),drawV=__name(((v,x,yTop,yBottom)=>{g.beginPath(),g.moveTo(x,yTop),g.lineTo(x+4,yTop+4),g.lineTo(x+4,yBottom-4),g.lineTo(x,yBottom),g.lineTo(x-4,yBottom-4),g.lineTo(x-4,yTop+4),g.closePath(),g.stroke(),doFill(v)}),"drawV");g.strokeStyle=COLOR_OFF_BACKGROUND,g.lineWidth=1,drawH(a2,drawTop+4),drawV(b2,drawRight-4,drawTop+4,this.posY),drawV(c,drawRight-4,this.posY,drawBottom-4),drawH(d,drawBottom-4),drawV(e,drawLeft+4,this.posY,drawBottom-4),drawV(f,drawLeft+4,drawTop+4,this.posY),drawH(gg,this.posY),g.beginPath();g.arc(right2-10,bottom2-10-2.6,5.2,0,2*Math.PI),g.stroke(),doFill(p)}})}};__name(Display7Seg,"Display7Seg"),Display7SegDef.impl=Display7Seg;var t24=__toESM(require_lib()),DisplayAsciiDef=defineComponent("ascii",{idPrefix:"disp",button:{imgWidth:32},repr:{name:ComponentNameRepr,additionalReprRadix:typeOrUndefined(t24.number),showAsUnknown:typeOrUndefined(t24.boolean)},valueDefaults:{},size:{gridWidth:4,gridHeight:8},makeNodes:()=>({ins:{Z:groupVertical("w",-3,0,7)}}),initialValue:()=>["0000000",0]}),DisplayAscii=class extends ComponentBase{constructor(parent,saved){var _a,_b,_c;super(parent,DisplayAsciiDef,saved),this._name=null!=(_a=null==saved?void 0:saved.name)?_a:void 0,this._additionalReprRadix=null!=(_b=null==saved?void 0:saved.additionalReprRadix)?_b:void 0,this._showAsUnknown=null!=(_c=null==saved?void 0:saved.showAsUnknown)&&_c}toJSON(){return{...this.toJSONBase(),name:this._name,additionalReprRadix:this._additionalReprRadix,showAsUnknown:!!this._showAsUnknown||void 0}}get showAsUnknown(){return this._showAsUnknown||this.parent.editor.options.hideOutputColors}makeTooltip(){const s=S.Components.DisplayAscii.tooltip,[binaryStringRep,value]=this.value;return tooltipContent(s.title,mods(div(s.desc[0],b(binaryStringRep),s.desc[1]),this.showAsUnknown?emptyMod:isUnknown(value)?div(s.CurrentlyUndefined):mods(s.CurrentlyThisCharacter+" ",b(""+value),value<32?s.WhichIsNotPrintable:mods(", ‘",b(String.fromCharCode(value)),"’."))))}doRecalcValue(){return displayValuesFromArray(this.inputValues(this.inputs.Z),!1)}doDraw(g,ctx){const[binaryStringRep,value]=this.value;let mainText,mainTextFont,mainTextStyle=COLOR_COMPONENT_BORDER;isUnknown(value)||this.showAsUnknown?(mainTextFont="bold 18px sans-serif",this.showAsUnknown&&(mainTextStyle=COLOR_UNKNOWN),mainText="?"):(mainText=DisplayAscii.numberToAscii(value),mainTextFont=value<32?"16px sans-serif":"bold 18px sans-serif"),this.doDrawDefault(g,ctx,{skipLabels:!0,componentName:[this._name,!0,mainText],drawLabels:(ctx2,_ref73)=>{let{width:width,height:height}=_ref73;var _a;const isVertical=Orientation.isVertical(this.orient),hasAdditionalRepresentation=void 0!==this._additionalReprRadix;let mainTextPosY=this.posY+(isVertical?4:0);if(g.font="9px sans-serif",g.fillStyle=COLOR_COMPONENT_BORDER,!this.showAsUnknown&&(isVertical&&hasAdditionalRepresentation?(g.textAlign="start",fillTextVAlign(g,TextVAlign_middle,binaryStringRep,this.posX-height/2+3,this.posY-width/2+8),g.textAlign="center"):(g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,binaryStringRep,this.posX,this.posY+(isVertical?-width/2+8:-height/2+10))),hasAdditionalRepresentation)){const additionalRepr=formatWithRadix(value,null!=(_a=this._additionalReprRadix)?_a:10,7);g.font="bold 11px sans-serif",isVertical?(g.textAlign="end",fillTextVAlign(g,TextVAlign_middle,additionalRepr,this.posX+height/2-3,this.posY-width/2+9),g.textAlign="center"):(fillTextVAlign(g,TextVAlign_middle,additionalRepr,this.posX,this.posY-height/2+22),mainTextPosY+=8)}g.font=mainTextFont,g.fillStyle=mainTextStyle,fillTextVAlign(g,TextVAlign_middle,mainText,this.posX,mainTextPosY)}})}static numberToAscii(n){return n<32?"\\"+n:String.fromCharCode(n)}pointerDoubleClicked(e){const superChange=super.pointerDoubleClicked(e);if(superChange.isChange)return superChange;const mode=this.parent.mode;return mode>=4&&e.altKey?(this.doSetShowAsUnknown(!this._showAsUnknown),InteractionResult.SimpleChange):mode>=3?(this.doSetAdditionalDisplayRadix((()=>{switch(this._additionalReprRadix){case void 0:return 10;case 10:return 16;default:return}})()),InteractionResult.SimpleChange):InteractionResult.NoChange}doSetName(name2){this._name=name2,this.requestRedraw({why:"name changed"})}doSetShowAsUnknown(showAsUnknown){this._showAsUnknown=showAsUnknown,this.requestRedraw({why:"display as unknown changed"})}doSetAdditionalDisplayRadix(additionalReprRadix){this._additionalReprRadix=additionalReprRadix,this.requestRedraw({why:"additional display radix changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.DisplayAscii.contextMenu,makeItemShowAs=__name(((desc,handler,isCurrent)=>{const icon=isCurrent?"check":"none";return MenuData.item(icon,desc,handler)}),"makeItemShowAs"),makeItemShowRadix=__name(((radix,desc)=>makeItemShowAs(desc,(()=>this.doSetAdditionalDisplayRadix(radix)),this._additionalReprRadix===radix)),"makeItemShowRadix");return[["mid",MenuData.submenu("eye",s.AdditionalDisplay,[makeItemShowRadix(void 0,s.DisplayNone),makeItemShowRadix(10,s.DisplayDecimal),makeItemShowRadix(16,s.DisplayHex),MenuData.sep(),MenuData.text(s.ChangeDisplayDesc)])],["mid",makeItemShowAs(S.Components.Generic.contextMenu.ShowAsUnknown,(()=>this.doSetShowAsUnknown(!this._showAsUnknown)),this._showAsUnknown)],["mid",MenuData.sep()],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetNameDialog(this._name,this.doSetName.bind(this))}};__name(DisplayAscii,"DisplayAscii"),DisplayAsciiDef.impl=DisplayAscii;var FlipflopDDef=defineComponent("ff-d",{idPrefix:"ff",...FlipflopBaseDef,makeNodes:()=>{const base=FlipflopBaseDef.makeNodes(2),s=S.Components.Generic;return{ins:{...base.ins,D:[-4,-2,"w",s.InputDataDesc]},outs:base.outs}}}),FlipflopD=class extends Flipflop{constructor(parent,saved){super(parent,FlipflopDDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.FlipflopD.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValueAfterClock(){return LogicValue.filterHighZ(this.inputs.D.value)}};__name(FlipflopD,"FlipflopD"),FlipflopDDef.impl=FlipflopD;var FlipflopJKDef=defineComponent("ff-jk",{idPrefix:"ff",...FlipflopBaseDef,makeNodes:()=>{const base=FlipflopBaseDef.makeNodes(0),s=S.Components.FlipflopJK;return{ins:{...base.ins,J:[-4,-2,"w",s.InputJDesc],K:[-4,2,"w",s.InputKDesc]},outs:base.outs}}}),FlipflopJK=class extends Flipflop{constructor(parent,saved){super(parent,FlipflopJKDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.FlipflopJK.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValueAfterClock(){const j=this.inputs.J.value,k=this.inputs.K.value,q=this.outputs.Q.value;return!0===j?!0!==k||LogicValue.invert(q):!0!==k&&q}};__name(FlipflopJK,"FlipflopJK"),FlipflopJKDef.impl=FlipflopJK;var FlipflopTDef=defineComponent("ff-t",{idPrefix:"ff",...FlipflopBaseDef,makeNodes:()=>{const base=FlipflopBaseDef.makeNodes(2),s=S.Components.FlipflopT;return{ins:{...base.ins,T:[-4,-2,"w",s.InputTDesc]},outs:base.outs}}}),FlipflopT=class extends Flipflop{constructor(parent,saved){super(parent,FlipflopTDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.FlipflopT.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValueAfterClock(){const t38=this.inputs.T.value;if(isUnknown(t38)||isHighImpedance(t38))return Unknown;const q=this.outputs.Q.value;return t38?LogicValue.invert(q):q}};__name(FlipflopT,"FlipflopT"),FlipflopTDef.impl=FlipflopT;var t25=__toESM(require_lib()),GateBase=class extends ParametrizedComponentBase{constructor(parent,SubclassDef,type7,saved){var _a,_b;super(parent,SubclassDef,saved),this._type=type7,this._poseAs=null!=(_a=null==saved?void 0:saved.poseAs)?_a:void 0,this._showAsUnknown=null!=(_b=null==saved?void 0:saved.showAsUnknown)&&_b}toJSONBase(){return{...super.toJSONBase(),showAsUnknown:!!this._showAsUnknown||void 0,poseAs:this._poseAs}}jsonType(){return this._type}get type(){return this._type}doSetType(newType){var _a;this._type=newType,this.updateLeadsFor(newType);for(const input2 of this.inputs.In)null==(_a=input2.incomingWire)||_a.invalidateWirePath();this.setNeedsRecalc(),this.requestRedraw({why:"gate type changed",invalidateTests:!0})}updateLeadsFor(type7){const isOrStyle="or"===type7||"nor"===type7||"imply"===type7||"rimply"===type7,leadLength=isOrStyle?25:20,ins=this.inputs.In;if(ins.forEach((node=>node.updateLeadLength(leadLength))),isOrStyle){const numBits=this.numBits;if((numBits>=6||4===numBits)&&(ins[0].updateLeadLength(leadLength-3),ins[numBits-1].updateLeadLength(leadLength-3),numBits>=8)){const numCoveredByGate=6,iTopGate=(numBits-numCoveredByGate)/2,iBottomGate=iTopGate+numCoveredByGate-1;ins[iTopGate].updateLeadLength(leadLength-3),ins[iBottomGate].updateLeadLength(leadLength-3),numBits>=24&&(ins[1].updateLeadLength(leadLength-2),ins[numBits-2].updateLeadLength(leadLength-2),ins[iTopGate-1].updateLeadLength(leadLength-2),ins[iTopGate-2].updateLeadLength(leadLength-2),ins[iBottomGate+1].updateLeadLength(leadLength-2),ins[iBottomGate+2].updateLeadLength(leadLength-2))}}}get poseAs(){return this._poseAs}set poseAs(newPoseAs){newPoseAs!==this._poseAs&&(this._poseAs=newPoseAs,this.requestRedraw({why:"gate display changed"}))}get showAsUnknown(){return this._showAsUnknown}doSetShowAsUnknown(newUnknown){this._showAsUnknown=newUnknown,this.requestRedraw({why:"display as unknown changed"})}toStringDetails(){return this.type}doRecalcValue(){const inputs=this.inputValues(this.inputs.In);return(0,this.gateTypes(this.numBits).props[this.type].out)(inputs)}propagateValue(newValue){this.outputs.Out.value=newValue}makeTooltip(){const s=S.Components.Gate.tooltip;if(this.showAsUnknown)return div(s.UnknownGate);const myIns=this.inputValues(this.inputs.In),myOut=this.value,gateProps=this.gateTypes(this.numBits).props[this.type],genTruthTableData=__name((()=>{const header2=1===this.numBits?[s.Input]:ArrayFillUsing((i2=>s.Input+" "+(i2+1)),this.numBits);header2.push(s.Output);const rows=[];for(const ins of valueCombinations(this.numBits)){const matchesCurrent=deepArrayEquals(myIns,ins),out=gateProps.out(ins);ins.push(out),rows.push({matchesCurrent:matchesCurrent,cells:ins})}return[header2,rows]}),"genTruthTableData"),desc=this.outputs.Out.value===myOut?s.CurrentlyDelivers:s.ShouldCurrentlyDeliver,explanation=myIns.includes(Unknown)?mods(desc+" "+s.UndeterminedOutputBecauseInputUnknown):mods(desc+" "+s.ThisOutput+" ",asValue(myOut)," "+s.BecauseInputIs+" ",...myIns.map(asValue)),fullShortDesc=gateProps.fullShortDesc(),header=(()=>{switch(this.type){case"not":return mods(s.Inverter[0],b(S.Components.Gate.not[0]),s.Inverter[1]);case"buf":return mods(s.Buffer[0],b(S.Components.Gate.buf[0]),s.Buffer[1]);default:return s.GateTitle(b(fullShortDesc[0]))}})(),explanationAndTable=this.numBits<=4?mods(explanation,", "+s.AccordingToTruthTable,div(makeTruthTable(genTruthTableData()))):mods(explanation,".");return makeGateTooltip(this.numBits,header,fullShortDesc[2],explanationAndTable)}doDraw(g,ctx){var _a;const gateType=this._showAsUnknown?Unknown:null!=(_a=this.poseAs)?_a:this.type;this.drawGate(g,gateType,gateType!==this.type&&!this._showAsUnknown,ctx)}drawGate(g,type7,isFake,ctx){const numBits=this.numBits,output=this.outputs.Out,{top:top2,left:left2,bottom:bottom2,right:right2,height:height}=this.bounds(),drawArms=numBits>=4&&5!==numBits,armsOffset=GRID_STEP/(useCompact(numBits)?2:1),armsTop=this.inputs.In[0].posYInParentTransform-armsOffset,armsBottom=this.inputs.In[numBits-1].posYInParentTransform+armsOffset,pi22=Math.PI/2;let nameDeltaX=0;const drawInversionCircle=__name(((x,y)=>{g.beginPath(),circle(g,x,y,8),g.fillStyle=COLOR_BACKGROUND,g.fill(),g.stroke()}),"drawInversionCircle"),showAsFake=isFake&&this.parent.mode>=4,gateBorderColor=ctx.isMouseOver?COLOR_MOUSE_OVER:showAsFake?COLOR_DARK_RED:COLOR_COMPONENT_BORDER,gateFill=showAsFake?PATTERN_STRIPED_GRAY:COLOR_BACKGROUND;for(let i2=0;i2<numBits;i2++)drawWireLineToComponent(g,this.inputs.In[i2]);switch(drawWireLineToComponent(g,output),g.lineWidth=3,g.strokeStyle=gateBorderColor,g.fillStyle=gateFill,type7){case"not":case"buf":g.beginPath(),g.moveTo(left2,top2),g.lineTo(right2,this.posY),g.lineTo(left2,bottom2),g.closePath(),g.fill(),g.stroke(),"not"===type7&&drawInversionCircle(right2+5,this.posY),nameDeltaX=-7;break;case"and":case"nand":case"nimply":case"rnimply":{const arcBeginX=right2-height/2;g.beginPath(),g.moveTo(arcBeginX,bottom2),g.lineTo(left2,bottom2),g.lineTo(left2,top2),g.lineTo(arcBeginX,top2),g.arc(arcBeginX,this.posY,height/2,-pi22,pi22),g.closePath(),g.fill(),g.lineWidth=1,g.stroke(),g.strokeStyle=gateBorderColor,g.lineWidth=3,g.stroke(),g.beginPath(),type7.startsWith("nand")&&drawInversionCircle(right2+5,this.posY),"nimply"===type7?drawInversionCircle(left2-5,this.posY+GRID_STEP):"rnimply"===type7&&drawInversionCircle(left2-5,this.posY-GRID_STEP),nameDeltaX=-2,drawArms&&(g.moveTo(left2,armsTop),g.lineTo(left2,armsBottom),g.stroke());break}case"or":case"nor":case"xor":case"xnor":case"imply":case"rimply":{const leftCurve=12;g.beginPath(),g.moveTo(this.posX-15,top2),g.bezierCurveTo(this.posX+10,top2,right2-5,this.posY-8,right2,this.posY),g.bezierCurveTo(right2-5,this.posY+8,this.posX+10,bottom2,left2,bottom2),g.quadraticCurveTo(left2+leftCurve,this.posY,left2,top2),g.closePath(),g.fill(),g.stroke();const armsHeight=armsBottom-bottom2,armsCurvature=Math.min(leftCurve,armsHeight/4);if(drawArms&&(g.beginPath(),g.moveTo(left2,bottom2),g.quadraticCurveTo(left2+armsCurvature,bottom2+armsHeight/2,left2,armsBottom),g.moveTo(left2,top2),g.quadraticCurveTo(left2+armsCurvature,top2-armsHeight/2,left2,armsTop),g.stroke()),(type7.startsWith("nor")||type7.startsWith("xnor"))&&drawInversionCircle(right2+5,this.posY),"imply"===type7?drawInversionCircle(left2-2,this.posY-GRID_STEP):"rimply"===type7&&drawInversionCircle(left2-2,this.posY+GRID_STEP),type7.startsWith("x")){g.lineWidth=3;const leftXorCurve=__name((delta=>{g.beginPath(),drawArms?(g.moveTo(left2-delta,armsBottom),g.quadraticCurveTo(left2+armsCurvature-delta,bottom2+armsHeight/2,left2-delta,bottom2),g.quadraticCurveTo(left2+leftCurve-delta,this.posY,left2-delta,top2),g.quadraticCurveTo(left2+armsCurvature-delta,top2-armsHeight/2,left2-delta,armsTop)):(g.moveTo(left2-delta,bottom2),g.quadraticCurveTo(left2+leftCurve-delta,this.posY,left2-delta,top2))}),"leftXorCurve");leftXorCurve(3),g.strokeStyle=COLOR_BACKGROUND,g.stroke(),leftXorCurve(6),g.strokeStyle=gateBorderColor,g.stroke()}nameDeltaX=1;break}case"txa":case"txna":g.beginPath(),g.moveTo(left2,bottom2),g.lineTo(left2,top2),g.lineTo(right2,this.posY+.5),g.lineTo(left2+2,this.posY+.5),g.fill(),g.stroke(),"txna"===type7&&drawInversionCircle(left2-5,this.posY-GRID_STEP);break;case"txb":case"txnb":g.beginPath(),g.moveTo(left2,top2),g.lineTo(left2,bottom2),g.lineTo(right2,this.posY-.5),g.lineTo(left2+2,this.posY-.5),g.fill(),g.stroke(),"txnb"===type7&&drawInversionCircle(left2-5,this.posY+GRID_STEP);break;case"?":{const gateRightSquare=left2+(bottom2-top2);g.strokeStyle=ctx.isMouseOver?COLOR_MOUSE_OVER:COLOR_UNKNOWN,g.beginPath(),g.moveTo(left2,top2),g.lineTo(gateRightSquare,top2),g.lineTo(gateRightSquare,bottom2),g.lineTo(left2,bottom2),g.closePath(),g.fill(),g.stroke(),drawArms&&(g.moveTo(left2,armsTop),g.lineTo(left2,armsBottom),g.stroke()),g.lineWidth=0,ctx.inNonTransformedFrame((()=>{g.fillStyle=COLOR_UNKNOWN,g.textAlign="center",g.font="bold 20px sans-serif",fillTextVAlign(g,TextVAlign_middle,"?",(left2+gateRightSquare)/2,this.posY)}));break}}if(this.parent.editor.options.showGateTypes&&!isUnknown(type7)){const gateShortName=this.gateTypes(this.numBits).props[type7].fullShortDesc()[1];if(void 0!==gateShortName){g.fillStyle=COLOR_GATE_NAMES,g.font="bold 13px sans-serif";const oldTransform=g.getTransform();g.translate(this.posX+nameDeltaX,this.posY),g.scale(.65,1),g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,gateShortName,0,0),g.setTransform(oldTransform)}}}pointerDoubleClicked(e){return this.parent.mode>=4&&e.altKey?(this.doSetShowAsUnknown(!this._showAsUnknown),InteractionResult.SimpleChange):super.pointerDoubleClicked(e)}makeComponentSpecificContextMenuItems(){const items=[],adminMode=this.parent.mode>=4;if(!this._showAsUnknown||adminMode){const replaceBy=this.makeReplaceByMenuItem();void 0!==replaceBy&&items.push(["start",replaceBy])}return adminMode&&items.push(["mid",this.makePoseAsMenuItem()],...this.makeForceOutputsContextMenuItem()),items}makeReplaceByMenuItem(){const gateTypes=this.gateTypes(this.numBits),s=S.Components.Gate.contextMenu,otherTypes=gateTypes.values.filter((t38=>t38!==this._type&&gateTypes.props[t38].includeInContextMenu)).filter((t38=>this.parent.editor.allowGateType(t38)));if(0!==otherTypes.length)return MenuData.submenu("replace",s.ReplaceBy,[...otherTypes.map((newType=>{const gateProps=gateTypes.props[newType];return MenuData.item(void 0,s.GateTempl.expand({type:gateProps.fullShortDesc()[0]}),(()=>{const oldType=this._type;this.doSetType(newType);const ref=this.ref;void 0!==ref&&ref.startsWith(oldType)&&this.parent.components.regenerateIdOf(this)}))})),MenuData.sep(),MenuData.text(s.VariantChangeDesc)])}makePoseAsMenuItem(){const gateTypes=this.gateTypes(this.numBits),s=S.Components.Gate.contextMenu,otherTypes=gateTypes.values.filter((t38=>t38!==this._type&&gateTypes.props[t38].includeInPoseAs)),currentShowAsUnknown=this._showAsUnknown,currentPoseAs=this.poseAs;return MenuData.submenu("questioncircled",s.ShowAs,[MenuData.item(currentShowAsUnknown||void 0!==currentPoseAs?"none":"check",s.NormalGateTempl.expand({type:gateTypes.props[this._type].fullShortDesc()[0]}),(()=>{this.poseAs=void 0,this.doSetShowAsUnknown(!1)})),MenuData.item(currentShowAsUnknown?"check":"none",s.UnknownGate,(()=>{this.poseAs=void 0,this.doSetShowAsUnknown(!0)})),MenuData.sep(),...otherTypes.map((newType=>{const gateProps=gateTypes.props[newType];return MenuData.item(currentShowAsUnknown||newType!==currentPoseAs?"none":"check",s.GateTempl.expand({type:gateProps.fullShortDesc()[0]}),(()=>{this.doSetShowAsUnknown(!1),this.poseAs=newType}))}))])}};function validateGateType(GateTypes2,typeFromParam,typeFromJson,defaultFromDef,jsonTypeSuffix){let typeToValidate;return typeToValidate=void 0===typeFromJson?typeFromParam:void 0!==jsonTypeSuffix&&typeFromJson.endsWith(jsonTypeSuffix)?typeFromJson.slice(0,-jsonTypeSuffix.length):typeFromJson,GateTypes2.includes(typeToValidate)?typeToValidate:(console.error("Invalid gate type: '".concat(typeToValidate,"'")),defaultFromDef)}__name(GateBase,"GateBase"),__name(validateGateType,"validateGateType");var Gate1Def=defineParametrizedComponent("gate1",!0,!0,{variantName:_ref74=>{let{type:type7}=_ref74;return[type7]},button:{imgWidth:50},repr:{poseAs:typeOrUndefined(Gate1TypeRepr),showAsUnknown:typeOrUndefined(t25.boolean)},valueDefaults:{},params:{type:param("not")},validateParams:(_ref75,jsonType,defaults)=>{let{type:paramType}=_ref75;return{type:validateGateType(Gate1Types,paramType,jsonType,defaults.type.defaultValue)}},idPrefix:_ref76=>{let{type:type7}=_ref76;return type7},size:()=>({gridWidth:4,gridHeight:4}),makeNodes:()=>({ins:{In:[[-4,0,"w",{leadLength:20}]]},outs:{Out:[4,0,"e",{leadLength:20}]}}),initialValue:()=>!1}),Gate1=class extends GateBase{get numBits(){return 1}constructor(parent,params,saved){super(parent,Gate1Def.with(params),params.type,saved)}gateTypes(){return Gate1Types}toJSON(){return super.toJSONBase()}pointerDoubleClicked(e){const superChange=super.pointerDoubleClicked(e);return superChange.isChange?superChange:this.parent.mode>=3?(this.doSetType("buf"===this.type?"not":"buf"),InteractionResult.SimpleChange):InteractionResult.NoChange}};__name(Gate1,"Gate1"),Gate1Def.impl=Gate1;var GateNDef=defineParametrizedComponent("gate",!0,!0,{variantName:_ref77=>{let{type:type7,bits:bits}=_ref77;return[type7,"".concat(type7,"-").concat(bits)]},button:{imgWidth:50},repr:{poseAs:typeOrUndefined(GateNTypeRepr),showAsUnknown:typeOrUndefined(t25.boolean)},valueDefaults:{},params:{bits:param(2,[2,3,4,5,6,7,8,12,16,24,32]),type:param("and")},validateParams:(_ref78,jsonType,defaults)=>{let{type:paramType,bits:bits}=_ref78;return{type:validateGateType(bits>2?Gate2toNTypes:GateNTypes,paramType,jsonType,defaults.type.defaultValue),numBits:bits}},idPrefix:_ref79=>{let{type:type7}=_ref79;return type7},size:_ref80=>{let{numBits:numBits}=_ref80;return{gridWidth:4,gridHeight:2!==numBits&&4!==numBits&&6!==numBits?5:4}},makeNodes:_ref81=>{let{numBits:numBits}=_ref81;return{ins:{In:groupVertical("w",-4,0,numBits,void 0,{leadLength:20})},outs:{Out:[4,0,"e",{leadLength:20}]}}},initialValue:()=>!1}),GateN=class extends GateBase{constructor(parent,params,saved){super(parent,GateNDef.with(params),params.type,saved),this.numBits=params.numBits,this.updateLeadsFor(params.type)}gateTypes(numBits){return numBits>2?Gate2toNTypes:GateNTypes}toJSON(){return{...this.toJSONBase(),bits:this.numBits!==GateNDef.aults.bits?this.numBits:void 0}}pointerDoubleClicked(e){const superChange=super.pointerDoubleClicked(e);if(superChange.isChange)return superChange;if(this.parent.mode>=3){const newType=(()=>{switch(this.type){case"imply":return"rimply";case"rimply":return"imply";case"nimply":return"rnimply";case"rnimply":return"nimply";case"txa":return"txb";case"txb":return"txna";case"txna":return"txnb";case"txnb":return"txa";default:return}})();if(void 0!==newType)return this.doSetType(newType),InteractionResult.SimpleChange}return InteractionResult.NoChange}makeComponentSpecificContextMenuItems(){const s=S.Components.Generic.contextMenu;return[...Gate2OnlyTypes.includes(this.type)?[]:[this.makeChangeParamsContextMenuItem("inputs",s.ParamNumInputs,this.numBits,"bits"),["mid",MenuData.sep()]],...super.makeComponentSpecificContextMenuItems()]}};function*valueCombinations(n){let curr=0;const max3=1<<n;for(;curr<max3;){const valueArray=curr.toString(2).padStart(n,"0").split("").reverse().map((v=>"1"===v));yield valueArray,curr++}}function makeTruthTable(_ref82){let[header,rows]=_ref82;const htmlRows=rows.map((_ref83=>{let{matchesCurrent:matchesCurrent,cells:cells}=_ref83;return tr(matchesCurrent?cls("current"):emptyMod,...cells.map((v=>td(asValue(v)))))}));return table(cls("truth-table"),thead(tr(...header.map((title2=>th(title2))))),tbody(...htmlRows))}function makeGateTooltip(numBits,title2,description,explanationAndTable){const numBitsDisplay=Math.min(4,numBits),maxWidth=200+50*Math.max(0,numBitsDisplay-2);return tooltipContent(title2,mods(div(description),div(explanationAndTable)),maxWidth)}__name(GateN,"GateN"),GateNDef.impl=GateN,__name(valueCombinations,"valueCombinations"),__name(makeTruthTable,"makeTruthTable"),__name(makeGateTooltip,"makeGateTooltip");var t26=__toESM(require_lib()),GateArrayDef=defineParametrizedComponent("gate-array",!0,!0,{variantName:_ref84=>{let{type:type7,bits:bits}=_ref84;return["gate-array","".concat(type7,"-array"),"".concat(type7,"-array-").concat(bits)]},idPrefix:"array",button:{imgWidth:50},repr:{bits:typeOrUndefined(t26.number),showAsUnknown:typeOrUndefined(t26.boolean)},valueDefaults:{showAsUnknown:!1},params:{bits:param(4,[2,4,8,16]),type:param("and",GateNTypes.values)},validateParams:(_ref85,jsonType,defaults)=>{let{type:paramType,bits:bits}=_ref85;return{type:validateGateType(GateNTypes,paramType,jsonType,defaults.type.defaultValue,"-array"),numBits:bits}},size:AdderArrayDef.size,makeNodes:_ref86=>{let{numBits:numBits}=_ref86;const inputCenterY=5+Math.max(0,(numBits-8)/2);return{ins:{A:groupVertical("w",-3,-inputCenterY,numBits),B:groupVertical("w",-3,inputCenterY,numBits)},outs:{S:groupVertical("e",3,0,numBits)}}},initialValue:(saved,_ref87)=>{let{numBits:numBits}=_ref87;return ArrayFillWith(!1,numBits)}}),GateArray=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a;super(parent,GateArrayDef.with(params),saved),this.numBits=params.numBits,this._type=params.type,this._showAsUnknown=null!=(_a=null==saved?void 0:saved.showAsUnknown)?_a:GateArrayDef.aults.showAsUnknown}toJSON(){return{...this.toJSONBase(),bits:this.numBits===GateArrayDef.aults.bits?void 0:this.numBits,showAsUnknown:this._showAsUnknown===GateArrayDef.aults.showAsUnknown?void 0:this._showAsUnknown}}jsonType(){return"".concat(this._type,"-array")}get type(){return this._type}makeTooltip(){const s=S.Components.GateArray.tooltip,opDesc=S.Components.Gate[this._type][0];return tooltipContent(s.title,mods(div(s.desc.expand({op:opDesc}))))}doRecalcValue(){const out=GateNTypes.props[this._type].out,a2=this.inputValues(this.inputs.A),b2=this.inputValues(this.inputs.B);return ArrayFillUsing((i2=>out([a2[i2],b2[i2]])),this.numBits)}propagateValue(newValue){this.outputValues(this.outputs.S,newValue)}doDraw(g,ctx){this.doDrawDefault(g,ctx,{skipLabels:!0,drawInside:_ref88=>{let{left:left2,right:right2}=_ref88;if(this._showAsUnknown)ctx.inNonTransformedFrame((()=>{g.fillStyle=COLOR_UNKNOWN,g.font="bold 20px sans-serif",g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"?",this.posX,this.posY)}));else{g.lineWidth=2,g.strokeStyle=COLOR_COMPONENT_BORDER,g.beginPath();const top2=this.posY-GRID_STEP,bottom2=this.posY+GRID_STEP;let gateLeft=left2+10;const gateRight=right2-10,pi22=Math.PI/2,type7=this._type,drawRightCircle=__name((()=>{g.beginPath(),circle(g,gateRight+3,this.posY,5),g.stroke()}),"drawRightCircle"),drawLeftCircle=__name((up=>{g.beginPath(),circle(g,gateLeft-3,this.posY-4*(up?1:-1),5),g.stroke()}),"drawLeftCircle");switch(type7){case"and":case"nand":case"nimply":case"rnimply":g.moveTo(this.posX,bottom2),g.lineTo(gateLeft,bottom2),g.lineTo(gateLeft,top2),g.lineTo(this.posX,top2),g.arc(this.posX,this.posY,GRID_STEP,-pi22,pi22),g.closePath(),g.stroke(),g.beginPath(),type7.startsWith("nand")&&drawRightCircle(),"nimply"===type7?drawLeftCircle(!1):"rnimply"===type7&&drawLeftCircle(!0);break;case"or":case"nor":case"xor":case"xnor":case"imply":case"rimply":{g.beginPath(),g.moveTo(gateLeft,top2),g.lineTo(this.posX-5,top2),g.bezierCurveTo(this.posX+2,top2,gateRight-5,this.posY-8,gateRight,this.posY),g.bezierCurveTo(gateRight-5,this.posY+8,this.posX+2,bottom2,this.posX-5,bottom2),g.lineTo(gateLeft,bottom2),g.quadraticCurveTo(this.posX-4,this.posY,gateLeft,top2),g.closePath(),g.stroke();const savedGateLeft=gateLeft;gateLeft+=2,(type7.startsWith("nor")||type7.startsWith("xnor"))&&drawRightCircle(),"imply"===type7?drawLeftCircle(!0):"rimply"===type7&&drawLeftCircle(!1),type7.startsWith("x")&&(g.beginPath(),g.moveTo(savedGateLeft-4,bottom2),g.quadraticCurveTo(this.posX-8,this.posY,savedGateLeft-4,top2),g.stroke());break}case"txa":case"txna":g.beginPath(),g.moveTo(gateLeft,bottom2),g.lineTo(gateLeft,top2),g.lineTo(gateRight,this.posY),g.lineTo(gateLeft+2,this.posY),g.stroke(),"txna"===type7&&drawLeftCircle(!0);break;case"txb":case"txnb":g.beginPath(),g.moveTo(gateLeft,top2),g.lineTo(gateLeft,bottom2),g.lineTo(gateRight,this.posY),g.lineTo(gateLeft+2,this.posY),g.stroke(),"txnb"===type7&&drawLeftCircle(!1)}}}})}doSetType(newSubtype){this._type=newSubtype,this.setNeedsRecalc(),this.requestRedraw({why:"quad gate type changed",invalidateTests:!0})}doSetShowAsUnknown(showAsUnknown){this._showAsUnknown=showAsUnknown,this.requestRedraw({why:"display as unknown changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.GateArray.contextMenu,typeItems=[],subtypes=["and","or","xor","nand","nor","xnor","-","imply","rimply","nimply","rnimply"].filter((t38=>this.parent.editor.allowGateType(t38)));if(0!==subtypes.length){"-"===subtypes[0]?subtypes.shift():"-"===subtypes[subtypes.length-1]&&subtypes.pop();for(const subtype of subtypes)if("-"===subtype)typeItems.push(MenuData.sep());else{const icon=this._type===subtype?"check":"none";typeItems.push(MenuData.item(icon,subtype.toUpperCase(),(()=>{this.doSetType(subtype)})))}}const items=[];if(typeItems.length>=2&&items.push(["mid",MenuData.submenu("settings",s.Type,typeItems)]),this.parent.mode>=4){const showAsUnknownItem=MenuData.item(this._showAsUnknown?"check":"none",s.ShowAsUnknown,(()=>{this.doSetShowAsUnknown(!this._showAsUnknown)}));items.push(["mid",showAsUnknownItem])}return items.push(["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("inputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)),items}};__name(GateArray,"GateArray"),GateArrayDef.impl=GateArray;var HalfAdderDef=defineComponent("halfadder",{idPrefix:"hadder",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:4,gridHeight:6},makeNodes:()=>{const s=S.Components.Generic;return{ins:{A:[-4,-2,"w","A",{hasTriangle:!0}],B:[-4,2,"w","B",{hasTriangle:!0}]},outs:{S:[4,-2,"e",s.OutputSumDesc,{hasTriangle:!0}],C:[4,2,"e",s.OutputCarryDesc,{hasTriangle:!0}]}}},initialValue:()=>({s:!1,c:!1})}),HalfAdder=class extends ComponentBase{constructor(parent,saved){super(parent,HalfAdderDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.HalfAdder.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValue(){const a2=this.inputs.A.value,b2=this.inputs.B.value;if(isUnknown(a2)||isUnknown(b2)||isHighImpedance(a2)||isHighImpedance(b2))return{s:Unknown,c:Unknown};switch(+a2+ +b2){case 0:return{s:!1,c:!1};case 1:return{s:!0,c:!1};case 2:return{s:!1,c:!0};default:return console.log("ERROR: sum of halfadder is > 2"),{s:!1,c:!1}}}propagateValue(newValue){this.outputs.S.value=newValue.s,this.outputs.C.value=newValue.c}doDraw(g,ctx){this.doDrawDefault(g,ctx,(()=>{g.fillStyle=COLOR_COMPONENT_BORDER,g.font="26px sans-serif",g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"+",this.posX,this.posY-2)}))}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};__name(HalfAdder,"HalfAdder"),HalfAdderDef.impl=HalfAdder;var t27=__toESM(require_lib()),LabelDef=defineComponent("label",{idPrefix:"label",button:{imgWidth:32},repr:{text:t27.string,font:typeOrUndefined(t27.string)},valueDefaults:{text:"Label",font:"18px sans-serif"},size:{gridWidth:4,gridHeight:2},makeNodes:()=>({})}),Label=class extends ComponentBase{constructor(parent,saved){var _a,_b;super(parent,LabelDef,saved),this._cachedTextMetrics=void 0,this._text=null!=(_a=null==saved?void 0:saved.text)?_a:LabelDef.aults.text,this._font=null!=(_b=null==saved?void 0:saved.font)?_b:LabelDef.aults.font}toJSON(){return{...this.toJSONBase(),text:this._text,font:this._font===LabelDef.aults.font?void 0:this._font}}get unrotatedWidth(){var _a,_b;return null!=(_b=null==(_a=this._cachedTextMetrics)?void 0:_a.width)?_b:GRID_STEP*this._text.length}get unrotatedHeight(){const metrics=this._cachedTextMetrics;return void 0===metrics?2*GRID_STEP:metrics.actualBoundingBoxAscent+metrics.actualBoundingBoxDescent}get text(){return this._text}doRecalcValue(){}get drawZIndex(){return DrawZIndex.Overlay}doDraw(g,ctx){if(g.font=this._font,g.lineWidth=3,ctx.isMouseOver){void 0===this._cachedTextMetrics&&(this._cachedTextMetrics=g.measureText(this._text));const width=this.unrotatedWidth,height=this.unrotatedHeight;g.strokeStyle=ctx.borderColor,g.beginPath(),g.rect(this.posX-width/2,this.posY-height/2,width,height),g.stroke()}g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,this._text,this.posX,this.posY)}doSetText(text){this._text=text,this._cachedTextMetrics=void 0,this.requestRedraw({why:"text changed",invalidateMask:!0})}doSetFont(font){this._font=font,this._cachedTextMetrics=void 0,this.requestRedraw({why:"font changed",invalidateMask:!0})}makeComponentSpecificContextMenuItems(){const s=S.Components.Label.contextMenu;return[["mid",MenuData.item("pen",s.ChangeText,this.runSetTextDialog.bind(this),"↩︎")],["mid",MenuData.item("font",s.Font,(()=>{this.runSetFontDialog(this._font,LabelDef.aults.font,this.doSetFont.bind(this))}))]]}runSetTextDialog(){const promptReturnValue=window.prompt(S.Components.Label.contextMenu.ChangeTextPrompt,this._text);if(null!==promptReturnValue){const newText=0===promptReturnValue.length?LabelDef.aults.text:promptReturnValue;return this.doSetText(newText),InteractionResult.SimpleChange}return InteractionResult.NoChange}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetTextDialog()}pointerDoubleClicked(e){const superChange=super.pointerDoubleClicked(e);return superChange.isChange?superChange:this.runSetTextDialog()}};__name(Label,"Label"),LabelDef.impl=Label;var LatchSRDef=defineComponent("latch-sr",{idPrefix:"latch",...FlipflopOrLatchDef,makeNodes:()=>{const base=FlipflopOrLatchDef.makeNodes(),s=S.Components.Generic;return{ins:{S:[-4,-2,"w",s.InputSetDesc,{prefersSpike:!0}],R:[-4,2,"w",s.InputResetDesc,{prefersSpike:!0}]},outs:base.outs}}}),LatchSR=class extends FlipflopOrLatch{constructor(parent,saved){super(parent,LatchSRDef,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.LatchSR.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValue(){const s=this.inputs.S.value,r=this.inputs.R.value;if(this._isInInvalidState=!1,!0===s)return!0===r?(this._isInInvalidState=!0,[!1,!1]):[!0,!1];if(!0===r)return[!1,!0];const q=this.outputs.Q.value;return[q,LogicValue.invert(q)]}makeComponentSpecificContextMenuItems(){const icon=this._showContent?"check":"none";return[["mid",MenuData.item(icon,S.Components.Generic.contextMenu.ShowContent,(()=>{this.doSetShowContent(!this._showContent)}))],...this.makeForceOutputsContextMenuItem(!0)]}};__name(LatchSR,"LatchSR"),LatchSRDef.impl=LatchSR;var t28=__toESM(require_lib()),MuxDef=defineParametrizedComponent("mux",!0,!0,{variantName:_ref89=>{let{from:from,to:to,bottom:bottom2}=_ref89;return"mux-".concat(from,"to").concat(to).concat(bottom2?"b":"")},idPrefix:"mux",button:{imgWidth:50},repr:{from:typeOrUndefined(t28.number),to:typeOrUndefined(t28.number),bottom:typeOrUndefined(t28.boolean),showWiring:typeOrUndefined(t28.boolean)},valueDefaults:{showWiring:!0},params:{to:param(2,[1,2,4,8,16]),from:param(4),bottom:paramBool()},validateParams:_ref90=>{let{from:from,to:to,bottom:bottom2}=_ref90;const numFrom=Math.min(16*to,Math.max(2*to,from)),numGroups=Math.ceil(numFrom/to);return{numFrom:numFrom,numTo:to,numGroups:numGroups,numSel:Math.ceil(Math.log2(numGroups)),controlPinsAtBottom:bottom2}},size:_ref91=>{let{numFrom:numFrom,numTo:numTo,numGroups:numGroups,numSel:numSel}=_ref91;return{gridWidth:2*numSel,gridHeight:1+(useCompact(1===numTo?numFrom:numTo)?1:2)*(numFrom+(numGroups-1)*(numTo>1?1:0))}},makeNodes:_ref92=>{let{numTo:numTo,numGroups:numGroups,numSel:numSel,controlPinsAtBottom:controlPinsAtBottom}=_ref92;const outX=1+numSel,groupOfInputs=groupVerticalMulti("w",-outX,0,numGroups,numTo),firstInputY=groupOfInputs[0][0][1],lastGroup=groupOfInputs[groupOfInputs.length-1],lastInputY=lastGroup[lastGroup.length-1][1];return{ins:{I:groupOfInputs,S:groupHorizontal(controlPinsAtBottom?"s":"n",0,controlPinsAtBottom?lastInputY+2:firstInputY-2,numSel,void 0,{leadLength:35})},outs:{Z:groupVertical("e",outX,0,numTo)}}},initialValue:(saved,_ref93)=>{let{numTo:numTo}=_ref93;return ArrayFillWith(!1,numTo)}}),Mux=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a;super(parent,MuxDef.with(params),saved),this.numFrom=params.numFrom,this.numTo=params.numTo,this.numGroups=params.numGroups,this.numSel=params.numSel,this.controlPinsAtBottom=params.controlPinsAtBottom,this._showWiring=null!=(_a=null==saved?void 0:saved.showWiring)?_a:MuxDef.aults.showWiring}toJSON(){return{...super.toJSONBase(),from:this.numFrom,to:this.numTo,bottom:this.controlPinsAtBottom===MuxDef.aults.bottom?void 0:this.controlPinsAtBottom,showWiring:this._showWiring!==MuxDef.aults.showWiring?this._showWiring:void 0}}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.Mux.tooltip.expand({from:this.numFrom,to:this.numTo}))))}doRecalcValue(){const sel=displayValuesFromArray(this.inputValues(this.inputs.S),!1)[1];return isUnknown(sel)?ArrayFillWith(Unknown,this.numTo):this.inputValues(this.inputs.I[sel])}propagateValue(newValues){this.outputValues(this.outputs.Z,newValues)}doDraw(g,ctx){const{top:top2,left:left2,bottom:bottom2,right:right2}=this.bounds(),dy=(right2-left2)/3;for(const inputGroup of this.inputs.I)for(const input2 of inputGroup)drawWireLineToComponent(g,input2);for(const sel of this.inputs.S)drawWireLineToComponent(g,sel);for(const output of this.outputs.Z)drawWireLineToComponent(g,output);g.fillStyle=COLOR_BACKGROUND;const outline=g.createPath();if(outline.moveTo(left2,top2),outline.lineTo(right2,top2+dy),outline.lineTo(right2,bottom2-dy),outline.lineTo(left2,bottom2),outline.closePath(),g.fill(outline),this._showWiring){const sel=displayValuesFromArray(this.inputValues(this.inputs.S),!1)[1];if(!isUnknown(sel)){const neutral=this.parent.editor.options.hideWireColors,selectedInputs=this.inputs.I[sel],anchorDiffX=(right2-left2)/3,wireStyle=this.parent.editor.options.wireStyle,wireStyleBezier=wireStyle===WireStyles.bezier||wireStyle===WireStyles.auto,timeFraction=ctx.drawParams.drawTimeAnimationFraction;for(let i2=0;i2<selectedInputs.length;i2++){this.parent.editor.options.wireStyle,g.beginPath();const fromY=selectedInputs[i2].posYInParentTransform,toNode=this.outputs.Z[i2],toY=toNode.posYInParentTransform;g.moveTo(left2+1,fromY),wireStyleBezier?g.bezierCurveTo(left2+anchorDiffX,fromY,right2-anchorDiffX,toY,right2-1,toY):(g.lineTo(left2+3,fromY),g.lineTo(right2-3,toY),g.lineTo(right2-1,toY)),strokeWireOutlineAndSingleValue(g,selectedInputs[i2].value,toNode.color,neutral,timeFraction)}}}g.lineWidth=3,g.strokeStyle=ctx.borderColor,g.stroke(outline)}doSetShowWiring(showWiring){this._showWiring=showWiring,this.requestRedraw({why:"show wiring changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.MuxDemux.contextMenu,icon=this._showWiring?"check":"none",toggleShowWiringItem=MenuData.item(icon,s.ShowWiring,(()=>{this.doSetShowWiring(!this._showWiring)}));return[this.makeChangeParamsContextMenuItem("outputs",s.ParamNumTo,this.numTo,"to"),this.makeChangeParamsContextMenuItem("inputs",s.ParamNumFrom,this.numFrom,"from",[2,4,8,16].map((x=>x*this.numTo))),["mid",MenuData.sep()],this.makeChangeBooleanParamsContextMenuItem(1===this.numSel?S.Components.Generic.contextMenu.ParamControlBitAtBottom:S.Components.Generic.contextMenu.ParamControlBitsAtBottom,this.controlPinsAtBottom,"bottom"),["mid",toggleShowWiringItem],...this.makeForceOutputsContextMenuItem(!0)]}};__name(Mux,"Mux"),MuxDef.impl=Mux;var t30=__toESM(require_lib()),import_file_saver2=__toESM(require_FileSaver_min()),t29=__toESM(require_lib()),ROMRAMDef={button:{imgWidth:50},repr:{bits:typeOrUndefined(t29.number),lines:typeOrUndefined(t29.number),showContent:typeOrUndefined(t29.boolean),displayRadix:typeOrUndefined(t29.number),content:typeOrUndefined(t29.union([t29.string,t29.array(t29.string)]))},valueDefaults:{showContent:!0,displayRadix:void 0},params:{bits:param(4,[4,8,16,24,32]),lines:param(16,[4,8,16,32,64,128,256,512,1024,2048])},validateParams:_ref94=>{let{bits:bits,lines:lines}=_ref94;const numAddressBits=Math.ceil(Math.log2(lines));return{numDataBits:bits,numAddressBits:numAddressBits,numWords:Math.pow(2,numAddressBits)}},size:_ref95=>{let{numWords:numWords,numDataBits:numDataBits}=_ref95;return{gridWidth:11,gridHeight:Math.max(numWords<=16?16:22,numDataBits+4)}},makeNodes:_ref96=>{let{numDataBits:numDataBits,numAddressBits:numAddressBits,gridHeight:gridHeight}=_ref96;return{ins:{Addr:groupHorizontal("n",0,-Math.ceil((gridHeight+1)/2),numAddressBits)},outs:{Q:groupVertical("e",7,0,numDataBits)}}},initialValue:(saved,_ref97)=>{let{numDataBits:numDataBits,numWords:numWords}=_ref97;if(void 0===saved||void 0===saved.content)return ROMRAMBase.defaultValue(numWords,numDataBits);const mem=ROMRAMBase.contentsFromString(saved.content,numDataBits,numWords);return{mem:mem,out:[...mem[0]]}}},ROMRAMBase=class extends ParametrizedComponentBase{constructor(parent,SubclassDef,params,saved){var _a,_b;super(parent,SubclassDef.with(params),saved),this.numDataBits=params.numDataBits,this.numAddressBits=params.numAddressBits,this.numWords=params.numWords,this._showContent=null!=(_a=null==saved?void 0:saved.showContent)?_a:!!this.canShowContent()&&RAMDef.aults.showContent,this._displayRadix=null!=(_b=null==saved?void 0:saved.displayRadix)?_b:RAMDef.aults.displayRadix}static defaultValue(numWords,numDataBits){return ROMRAMBase.valueFilledWith(!1,numWords,numDataBits)}static valueFilledWith(v,numWords,numDataBits){const mem=new Array(numWords);for(let i2=0;i2<numWords;i2++)mem[i2]=ArrayFillWith(v,numDataBits);return{mem:mem,out:ArrayFillWith(v,numDataBits)}}static contentsFromString(stringRep,numDataBits,numWords){const splitContent=isArray(stringRep)?stringRep:stringRep.split(/\s+/),mem=new Array(numWords);for(let i2=0;i2<numWords;i2++){const row=i2>=splitContent.length?ArrayFillWith(!1,numDataBits):valuesFromBinaryOrHexRepr(splitContent[i2],numDataBits);mem[i2]=row}return mem}toJSONBase(){return{...super.toJSONBase(),bits:this.numDataBits===RAMDef.aults.bits?void 0:this.numDataBits,lines:this.numWords===RAMDef.aults.lines?void 0:this.numWords,showContent:this.canShowContent()&&this._showContent!==RAMDef.aults.showContent?this._showContent:void 0,displayRadix:this._displayRadix!==RAMDef.aults.displayRadix?this._displayRadix:void 0,content:this.contentRepr(" ",!0)}}contentRepr(delim,trimEnd){const cells=[],useHex=this.numDataBits>=8,hexWidth=Math.ceil(this.numDataBits/4);for(let addr=0;addr<this.numWords;addr++){const word=this.value.mem[addr],wordRepr=useHex&&allBooleans(word)?hexStringRepr(word,hexWidth):binaryStringRepr(word);cells.push(wordRepr)}if(trimEnd){let numToSkip=0;for(let addr=this.numWords-1;addr>=0&&isAllZeros(cells[addr]);addr--)numToSkip++;numToSkip>0&&cells.splice(this.numWords-numToSkip,numToSkip)}return 0===cells.length?void 0:cells.join(delim)}currentAddress(){const addrBits=this.inputValues(this.inputs.Addr),[__,addr]=displayValuesFromArray(addrBits,!1);return addr}propagateValue(newValue){this.outputValues(this.outputs.Q,newValue.out)}canShowContent(){return this.numWords<=64&&this.numDataBits<=16}doSetShowContent(showContent){this._showContent=showContent,this.requestRedraw({why:"show content changed"})}doDraw(g,ctx){this.doDrawDefault(g,ctx,((ctx2,_ref98)=>{let{width:width,height:height}=_ref98;const mem=this.value.mem,addr=this.currentAddress();let contentBottom,labelCenter;if(this._showContent&&this.canShowContent()&&!this.parent.editor.options.hideMemoryContent){const isVertical=Orientation.isVertical(this.orient),canUseTwoCols=isVertical,addressedContentHeight=void 0!==this._displayRadix?12:0,contentCenterY=this.posY-addressedContentHeight/2,[availWidth,availHeight]=isVertical?[height-66,width-30-addressedContentHeight]:[width-42,height-30-addressedContentHeight],arrowWidth=10;let useTwoCols=!1,cellHeight=Math.floor(2*(availHeight-addressedContentHeight)/this.numWords)/2;if(cellHeight<=2&&canUseTwoCols&&(useTwoCols=!0,cellHeight=Math.floor(4*(availHeight-addressedContentHeight)/this.numWords)/2),useTwoCols){const cellWidth=Math.floor(2*(availWidth/2-2*arrowWidth)/this.numDataBits)/2;labelCenter=this.posX,contentBottom=drawMemoryCells(g,mem,this.numDataBits,addr,0,this.numWords/2,this.posX+2-38,contentCenterY,cellWidth,cellHeight),drawMemoryCells(g,mem,this.numDataBits,addr,this.numWords/2,this.numWords,this.posX+2+38,contentCenterY,cellWidth,cellHeight)}else{const cellWidth=Math.floor(2*(availWidth-arrowWidth)/this.numDataBits)/2;labelCenter=this.posX+3,contentBottom=drawMemoryCells(g,mem,this.numDataBits,addr,0,this.numWords,labelCenter,contentCenterY,cellWidth,cellHeight)}}else{g.font="bold 18px sans-serif",g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,this.moduleName,this.posX,this.posY-6),g.font="11px sans-serif";const numWordsStr=this.numWords>=1024?"".concat(this.numWords/1024,"k"):this.numWords.toString();fillTextVAlign(g,TextVAlign_middle,"".concat(numWordsStr," × ").concat(this.numDataBits," bits"),this.posX,this.posY+12),labelCenter=this.posX,contentBottom=this.posY+25}if(void 0!==this._displayRadix){const repr=formatWithRadix(isUnknown(addr)?Unknown:displayValuesFromArray(mem[addr],!1)[1],this._displayRadix,this.numDataBits,!0);g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_top,"".concat(repr),labelCenter,contentBottom+3)}}))}doSetDisplayRadix(additionalReprRadix){this._displayRadix=additionalReprRadix,this.requestRedraw({why:"additional display radix changed"})}doSetMem(mem){const addr=this.currentAddress(),out=isUnknown(addr)?ArrayFillWith(Unknown,this.numDataBits):mem[addr];this.doSetValue({mem:mem,out:out},!0)}makeComponentSpecificContextMenuItems(){const s=S.Components.RAM.contextMenu,sg=S.Components.Generic.contextMenu,ss=S.Components.Display.contextMenu,makeItemShowRadix=__name(((radix,desc)=>{const icon2=this._displayRadix===radix?"check":"none";return MenuData.item(icon2,desc,(()=>this.doSetDisplayRadix(radix)))}),"makeItemShowRadix"),editContentItem=["mid",MenuData.item("memcontent",s.EditContent,(()=>{const current=this.contentRepr(" ",!1),promptReturnValue=window.prompt(s.EditContentPrompt,current);null!==promptReturnValue&&this.doSetMem(RAM.contentsFromString(promptReturnValue,this.numDataBits,this.numWords))}))],saveContentItem=["mid",MenuData.item("download",s.SaveContent,(()=>{var _a;const blob=new Blob([this.contentRepr("\n",!1)],{type:"text/plain"}),filename=this.parent.editor.documentDisplayName+"."+(null!=(_a=this.ref)?_a:this.moduleName.toLowerCase())+"-content.txt";(0,import_file_saver2.saveAs)(blob,filename)}))],loadContentItem=["mid",MenuData.item("open",s.LoadContent,(()=>{this.parent.editor.runFileChooser("text/plain",(async file=>{const content=await file.text();this.doSetMem(RAM.contentsFromString(content,this.numDataBits,this.numWords))}))}))],swapROMRAMItem=["mid",MenuData.item("replace",s.SwapROMRAM,(()=>{const isROM=this instanceof ROM,repr=this.toNodelessJSON();repr.type=isROM?"ram":"rom";const newComp=(isROM?RAMDef:ROMDef).makeFromJSON(this.parent,repr);return void 0===newComp?(console.warn("Could not swap ROM/RAM from repr:",repr),InteractionResult.NoChange):(this.replaceWithComponent(newComp),InteractionResult.SimpleChange)}))],additionalDisplayItems=["mid",MenuData.submenu("eye",s.SelectedDataDisplay,[makeItemShowRadix(void 0,ss.DisplayNone),MenuData.sep(),makeItemShowRadix(2,ss.DisplayAsBinary),makeItemShowRadix(16,ss.DisplayAsHexadecimal),makeItemShowRadix(10,ss.DisplayAsDecimal),makeItemShowRadix(-10,ss.DisplayAsSignedDecimal),makeItemShowRadix(8,ss.DisplayAsOctal)])],icon=this._showContent?"check":"none",toggleShowContentItems=this.canShowContent()?[["mid",MenuData.item(icon,sg.ShowContent,(()=>this.doSetShowContent(!this._showContent)))]]:[];return[...this.makeSpecificROMRAMItems(),additionalDisplayItems,...toggleShowContentItems,["mid",MenuData.sep()],editContentItem,saveContentItem,loadContentItem,["mid",MenuData.sep()],swapROMRAMItem,["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("memlines",sg.ParamNumWords,this.numWords,"lines"),this.makeChangeParamsContextMenuItem("outputs",S.Components.Generic.contextMenu.ParamNumBits,this.numDataBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}makeSpecificROMRAMItems(){return[]}};function drawMemoryCells(g,mem,numDataBits,addr,start2,end2,centerX,centerY,cellWidth,cellHeight){const numCellsToDraw=end2-start2,contentTop=centerY-numCellsToDraw/2*cellHeight,contentLeft=centerX-numDataBits/2*cellWidth,contentRight=contentLeft+numDataBits*cellWidth,contentBottom=contentTop+numCellsToDraw*cellHeight;g.fillStyle=COLOR_EMPTY,g.fillRect(contentLeft,contentTop,contentRight-contentLeft,contentBottom-contentTop);for(let i2=start2;i2<end2;i2++)for(let j=0;j<numDataBits;j++){const v=mem[i2][numDataBits-j-1];!1!==v&&(g.fillStyle=colorForLogicValue(v),g.fillRect(contentLeft+j*cellWidth,contentTop+i2*cellHeight,cellWidth,cellHeight))}g.strokeStyle=COLOR_COMPONENT_BORDER,g.lineWidth=.5;for(let i2=1;i2<numCellsToDraw;i2++){const y=contentTop+i2*cellHeight;strokeSingleLine(g,contentLeft,y,contentRight,y)}for(let j=1;j<numDataBits;j++){const x=contentLeft+j*cellWidth;strokeSingleLine(g,x,contentTop,x,contentBottom)}if(g.lineWidth=2,g.strokeRect(contentLeft-1,contentTop-1,contentRight-contentLeft+2,contentBottom-contentTop+2),!isUnknown(addr)&&addr>=start2&&addr<end2){const arrowY=contentTop+(addr-start2)*cellHeight+cellHeight/2,arrowRight=contentLeft-3,arrowWidth=8,arrowHalfHeight=3;g.beginPath(),g.moveTo(arrowRight,arrowY),g.lineTo(arrowRight-arrowWidth,arrowY+arrowHalfHeight),g.lineTo(arrowRight-arrowWidth+2,arrowY),g.lineTo(arrowRight-arrowWidth,arrowY-arrowHalfHeight),g.closePath(),g.fillStyle=COLOR_COMPONENT_BORDER,g.fill()}return contentBottom}__name(ROMRAMBase,"ROMRAMBase"),__name(drawMemoryCells,"drawMemoryCells");var ROMDef=defineParametrizedComponent("rom",!0,!0,{variantName:_ref99=>{let{bits:bits,lines:lines}=_ref99;return"rom-".concat(lines,"x").concat(bits)},idPrefix:"rom",...ROMRAMDef}),ROM=class extends ROMRAMBase{constructor(parent,params,saved){super(parent,ROMDef,params,saved)}toJSON(){return super.toJSONBase()}get moduleName(){return"ROM"}doRecalcValue(){const{mem:mem}=this.value,addr=this.currentAddress();return{mem:mem,out:isUnknown(addr)?ArrayFillWith(Unknown,this.numDataBits):mem[addr]}}makeTooltip(){const s=S.Components.ROM.tooltip;return tooltipContent(s.title,mods(div(s.desc.expand({numWords:this.numWords,numDataBits:this.numDataBits}))))}};__name(ROM,"ROM"),ROMDef.impl=ROM;var RAMDef=defineParametrizedComponent("ram",!0,!0,{variantName:_ref100=>{let{bits:bits,lines:lines}=_ref100;return"ram-".concat(lines,"x").concat(bits)},idPrefix:"ram",...ROMRAMDef,repr:{...ROMRAMDef.repr,trigger:typeOrUndefined(t30.keyof(EdgeTrigger))},valueDefaults:{...ROMRAMDef.valueDefaults,trigger:EdgeTrigger.rising},makeNodes:(params,defaults)=>{const base=ROMRAMDef.makeNodes(params,defaults),{numDataBits:numDataBits,gridHeight:gridHeight}=params,bottomOffset=Math.ceil((gridHeight+1)/2),clockYOffset=bottomOffset-2,s=S.Components.Generic;return{ins:{Clock:[-7,clockYOffset,"w",s.InputClockDesc,{isClock:!0}],WE:[-2,bottomOffset,"s",s.InputWriteEnableDesc],Clr:[2,bottomOffset,"s",s.InputClearDesc,{prefersSpike:!0}],D:groupVertical("w",-7,0,numDataBits),Addr:base.ins.Addr},outs:base.outs}}}),RAM=class extends ROMRAMBase{constructor(parent,params,saved){var _a;super(parent,RAMDef,params,saved),this._trigger=RAMDef.aults.trigger,this._lastClock=Unknown,this._trigger=null!=(_a=null==saved?void 0:saved.trigger)?_a:RAMDef.aults.trigger}toJSON(){return{...super.toJSONBase(),trigger:this._trigger!==RAMDef.aults.trigger?this._trigger:void 0}}get moduleName(){return"RAM"}get trigger(){return this._trigger}doSetTrigger(trigger){this._trigger=trigger,this.requestRedraw({why:"trigger changed",invalidateTests:!0})}doRecalcValue(){const clear=this.inputs.Clr.value,numWords=this.numWords;if(!0===clear)return RAM.valueFilledWith(!1,numWords,this.numDataBits);const addr=this.currentAddress(),prevClock=this._lastClock,clock=this._lastClock=this.inputs.Clock.value,oldState=this.value;if(!0!==this.inputs.WE.value||!Flipflop.isClockTrigger(this.trigger,prevClock,clock)){const out=isUnknown(addr)?ArrayFillWith(Unknown,this.numDataBits):oldState.mem[addr];return{mem:oldState.mem,out:out}}if(isUnknown(addr))return RAM.valueFilledWith(Unknown,numWords,this.numDataBits);const newData=this.inputValues(this.inputs.D).map(LogicValue.filterHighZ),newState=new Array(numWords);for(let i2=0;i2<numWords;i2++)newState[i2]=i2===addr?newData:oldState.mem[i2];return{mem:newState,out:newData}}makeTooltip(){const s=S.Components.RAM.tooltip;return tooltipContent(s.title,mods(div(s.desc.expand({numWords:this.numWords,numDataBits:this.numDataBits}))))}override(){return[...makeTriggerItems(this._trigger,this.doSetTrigger.bind(this)),["mid",MenuData.sep()]]}};__name(RAM,"RAM"),RAMDef.impl=RAM;var t32=__toESM(require_lib()),t31=__toESM(require_lib()),RegisterBaseDef={button:{imgWidth:50},repr:{bits:typeOrUndefined(t31.number),showContent:typeOrUndefined(t31.boolean),trigger:typeOrUndefined(t31.keyof(EdgeTrigger)),content:typeOrUndefined(t31.string)},valueDefaults:{showContent:!0,trigger:EdgeTrigger.rising},params:{bits:param(4,[2,4,8,16])},validateParams:_ref101=>{let{bits:bits}=_ref101;return{numBits:bits}},size:_ref102=>{let{numBits:numBits}=_ref102;return{gridWidth:7,gridHeight:2===numBits?11:Math.max(15,5+numBits)}},makeNodes:_ref103=>{let{numBits:numBits,gridHeight:gridHeight}=_ref103;const bottomOffset=(gridHeight+1)/2,clockYOffset=bottomOffset-2,topOffset=-bottomOffset,s=S.Components.Generic;return{ins:{Clock:[-5,clockYOffset,"w",s.InputClockDesc,{isClock:!0}],Pre:[0,topOffset,"n",s.InputPresetDesc,{prefersSpike:!0}],Clr:[0,bottomOffset,"s",s.InputClearDesc,{prefersSpike:!0}]},outs:{Q:groupVertical("e",5,0,numBits)}}},initialValue:(saved,_ref104)=>{let content,{numBits:numBits}=_ref104;return void 0===saved||void 0===(content=saved.content)?ArrayFillWith(!1,numBits):valuesFromBinaryOrHexRepr(content,numBits)}},RegisterBase=class extends ParametrizedComponentBase{constructor(parent,SubclassDef,params,saved){var _a,_b;super(parent,SubclassDef.with(params),saved),this._isInInvalidState=!1,this._lastClock=Unknown,this.numBits=params.numBits,this._showContent=null!=(_a=null==saved?void 0:saved.showContent)?_a:RegisterDef.aults.showContent,this._trigger=null!=(_b=null==saved?void 0:saved.trigger)?_b:RegisterDef.aults.trigger}toJSONBase(){return{bits:this.numBits===RegisterDef.aults.bits?void 0:this.numBits,...super.toJSONBase(),showContent:this._showContent!==RegisterDef.aults.showContent?this._showContent:void 0,trigger:this._trigger!==RegisterDef.aults.trigger?this._trigger:void 0,content:this.contentRepr(!0)}}contentRepr(undefinedIfTrivial){const content=this.value,hexWidth=Math.ceil(this.numBits/4),repr=allBooleans(content)?hexStringRepr(content,hexWidth):binaryStringRepr(content);return undefinedIfTrivial&&isAllZeros(repr)?void 0:repr}get trigger(){return this._trigger}doRecalcValue(){const prevClock=this._lastClock,clock=this._lastClock=this.inputs.Clock.value,{isInInvalidState:isInInvalidState,newState:newState}=Flipflop.doRecalcValueForSyncComponent(this,prevClock,clock,this.inputs.Pre.value,this.inputs.Clr.value);return this._isInInvalidState=isInInvalidState,newState}makeInvalidState(){return ArrayFillWith(!1,this.numBits)}makeStateFromMainValue(val){return ArrayFillWith(val,this.numBits)}propagateValue(newValue){this.outputValues(this.outputs.Q,newValue)}doSetShowContent(showContent){this._showContent=showContent,this.requestRedraw({why:"show content changed"})}doSetTrigger(trigger){this._trigger=trigger,this.requestRedraw({why:"trigger changed",invalidateTests:!0})}doDraw(g,ctx){this.doDrawDefault(g,ctx,(ctx2=>{this._showContent&&!this.parent.editor.options.hideMemoryContent?RegisterBase.drawStoredValues(g,ctx2,this.outputs.Q,this.posX,Orientation.isVertical(this.orient)):this.doDrawGenericCaption(g)}))}static drawStoredValues(g,ctx,outputs,posX,swapHeightWidth){const cellHeight=useCompact(outputs.length)?GRID_STEP:2*GRID_STEP;for(const output of outputs)FlipflopOrLatch.drawStoredValue(g,output.value,...ctx.rotatePoint(posX,output.posYInParentTransform),cellHeight,swapHeightWidth)}makeComponentSpecificContextMenuItems(){const s=S.Components.Generic.contextMenu,icon=this._showContent?"check":"none",toggleShowContentItem=MenuData.item(icon,s.ShowContent,(()=>this.doSetShowContent(!this._showContent)));return[this.makeChangeParamsContextMenuItem("outputs",s.ParamNumBits,this.numBits,"bits"),...this.makeRegisterSpecificContextMenuItems(),["mid",MenuData.sep()],...makeTriggerItems(this._trigger,this.doSetTrigger.bind(this)),["mid",MenuData.sep()],["mid",toggleShowContentItem],...this.makeForceOutputsContextMenuItem(!0)]}makeRegisterSpecificContextMenuItems(){return[]}};__name(RegisterBase,"RegisterBase");var RegisterDef=defineParametrizedComponent("reg",!0,!0,{variantName:_ref105=>{let{bits:bits}=_ref105;return"reg-".concat(bits)},idPrefix:"reg",...RegisterBaseDef,repr:{...RegisterBaseDef.repr,inc:typeOrUndefined(t31.boolean),saturating:typeOrUndefined(t31.boolean)},valueDefaults:{...RegisterBaseDef.valueDefaults,saturating:!1},params:{bits:RegisterBaseDef.params.bits,inc:paramBool()},validateParams:_ref106=>{let{bits:bits,inc:inc}=_ref106;return{numBits:bits,hasIncDec:inc}},makeNodes:(params,defaults)=>{const base=RegisterBaseDef.makeNodes(params,defaults),baseClear=base.ins.Clr,bottomOffset=base.ins.Clr[1];return{ins:{...base.ins,D:groupVertical("w",-5,0,params.numBits),...params.hasIncDec?{Clr:[2,bottomOffset,"s",baseClear[3],baseClear[4]],Inc:[-2,bottomOffset,"s"],Dec:[0,bottomOffset,"s"]}:{}},outs:base.outs}}}),Register=class extends RegisterBase{constructor(parent,params,saved){var _a;super(parent,RegisterDef,params,saved),this.hasIncDec=params.hasIncDec,this._saturating=this.hasIncDec&&(null!=(_a=null==saved?void 0:saved.saturating)?_a:RegisterDef.aults.saturating)}toJSON(){return{...this.toJSONBase(),inc:this.hasIncDec===RegisterDef.aults.inc?void 0:this.hasIncDec,saturating:this._saturating===RegisterDef.aults.saturating?void 0:this._saturating}}makeTooltip(){const s=S.Components.Register.tooltip;return tooltipContent(s.title,mods(div(s.desc.expand({numBits:this.numBits}))))}makeStateAfterClock(){var _a,_b,_c,_d;const inc=null!=(_b=null==(_a=this.inputs.Inc)?void 0:_a.value)&&_b,dec=null!=(_d=null==(_c=this.inputs.Dec)?void 0:_c.value)&&_d;if(isUnknown(inc)||isUnknown(dec)||isHighImpedance(inc)||isHighImpedance(dec))return ArrayFillWith(!1,this.numBits);if(inc||dec){if(inc&&dec)return this.value;const[__,val]=displayValuesFromArray(this.value,!1);if(isUnknown(val))return ArrayFillWith(Unknown,this.numBits);let newVal;if(inc){if(newVal=val+1,newVal>=2**this.numBits)return this._saturating?ArrayFillWith(!0,this.numBits):ArrayFillWith(!1,this.numBits)}else if(newVal=val-1,newVal<0)return this._saturating?ArrayFillWith(!1,this.numBits):ArrayFillWith(!0,this.numBits);return Counter.decimalToNBits(newVal,this.numBits)}return this.inputValues(this.inputs.D).map(LogicValue.filterHighZ)}doDrawGenericCaption(g){g.font="bold 15px sans-serif",g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"Reg.",this.posX,this.posY-8),g.font="11px sans-serif",fillTextVAlign(g,TextVAlign_middle,"".concat(this.numBits," bits"),this.posX,this.posY+10)}doSetSaturating(saturating){this._saturating=saturating,this.requestRedraw({why:"saturating changed",invalidateTests:!0})}makeRegisterSpecificContextMenuItems(){const s=S.Components.Register.contextMenu,toggleSaturatingItem=this.hasIncDec?[["mid",MenuData.item(this._saturating?"check":"none",s.Saturating,(()=>this.doSetSaturating(!this._saturating)))]]:[];return[this.makeChangeBooleanParamsContextMenuItem(s.ParamHasIncDec,this.hasIncDec,"inc"),...toggleSaturatingItem]}};__name(Register,"Register"),RegisterDef.impl=Register;var RandomDef=defineParametrizedComponent("rand",!0,!0,{variantName:_ref107=>{let{bits:bits}=_ref107;return"rand-".concat(bits)},idPrefix:"rand",button:{imgWidth:32},repr:{bits:typeOrUndefined(t32.number),prob1:typeOrUndefined(t32.number),showProb:typeOrUndefined(t32.boolean),trigger:typeOrUndefined(t32.keyof(EdgeTrigger)),name:ComponentNameRepr},valueDefaults:{prob1:.5,showProb:!1,trigger:EdgeTrigger.rising},params:{bits:param(1,[1,2,3,4,7,8,16])},validateParams:_ref108=>{let{bits:bits}=_ref108;return{numBits:bits}},size:_ref109=>{let{numBits:numBits}=_ref109;return{gridWidth:4,gridHeight:4+2*(useCompact(numBits)?numBits/2:numBits)}},makeNodes:_ref110=>{let{numBits:numBits,gridHeight:gridHeight}=_ref110;return{ins:{Clock:[-3,gridHeight/2-1,"w",S.Components.Generic.InputClockDesc,{isClock:!0}]},outs:{Out:groupVertical("e",3,0,numBits)}}},initialValue:(saved,_ref111)=>{let{numBits:numBits}=_ref111;return ArrayFillWith(!1,numBits)}}),Random=class extends ParametrizedComponentBase{constructor(parent,params,saved){var _a,_b,_c;super(parent,RandomDef.with(params),saved),this._lastClock=Unknown,this.numBits=params.numBits,this._prob1=void 0!==(null==saved?void 0:saved.prob1)?Math.max(0,Math.min(1,saved.prob1)):RandomDef.aults.prob1,this._showProb=null!=(_a=null==saved?void 0:saved.showProb)?_a:RandomDef.aults.showProb,this._trigger=null!=(_b=null==saved?void 0:saved.trigger)?_b:RandomDef.aults.trigger,this._name=null!=(_c=null==saved?void 0:saved.name)?_c:void 0}toJSON(){return{...super.toJSONBase(),bits:this.numBits===RandomDef.aults.bits?void 0:this.numBits,name:this._name,prob1:this._prob1!==RandomDef.aults.prob1?this._prob1:void 0,showProb:this._showProb!==RandomDef.aults.showProb?this._showProb:void 0,trigger:this._trigger!==RandomDef.aults.trigger?this._trigger:void 0}}get allowsForcedOutputs(){return!1}makeTooltip(){const s=S.Components.Random.tooltip;return tooltipContent(s.title,s.desc[0]+this._prob1+s.desc[1])}doRecalcValue(){const prevClock=this._lastClock,clock=this._lastClock=this.inputs.Clock.value;if(!Flipflop.isClockTrigger(this._trigger,prevClock,clock))return this.value;return ArrayFillUsing(__name((()=>Math.random()<this._prob1),"randBool"),this.numBits)}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}doDraw(g,ctx){const outputValues=this.value;this.doDrawDefault(g,ctx,{componentName:[this._name,!1,()=>displayValuesFromArray(outputValues,!1)[1]],skipLabels:!0,drawLabels:(ctx2,_ref112)=>{let{top:top2}=_ref112;if(1===this.numBits){const output=this.outputs.Out[0];FlipflopOrLatch.drawStoredValue(g,output.value,...ctx2.rotatePoint(this.posX,output.posYInParentTransform),26,!1)}else RegisterBase.drawStoredValues(g,ctx2,this.outputs.Out,this.posX,Orientation.isVertical(this.orient));if(this._showProb){const isVertical=Orientation.isVertical(this.orient);g.fillStyle=COLOR_COMPONENT_INNER_LABELS,g.font="9px sans-serif";const probTextParts=["P(1)","=",String(Math.round(100*this._prob1)/100).substring(1)];if(isVertical){let currentOffset=-10,offset2=Math.abs(currentOffset);"s"===this.orient&&(currentOffset=-currentOffset,offset2=-offset2);for(const part of probTextParts)drawLabel(ctx2,this.orient,part,"n",this.posX-currentOffset,top2-1,void 0),currentOffset+=offset2}else{const probText=probTextParts.join(" ");drawLabel(ctx2,this.orient,probText,"n",this.posX,top2,void 0)}}}})}doSetName(name2){this._name=name2,this.requestRedraw({why:"name changed"})}doSetShowProb(showProb){this._showProb=showProb,this.requestRedraw({why:"show probability changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.Random.contextMenu,icon=this._showProb?"check":"none";return[["mid",MenuData.item(icon,s.ShowProb,(()=>this.doSetShowProb(!this._showProb)))],["mid",MenuData.sep()],this.makeChangeParamsContextMenuItem("inputs",S.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),["mid",MenuData.sep()],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetNameDialog(this._name,this.doSetName.bind(this))}};__name(Random,"Random"),RandomDef.impl=Random;var t33=__toESM(require_lib()),RectangleColor={grey:"grey",red:"red",blue:"blue",yellow:"yellow",green:"green",turquoise:"turquoise"},CaptionPosition={n:"n",ne:"ne",e:"e",se:"se",s:"s",sw:"sw",w:"w",nw:"nw",c:"c"},RectangleDef=defineComponent("rect",{idPrefix:"rect",button:{imgWidth:32},repr:{w:t33.number,h:t33.number,color:typeOrUndefined(t33.keyof(RectangleColor)),strokeWidth:typeOrUndefined(t33.number),noFill:typeOrUndefined(t33.boolean),rounded:typeOrUndefined(t33.boolean),caption:typeOrUndefined(t33.string),captionPos:typeOrUndefined(t33.keyof(CaptionPosition)),captionInside:typeOrUndefined(t33.boolean),font:typeOrUndefined(t33.string)},valueDefaults:{width:10*GRID_STEP,height:10*GRID_STEP,color:RectangleColor.yellow,strokeWidth:2,noFill:!1,rounded:!1,caption:void 0,captionPos:CaptionPosition.n,captionInside:!1,font:"18px sans-serif"},size:{gridWidth:10,gridHeight:10},makeNodes:()=>({})}),Rectangle=class extends ComponentBase{constructor(parent,saved){var _a,_b,_c,_d,_e,_f,_g,_h,_i,_j;super(parent,RectangleDef,saved),this._w=null!=(_a=null==saved?void 0:saved.w)?_a:RectangleDef.aults.width,this._h=null!=(_b=null==saved?void 0:saved.h)?_b:RectangleDef.aults.height,this._color=null!=(_c=null==saved?void 0:saved.color)?_c:RectangleDef.aults.color,this._strokeWidth=null!=(_d=null==saved?void 0:saved.strokeWidth)?_d:RectangleDef.aults.strokeWidth,this._noFill=null!=(_e=null==saved?void 0:saved.noFill)?_e:RectangleDef.aults.noFill,this._rounded=null!=(_f=null==saved?void 0:saved.rounded)?_f:RectangleDef.aults.rounded,this._caption=null!=(_g=null==saved?void 0:saved.caption)?_g:RectangleDef.aults.caption,this._captionPos=null!=(_h=null==saved?void 0:saved.captionPos)?_h:RectangleDef.aults.captionPos,this._captionInside=null!=(_i=null==saved?void 0:saved.captionInside)?_i:RectangleDef.aults.captionInside,this._font=null!=(_j=null==saved?void 0:saved.font)?_j:RectangleDef.aults.font}toJSON(){return{...this.toJSONBase(),w:this._w,h:this._h,color:this._color,strokeWidth:this._strokeWidth,noFill:this._noFill===RectangleDef.aults.noFill?void 0:this._noFill,rounded:this._rounded===RectangleDef.aults.rounded?void 0:this._rounded,caption:this._caption===RectangleDef.aults.caption?void 0:this._caption,captionPos:this._captionPos===RectangleDef.aults.captionPos?void 0:this._captionPos,captionInside:this._captionInside===RectangleDef.aults.captionInside?void 0:this._captionInside,font:this._font===RectangleDef.aults.font?void 0:this._font}}canRotate(){return!1}get unrotatedWidth(){return this._w}get unrotatedHeight(){return this._h}doRecalcValue(){}get drawZIndex(){return DrawZIndex.Background}doDraw(g,ctx){const width=this._w,height=this._h,left2=this.posX-width/2,top2=this.posY-height/2;if(g.beginPath(),this._rounded){const r=3*this._strokeWidth;g.moveTo(left2+r,top2),g.lineTo(left2+width-r,top2),g.quadraticCurveTo(left2+width,top2,left2+width,top2+r),g.lineTo(left2+width,top2+height-r),g.quadraticCurveTo(left2+width,top2+height,left2+width-r,top2+height),g.lineTo(left2+r,top2+height),g.quadraticCurveTo(left2,top2+height,left2,top2+height-r),g.lineTo(left2,top2+r),g.quadraticCurveTo(left2,top2,left2+r,top2)}else g.rect(left2,top2,width,height);if(g.closePath(),this._noFill||(g.fillStyle=COLOR_RECTANGLE_BACKGROUND[this._color],g.fill()),void 0!==this._caption){g.fillStyle=COLOR_COMPONENT_BORDER,g.font=this._font;const metrics=g.measureText(this._caption),offsetV=(metrics.actualBoundingBoxAscent+metrics.actualBoundingBoxDescent+this._strokeWidth)/2+2,margin=2,offsetH=(metrics.width+this._strokeWidth)/2+margin,captionY=(()=>{switch(this._captionPos){case"c":case"w":case"e":return this.posY;case"n":case"nw":case"ne":return this.posY-this.height/2+(this._captionInside?1:-1)*offsetV;case"s":case"se":case"sw":return this.posY+this.height/2+(this._captionInside?-1:1)*offsetV}})(),captionX=(()=>{switch(this._captionPos){case"c":case"n":case"s":return this.posX;case"w":return this.posX-this.width/2+(this._captionInside?1:-1)*offsetH;case"nw":case"sw":return this.posX-this.width/2+offsetH-(this._captionInside?0:1)*(margin+this._strokeWidth);case"e":return this.posX+this.width/2+(this._captionInside?-1:1)*offsetH;case"ne":case"se":return this.posX+this.width/2-offsetH+(this._captionInside?0:1)*(margin+this._strokeWidth)}})();g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,this._caption,captionX,captionY)}ctx.isMouseOver?(g.lineWidth=Math.max(3,this._strokeWidth),g.strokeStyle=ctx.borderColor,g.stroke()):this._strokeWidth>0&&(g.lineWidth=this._strokeWidth,g.strokeStyle=COLOR_RECTANGLE_BORDER[this._color],g.stroke())}doSetColor(color){this._color=color,this.requestRedraw({why:"color changed"})}doSetStrokeWidth(strokeWidth){this._strokeWidth=strokeWidth,this.requestRedraw({why:"stroke width changed",invalidateMask:!0})}doSetCaption(caption){this._caption=caption,this.requestRedraw({why:"caption changed"})}doSetCaptionPos(captionPos){this._captionPos=captionPos,this.requestRedraw({why:"caption position changed"})}doSetFont(font){this._font=font,this.requestRedraw({why:"font changed"})}makeCurrentSizeString(){return"".concat(this._w," × ").concat(this._h)}makeComponentSpecificContextMenuItems(){const s=S.Components.Rectangle.contextMenu,currentSizeStr=this.makeCurrentSizeString(),setSizeItem=MenuData.item("dimensions",s.Size+" (".concat(currentSizeStr,")…"),(()=>this.runSetSizeDialog(currentSizeStr))),makeSetStrokeWidthItem=__name(((strokeWidth,desc)=>{const icon=this._strokeWidth===strokeWidth?"check":"none";return MenuData.item(icon,desc,(()=>this.doSetStrokeWidth(strokeWidth)))}),"makeSetStrokeWidthItem"),makeItemUseColor=__name(((desc,color)=>{const isCurrent=this._color===color,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>this.doSetColor(color);if(void 0!==color){const fillColorProp=this._noFill?"":"background-color: ".concat(COLOR_RECTANGLE_BACKGROUND[color],"; "),roundedProp=this._rounded?"border-radius: 4px; ":"",borderColor=COLOR_RECTANGLE_BORDER[color];return MenuData.item(icon,span(title(desc),style("display: inline-block; width: 140px; height: 18px; ".concat(fillColorProp).concat(roundedProp,"margin-right: 8px; border: 2px solid ").concat(borderColor))),action)}return MenuData.item(icon,desc,action)}),"makeItemUseColor"),toggleRoundedItem=MenuData.item(this._rounded?"check":"none",s.Rounded,(()=>{this._rounded=!this._rounded,this.requestRedraw({why:"rounded changed"})})),toggleNoFillItem=MenuData.item(this._noFill?"none":"check",s.WithBackgroundColor,(()=>{this._noFill=!this._noFill,this.requestRedraw({why:"nofill changed"})})),setCaptionItemName=void 0!==this._caption?s.ChangeTitle:s.SetTitle,setCaptionItem=MenuData.item("pen",setCaptionItemName,(()=>this.runSetCaptionDialog()),"↩︎"),makeItemSetPlacement=__name(((desc,placement)=>{const isCurrent=this._captionPos===placement,icon=isCurrent?"check":"none",action=isCurrent?()=>{}:()=>this.doSetCaptionPos(placement);return MenuData.item(icon,desc,action)}),"makeItemSetPlacement"),toggleCaptionInsideItems="c"===this._captionPos?[]:[MenuData.item(this._captionInside?"check":"none",s.InsideFrame,(()=>{this._captionInside=!this._captionInside,this.requestRedraw({why:"caption inside changed"})})),MenuData.sep()],setFontItem=MenuData.item("font",s.Font,(()=>{this.runSetFontDialog(this._font,RectangleDef.aults.font,this.doSetFont.bind(this))}));return[["mid",setSizeItem],["mid",MenuData.submenu("palette",s.Color,[toggleNoFillItem,MenuData.sep(),makeItemUseColor(s.ColorYellow,RectangleColor.yellow),makeItemUseColor(s.ColorRed,RectangleColor.red),makeItemUseColor(s.ColorGreen,RectangleColor.green),makeItemUseColor(s.ColorBlue,RectangleColor.blue),makeItemUseColor(s.ColorTurquoise,RectangleColor.turquoise),makeItemUseColor(s.ColorGrey,RectangleColor.grey)])],["mid",MenuData.submenu("strokewidth",s.Border,[makeSetStrokeWidthItem(0,s.BorderNone),MenuData.sep(),makeSetStrokeWidthItem(1,s.Border1px),makeSetStrokeWidthItem(2,s.Border2px),makeSetStrokeWidthItem(3,s.Border3px),makeSetStrokeWidthItem(5,s.Border5px),makeSetStrokeWidthItem(10,s.Border10px)])],["mid",toggleRoundedItem],["mid",MenuData.sep()],["mid",setCaptionItem],["mid",setFontItem],["mid",MenuData.submenu("placement",s.TitlePlacement,[...toggleCaptionInsideItems,makeItemSetPlacement(s.PlacementTop,CaptionPosition.n),makeItemSetPlacement(s.PlacementTopLeft,CaptionPosition.nw),makeItemSetPlacement(s.PlacementTopRight,CaptionPosition.ne),makeItemSetPlacement(s.PlacementBottom,CaptionPosition.s),makeItemSetPlacement(s.PlacementBottomLeft,CaptionPosition.sw),makeItemSetPlacement(s.PlacementBottomRight,CaptionPosition.se),makeItemSetPlacement(s.PlacementLeft,CaptionPosition.w),makeItemSetPlacement(s.PlacementRight,CaptionPosition.e),makeItemSetPlacement(s.PlacementCenter,CaptionPosition.c)])]]}runSetSizeDialog(currentSizeStr){var _a,_b;const promptReturnValue=window.prompt(S.Components.Rectangle.contextMenu.SizePrompt,currentSizeStr);if(null!==promptReturnValue){let match;if(null!==(match=/^(?<w>\d*)((\s+|( *[×x,;] *))(?<h>\d*))?$/.exec(promptReturnValue))){const parse=__name(((s,dflt)=>{if(void 0===s)return dflt;const n=parseInt(s);return isNaN(n)||n<=0?dflt:n}),"parse"),w=parse(null==(_a=match.groups)?void 0:_a.w,this._w),h=parse(null==(_b=match.groups)?void 0:_b.h,this._h);this.doSetDimensions(w,h)}}}doSetDimensions(w,h){this._w=w,this._h=h,this.requestRedraw({why:"size changed",invalidateMask:!0})}wrapContents(selectedComps){var _a;if(0===selectedComps.size)return;let left2=Number.POSITIVE_INFINITY,top2=Number.POSITIVE_INFINITY,right2=Number.NEGATIVE_INFINITY,bottom2=Number.NEGATIVE_INFINITY;for(const comp of selectedComps)comp instanceof DrawableWithPosition&&(left2=Math.min(left2,comp.posX-comp.width/2),top2=Math.min(top2,comp.posY-comp.height/2),right2=Math.max(right2,comp.posX+comp.width/2),bottom2=Math.max(bottom2,comp.posY+comp.height/2));const tryX=(left2+right2)/2,tryY=(top2+bottom2)/2,[x,y]=null!=(_a=this.trySetPosition(tryX,tryY,!0))?_a:[tryX,tryY];left2=Math.floor((left2+Math.max(0,tryX-x))/GRID_STEP)*GRID_STEP,top2=Math.floor((top2+Math.max(0,tryY-y))/GRID_STEP)*GRID_STEP,right2=Math.ceil((right2+Math.max(0,x-tryX))/GRID_STEP)*GRID_STEP,bottom2=Math.ceil((bottom2+Math.max(0,y-tryY))/GRID_STEP)*GRID_STEP;const w=right2-left2+4*GRID_STEP,h=bottom2-top2+4*GRID_STEP;this.doSetDimensions(w,h)}runSetCaptionDialog(){const promptReturnValue=window.prompt(S.Components.Rectangle.contextMenu.SetTitlePrompt,this._caption);if(null!==promptReturnValue){const newCaption=0===promptReturnValue.length?void 0:promptReturnValue;this.doSetCaption(newCaption)}}pointerDoubleClicked(__e2){return this.runSetSizeDialog(this.makeCurrentSizeString()),InteractionResult.SimpleChange}keyDown(e){"Enter"!==e.key||e.altKey?super.keyDown(e):this.runSetCaptionDialog()}};__name(Rectangle,"Rectangle"),RectangleDef.impl=Rectangle;var t34=__toESM(require_lib()),import_json54=__toESM(require_dist()),ShiftDisplayDecoders_={raw:{decodeWidth:1,maxDisplayWidth:16,decode:v=>v.toString()},octal:{decodeWidth:3,maxDisplayWidth:16,decode:v=>v.toString()},hex:{decodeWidth:4,maxDisplayWidth:16,decode:v=>v.toString(16).toUpperCase()},ascii:{decodeWidth:7,maxDisplayWidth:12,decode:v=>DisplayAscii.numberToAscii(v)},ascii8:{decodeWidth:8,maxDisplayWidth:12,decode:v=>DisplayAscii.numberToAscii(127&v)},uint4:{decodeWidth:4,maxDisplayWidth:8,decode:v=>v.toString()},int4:{decodeWidth:4,maxDisplayWidth:8,decode:v=>(v>7?v-16:v).toString()},uint8:{decodeWidth:8,maxDisplayWidth:4,decode:v=>v.toString()},int8:{decodeWidth:8,maxDisplayWidth:4,decode:v=>(v>127?v-256:v).toString()},uint16:{decodeWidth:16,maxDisplayWidth:1,decode:v=>v.toString()},int16:{decodeWidth:16,maxDisplayWidth:1,decode:v=>(v>32767?v-65536:v).toString()}},ShiftDisplayDecoders=RichStringEnum.withProps()(ShiftDisplayDecoders_),ShiftDisplayDef=defineComponent("shift-display",{idPrefix:"shiftdisp",button:{imgWidth:50},repr:{state:typeOrUndefined(t34.string),decodeAs:typeOrUndefined(t34.keyof(ShiftDisplayDecoders_)),groupEvery:typeOrUndefined(t34.number),maxItems:typeOrUndefined(t34.number),trigger:typeOrUndefined(t34.keyof(EdgeTrigger))},valueDefaults:{decodeAs:"raw",trigger:EdgeTrigger.rising},size:{gridWidth:25,gridHeight:5},makeNodes:()=>{const s=S.Components.Generic;return{ins:{Clock:[-14,1,"w",s.InputClockDesc,{isClock:!0}],Clr:[-10,3,"s",s.InputClearDesc,{prefersSpike:!0}],D:[-14,-1,"w",s.InputDataDesc]}}},initialValue:saved=>{if(void 0===saved||void 0===saved.state)return{incoming:[],decoded:[]};const incoming=[];for(let i2=0;i2<saved.state.length;i2++){const c=saved.state.charAt(i2);"1"===c?incoming.push(!0):"0"===c?incoming.push(!1):incoming.push(Unknown)}return{incoming:incoming,decoded:[]}}}),ShiftDisplay=class extends ComponentBase{constructor(parent,saved){var _a,_b,_c,_d;super(parent,ShiftDisplayDef,saved),this._lastClock=Unknown,this._decodeAs=null!=(_a=null==saved?void 0:saved.decodeAs)?_a:ShiftDisplayDef.aults.decodeAs,this._groupEvery=null!=(_b=null==saved?void 0:saved.groupEvery)?_b:void 0,this._maxItems=null!=(_c=null==saved?void 0:saved.maxItems)?_c:void 0,this._trigger=null!=(_d=null==saved?void 0:saved.trigger)?_d:ShiftDisplayDef.aults.trigger,this.redecodeAll()}toJSON(){const stateArray=allBitsOf(this.value).map((b2=>toLogicValueRepr(b2)));return{...this.toJSONBase(),state:0===stateArray.length?void 0:stateArray.join(""),decodeAs:this._decodeAs!==ShiftDisplayDef.aults.decodeAs?this._decodeAs:void 0,groupEvery:this._groupEvery,maxItems:this._maxItems,trigger:this._trigger!==ShiftDisplayDef.aults.trigger?this._trigger:void 0}}get trigger(){return this._trigger}makeTooltip(){return tooltipContent(S.Components.ShiftDisplay.tooltip,mods(div(import_json54.default.stringify(this.value))))}doRecalcValue(){var _a;if(!0===this.inputs.Clr.value)return{incoming:[],decoded:[]};const prevClock=this._lastClock,clock=this._lastClock=this.inputs.Clock.value,oldValue=this.value;if(Flipflop.isClockTrigger(this._trigger,prevClock,clock)){const newBit=this.inputs.D.value,decoder=ShiftDisplayDecoders.props[this._decodeAs],maxItems=null!=(_a=this._maxItems)?_a:decoder.maxDisplayWidth;return ShiftDisplay.valueByAddingNewBit(newBit,oldValue,decoder,maxItems)}return oldValue}static valueByAddingNewBit(newBit,oldValue,decoder,maxItems){const newIncoming=[newBit,...oldValue.incoming];if(newIncoming.length<decoder.decodeWidth)return{incoming:newIncoming,decoded:oldValue.decoded};const valAsInt=displayValuesFromArray(newIncoming,!0)[1],newDecoded=[[isUnknown(valAsInt)?Unknown:decoder.decode(valAsInt),newIncoming],...oldValue.decoded];return newDecoded.length>maxItems&&newDecoded.splice(maxItems,newDecoded.length-maxItems),{incoming:[],decoded:newDecoded}}doSetTrigger(trigger){this._trigger=trigger,this.requestRedraw({why:"trigger changed",invalidateTests:!0})}doDraw(g,ctx){this.doDrawDefault(g,ctx,{drawInside:()=>{const drawContents=__name((()=>{const text=this.makeRepresentationString();let toDraw;void 0===text?(g.fillStyle=COLOR_COMPONENT_INNER_LABELS,g.font="15px sans-serif",toDraw=S.Components.ShiftDisplay.EmptyCaption):(g.fillStyle=COLOR_COMPONENT_BORDER,g.font="bold 16px sans-serif",toDraw=text),fillTextVAlign(g,TextVAlign_middle,toDraw,this.posX,this.posY)}),"drawContents");g.textAlign="center","w"===this.orient?ctx.inNonTransformedFrame(drawContents):drawContents()}})}makeRepresentationString(){var _a;const{incoming:incoming,decoded:decoded}=this.value;if(0===incoming.length&&0===decoded.length)return;const decodeAs=this._decodeAs,undecodedStr=repeatString("_ ",ShiftDisplayDecoders.props[decodeAs].decodeWidth-incoming.length)+displayValuesFromArray(incoming,!0)[0],sep=decodeAs.includes("int")?" ":"";let fullDecodedStr;if(0===decoded.length)fullDecodedStr="…";else{const groupEvery=null!=(_a=this._groupEvery)?_a:0;if(groupEvery<2)fullDecodedStr=decoded.map((v=>v[0])).join(sep);else{const offset2=groupEvery-decoded.length%groupEvery,decodedParts=[];for(let i2=0;i2<decoded.length;i2++)0!==i2&&((i2+offset2)%groupEvery==0?decodedParts.push(sep+" "):decodedParts.push(sep)),decodedParts.push(decoded[i2][0]);fullDecodedStr=decodedParts.join("")}"hex"===decodeAs?fullDecodedStr="0x"+(groupEvery<2?"":" ")+fullDecodedStr:"octal"===decodeAs&&(fullDecodedStr="0o"+(groupEvery<2?"":" ")+fullDecodedStr)}return"raw"===decodeAs?fullDecodedStr:undecodedStr+" ➟ "+fullDecodedStr}redecodeAll(){var _a;const decoder=ShiftDisplayDecoders.props[this._decodeAs],allBits=allBitsOf(this.value),maxItems=null!=(_a=this._maxItems)?_a:decoder.maxDisplayWidth;let value={incoming:[],decoded:[]};for(const newBit of allBits.reverse())value=ShiftDisplay.valueByAddingNewBit(newBit,value,decoder,maxItems);this.doSetValue(value)}doSetDecodeAs(decodeAs){this._decodeAs=decodeAs,this.redecodeAll()}doSetGroupEvery(groupEvery){this._groupEvery=groupEvery,this.requestRedraw({why:"grouping changed"})}makeComponentSpecificContextMenuItems(){const s=S.Components.ShiftDisplay.contextMenu,makeItemDecodeAs=__name(((decoder,desc)=>{const icon=this._decodeAs===decoder?"check":"none";return MenuData.item(icon,desc,(()=>this.doSetDecodeAs(decoder)))}),"makeItemDecodeAs"),makeItemGroupEvery=__name(((groupEvery,desc)=>{const icon=this._groupEvery===groupEvery?"check":"none";return MenuData.item(icon,desc,(()=>this.doSetGroupEvery(groupEvery)))}),"makeItemGroupEvery");return[...makeTriggerItems(this._trigger,this.doSetTrigger.bind(this)),["mid",MenuData.sep()],["mid",MenuData.submenu("eye",s.Decoding,[makeItemDecodeAs("raw",s.DecodingNone),makeItemDecodeAs("octal",s.DecodingOctal),makeItemDecodeAs("hex",s.DecodingHex),makeItemDecodeAs("ascii",s.DecodingAscii7),makeItemDecodeAs("ascii8",s.DecodingAscii8),makeItemDecodeAs("uint4",s.DecodingUint4),makeItemDecodeAs("int4",s.DecodingInt4),makeItemDecodeAs("uint8",s.DecodingUint8),makeItemDecodeAs("int8",s.DecodingInt8),makeItemDecodeAs("uint16",s.DecodingUint16),makeItemDecodeAs("int16",s.DecodingInt16),MenuData.sep(),MenuData.text(s.DecodingChangeWarning)])],["mid",MenuData.submenu("regroup",s.Grouping,[makeItemGroupEvery(void 0,s.GroupingNone),MenuData.sep(),makeItemGroupEvery(2,s.GroupBy.expand({n:2})),makeItemGroupEvery(3,s.GroupBy.expand({n:3})),makeItemGroupEvery(4,s.GroupBy.expand({n:4})),makeItemGroupEvery(7,s.GroupBy.expand({n:7})),makeItemGroupEvery(8,s.GroupBy.expand({n:8})),makeItemGroupEvery(16,s.GroupBy.expand({n:16}))])]]}};function allBitsOf(_ref113){let{incoming:incoming,decoded:decoded}=_ref113;const allBits=[...incoming];for(const[__stringRep,bits]of decoded)allBits.push(...bits);return allBits}__name(ShiftDisplay,"ShiftDisplay"),ShiftDisplayDef.impl=ShiftDisplay,__name(allBitsOf,"allBitsOf");var ShiftRegisterDef=defineParametrizedComponent("shift-reg",!0,!0,{variantName:_ref114=>{let{bits:bits}=_ref114;return"shift-reg-".concat(bits)},idPrefix:"reg",...RegisterBaseDef,makeNodes:(params,defaults)=>{const base=RegisterBaseDef.makeNodes(params,defaults),lrYOffset=base.ins.Clock[1]-2;return{ins:{...base.ins,D:[-5,0,"w"],"L̅R":[-5,lrYOffset,"w"]},outs:base.outs}}}),ShiftRegister=class extends RegisterBase{constructor(parent,params,saved){super(parent,ShiftRegisterDef,params,saved)}toJSON(){return this.toJSONBase()}makeTooltip(){const s=S.Components.ShiftRegister.tooltip;return tooltipContent(s.title,mods(div(s.desc.expand({numBits:this.numBits}))))}makeStateAfterClock(){const dirIsRight=this.inputs.L̅R.value;if(isUnknown(dirIsRight)||isHighImpedance(dirIsRight))return this.makeStateFromMainValue(Unknown);const d=LogicValue.filterHighZ(this.inputs.D.value),current=this.value;return dirIsRight?[...current.slice(1),d]:[d,...current.slice(0,-1)]}doDrawGenericCaption(g){g.font="bold 13px sans-serif",g.fillStyle=COLOR_COMPONENT_BORDER,g.textAlign="center",fillTextVAlign(g,TextVAlign_middle,"Shift R.",this.posX,this.posY-8),g.font="11px sans-serif",fillTextVAlign(g,TextVAlign_middle,"".concat(this.numBits," bits"),this.posX,this.posY+10)}};__name(ShiftRegister,"ShiftRegister"),ShiftRegisterDef.impl=ShiftRegister;var t35=__toESM(require_lib()),TristateBufferDef=defineParametrizedComponent("tristate",!0,!0,{variantName:_ref115=>{let{bottom:bottom2}=_ref115;return"tristate".concat(bottom2?"b":"")},idPrefix:"tristate",button:{imgWidth:50},repr:{bottom:typeOrUndefined(t35.boolean)},valueDefaults:{},params:{bottom:paramBool()},validateParams:_ref116=>{let{bottom:bottom2}=_ref116;return{controlPinsAtBottom:bottom2}},size:()=>({gridWidth:4,gridHeight:4}),makeNodes:_ref117=>{let{controlPinsAtBottom:controlPinsAtBottom}=_ref117;return{ins:{In:[-4,0,"w",{leadLength:20}],E:[0,controlPinsAtBottom?3:-3,controlPinsAtBottom?"s":"n","E (Enable)",{leadLength:20}]},outs:{Out:[4,0,"e",{leadLength:20}]}}},initialValue:()=>HighImpedance}),TristateBuffer=class extends ParametrizedComponentBase{constructor(parent,params,saved){super(parent,TristateBufferDef.with(params),saved),this.controlPinsAtBottom=params.controlPinsAtBottom}toJSON(){return{...this.toJSONBase(),bottom:this.controlPinsAtBottom===TristateBufferDef.aults.bottom?void 0:this.controlPinsAtBottom}}makeTooltip(){return tooltipContent(void 0,mods(div(S.Components.TristateBuffer.tooltip)))}doRecalcValue(){const en=this.inputs.E.value;if(isUnknown(en)||isHighImpedance(en))return Unknown;if(!en)return HighImpedance;const i2=this.inputs.In.value;return isHighImpedance(i2)?Unknown:i2}propagateValue(newValue){this.outputs.Out.value=newValue}doDraw(g,ctx){drawWireLineToComponent(g,this.inputs.In),drawWireLineToComponent(g,this.inputs.E),drawWireLineToComponent(g,this.outputs.Out);const{top:top2,bottom:bottom2}=this.bounds(),gateWidth=2*Math.max(2,this.inputs._all.length)*GRID_STEP,gateLeft=this.posX-gateWidth/2,gateRight=this.posX+gateWidth/2;g.fillStyle=COLOR_BACKGROUND,g.strokeStyle=ctx.isMouseOver?COLOR_MOUSE_OVER:COLOR_COMPONENT_BORDER,g.lineWidth=3,g.beginPath(),g.moveTo(gateLeft,top2),g.lineTo(gateRight,this.posY),g.lineTo(gateLeft,bottom2),g.closePath(),g.stroke()}makeComponentSpecificContextMenuItems(){return[this.makeChangeBooleanParamsContextMenuItem(S.Components.Generic.contextMenu.ParamControlBitAtBottom,this.controlPinsAtBottom,"bottom")]}};__name(TristateBuffer,"TristateBuffer"),TristateBufferDef.impl=TristateBuffer;var t36=__toESM(require_lib()),TristateBufferArrayDef=defineParametrizedComponent("tristate-array",!0,!0,{variantName:_ref118=>{let{bits:bits,bottom:bottom2}=_ref118;return"tristate-array-".concat(bits).concat(bottom2?"b":"")},idPrefix:"tristate",button:{imgWidth:50},repr:{bits:typeOrUndefined(t36.number),bottom:typeOrUndefined(t36.boolean)},valueDefaults:{},params:{bits:param(4,[2,4,8,16]),bottom:paramBool()},validateParams:_ref119=>{let{bits:bits,bottom:bottom2}=_ref119;return{numBits:bits,controlPinsAtBottom:bottom2}},size:ControlledInverterDef.size,makeNodes:_ref120=>{let{numBits:numBits,controlPinsAtBottom:controlPinsAtBottom,gridHeight:gridHeight}=_ref120;return{ins:{In:groupVertical("w",-3,0,numBits),E:[0,-(gridHeight/2+1)*(controlPinsAtBottom?-1:1),controlPinsAtBottom?"s":"n","E (Enable)"]},outs:{Out:groupVertical("e",3,0,numBits)}}},initialValue:(saved,_ref121)=>{let{numBits:numBits}=_ref121;return ArrayFillWith(HighImpedance,numBits)}}),TristateBufferArray=class extends ParametrizedComponentBase{constructor(parent,params,saved){super(parent,TristateBufferArrayDef.with(params),saved),this.numBits=params.numBits,this.controlPinsAtBottom=params.controlPinsAtBottom}toJSON(){return{...this.toJSONBase(),bits:this.numBits===TristateBufferArrayDef.aults.bits?void 0:this.numBits,bottom:this.controlPinsAtBottom===TristateBufferArrayDef.aults.bottom?void 0:this.controlPinsAtBottom}}makeTooltip(){const s=S.Components.TristateBufferArray.tooltip;return tooltipContent(s.title,mods(div(s.desc)))}doRecalcValue(){const enable=this.inputs.E.value;return isUnknown(enable)||isHighImpedance(enable)?ArrayFillWith(Unknown,this.numBits):enable?this.inputValues(this.inputs.In):ArrayFillWith(HighImpedance,this.numBits)}propagateValue(newValue){this.outputValues(this.outputs.Out,newValue)}doDraw(g,ctx){this.doDrawDefault(g,ctx,{skipLabels:!0,drawInside:_ref122=>{let{top:top2,bottom:bottom2,left:left2,right:right2}=_ref122;const enable=this.inputs.E.value;g.lineWidth=2,g.strokeStyle=colorForLogicValue(enable),g.beginPath(),this.controlPinsAtBottom?(g.moveTo(this.posX,bottom2),g.lineTo(this.posX,this.posY+4)):(g.moveTo(this.posX,top2),g.lineTo(this.posX,this.posY-4)),g.stroke(),g.strokeStyle=COLOR_COMPONENT_BORDER,g.beginPath(),g.moveTo(left2+12,this.posY-8),g.lineTo(right2-13,this.posY),g.lineTo(left2+12,this.posY+8),g.closePath(),g.stroke()}})}makeComponentSpecificContextMenuItems(){const s=S.Components.Generic.contextMenu;return[this.makeChangeParamsContextMenuItem("inputs",s.ParamNumBits,this.numBits,"bits"),this.makeChangeBooleanParamsContextMenuItem(s.ParamControlBitAtBottom,this.controlPinsAtBottom,"bottom"),...this.makeForceOutputsContextMenuItem(!0)]}};__name(TristateBufferArray,"TristateBufferArray"),TristateBufferArrayDef.impl=TristateBufferArray;var AllComponentDefs=[InputDef,ClockDef,RandomDef,OutputDef,DisplayDef,Display7SegDef,Display16SegDef,DisplayAsciiDef,DisplayBarDef,ShiftDisplayDef,Gate1Def,GateNDef,GateArrayDef,TristateBufferDef,TristateBufferArrayDef,ControlledInverterDef,LabelDef,RectangleDef,PassthroughDef,HalfAdderDef,AdderDef,ComparatorDef,AdderArrayDef,ALUDef,MuxDef,DemuxDef,LatchSRDef,FlipflopJKDef,FlipflopTDef,FlipflopDDef,RegisterDef,ShiftRegisterDef,ROMDef,RAMDef,CounterDef,DecoderDef,Decoder7SegDef,Decoder16SegDef,DecoderBCD4Def],ComponentFactory=class{constructor(editor){this._predefinedComponents=new Map,this._customComponents=new Map,this.editor=editor;for(const maker of AllComponentDefs){const key=maker.type;if(!maker.isValid())throw new Error("Implementation missing for components of type '".concat(key,"'"));if(this._predefinedComponents.has(key))throw new Error("Duplicate component for components of type '".concat(key,"'"));this._predefinedComponents.set(key,maker)}}makeFromJSON(parent,obj_,offsetPos){if(!isRecord(obj_))return void console.warn("Skipping invalid non-object component: ".concat(import_json55.default.stringify(obj_,null,2)));const obj=obj_;void 0!==offsetPos&&isArray(obj.pos)&&(obj.pos=[obj.pos[0]+offsetPos[0],obj.pos[1]+offsetPos[1]]);const type7=isString(obj.type)?obj.type:"<unknown>",maker=this.getMaker(type7);return null==maker?void 0:maker.makeFromJSON(parent,obj)}makeFromButton(parent,elem){const compDataset=elem.dataset,paramsStr=compDataset.params,maker=this.getMaker(compDataset.type),params=void 0===paramsStr?void 0:import_json55.default.parse(paramsStr);return null==maker?void 0:maker.make(parent,params)}getMaker(type7){let maker;if(void 0!==(maker=this._predefinedComponents.get(type7)))return maker;if(Gate1Types.includes(type7))return Gate1Def;if(GateNTypes.includes(type7))return GateNDef;const hyphenPos=type7.indexOf("-");if(-1!==hyphenPos){const typeStart=type7.substring(0,hyphenPos);if("array"===type7.substring(hyphenPos+1)&&GateNTypes.includes(typeStart))return GateArrayDef;if(type7.startsWith("custom-")){const customId=type7.substring("custom-".length);if(void 0!==(maker=this._customComponents.get(customId)))return maker}}console.warn("Unknown component for '".concat(type7,"'"))}getCustomDef(customId){return this._customComponents.get(customId)}customDefs(){if(0!==this._customComponents.size)return[...this._customComponents.values()]}customDefReprs(){const defs=this.customDefs();if(void 0!==defs)return defs.map((def=>def.toJSON()))}clearCustomDefs(){this._customComponents.clear()}getCustomComponentTypesWhichUse(id){const compIds=[id];for(const def of this._customComponents.values())def.uses(id,[!0,this])&&compIds.push(def.type);return compIds}tryAddCustomDef(def,overwrite){const customid=def.customId;if(overwrite||!this._customComponents.has(customid))return this._customComponents.set(customid,def),def;console.warn("Could not add custom component with duplicate id '".concat(customid,"'"))}tryLoadCustomDefsFrom(defs){if(void 0===defs)return 0;const validatedDefs=validateJson(defs,t37.array(CustomComponentDefRepr),"defs");if(void 0===validatedDefs)return 0;let numLoaded=0;for(const validatedDef of validatedDefs){void 0!==this.tryAddCustomDef(new CustomComponentDef(validatedDef),!1)&&numLoaded++}return numLoaded}hasCustomComponents(){return this._customComponents.size>0}makeContextMenu(id){const customId=id.substring("custom-".length),def=this._customComponents.get(customId);if(void 0===def)return;const s=S.Components.Custom.contextMenu;return[MenuData.item("pen",s.ChangeName,(()=>this.runChangeCustomComponentCaptionDialog(def))),MenuData.item("connect",s.ChangeCircuit,(()=>{window.alert(s.EditFromComponentMessage)})),MenuData.sep(),MenuData.item("trash",s.Delete,(()=>{if(this.editor.components.contains(id))window.alert(s.CannotDeleteInUse);else{for(const compDef of this._customComponents.values())if(compDef.uses(def.type,!1))return void window.alert(s.CannotDeleteInUseBy.expand({caption:compDef.caption}));window.confirm(s.ConfirmDelete)&&(this._customComponents.delete(customId),this.editor.updateCustomComponentButtons())}}),void 0,!0)]}runChangeCustomComponentCaptionDialog(def){var _a;const s=S.Components.Custom.contextMenu,oldCaption=def.caption,oldType=def.type;for(;;){const newCaption=window.prompt(s.ChangeNamePrompt,oldCaption);if(null===newCaption||newCaption===oldCaption)return;if(0===newCaption.length){window.alert(s.ChangeNameEmpty);continue}def.doSetCaption(newCaption);const oldDefaultCustomId=makeCustomIdFromCaption(oldCaption);if(def.customId===oldDefaultCustomId){const newCustomId=makeCustomIdFromCaption(newCaption);if(!this._customComponents.has(newCustomId)){this._customComponents.delete(oldDefaultCustomId),def.customId=newCustomId;const newType=def.type;for(const compDef of this._customComponents.values())for(const compRepr of Object.values(null!=(_a=compDef.circuit.components)?_a:{}))compRepr.type===oldType&&(compRepr.type=newType);this._customComponents.set(newCustomId,def)}}break}this.editor.updateCustomComponentButtons(),this.editor.components.updateCustomComponents(oldType),this.editor.focus()}tryMakeNewCustomComponent(editor){var _a;const s=S.Components.Custom.messages,selectionAll=null==(_a=editor.eventMgr.currentSelection)?void 0:_a.previouslySelectedElements;if(void 0===selectionAll)return s.EmptySelection;const selectedComps=[...selectionAll].filter((e=>e instanceof ComponentBase));if(0===selectedComps.length)return s.EmptySelection;const checkResult=this.checkComponentsForCustomDef(selectedComps);if(isString(checkResult))return checkResult;const componentsToInclude=checkResult.components;let caption;const labels=componentsToInclude.filter((e=>e instanceof Label));if(1!==labels.length){if(caption=window.prompt(s.EnterCaptionPrompt),null===caption)return""}else caption=labels[0].text;const id=makeCustomIdFromCaption(caption);if(this._customComponents.has(id))return s.ComponentAlreadyExists.expand({id:id});const{components:components,wires:wires}=Serialization.buildComponentsAndWireObject(componentsToInclude,[],void 0);if(void 0===components||void 0===wires)return s.NoWires;const customDef=new CustomComponentDef({id:id,caption:caption,circuit:{components:components,wires:wires}}),maker=this.tryAddCustomDef(customDef,!1);if(void 0===maker)return"";const customComp=maker.make(editor);customComp.setSpawned(),customComp.setPosition(editor.pointerX+customComp.unrotatedWidth/2-5,editor.pointerY,!0),editor.eventMgr.currentSelection=void 0,editor.eventMgr.setCurrentComponentUnderPointer(customComp);for(const comp of componentsToInclude)editor.components.tryDelete(comp);return customDef}tryMakeNewTestCase(editor){var _a;const checkResult=this.checkSelectionForTestCase(editor);if(isString(checkResult))return checkResult;const{inputs:inputs,outputs:outputs}=checkResult;return null!=(_a=this.makeTestCaseWithCurrentValues(editor,inputs,outputs,!0))?_a:""}makeTestCaseWithCurrentValues(editor,inputs,outputs,askName){var _a,_b;const inReprBuf=[],outReprBuf=[],mkDesc=__name((reprBuf=>inOut=>{var _a2;const repr=binaryStringRepr(inOut.value);return reprBuf.push(repr),"".concat(null!=(_a2=inOut.ref)?_a2:"?").concat(isString(inOut.name)?" (“".concat(inOut.name,"”)"):"",": ").concat(repr)}),"mkDesc"),s=S.Messages,inputsStr=s.TestCaseInputToSet.expand({n:inputs.length})+"\n • "+inputs.map(mkDesc(inReprBuf)).join("\n • "),outputsStr=s.TestCaseOuputToCheck.expand({n:outputs.length})+"\n • "+outputs.map(mkDesc(outReprBuf)).join("\n • "),prompt2=s.NewTestCaseTitle+"\n\n".concat(inputsStr,"\n\n").concat(outputsStr,"\n\n")+s.NewTestCaseSetName;let testCaseName=inReprBuf.join(" ")+" → "+outReprBuf.join(" ");if(askName&&(testCaseName=window.prompt(prompt2,testCaseName),null===testCaseName))return;const inMap=Object.create(null);for(const input2 of inputs)inMap[null!=(_a=input2.ref)?_a:"?"]=valuesReprForTest(input2.value);const outMap=Object.create(null);for(const output of outputs)outMap[null!=(_b=output.ref)?_b:"?"]=valuesReprForTest(output.value);return new TestCaseCombinational({in:inMap,out:outMap,name:0===testCaseName.length?void 0:testCaseName},editor.components)}async tryMakeAllTestCases(editor){const checkResult=this.checkSelectionForTestCase(editor);if(isString(checkResult))return checkResult;const{inputs:inputs,outputs:outputs}=checkResult,s=S.Messages,inputsByBit=[];let numInputs=0;for(const input2 of inputs){for(let i2=0;i2<input2.numBits;i2++)inputsByBit.push([input2,i2]);numInputs+=input2.numBits}const setBit=__name(((i2,value)=>{const[input2,bit]=inputsByBit[i2],newValues=input2.value.slice();newValues[bit]=value,input2.setValue(newValues)}),"setBit");if(numInputs>10)return s.TooManyInputsForAutoTestCases.expand({max:10});const numCases=Math.pow(2,numInputs);if(!confirm(s.AutoTestCasesWarning.expand({numInputs:numInputs,numCases:numCases})))return"";const result=await editor.disableUIWhile(s.ComputingTestCases,(async restoreAfter=>{for(const input2 of inputs)restoreAfter.set(input2,input2.value);const testCases=[];for(let i2=0;i2<numCases;i2++){for(let j=0;j<numInputs;j++){setBit(j,0!=(i2&1<<j))}editor.recalcPropagateAndDrawIfNeeded(!0),await editor.waitForPropagation(),testCases.push(this.makeTestCaseWithCurrentValues(editor,inputs,outputs,!1))}return testCases}));return null!=result?result:""}tryModifyCustomComponent(def,defRoot){const s=S.Components.Custom.messages,components=[...defRoot.components.all()],checkResult=this.checkComponentsForCustomDef(components);if(isString(checkResult))return checkResult;const newComponents=checkResult.components,circuit=Serialization.buildComponentsAndWireObject(newComponents,[],void 0);if(void 0===circuit.components||void 0===circuit.wires)return"";const newDef=new CustomComponentDef({id:def.customId,caption:def.caption,circuit:{components:circuit.components,wires:circuit.wires}});if((newDef.numInputs!==def.numInputs||newDef.numOutputs!==def.numOutputs)&&!window.confirm(s.InputsOutputsChanged))return"";this.tryAddCustomDef(newDef,!0)}checkComponentsForCustomDef(components){const s=S.Components.Custom.messages,inputs=components.filter((e=>e instanceof Input));if(0===inputs.length)return s.NoInput;const outputs=components.filter((e=>e instanceof Output));if(0===outputs.length)return s.NoOutput;function checkNames(inOuts){const names=new Set,missingNames=[];for(const inOut of inOuts){const name2=inOut.name;if(void 0===name2)missingNames.push(inOut);else{if(!isString(name2)||names.has(name2))return!1;names.add(name2)}}for(const inOut of missingNames){const prefix=inOut instanceof Input?"In":"Out";let name2,i2=0;do{name2="".concat(prefix).concat(i2++)}while(names.has(name2));inOut.doSetName(name2),names.add(name2)}return!0}__name(checkNames,"checkNames");if(!(checkNames(inputs)&&checkNames(outputs)))return s.InputsOutputsMustHaveNames;const componentsToInclude=[...inputs,...outputs],queue=[];let comp;for(queue.push(...inputs);void 0!==(comp=queue.shift());)for(const node of comp.outputs._all)for(const wire of node.outgoingWires){const otherComp=wire.endNode.component;components.includes(otherComp)&&!componentsToInclude.includes(otherComp)&&(componentsToInclude.push(otherComp),queue.push(otherComp))}queue.push(...outputs);const missingComponents=[];for(;void 0!==(comp=queue.shift());)for(const node of comp.inputs._all){const wire=node.incomingWire;if(null!==wire){const otherComp=wire.startNode.component;components.includes(otherComp)?componentsToInclude.includes(otherComp)||(componentsToInclude.push(otherComp),queue.push(otherComp)):missingComponents.includes(otherComp)||missingComponents.push(otherComp)}}if(missingComponents.length>0){const missingCompsStr=missingComponents.map((c=>c.toString())).join(", ");return s.MissingComponents.expand({list:missingCompsStr})}const uselessComponents=components.filter((c=>!componentsToInclude.includes(c)&&(0!==c.inputs._all.length||0!==c.outputs._all.length)));if(uselessComponents.length>0){const uselessCompsStr=uselessComponents.map((c=>c.toString())).join(", ");return s.UselessComponents.expand({list:uselessCompsStr})}return componentsToInclude.some((c=>c instanceof Clock))?s.CannotIncludeClock:{components:componentsToInclude,inputs:inputs,outputs:outputs}}checkSelectionForTestCase(editor){var _a;const s=S.Components.Custom.messages,selectionAll=null==(_a=editor.eventMgr.currentSelection)?void 0:_a.previouslySelectedElements;if(void 0===selectionAll)return s.EmptySelection;const components=[...selectionAll].filter((e=>e instanceof ComponentBase));if(0===components.length)return s.EmptySelection;const inputs=components.filter((e=>e instanceof Input));if(0===inputs.length)return s.NoInput;const outputs=components.filter((e=>e instanceof Output));return 0===outputs.length?s.NoOutput:{inputs:inputs,outputs:outputs}}};function makeCustomIdFromCaption(caption){return caption.trim().normalize("NFKD").toLowerCase().replace(/[^a-z0-9]+/g,"")}__name(ComponentFactory,"ComponentFactory"),__name(makeCustomIdFromCaption,"makeCustomIdFromCaption");var import_json56=__toESM(require_dist()),withButton="withButton",ifShowOnly="ifShowOnly",componentsMenu=[{nameKey:"InputOutput",items:[InputDef.button({bits:1},"Input1"),OutputDef.button({bits:1},"Output1"),DisplayBarDef.button("DisplayBar",{compat:"out.bar",visible:withButton}),ClockDef.button("Clock"),InputDef.button({bits:4},["InputN","Input4"],{compat:"in.nibble"}),OutputDef.button({bits:4},["OutputN","Output4"],{compat:"out.nibble"}),DisplayDef.button({bits:4},["DisplayN","Display4"],{compat:"out.nibble-display"}),InputDef.button({bits:8},"Input8",{compat:"in.byte",visible:ifShowOnly}),OutputDef.button({bits:8},"Output8",{compat:"out.byte",visible:ifShowOnly}),DisplayDef.button({bits:8},"Display8",{compat:"out.byte-display",visible:ifShowOnly}),Display7SegDef.button("Display7Seg",{compat:"out.7seg",visible:withButton}),Display16SegDef.button("Display16Seg",{compat:"out.16seg",visible:withButton}),DisplayAsciiDef.button("DisplayAscii",{compat:"out.ascii",visible:withButton}),RandomDef.button({bits:1},"Random",{compat:"random",visible:withButton}),ShiftDisplayDef.button("ShiftDisplay",{compat:"out.shift-buffer",visible:withButton})]},{nameKey:"Gates",items:[Gate1Def.button({type:"not"},"not"),Gate1Def.button({type:"buf"},"buf",{visible:withButton}),TristateBufferDef.button({bottom:!1},"tri",{compat:"tri",visible:withButton}),GateNDef.button({type:"and",bits:2},"and"),GateNDef.button({type:"or",bits:2},"or"),GateNDef.button({type:"xor",bits:2},"xor"),GateNDef.button({type:"nand",bits:2},"nand"),GateNDef.button({type:"nor",bits:2},"nor"),GateNDef.button({type:"xnor",bits:2},"xnor",{visible:withButton}),GateNDef.button({type:"imply",bits:2},"imply",{visible:withButton}),GateNDef.button({type:"nimply",bits:2},"nimply",{visible:withButton}),GateNDef.button({type:"txa",bits:2},["transfer","txa"],{visible:withButton}),GateNDef.button({type:"and",bits:3},"and3",{compat:"and3",visible:ifShowOnly}),GateNDef.button({type:"or",bits:3},"or3",{compat:"or3",visible:ifShowOnly}),GateNDef.button({type:"xor",bits:3},"xor3",{compat:"xor3",visible:ifShowOnly}),GateNDef.button({type:"nand",bits:3},"nand3",{compat:"nand3",visible:ifShowOnly}),GateNDef.button({type:"nor",bits:3},"nor3",{compat:"nor3",visible:ifShowOnly}),GateNDef.button({type:"xnor",bits:3},"xnor3",{compat:"xnor3",visible:ifShowOnly}),GateNDef.button({type:"and",bits:4},"and4",{compat:"and4",visible:ifShowOnly}),GateNDef.button({type:"or",bits:4},"or4",{compat:"or4",visible:ifShowOnly}),GateNDef.button({type:"xor",bits:4},"xor4",{compat:"xor4",visible:ifShowOnly}),GateNDef.button({type:"nand",bits:4},"nand4",{compat:"nand4",visible:ifShowOnly}),GateNDef.button({type:"nor",bits:4},"nor4",{compat:"nor4",visible:ifShowOnly}),GateNDef.button({type:"xnor",bits:4},"xnor4",{compat:"xnor4",visible:ifShowOnly}),ControlledInverterDef.button({bits:4,bottom:!1},"ControlledInverter",{compat:"switched-inverter",visible:withButton}),GateArrayDef.button({type:"and",bits:4},"GateArray",{compat:"quad-gate",visible:withButton}),TristateBufferArrayDef.button({bits:4,bottom:!1},"TristateBufferArray",{visible:withButton})]},{nameKey:"Layout",items:[LabelDef.button("Label"),RectangleDef.button("Rectangle",{compat:"label.rect"}),PassthroughDef.button({bits:1},"Passthrough1"),PassthroughDef.button({bits:4},"PassthroughN")]},{nameKey:"Components",items:[HalfAdderDef.button("HalfAdder"),AdderDef.button("Adder"),ComparatorDef.button("Comparator",{compat:"comparator",visible:withButton}),AdderArrayDef.button({bits:4},"AdderArray"),ALUDef.button({bits:4,ext:!1},"ALU"),MuxDef.button({from:4,to:2,bottom:!1},"Mux"),MuxDef.button({from:8,to:4,bottom:!1},"Mux",{visible:ifShowOnly}),DemuxDef.button({from:2,to:4,bottom:!1},"Demux"),LatchSRDef.button("LatchSR"),FlipflopJKDef.button("FlipflopJK",{compat:"flipflop-jk",visible:withButton}),FlipflopTDef.button("FlipflopT",{compat:"flipflop-t",visible:withButton}),FlipflopDDef.button("FlipflopD",{compat:"flipflop-d"}),RegisterDef.button({bits:4,inc:!1},"Register",{compat:"register"}),ShiftRegisterDef.button({bits:4},"ShiftRegister",{compat:"shift-register"}),CounterDef.button({bits:4},"Counter"),RAMDef.button({lines:16,bits:4},"RAM"),ROMDef.button({lines:16,bits:4},"ROM",{visible:withButton}),DecoderDef.button({bits:2},"Decoder",{compat:"decoder"}),Decoder7SegDef.button("Decoder7Seg",{compat:"decoder-7seg"}),Decoder16SegDef.button("Decoder16Seg",{compat:"decoder-16seg",visible:withButton}),DecoderBCD4Def.button("DecoderBCD4",{compat:"decoder-bcd4",visible:withButton})]}],ComponentMenu=class{constructor(editor,parent){var _a;this.editor=editor,this.parent=parent;const showOnly=editor.options.showOnly;this._htmlSections=[],this._restrictedToGateTypes=void 0===showOnly?void 0:new Set;const showOnlyBuf=void 0===showOnly?void 0:[...showOnly];let lastSectionNonEmpty=!1;for(const section of componentsMenu){const{allButtons:allButtons,buttonsShowWithMore:buttonsShowWithMore,buttonsShowWithURLParam:buttonsShowWithURLParam,accessibleGateTypes:accessibleGateTypes}=makeButtons(section,showOnlyBuf),htmlSection=this.makeSection(section.nameKey,allButtons,buttonsShowWithMore,buttonsShowWithURLParam,showOnlyBuf,lastSectionNonEmpty);for(const type7 of accessibleGateTypes)null==(_a=this._restrictedToGateTypes)||_a.add(type7);void 0!==htmlSection&&(this._htmlSections.push(htmlSection),lastSectionNonEmpty=!0)}void 0!==showOnlyBuf&&showOnlyBuf.filter((s=>!s.endsWith("*"))).length>0&&console.log("ERROR Supposed to show unknown elems: ".concat(showOnlyBuf.join("; ")))}allFixedButtons(){return this._htmlSections.flatMap((s=>s.buttons))}allCustomButtons(){return void 0===this._customComponentSection?[]:this._customComponentSection.buttons}allowGateType(type7){var _a,_b;return null==(_b=null==(_a=this._restrictedToGateTypes)?void 0:_a.has(type7))||_b}updateCustomComponentButtons(defs){const oldSec=this._customComponentSection;if(void 0!==oldSec){void 0!==oldSec.header&&oldSec.header.remove(),void 0!==oldSec.separator&&oldSec.separator.remove();for(const button2 of oldSec.buttons)button2.remove();void 0!==oldSec.showMoreLink&&oldSec.showMoreLink.remove()}this._customComponentSection=void 0===defs?void 0:this.makeCustomComponentSection(defs)}setCustomComponentsHidden(ids){const section=this._customComponentSection;if(void 0===section)return;let anyVisible=!1;for(const button2 of section.buttons){const show=!ids.includes(button2.dataset.type);anyVisible||(anyVisible=show),setVisible(button2,show)}setVisible(section.header,anyVisible),void 0!==section.separator&&setVisible(section.separator,anyVisible)}makeCustomComponentSection(defs){const showOnly=this.editor.options.showOnly,showOnlyBuf=void 0===showOnly?void 0:[...showOnly],allButtons=[],buttonsShowWithMore=[];for(const def of defs){const type7=def.type,icon=makeSvgHolder("svgimg","custom",def.makeButtonSVG(),50,34),caption=def.caption,{compButton:compButton,hiddenNow:hiddenNow}=makeButton(type7,!1,[type7],showOnlyBuf,icon,caption,caption+S.Components.Custom.MenuButtonSuffix,void 0,!0);hiddenNow&&buttonsShowWithMore.push(compButton),allButtons.push(compButton)}const makeSeparator=this._htmlSections.length>0;return this.makeSection("Custom",allButtons,buttonsShowWithMore,[],showOnlyBuf,makeSeparator)}makeSection(nameKey,allButtons,buttonsShowWithMore,buttonsShowWithURLParam,showOnlyBuf,makeSeparator){const numShowWithMoreButton=buttonsShowWithMore.length;if(0===allButtons.length-numShowWithMoreButton-buttonsShowWithURLParam.length)return;let separator;makeSeparator&&(separator=div(style("height: 20px"),raw("&nbsp;")).render(),this.parent.appendChild(separator));const header=div(cls("leftToolbarHeader"),S.ComponentBar.SectionNames[nameKey]).render();this.parent.appendChild(header);for(const compButton of allButtons)this.parent.appendChild(compButton);let showMoreLink;if(0!==numShowWithMoreButton&&void 0===showOnlyBuf){let moreShown=!1;const names=[S.ComponentBar.Labels.More+" ↓",S.ComponentBar.Labels.Less+" ↑"];showMoreLink=a(cls("leftToolbarMore"),names[0]).render(),showMoreLink.addEventListener("click",(()=>{moreShown=!moreShown;for(const button2 of buttonsShowWithMore)moreShown?(button2.style.removeProperty("padding"),button2.style.removeProperty("border"),button2.style.removeProperty("margin-bottom"),button2.style.removeProperty("max-height"),button2.style.removeProperty("overflow")):(button2.style.padding="0",button2.style.border="0",button2.style.marginBottom="0",button2.style.maxHeight="0",button2.style.overflow="hidden");showMoreLink.innerHTML=names[Number(moreShown)]})),this.parent.appendChild(showMoreLink)}return{separator:separator,header:header,buttons:allButtons,showMoreLink:showMoreLink}}};function makeButtons(section,showOnlyBuf){var _a,_b,_c;const allButtons=[],buttonsShowWithMore=[],buttonsShowWithURLParam=[],accessibleGateTypes=new Set;for(const item of section.items){const normallyHidden=void 0!==item.visible&&"always"!==item.visible,[stringsKey,img2]=isString(item.visual)?[item.visual,item.visual]:item.visual,compStrings=S.ComponentBar.Components.props[stringsKey],[titleStr,captionStr]=isString(compStrings)?[compStrings,void 0]:compStrings,{compButton:compButton,hiddenByShowOnly:hiddenByShowOnly,hiddenNow:hiddenNow}=makeButton(item.type,normallyHidden,componentIdsFor(item),showOnlyBuf,makeImage(img2,item.width),captionStr,titleStr,null==(_a=item.params)?void 0:_a.params,!1);if(hiddenNow){("withButton"===item.visible?buttonsShowWithMore:buttonsShowWithURLParam).push(compButton)}allButtons.push(compButton);let gateType;item.type.startsWith("gate")&&!hiddenByShowOnly&&void 0!==(gateType=null==(_c=null==(_b=item.params)?void 0:_b.params)?void 0:_c.type)&&accessibleGateTypes.add(gateType)}return{allButtons:allButtons,buttonsShowWithMore:buttonsShowWithMore,buttonsShowWithURLParam:buttonsShowWithURLParam,accessibleGateTypes:accessibleGateTypes}}function makeButton(typeStr,normallyHidden,componentIds,showOnlyBuf,buttonIcon,captionStr,titleStr,params,isCustom){const hiddenByShowOnly=void 0!==showOnlyBuf&&!shouldShow(componentIds,showOnlyBuf),hiddenNow=void 0!==showOnlyBuf?hiddenByShowOnly:normallyHidden,buttonStyle=hiddenNow?"max-height: 0; transition: all 0.25s ease-out; overflow: hidden; padding: 0; border: 0; margin-bottom: 0;":"",extraClasses=hiddenNow?" sim-component-button-extra":"",customClasses=isCustom?" sim-component-button-custom":"",caption=void 0===captionStr?emptyMod:span(cls("barLabel"),captionStr),buttonTitle=title(void 0===titleStr?"":titleStr+" \n(“".concat(componentIds[0],"”)")),compButton=button(type("button"),style(buttonStyle),cls("list-group-item list-group-item-action sim-component-button".concat(extraClasses).concat(customClasses)),buttonIcon,caption,buttonTitle).render(),compDataset=compButton.dataset;return compDataset.type=typeStr,compDataset.componentId=componentIds[0],void 0!==params&&(compDataset.params=import_json56.default.stringify(params)),{compButton:compButton,hiddenByShowOnly:hiddenByShowOnly,hiddenNow:hiddenNow}}function shouldShow(componentIds,showOnly){let visible=!1;for(const componentId of componentIds)for(const showOnlySpec of showOnly){const[isMatch,isWildcard]=matchesSpec(showOnlySpec,componentId);if(isMatch){if(visible=!0,!isWildcard){const ind=showOnly.indexOf(componentId);showOnly.splice(ind,1)}break}}return visible;function matchesSpec(showOnlySpec,componentId){return showOnlySpec===componentId?[!0,!1]:showOnlySpec.endsWith("*")&&componentId.startsWith(showOnlySpec.slice(0,-1))?[!0,!0]:[!1,!1]}}function componentIdsFor(item){const ids=[],defAndParams=item.params,type7=item.type;if(void 0===defAndParams)ids.push(type7);else{const def=defAndParams.def,variants=def.variantName(defAndParams.params);isArray(variants)?ids.push(...variants):(deepObjectEquals(defAndParams.params,def.defaultParams)&&ids.push(type7),ids.push(variants))}return void 0!==item.compat&&ids.push(item.compat),ids}__name(ComponentMenu,"ComponentMenu"),__name(makeButtons,"makeButtons"),__name(makeButton,"makeButton"),__name(shouldShow,"shouldShow"),__name(componentIdsFor,"componentIdsFor");var MessageBar=class{constructor(editor){this._currentTimeout=void 0,this.msgSpan=span().render(),this.closeButton=span("×",style("padding-left: 0.5em; cursor: pointer; margin-left: 0.5em; border-left: 1px solid rgba(127,127,127,0.8);")).render(),this.closeButton.onclick=()=>this.hideNow(),this.root=div(cls("msgZone"),div(cls("msgBar"),this.msgSpan,this.closeButton)).render(),editor.html.mainCanvas.insertAdjacentElement("afterend",this.root),this.hideNow=this.hideNow.bind(this)}hideNow(){this._currentTimeout=void 0,this.root.classList.remove("visible")}showMessage(msg,duration,withCloseButton){return void 0!==this._currentTimeout&&(clearTimeout(this._currentTimeout),this._currentTimeout=void 0),this.msgSpan.innerHTML="",applyModifierTo(this.msgSpan,msg),this.root.classList.add("visible"),duration>0&&(this._currentTimeout=setTimeout(this.hideNow,duration)),setVisible(this.closeButton,withCloseButton),this.hideNow}};__name(MessageBar,"MessageBar");var MoveManager=class{constructor(editor){this._movingDrawables=new Set,this.editor=editor}areDrawablesMoving(){return this._movingDrawables.size>0}getSingleMovingWaypoint(){if(1===this._movingDrawables.size){const drawable=this._movingDrawables.values().next().value;if(drawable instanceof Waypoint)return drawable}}getSingleMovingComponentWithAnchors(){if(1===this._movingDrawables.size){const drawable=this._movingDrawables.values().next().value;if(drawable instanceof DrawableWithPosition&&void 0!==drawable.anchor||drawable instanceof ComponentBase&&0!==drawable.anchoredDrawables.length)return drawable}}setDrawableMoving(comp,e){this.changeMovingDrawables((()=>{this._movingDrawables.add(comp)}),e)}setDrawableStoppedMoving(comp,e){this.changeMovingDrawables((()=>{this._movingDrawables.delete(comp)}),e)}changeMovingDrawables(change,e){const emptyBefore=0===this._movingDrawables.size;change();emptyBefore!==(0===this._movingDrawables.size)&&(this.editor.updateCursor(e),this.editor.editTools.redrawMgr.requestRedraw({why:"started or stopped moving drawables",invalidateMask:!0}))}clear(){this._movingDrawables.clear()}dump(){var _a,_b;const num=this._movingDrawables.size;if(0===num)console.log("No moving drawables");else{console.log("There are ".concat(num," moving drawables:"));for(const drawable of this._movingDrawables){const className=drawable.constructor.name;drawable instanceof ComponentBase?console.log(className+" - "+(null!=(_b=null==(_a=drawable.outputs._all[0])?void 0:_a.id)?_b:"?")):console.log(className)}}}};__name(MoveManager,"MoveManager");var Tests=class{aluOps(){function*nibbles(){for(const a2 of[!1,!0])for(const b2 of[!1,!0])for(const c of[!1,!0])for(const d of[!1,!0])yield[a2,b2,c,d]}function representationsOf(v){const[str,uint_]=displayValuesFromArray(v,!0);return[str,uint_,uint_<8?uint_:uint_-16]}__name(nibbles,"nibbles"),__name(representationsOf,"representationsOf");let totalTests=0,failedTests=0;for(const a2 of nibbles())for(const b2 of nibbles())for(const cin of[!1,!0]){const[a_str,a_uint,a_sint]=representationsOf(a2),[b_str,b_uint,b_sint]=representationsOf(b2);a2.reverse(),b2.reverse();const{s:sum,v:v_sum,cout:c_sum}=doALUAdd(a2,b2,cin),{s:diff,v:v_diff,cout:c_diff}=doALUSub(a2,b2,cin);a2.reverse(),b2.reverse(),sum.reverse(),diff.reverse();const[sum_str,sum_uint,sum_sint]=representationsOf(sum),[diff_str,diff_uint,diff_sint]=representationsOf(diff),should_sum_uint=a_uint+b_uint+Number(cin);let carryError=!1;carryError=should_sum_uint>15?sum_uint===should_sum_uint||!0!==c_sum:sum_uint!==should_sum_uint||!1!==c_sum,carryError&&(console.log("ERROR carry - ".concat(a_uint," (").concat(a_str,") + ").concat(b_uint," (").concat(b_str,") + ").concat(Number(cin)," = ").concat(sum_uint," (").concat(sum_str,") (c=").concat(c_sum,")")),failedTests++),totalTests++;const should_diff_uint=a_uint-b_uint-Number(cin);let borrowError=!1;borrowError=a_uint-Number(cin)<b_uint?diff_uint===should_diff_uint||!0!==c_diff:diff_uint!==should_diff_uint||!1!==c_diff,borrowError&&(console.log("ERROR borrow - ".concat(a_uint," (").concat(a_str,") - ").concat(b_uint," (").concat(b_str,") - ").concat(Number(cin)," = ").concat(diff_uint," (").concat(diff_str,") (c=").concat(c_diff,")")),failedTests++),totalTests++;const should_sum_sint=a_sint+b_sint+Number(cin);let overflowError=!1;overflowError=should_sum_sint>7||should_sum_sint<-8?sum_sint===should_sum_sint||!0!==v_sum:sum_sint!==should_sum_sint||!1!==v_sum,overflowError&&(console.log("ERROR overflow - ".concat(a_sint," (").concat(a_str,") + ").concat(b_sint," (").concat(b_str,") + ").concat(Number(cin)," = ").concat(sum_sint," (").concat(sum_str,") (v=").concat(v_sum,")")),failedTests++),totalTests++;const should_diff_sint=a_sint-b_sint-Number(cin);let overflowError2=!1;overflowError2=should_diff_sint>7||should_diff_sint<-8?diff_sint===should_diff_sint||!0!==v_diff:diff_sint!==should_diff_sint||!1!==v_diff,overflowError2&&(console.log("ERROR overflow - ".concat(a_sint," (").concat(a_str,") - ").concat(b_sint," (").concat(b_str,") - ").concat(Number(cin)," = ").concat(diff_sint," (").concat(diff_str,") (v=").concat(v_diff,")")),failedTests++),totalTests++}console.log("Tests: ".concat(totalTests," total, ").concat(failedTests," failed, ").concat(totalTests-failedTests," passed"))}};__name(Tests,"Tests");var TestsPalette=class{constructor(editor){this.editor=editor,this.testSuites=new Map,this._isDisplayingResults=!1,this._skipUpdates=!1;const s=S.Tests,testsTitleElem=div(cls("toolbar-title"),s.Title).render();editor.eventMgr.registerTitleDragListenersOn(testsTitleElem,(()=>{editor.setTestsPaletteVisible(!1)})),this.suiteContainer=div(cls("noselect"),style("width: 100%")).render(),this.scroller=div(style("width: 100%; font-size: 80%; overflow-y: auto; min-height: 28px; resize: vertical"),this.suiteContainer).render(),this.rootElem=div(cls("sim-toolbar-right"),style("display: none"),data("prev-display")("block"),testsTitleElem,this.scroller).render()}updateMaxHeight(){const maxHeight=Math.min(this.suiteContainer.clientHeight,this.editor.html.mainCanvas.clientHeight-38);this.scroller.style.maxHeight=maxHeight+"px"}setVisible(visible){setVisible(this.rootElem,visible),visible&&this.updateMaxHeight()}clearAllSuites(){this.suiteContainer.innerHTML="",this.testSuites.clear()}update(){this.clearAllSuites();const parentSuites=this.editor.editorRoot.testSuites;for(const suite of parentSuites.suites)this.addTestSuite(suite);this.editor.didLoadTests(parentSuites)}addTestSuite(testSuite){const numExisting=this.testSuites.size,ui=new TestSuiteUI(this.editor,this,testSuite);return ui.expanded=0===numExisting,this.testSuites.set(testSuite,ui),this.suiteContainer.appendChild(ui.rootElem),ui}getOrMakeUIFor(testSuite){var _a;return null!=(_a=this.testSuites.get(testSuite))?_a:this.addTestSuite(testSuite)}setDisplayingResults(){this._isDisplayingResults=!0}clearDisplayedResults(){this._isDisplayingResults&&!this._skipUpdates&&(console.log("Clearing displayed results"),this.update(),this._isDisplayingResults=!1)}async skipUpdatesWhile(f){this._skipUpdates=!0;try{return await f()}finally{this._skipUpdates=!1}}async runAllTestSuites(){for(const testSuiteUI of this.testSuites.values())await testSuiteUI.runTestCases()}};__name(TestsPalette,"TestsPalette");var TestSuiteUI=class{constructor(editor,palette,testSuite){var _a;this.editor=editor,this.palette=palette,this.testSuite=testSuite,this._expanded=!1;const s=S.Tests;this.htmlResults=testSuite.testCases.map((tc=>this.makeTestCaseUI(tc)));const runAllIcon=makeIcon("play");style("position: relative; top: -2px;").applyTo(runAllIcon),this.runTestCasesButton=span(cls("sim-mode-link"),style("flex: none; font-size: 85%; opacity: 0.9; margin: -2px 0 -2px 4px; padding: 2px 4px 0 0;"),title(s.RunTestSuite),runAllIcon,s.Run).render(),this.runTestCasesButton.addEventListener("click",(()=>this.runTestCases())),this.header=div(cls("test-suite test-disclosable expanded"),style("display: flex"),span(style("flex: auto"),null!=(_a=testSuite.name)?_a:s.DefaultTestSuiteName),this.runTestCasesButton).render(),this.content=div(cls("test-cases"),style("display: block"),...this.htmlResults.map((p=>p.container))).render(),this.header.addEventListener("click",(e=>{e.target===this.header&&(this.expanded=!this.expanded)})),this.rootElem=div(this.header,this.content).render()}makeTestCaseUI(testCase){var _a;const s=S.Tests,editButton=span(cls("sim-mode-link testcase-change-button"),style("flex: none; font-size: 80%; opacity: 0.85; margin: -1px; padding: 1px"),title(s.EditTestCaseName),makeIcon("pen")).render(),deleteButton=span(cls("sim-mode-link testcase-change-button"),style("flex: none; font-size: 80%; opacity: 0.85; margin: -1px; padding: 1px"),title(s.DeleteTestCase),makeIcon("trash")).render(),nameSpan=span(style("flex: auto"),null!=(_a=testCase.name)?_a:s.DefaultTestCaseName).render(),line=div(cls("test-disclosable testcase-button"),nameSpan,editButton,deleteButton).render(),details=div(cls("testcase-details"),style("display: none"),this.makeTestCaseDetailsTable(testCase)).render(),toggle=__name((force=>{const expanded=line.classList.toggle("expanded",force);setVisible(details,expanded),this.palette.updateMaxHeight()}),"toggle");line.addEventListener("click",(()=>{toggle()}));const container=div(cls("testcase wait"),line,details).render();return editButton.addEventListener("click",(e=>{var _a2;if(e.stopPropagation(),!UIPermissions.canModifyTestCases(this.editor))return void window.alert(S.Messages.NoPermission);const newName=window.prompt(s.EnterNewTestCaseName,null!=(_a2=testCase.name)?_a2:"");null!==newName&&0!==newName.length&&(testCase.name=newName,nameSpan.textContent=newName)})),deleteButton.addEventListener("click",(e=>{UIPermissions.canModifyTestCases(this.editor)?(this.editor.removeTestCase(testCase),e.stopPropagation()):window.alert(S.Messages.NoPermission)})),{line:line,details:details,container:container,toggle:toggle}}get expanded(){return this._expanded}set expanded(expanded){this._expanded=this.header.classList.toggle("expanded",expanded),setVisible(this.content,this._expanded),this.palette.updateMaxHeight()}async runTestCases(){const oldExpanded=this.expanded;setHidden(this.runTestCasesButton,!0);try{const testResult=await this.editor.runTestSuite(this.testSuite,{fast:!0});void 0!==testResult&&testResult.isAllPass()&&(this.expanded=oldExpanded)}finally{setHidden(this.runTestCasesButton,!1)}}setRunning(i2){this._expanded||(this.expanded=!0);const htmlResult=this.htmlResults[i2];htmlResult.container.className="testcase running",htmlResult.toggle(!0)}setResult(i2,result){const htmlResult=this.htmlResults[i2];"fail"===result._tag?(htmlResult.details.innerHTML="",htmlResult.details.appendChild(this.makeTestCaseDetailsTable(this.testSuite.testCases[i2],result))):htmlResult.toggle(),htmlResult.container.className="testcase "+result._tag,this.palette.setDisplayingResults()}makeComponentRefSpan(elem){var _a;const compStr=isString(elem)?elem:isString(elem.name)?elem.name:null!=(_a=elem.ref)?_a:"?",link=a(compStr,href("#")).render();return link.addEventListener("click",(()=>{this.editor.highlight(elem)})),link}makeTestCaseDetailsTable(testCase,failed){const s=S.Tests,tableBody=tbody().render(),ins=[...testCase.in],outs=[...testCase.out];for(let i2=0;i2<Math.max(ins.length,outs.length);i2++){const inStr=i2>=ins.length?"":mods(this.makeComponentRefSpan(ins[i2][0]),": ".concat(ins[i2][1]));let outStr="";if(i2<outs.length){const[output,expectedRepr]=outs[i2];let outValue=String(expectedRepr);if(void 0!==failed){const mismatch=failed.mismatches.find((m=>m.output===output));void 0!==mismatch&&(outValue=mods(span(cls("testcase-wrongvalue"),"".concat(reprForLogicValues(mismatch.actual,!1)))," ≠ ".concat(outValue)))}outStr=mods(this.makeComponentRefSpan(output),": ",outValue)}tr(td(inStr),td(outStr)).applyTo(tableBody)}const setTheseInputsButton=span(cls("sim-mode-link"),style("margin: 2px; padding: 3px"),title(s.SetTheseInputs),makeIcon("setinput")).render();return setTheseInputsButton.addEventListener("click",(async()=>{testCase.tryFixReferences(this.editor.components),this.palette.skipUpdatesWhile((async()=>{this.editor.trySetInputsAndRecalc(testCase.in),await this.editor.waitForPropagation()}))})),table(cls("testcase-table"),thead(tr(th(s.SetInputs,setTheseInputsButton),th(s.WantedOutputs))),tableBody).render()}};function areStatesEqual(s1,s2){return s1.hasCallbacks===s2.hasCallbacks&&s1.enablesPause===s2.enablesPause&&s1.isPaused===s2.isPaused&&s1.enablesPause===s2.enablesPause&&s1.nextStepDesc===s2.nextStepDesc}__name(TestSuiteUI,"TestSuiteUI"),__name(areStatesEqual,"areStatesEqual");var Timeline=class{constructor(editor){this.onStateChanged=__name((__=>null),"onStateChanged"),this.editor=editor,this.reset()}reset(){this._epochStart=this.unadjustedTime(),this._sortedNextCallbackTimes=[],this._schedule={},this._numCallbacksEnablingPause=0,void 0!==this._nextTimeout&&(clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0),this._fixedLogicalTime=void 0,this._pausedSince=void 0}get isPaused(){return void 0!==this._pausedSince}get nextTickDesc(){var _a;if(0===this._sortedNextCallbackTimes.length)return;const nextTime=this._sortedNextCallbackTimes[0],nextCallbacks=this._schedule[nextTime];if(1===nextCallbacks.length)return nextCallbacks[0].desc;const counts=new Map;for(const c of nextCallbacks)counts.set(c.desc,(null!=(_a=counts.get(c.desc))?_a:0)+1);return[...counts.entries()].map((_ref123=>{let[desc,count]=_ref123;return"".concat(count," × ").concat(desc)})).join("\n")}get state(){const hasCallbacks=this._sortedNextCallbackTimes.length>0,enablesPause=this._numCallbacksEnablingPause>0,isPaused=this.isPaused;return{hasCallbacks:hasCallbacks,enablesPause:enablesPause,isPaused:isPaused,nextStepDesc:isPaused&&hasCallbacks?this.nextTickDesc:void 0}}unadjustedTime(){return(new Date).getTime()}logicalTime(){return void 0!==this._fixedLogicalTime?this._fixedLogicalTime:void 0!==this._pausedSince?this._pausedSince-this._epochStart:this.unadjustedTime()-this._epochStart}hasPendingCallbacksNow(){return this._sortedNextCallbackTimes.length>0&&this._sortedNextCallbackTimes[0]<=this.logicalTime()}scheduleAt(time,callback,desc,enablesPause){const callbackRec={callback:callback,desc:desc,enablesPause:enablesPause};if(this._numCallbacksEnablingPause+=enablesPause?1:0,time in this._schedule)this._schedule[time].push(callbackRec);else{time<this.logicalTime()&&console.log("WARNING Scheduling this in the past (".concat(time-this.logicalTime()," ms), may behave strangely: ")+desc);let i2=0;for(;;){if(i2>=this._sortedNextCallbackTimes.length){this._sortedNextCallbackTimes.push(time);break}if(time<this._sortedNextCallbackTimes[i2]){this._sortedNextCallbackTimes.splice(i2,0,time);break}i2++}this._schedule[time]=[callbackRec],0===i2&&this.rescheduleNextIfNeeded()}this.fireStateChangedIfNeeded()}rescheduleNextIfNeeded(){if(0===this._sortedNextCallbackTimes.length)void 0!==this._nextTimeout&&(clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0);else{const tickTime=this._sortedNextCallbackTimes[0];if(void 0!==this._nextTimeout){if(this._nextTimeout.tickTime<=tickTime)return;clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0}const now=this.logicalTime(),handle=setTimeout((()=>this.nextTickCallback()),tickTime-now);this._nextTimeout={handle:handle,tickTime:tickTime}}}nextTickCallback(){this._nextTimeout=void 0,void 0===this._pausedSince&&this.handleNextTick()}handleNextTick(){const wantedTime=this._sortedNextCallbackTimes.shift();if(void 0===wantedTime)return;const now=this.logicalTime(),callbacks=this._schedule[wantedTime],late=now-wantedTime;late>100&&(this._epochStart+=late);const runAllCallbacks=__name((()=>{let elem;for(this._fixedLogicalTime=wantedTime;void 0!==(elem=callbacks.shift());){const{callback:callback,desc:desc,enablesPause:enablesPause}=elem;this._numCallbacksEnablingPause-=enablesPause?1:0;try{callback()}catch(err){console.log("ERROR running callback '".concat(desc,"': ")+err)}}this._fixedLogicalTime=void 0}),"runAllCallbacks");this.editor.wrapHandler(runAllCallbacks)(),delete this._schedule[wantedTime],this.rescheduleNextIfNeeded(),this.fireStateChangedIfNeeded()}pause(){void 0===this._pausedSince&&(void 0!==this._nextTimeout&&(clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0),this._pausedSince=this.unadjustedTime(),this.fireStateChangedIfNeeded())}play(){void 0!==this._pausedSince&&(this._epochStart+=this.unadjustedTime()-this._pausedSince,this._pausedSince=void 0,this.editor.editTools.redrawMgr.requestRedraw({why:"timeline-play",invalidateTests:!0}),this.rescheduleNextIfNeeded(),this.fireStateChangedIfNeeded())}step(){if(void 0===this._pausedSince||0===this._sortedNextCallbackTimes.length)return;const nextTickTime=this._sortedNextCallbackTimes[0],currentPauseTime=this.logicalTime();this._epochStart-=nextTickTime-currentPauseTime,this.handleNextTick(),this.fireStateChangedIfNeeded()}fireStateChangedIfNeeded(){const newState=this.state;void 0!==this._lastSentState&&areStatesEqual(this._lastSentState,newState)||(this.onStateChanged(newState),this._lastSentState=newState)}};__name(Timeline,"Timeline");var TopBar=class{constructor(editor){this.editor=editor,this._showingCompactUI=!1,this._showingCircuitName=!1,this._customComponentShown=void 0,this._showingTimelineUI=!1;const s=S.TopBar;this.alwaysShowCircuitName=editor.isSingleton,this.dirtyIndicator=this.makeLabel(mods(style("margin: 3px 3px 0 -2px; font-size: 20pt"),"•",title(s.DirtyTooltip))),this.circuitNameLabel=this.makeLink(mods("",title(s.CircuitNameTooltip)),this.runSetCircuitNameDialog.bind(this)),this.mainCircuitTab=this.makeTab(this.circuitNameLabel),this.customComponentChevron=this.makeLabel("❯"),this.customComponentChevron.style.fontSize="14pt",this.customComponentNameLabel=this.makeLink(mods("",title(s.CustomComponentCaptionTooltip)),this.runSetCustomComponentCaptionDialog.bind(this)),this.customComponentNameLabel.style.fontWeight="bolder",this.closeCustomComponentButton=this.makeButton("close",s.CloseCircuit,(()=>editor.tryCloseCustomComponentEditor())),this.closeCustomComponentButton.style.padding="0",this.customComponentTab=this.makeTab(this.closeCustomComponentButton,this.customComponentNameLabel),this.circuitNameGroup=div(cls("path"),style("flex: none; display: flex; align-items: stretch; margin: -3px 0 -3px -5px; padding: 3px 5px"),this.dirtyIndicator,this.mainCircuitTab,this.customComponentChevron,this.customComponentTab).render(),this.undoButton=this.makeButtonWithLabel("undo",s.Undo,(()=>this.editor.editTools.undoMgr.undo())),this.redoButton=this.makeButtonWithLabel("redo",s.Redo,(()=>this.editor.editTools.undoMgr.redoOrRepeat())),this.resetButton=this.makeButtonWithLabel("reset",s.Reset,(()=>this.editor.resetCircuit())),this.openButton=this.makeButtonWithLabel("open",s.Open,this.openHandler.bind(this)),this.loadFromBrowserButton=this.makeButtonWithLabel("browserload",s.Restore,this.loadFromBrowserHandler.bind(this)),this.downloadButton=this.makeButtonWithLabel("download",s.Download,this.saveHandler.bind(this)),this.screenshotButton=this.makeButtonWithLabel("screenshot",s.Screenshot,this.screenshotHandler.bind(this)),this.timelineButtonSep=this.makeSep(),this.pauseButton=this.makeButtonWithLabel("pause",s.TimelinePause,(()=>this.editor.timeline.pause())),this.playButton=this.makeButtonWithLabel("play",s.TimelinePlay,(()=>this.editor.timeline.play())),this.stepButton=this.makeButtonWithLabel("step",s.TimelineStep,(()=>this.editor.timeline.step())),this.timeLabel=this.makeLabel(s.TimeLabel+"0"),this.timeLabel.style.fontSize="8pt",this.designButton=this.makeButtonWithLabel("mouse",s.Design,(()=>this.editor.setCurrentPointerAction("edit"))),this.deleteButton=this.makeButtonWithLabel("trash",s.Delete,(()=>this.editor.setCurrentPointerAction("delete"))),this.testsButton=this.makeButtonWithLabel("check",s.Tests,(()=>this.editor.setTestsPaletteVisible(!this.testsButton.classList.contains("active")))),this.flexibleSep=div(style("flex: auto")).render(),this.moveButton=this.makeButton("move",s.Move[1],(()=>this.editor.setCurrentPointerAction("move"))),this.zoomLevelInput=input(type("number"),style("margin: 0 2px 0 0; width: 4em; background-color: inherit;"),attr("min","0"),attr("step","10"),attr("value",String(editor.options.zoom)),attr("title",S.Settings.zoomLevel)).render(),this.zoomLevelInput.addEventListener("change",editor.wrapHandler(this.zoomLevelHandler.bind(this)));const zoomControl=this.makeLabel(mods(this.zoomLevelInput,S.Settings.zoomLevelField[1]));this.root=div(cls("topBar"),style("flex:none; height: 30px; padding: 3px 5px; display: flex; align-items: stretch;"),this.circuitNameGroup,this.undoButton,this.redoButton,this.makeSep(),this.resetButton,this.makeSep(),this.openButton,this.editor.autosave?this.loadFromBrowserButton:emptyMod,this.downloadButton,this.screenshotButton,this.timelineButtonSep,this.pauseButton,this.playButton,this.stepButton,this.timeLabel,this.makeSep(!0),this.designButton,this.deleteButton,this.makeSep(),this.testsButton,this.flexibleSep,this.moveButton,zoomControl).render(),editor.html.centerCol.insertAdjacentElement("afterbegin",this.root);const undoMgr=editor.editTools.undoMgr;undoMgr.onStateChanged=newState=>this.setUndoButtonsEnabled(newState),this.setUndoButtonsEnabled(undoMgr.state),editor.timeline.onStateChanged=newState=>this.setTimelineButtonsVisible(newState),this.setTimelineButtonsVisible(editor.timeline.state),this.setDirty(!1),this.setEditingCustomComponent(void 0),this.setCircuitName(editor.documentDisplayName),this.updateCompactMode()}runSetCircuitNameDialog(){var _a;const currentValue=null!=(_a=this.editor.options.name)?_a:"",newName=window.prompt(S.TopBar.SetCircuitName,currentValue);null!==newName&&newName!==currentValue&&(this.editor.setCircuitName(newName),this.editor.editTools.undoMgr.takeSnapshot())}runSetCustomComponentCaptionDialog(){void 0!==this._customComponentShown&&this.editor.factory.runChangeCustomComponentCaptionDialog(this._customComponentShown)}openHandler(){this.editor.runFileChooser("text/plain|image/png|application/json|application/json5",(file=>{this.editor.tryLoadFrom(file)}))}loadFromBrowserHandler(){this.editor.tryLoadFromLocalStorage()}saveHandler(e){e.altKey&&this.editor.factory.hasCustomComponents()?Serialization.saveLibraryToFile(this.editor):Serialization.saveCircuitToFile(this.editor)}screenshotHandler(e){const editor=this.editor;e.altKey?editor.download(editor.toSVG(!0),".svg"):editor.download(editor.toPNG(!0),".png")}zoomLevelHandler(){const zoom=this.zoomLevelInput.valueAsNumber,validatedZoom=this.editor.setZoom(zoom,!1);validatedZoom!==zoom&&this.setZoom(validatedZoom)}updateCompactMode(){const getSepWidth=__name((()=>this.flexibleSep.getBoundingClientRect().width),"getSepWidth"),sepWidth=getSepWidth();this._showingCompactUI?sepWidth>5&&(this.root.classList.remove("compact"),getSepWidth()<=5?this.root.classList.add("compact"):this._showingCompactUI=!1):sepWidth<=5&&(this._showingCompactUI=!0,this.root.classList.add("compact"))}getActiveTabCoords(){const rect=(void 0!==this._customComponentShown?this.customComponentTab:this.mainCircuitTab).getBoundingClientRect();return[rect.left,rect.right]}setButtonStateFromMode(state,mode){setDisplay(this.root,state.showComponentsAndEditControls),setVisible(this.resetButton,state.showReset);const showUndoRedo=mode>=2;setVisible(this.undoButton,showUndoRedo),setVisible(this.redoButton,showUndoRedo);const showToolButtons="show"===state.showComponentsAndEditControls;setVisible(this.designButton,showToolButtons),setVisible(this.deleteButton,showToolButtons),setVisible(this.moveButton,showToolButtons),this.updateCompactMode()}setCircuitName(name2){let show=!0;void 0!==name2?this.circuitNameLabel.textContent=name2:this.alwaysShowCircuitName?this.circuitNameLabel.textContent=this.editor.documentDisplayName:(show=!1,this.circuitNameLabel.textContent=""),this._showingCircuitName=show,setVisible(this.circuitNameLabel,show),setVisible(this.dirtyIndicator,show),this.updateCircuitNameUI()}updateCircuitNameUI(){setVisible(this.circuitNameGroup,this._showingCircuitName||void 0!==this._customComponentShown),this.updateCompactMode()}setZoom(zoom){this.zoomLevelInput.value=String(zoom)}setDirty(dirty){this.dirtyIndicator.style.visibility=dirty?"inherit":"hidden",setEnabled(this.resetButton,dirty)}setEditingCustomComponent(customDef){const showSubcircuitUI=void 0!==customDef;setVisible(this.customComponentChevron,showSubcircuitUI),setVisible(this.customComponentTab,showSubcircuitUI),setActive(this.mainCircuitTab,!showSubcircuitUI),setActive(this.customComponentTab,showSubcircuitUI),showSubcircuitUI?(this.circuitNameLabel.style.removeProperty("font-weight"),this.customComponentNameLabel.textContent=customDef.caption):(this.circuitNameLabel.style.fontWeight="bolder",this.customComponentNameLabel.textContent=""),this._customComponentShown=customDef,this.updateCircuitNameUI()}updateCustomComponentCaption(){void 0!==this._customComponentShown&&(this.customComponentNameLabel.textContent=this._customComponentShown.caption,this.updateCompactMode())}setTimelineButtonsVisible(_ref124){let{enablesPause:enablesPause,hasCallbacks:hasCallbacks,isPaused:isPaused,nextStepDesc:nextStepDesc}=_ref124;const showTimelineUI=enablesPause||this.editor.options.allowPausePropagation&&hasCallbacks;this._showingTimelineUI=showTimelineUI,showTimelineUI?(setVisible(this.timelineButtonSep,!0),setVisible(this.playButton,isPaused),setVisible(this.pauseButton,!isPaused),setVisible(this.stepButton,void 0!==nextStepDesc),this.stepButton.title=S.TopBar.TimelineStep[1]+"\n"+(null!=nextStepDesc?nextStepDesc:""),setVisible(this.timeLabel,isPaused),this.updateTimeLabelIfNeeded()):(setVisible(this.timelineButtonSep,!1),setVisible(this.playButton,!1),setVisible(this.pauseButton,!1),setVisible(this.stepButton,!1),setVisible(this.timeLabel,!1)),this.updateCompactMode()}setUndoButtonsEnabled(_ref125){let{canUndo:canUndo,canRedoOrRepeat:canRedoOrRepeat}=_ref125;setEnabled(this.undoButton,canUndo),setEnabled(this.redoButton,canRedoOrRepeat)}updateTimeLabelIfNeeded(){if(!this._showingTimelineUI)return;const t38=this.editor.timeline.logicalTime(),ms=t38%1e3,s=Math.floor(t38/1e3)%60,m=Math.floor(t38/6e4)%60,h=Math.floor(t38/36e5);this.timeLabel.textContent=S.TopBar.TimeLabel+(0===h?"":h+":")+(m<10?"0"+m:m)+":"+(s<10?"0"+s:s)+"."+(ms<100?ms<10?"00":"0":"")+ms}updateActiveTool(tool){setActive(this.designButton,"edit"===tool),setActive(this.deleteButton,"delete"===tool),setActive(this.moveButton,"move"===tool)}updateTestPaletteVisible(visible){this.testsButton.classList.toggle("active",visible)}setTestPaletteButtonVisible(numHint){const visible=0!==numHint;if(visible){const newCaption=numHint>0?S.TopBar.Tests[0]+" (".concat(numHint,")"):S.TopBar.Tests[0];this.setCaption(this.testsButton,newCaption)}setVisible(this.testsButton,visible)}makeTab(){for(var _len6=arguments.length,modifiers=new Array(_len6),_key6=0;_key6<_len6;_key6++)modifiers[_key6]=arguments[_key6];return div(cls("barTab"),...modifiers).render()}makeButtonWithLabel(icon,labelTooltip,handler){return this.makeButton(icon,labelTooltip[1],handler,labelTooltip[0])}makeButton(icon,tooltip,handler,label2){const labelSpan=void 0===label2?emptyMod:span(cls("btnLabel"),label2),but=button(i(cls("svgicon"),raw(inlineIconSvgFor(icon))),title(tooltip),labelSpan).render();return but.addEventListener("click",this.editor.wrapHandler(handler)),but}makeLabel(label2){return span(cls("barLabel"),label2).render()}makeLink(label2,handler){const link=a(cls("barLabel"),label2).render();return link.addEventListener("click",this.editor.wrapHandler(handler)),link}makeSep(){return div(cls(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"sep fat":"sep")).render()}setCaption(button2,caption){const label2=button2.querySelector(".btnLabel");null!==label2&&(label2.textContent=caption)}};__name(TopBar,"TopBar");var top="top",bottom="bottom",right="right",left="left",basePlacements=[top,bottom,right,left],variationPlacements=basePlacements.reduce((function(acc,placement){return acc.concat([placement+"-start",placement+"-end"])}),[]),placements=[].concat(basePlacements,["auto"]).reduce((function(acc,placement){return acc.concat([placement,placement+"-start",placement+"-end"])}),[]),modifierPhases=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function getNodeName(element){return element?(element.nodeName||"").toLowerCase():null}function getWindow(node){if(null==node)return window;if("[object Window]"!==node.toString()){var ownerDocument=node.ownerDocument;return ownerDocument&&ownerDocument.defaultView||window}return node}function isElement(node){return node instanceof getWindow(node).Element||node instanceof Element}function isHTMLElement(node){return node instanceof getWindow(node).HTMLElement||node instanceof HTMLElement}function isShadowRoot(node){return"undefined"!=typeof ShadowRoot&&(node instanceof getWindow(node).ShadowRoot||node instanceof ShadowRoot)}function applyStyles(_ref){var state=_ref.state;Object.keys(state.elements).forEach((function(name2){var style2=state.styles[name2]||{},attributes=state.attributes[name2]||{},element=state.elements[name2];isHTMLElement(element)&&getNodeName(element)&&(Object.assign(element.style,style2),Object.keys(attributes).forEach((function(name3){var value=attributes[name3];!1===value?element.removeAttribute(name3):element.setAttribute(name3,!0===value?"":value)})))}))}function effect(_ref2){var state=_ref2.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow),function(){Object.keys(state.elements).forEach((function(name2){var element=state.elements[name2],attributes=state.attributes[name2]||{},style2=Object.keys(state.styles.hasOwnProperty(name2)?state.styles[name2]:initialStyles[name2]).reduce((function(style3,property){return style3[property]="",style3}),{});isHTMLElement(element)&&getNodeName(element)&&(Object.assign(element.style,style2),Object.keys(attributes).forEach((function(attribute){element.removeAttribute(attribute)})))}))}}__name(getNodeName,"getNodeName"),__name(getWindow,"getWindow"),__name(isElement,"isElement"),__name(isHTMLElement,"isHTMLElement"),__name(isShadowRoot,"isShadowRoot"),__name(applyStyles,"applyStyles"),__name(effect,"effect");var applyStyles_default={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect,requires:["computeStyles"]};function getBasePlacement(placement){return placement.split("-")[0]}function getBoundingClientRect(element){var rect=element.getBoundingClientRect();return{width:rect.width,height:rect.height,top:rect.top,right:rect.right,bottom:rect.bottom,left:rect.left,x:rect.left,y:rect.top}}function getLayoutRect(element){var clientRect=getBoundingClientRect(element),width=element.offsetWidth,height=element.offsetHeight;return Math.abs(clientRect.width-width)<=1&&(width=clientRect.width),Math.abs(clientRect.height-height)<=1&&(height=clientRect.height),{x:element.offsetLeft,y:element.offsetTop,width:width,height:height}}function contains(parent,child){var rootNode=child.getRootNode&&child.getRootNode();if(parent.contains(child))return!0;if(rootNode&&isShadowRoot(rootNode)){var next=child;do{if(next&&parent.isSameNode(next))return!0;next=next.parentNode||next.host}while(next)}return!1}function getComputedStyle2(element){return getWindow(element).getComputedStyle(element)}function isTableElement(element){return["table","td","th"].indexOf(getNodeName(element))>=0}function getDocumentElement(element){return((isElement(element)?element.ownerDocument:element.document)||window.document).documentElement}function getParentNode(element){return"html"===getNodeName(element)?element:element.assignedSlot||element.parentNode||(isShadowRoot(element)?element.host:null)||getDocumentElement(element)}function getTrueOffsetParent(element){return isHTMLElement(element)&&"fixed"!==getComputedStyle2(element).position?element.offsetParent:null}function getContainingBlock(element){for(var isFirefox=-1!==navigator.userAgent.toLowerCase().indexOf("firefox"),currentNode=getParentNode(element);isHTMLElement(currentNode)&&["html","body"].indexOf(getNodeName(currentNode))<0;){var css=getComputedStyle2(currentNode);if("none"!==css.transform||"none"!==css.perspective||"paint"===css.contain||-1!==["transform","perspective"].indexOf(css.willChange)||isFirefox&&"filter"===css.willChange||isFirefox&&css.filter&&"none"!==css.filter)return currentNode;currentNode=currentNode.parentNode}return null}function getOffsetParent(element){for(var window2=getWindow(element),offsetParent=getTrueOffsetParent(element);offsetParent&&isTableElement(offsetParent)&&"static"===getComputedStyle2(offsetParent).position;)offsetParent=getTrueOffsetParent(offsetParent);return offsetParent&&("html"===getNodeName(offsetParent)||"body"===getNodeName(offsetParent)&&"static"===getComputedStyle2(offsetParent).position)?window2:offsetParent||getContainingBlock(element)||window2}function getMainAxisFromPlacement(placement){return["top","bottom"].indexOf(placement)>=0?"x":"y"}__name(getBasePlacement,"getBasePlacement"),__name(getBoundingClientRect,"getBoundingClientRect"),__name(getLayoutRect,"getLayoutRect"),__name(contains,"contains"),__name(getComputedStyle2,"getComputedStyle"),__name(isTableElement,"isTableElement"),__name(getDocumentElement,"getDocumentElement"),__name(getParentNode,"getParentNode"),__name(getTrueOffsetParent,"getTrueOffsetParent"),__name(getContainingBlock,"getContainingBlock"),__name(getOffsetParent,"getOffsetParent"),__name(getMainAxisFromPlacement,"getMainAxisFromPlacement");var max2=Math.max,min2=Math.min,round=Math.round;function within(min3,value,max3){return max2(min3,min2(value,max3))}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(paddingObject){return Object.assign({},{top:0,right:0,bottom:0,left:0},paddingObject)}function expandToHashMap(value,keys){return keys.reduce((function(hashMap,key){return hashMap[key]=value,hashMap}),{})}__name(within,"within"),__name(getFreshSideObject,"getFreshSideObject"),__name(mergePaddingObject,"mergePaddingObject"),__name(expandToHashMap,"expandToHashMap");var toPaddingObject=__name((function(padding,state){return mergePaddingObject("number"!=typeof(padding="function"==typeof padding?padding(Object.assign({},state.rects,{placement:state.placement})):padding)?padding:expandToHashMap(padding,basePlacements))}),"toPaddingObject");function arrow(_ref){var _state$modifiersData$,state=_ref.state,name2=_ref.name,options=_ref.options,arrowElement=state.elements.arrow,popperOffsets2=state.modifiersData.popperOffsets,basePlacement=getBasePlacement(state.placement),axis=getMainAxisFromPlacement(basePlacement),len=[left,right].indexOf(basePlacement)>=0?"height":"width";if(arrowElement&&popperOffsets2){var paddingObject=toPaddingObject(options.padding,state),arrowRect=getLayoutRect(arrowElement),minProp="y"===axis?top:left,maxProp="y"===axis?bottom:right,endDiff=state.rects.reference[len]+state.rects.reference[axis]-popperOffsets2[axis]-state.rects.popper[len],startDiff=popperOffsets2[axis]-state.rects.reference[axis],arrowOffsetParent=getOffsetParent(arrowElement),clientSize=arrowOffsetParent?"y"===axis?arrowOffsetParent.clientHeight||0:arrowOffsetParent.clientWidth||0:0,centerToReference=endDiff/2-startDiff/2,min3=paddingObject[minProp],max3=clientSize-arrowRect[len]-paddingObject[maxProp],center=clientSize/2-arrowRect[len]/2+centerToReference,offset2=within(min3,center,max3),axisProp=axis;state.modifiersData[name2]=((_state$modifiersData$={})[axisProp]=offset2,_state$modifiersData$.centerOffset=offset2-center,_state$modifiersData$)}}function effect2(_ref2){var state=_ref2.state,_options$element=_ref2.options.element,arrowElement=void 0===_options$element?"[data-popper-arrow]":_options$element;null!=arrowElement&&("string"!=typeof arrowElement||(arrowElement=state.elements.popper.querySelector(arrowElement)))&&(isHTMLElement(arrowElement)||console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).',"To use an SVG arrow, wrap it in an HTMLElement that will be used as","the arrow."].join(" ")),contains(state.elements.popper,arrowElement)?state.elements.arrow=arrowElement:console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper',"element."].join(" ")))}__name(arrow,"arrow"),__name(effect2,"effect");var arrow_default={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect2,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(_ref){var x=_ref.x,y=_ref.y,dpr=window.devicePixelRatio||1;return{x:round(round(x*dpr)/dpr)||0,y:round(round(y*dpr)/dpr)||0}}function mapToStyles(_ref2){var _Object$assign2,popper2=_ref2.popper,popperRect=_ref2.popperRect,placement=_ref2.placement,offsets=_ref2.offsets,position=_ref2.position,gpuAcceleration=_ref2.gpuAcceleration,adaptive=_ref2.adaptive,roundOffsets=_ref2.roundOffsets,_ref3=!0===roundOffsets?roundOffsetsByDPR(offsets):"function"==typeof roundOffsets?roundOffsets(offsets):offsets,_ref3$x=_ref3.x,x=void 0===_ref3$x?0:_ref3$x,_ref3$y=_ref3.y,y=void 0===_ref3$y?0:_ref3$y,hasX=offsets.hasOwnProperty("x"),hasY=offsets.hasOwnProperty("y"),sideX=left,sideY=top,win=window;if(adaptive){var offsetParent=getOffsetParent(popper2),heightProp="clientHeight",widthProp="clientWidth";offsetParent===getWindow(popper2)&&"static"!==getComputedStyle2(offsetParent=getDocumentElement(popper2)).position&&(heightProp="scrollHeight",widthProp="scrollWidth"),offsetParent=offsetParent,placement===top&&(sideY=bottom,y-=offsetParent[heightProp]-popperRect.height,y*=gpuAcceleration?1:-1),placement===left&&(sideX=right,x-=offsetParent[widthProp]-popperRect.width,x*=gpuAcceleration?1:-1)}var _Object$assign,commonStyles=Object.assign({position:position},adaptive&&unsetSides);return gpuAcceleration?Object.assign({},commonStyles,((_Object$assign={})[sideY]=hasY?"0":"",_Object$assign[sideX]=hasX?"0":"",_Object$assign.transform=(win.devicePixelRatio||1)<2?"translate("+x+"px, "+y+"px)":"translate3d("+x+"px, "+y+"px, 0)",_Object$assign)):Object.assign({},commonStyles,((_Object$assign2={})[sideY]=hasY?y+"px":"",_Object$assign2[sideX]=hasX?x+"px":"",_Object$assign2.transform="",_Object$assign2))}function computeStyles(_ref4){var state=_ref4.state,options=_ref4.options,_options$gpuAccelerat=options.gpuAcceleration,gpuAcceleration=void 0===_options$gpuAccelerat||_options$gpuAccelerat,_options$adaptive=options.adaptive,adaptive=void 0===_options$adaptive||_options$adaptive,_options$roundOffsets=options.roundOffsets,roundOffsets=void 0===_options$roundOffsets||_options$roundOffsets,transitionProperty=getComputedStyle2(state.elements.popper).transitionProperty||"";adaptive&&["transform","top","right","bottom","left"].some((function(property){return transitionProperty.indexOf(property)>=0}))&&console.warn(["Popper: Detected CSS transitions on at least one of the following",'CSS properties: "transform", "top", "right", "bottom", "left".',"\n\n",'Disable the "computeStyles" modifier\'s `adaptive` option to allow',"for smooth transitions, or remove these properties from the CSS","transition declaration on the popper element if only transitioning","opacity or background-color for example.","\n\n","We recommend using the popper element as a wrapper around an inner","element that can have any CSS property transitioned for animations."].join(" "));var commonStyles={placement:getBasePlacement(state.placement),popper:state.elements.popper,popperRect:state.rects.popper,gpuAcceleration:gpuAcceleration};null!=state.modifiersData.popperOffsets&&(state.styles.popper=Object.assign({},state.styles.popper,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.popperOffsets,position:state.options.strategy,adaptive:adaptive,roundOffsets:roundOffsets})))),null!=state.modifiersData.arrow&&(state.styles.arrow=Object.assign({},state.styles.arrow,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:roundOffsets})))),state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-placement":state.placement})}__name(roundOffsetsByDPR,"roundOffsetsByDPR"),__name(mapToStyles,"mapToStyles"),__name(computeStyles,"computeStyles");var computeStyles_default={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}},passive={passive:!0};function effect3(_ref){var state=_ref.state,instance=_ref.instance,options=_ref.options,_options$scroll=options.scroll,scroll=void 0===_options$scroll||_options$scroll,_options$resize=options.resize,resize=void 0===_options$resize||_options$resize,window2=getWindow(state.elements.popper),scrollParents=[].concat(state.scrollParents.reference,state.scrollParents.popper);return scroll&&scrollParents.forEach((function(scrollParent){scrollParent.addEventListener("scroll",instance.update,passive)})),resize&&window2.addEventListener("resize",instance.update,passive),function(){scroll&&scrollParents.forEach((function(scrollParent){scrollParent.removeEventListener("scroll",instance.update,passive)})),resize&&window2.removeEventListener("resize",instance.update,passive)}}__name(effect3,"effect");var eventListeners_default={name:"eventListeners",enabled:!0,phase:"write",fn:__name((function(){}),"fn"),effect:effect3,data:{}},hash={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(placement){return placement.replace(/left|right|bottom|top/g,(function(matched){return hash[matched]}))}__name(getOppositePlacement,"getOppositePlacement");var hash2={start:"end",end:"start"};function getOppositeVariationPlacement(placement){return placement.replace(/start|end/g,(function(matched){return hash2[matched]}))}function getWindowScroll(node){var win=getWindow(node);return{scrollLeft:win.pageXOffset,scrollTop:win.pageYOffset}}function getWindowScrollBarX(element){return getBoundingClientRect(getDocumentElement(element)).left+getWindowScroll(element).scrollLeft}function getViewportRect(element){var win=getWindow(element),html=getDocumentElement(element),visualViewport=win.visualViewport,width=html.clientWidth,height=html.clientHeight,x=0,y=0;return visualViewport&&(width=visualViewport.width,height=visualViewport.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(x=visualViewport.offsetLeft,y=visualViewport.offsetTop)),{width:width,height:height,x:x+getWindowScrollBarX(element),y:y}}function getDocumentRect(element){var _element$ownerDocumen,html=getDocumentElement(element),winScroll=getWindowScroll(element),body=null==(_element$ownerDocumen=element.ownerDocument)?void 0:_element$ownerDocumen.body,width=max2(html.scrollWidth,html.clientWidth,body?body.scrollWidth:0,body?body.clientWidth:0),height=max2(html.scrollHeight,html.clientHeight,body?body.scrollHeight:0,body?body.clientHeight:0),x=-winScroll.scrollLeft+getWindowScrollBarX(element),y=-winScroll.scrollTop;return"rtl"===getComputedStyle2(body||html).direction&&(x+=max2(html.clientWidth,body?body.clientWidth:0)-width),{width:width,height:height,x:x,y:y}}function isScrollParent(element){var _getComputedStyle=getComputedStyle2(element),overflow=_getComputedStyle.overflow,overflowX=_getComputedStyle.overflowX,overflowY=_getComputedStyle.overflowY;return/auto|scroll|overlay|hidden/.test(overflow+overflowY+overflowX)}function getScrollParent2(node){return["html","body","#document"].indexOf(getNodeName(node))>=0?node.ownerDocument.body:isHTMLElement(node)&&isScrollParent(node)?node:getScrollParent2(getParentNode(node))}function listScrollParents(element,list){var _element$ownerDocumen;void 0===list&&(list=[]);var scrollParent=getScrollParent2(element),isBody=scrollParent===(null==(_element$ownerDocumen=element.ownerDocument)?void 0:_element$ownerDocumen.body),win=getWindow(scrollParent),target2=isBody?[win].concat(win.visualViewport||[],isScrollParent(scrollParent)?scrollParent:[]):scrollParent,updatedList=list.concat(target2);return isBody?updatedList:updatedList.concat(listScrollParents(getParentNode(target2)))}function rectToClientRect(rect){return Object.assign({},rect,{left:rect.x,top:rect.y,right:rect.x+rect.width,bottom:rect.y+rect.height})}function getInnerBoundingClientRect(element){var rect=getBoundingClientRect(element);return rect.top=rect.top+element.clientTop,rect.left=rect.left+element.clientLeft,rect.bottom=rect.top+element.clientHeight,rect.right=rect.left+element.clientWidth,rect.width=element.clientWidth,rect.height=element.clientHeight,rect.x=rect.left,rect.y=rect.top,rect}function getClientRectFromMixedType(element,clippingParent){return"viewport"===clippingParent?rectToClientRect(getViewportRect(element)):isHTMLElement(clippingParent)?getInnerBoundingClientRect(clippingParent):rectToClientRect(getDocumentRect(getDocumentElement(element)))}function getClippingParents(element){var clippingParents2=listScrollParents(getParentNode(element)),clipperElement=["absolute","fixed"].indexOf(getComputedStyle2(element).position)>=0&&isHTMLElement(element)?getOffsetParent(element):element;return isElement(clipperElement)?clippingParents2.filter((function(clippingParent){return isElement(clippingParent)&&contains(clippingParent,clipperElement)&&"body"!==getNodeName(clippingParent)})):[]}function getClippingRect(element,boundary,rootBoundary){var mainClippingParents="clippingParents"===boundary?getClippingParents(element):[].concat(boundary),clippingParents2=[].concat(mainClippingParents,[rootBoundary]),firstClippingParent=clippingParents2[0],clippingRect=clippingParents2.reduce((function(accRect,clippingParent){var rect=getClientRectFromMixedType(element,clippingParent);return accRect.top=max2(rect.top,accRect.top),accRect.right=min2(rect.right,accRect.right),accRect.bottom=min2(rect.bottom,accRect.bottom),accRect.left=max2(rect.left,accRect.left),accRect}),getClientRectFromMixedType(element,firstClippingParent));return clippingRect.width=clippingRect.right-clippingRect.left,clippingRect.height=clippingRect.bottom-clippingRect.top,clippingRect.x=clippingRect.left,clippingRect.y=clippingRect.top,clippingRect}function getVariation(placement){return placement.split("-")[1]}function computeOffsets(_ref){var offsets,reference2=_ref.reference,element=_ref.element,placement=_ref.placement,basePlacement=placement?getBasePlacement(placement):null,variation=placement?getVariation(placement):null,commonX=reference2.x+reference2.width/2-element.width/2,commonY=reference2.y+reference2.height/2-element.height/2;switch(basePlacement){case top:offsets={x:commonX,y:reference2.y-element.height};break;case bottom:offsets={x:commonX,y:reference2.y+reference2.height};break;case right:offsets={x:reference2.x+reference2.width,y:commonY};break;case left:offsets={x:reference2.x-element.width,y:commonY};break;default:offsets={x:reference2.x,y:reference2.y}}var mainAxis=basePlacement?getMainAxisFromPlacement(basePlacement):null;if(null!=mainAxis){var len="y"===mainAxis?"height":"width";switch(variation){case"start":offsets[mainAxis]=offsets[mainAxis]-(reference2[len]/2-element[len]/2);break;case"end":offsets[mainAxis]=offsets[mainAxis]+(reference2[len]/2-element[len]/2)}}return offsets}function detectOverflow(state,options){void 0===options&&(options={});var _options=options,_options$placement=_options.placement,placement=void 0===_options$placement?state.placement:_options$placement,_options$boundary=_options.boundary,boundary=void 0===_options$boundary?"clippingParents":_options$boundary,_options$rootBoundary=_options.rootBoundary,rootBoundary=void 0===_options$rootBoundary?"viewport":_options$rootBoundary,_options$elementConte=_options.elementContext,elementContext=void 0===_options$elementConte?"popper":_options$elementConte,_options$altBoundary=_options.altBoundary,altBoundary=void 0!==_options$altBoundary&&_options$altBoundary,_options$padding=_options.padding,padding=void 0===_options$padding?0:_options$padding,paddingObject=mergePaddingObject("number"!=typeof padding?padding:expandToHashMap(padding,basePlacements)),altContext="popper"===elementContext?"reference":"popper",referenceElement=state.elements.reference,popperRect=state.rects.popper,element=state.elements[altBoundary?altContext:elementContext],clippingClientRect=getClippingRect(isElement(element)?element:element.contextElement||getDocumentElement(state.elements.popper),boundary,rootBoundary),referenceClientRect=getBoundingClientRect(referenceElement),popperOffsets2=computeOffsets({reference:referenceClientRect,element:popperRect,strategy:"absolute",placement:placement}),popperClientRect=rectToClientRect(Object.assign({},popperRect,popperOffsets2)),elementClientRect="popper"===elementContext?popperClientRect:referenceClientRect,overflowOffsets={top:clippingClientRect.top-elementClientRect.top+paddingObject.top,bottom:elementClientRect.bottom-clippingClientRect.bottom+paddingObject.bottom,left:clippingClientRect.left-elementClientRect.left+paddingObject.left,right:elementClientRect.right-clippingClientRect.right+paddingObject.right},offsetData=state.modifiersData.offset;if("popper"===elementContext&&offsetData){var offset2=offsetData[placement];Object.keys(overflowOffsets).forEach((function(key){var multiply=[right,bottom].indexOf(key)>=0?1:-1,axis=[top,bottom].indexOf(key)>=0?"y":"x";overflowOffsets[key]+=offset2[axis]*multiply}))}return overflowOffsets}function computeAutoPlacement(state,options){void 0===options&&(options={});var _options=options,placement=_options.placement,boundary=_options.boundary,rootBoundary=_options.rootBoundary,padding=_options.padding,flipVariations=_options.flipVariations,_options$allowedAutoP=_options.allowedAutoPlacements,allowedAutoPlacements=void 0===_options$allowedAutoP?placements:_options$allowedAutoP,variation=getVariation(placement),placements2=variation?flipVariations?variationPlacements:variationPlacements.filter((function(placement2){return getVariation(placement2)===variation})):basePlacements,allowedPlacements=placements2.filter((function(placement2){return allowedAutoPlacements.indexOf(placement2)>=0}));0===allowedPlacements.length&&(allowedPlacements=placements2,console.error(["Popper: The `allowedAutoPlacements` option did not allow any","placements. Ensure the `placement` option matches the variation","of the allowed placements.",'For example, "auto" cannot be used to allow "bottom-start".','Use "auto-start" instead.'].join(" ")));var overflows=allowedPlacements.reduce((function(acc,placement2){return acc[placement2]=detectOverflow(state,{placement:placement2,boundary:boundary,rootBoundary:rootBoundary,padding:padding})[getBasePlacement(placement2)],acc}),{});return Object.keys(overflows).sort((function(a2,b2){return overflows[a2]-overflows[b2]}))}function getExpandedFallbackPlacements(placement){if("auto"===getBasePlacement(placement))return[];var oppositePlacement=getOppositePlacement(placement);return[getOppositeVariationPlacement(placement),oppositePlacement,getOppositeVariationPlacement(oppositePlacement)]}function flip(_ref){var state=_ref.state,options=_ref.options,name2=_ref.name;if(!state.modifiersData[name2]._skip){for(var _options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0===_options$altAxis||_options$altAxis,specifiedFallbackPlacements=options.fallbackPlacements,padding=options.padding,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,_options$flipVariatio=options.flipVariations,flipVariations=void 0===_options$flipVariatio||_options$flipVariatio,allowedAutoPlacements=options.allowedAutoPlacements,preferredPlacement=state.options.placement,basePlacement=getBasePlacement(preferredPlacement),fallbackPlacements=specifiedFallbackPlacements||(basePlacement===preferredPlacement||!flipVariations?[getOppositePlacement(preferredPlacement)]:getExpandedFallbackPlacements(preferredPlacement)),placements2=[preferredPlacement].concat(fallbackPlacements).reduce((function(acc,placement2){return acc.concat("auto"===getBasePlacement(placement2)?computeAutoPlacement(state,{placement:placement2,boundary:boundary,rootBoundary:rootBoundary,padding:padding,flipVariations:flipVariations,allowedAutoPlacements:allowedAutoPlacements}):placement2)}),[]),referenceRect=state.rects.reference,popperRect=state.rects.popper,checksMap=new Map,makeFallbackChecks=!0,firstFittingPlacement=placements2[0],i2=0;i2<placements2.length;i2++){var placement=placements2[i2],_basePlacement=getBasePlacement(placement),isStartVariation="start"===getVariation(placement),isVertical=[top,bottom].indexOf(_basePlacement)>=0,len=isVertical?"width":"height",overflow=detectOverflow(state,{placement:placement,boundary:boundary,rootBoundary:rootBoundary,altBoundary:altBoundary,padding:padding}),mainVariationSide=isVertical?isStartVariation?right:left:isStartVariation?bottom:top;referenceRect[len]>popperRect[len]&&(mainVariationSide=getOppositePlacement(mainVariationSide));var altVariationSide=getOppositePlacement(mainVariationSide),checks=[];if(checkMainAxis&&checks.push(overflow[_basePlacement]<=0),checkAltAxis&&checks.push(overflow[mainVariationSide]<=0,overflow[altVariationSide]<=0),checks.every((function(check){return check}))){firstFittingPlacement=placement,makeFallbackChecks=!1;break}checksMap.set(placement,checks)}if(makeFallbackChecks)for(var numberOfChecks=flipVariations?3:1,_loop=__name((function(_i2){var fittingPlacement=placements2.find((function(placement2){var checks2=checksMap.get(placement2);if(checks2)return checks2.slice(0,_i2).every((function(check){return check}))}));if(fittingPlacement)return firstFittingPlacement=fittingPlacement,"break"}),"_loop"),_i=numberOfChecks;_i>0;_i--){if("break"===_loop(_i))break}state.placement!==firstFittingPlacement&&(state.modifiersData[name2]._skip=!0,state.placement=firstFittingPlacement,state.reset=!0)}}__name(getOppositeVariationPlacement,"getOppositeVariationPlacement"),__name(getWindowScroll,"getWindowScroll"),__name(getWindowScrollBarX,"getWindowScrollBarX"),__name(getViewportRect,"getViewportRect"),__name(getDocumentRect,"getDocumentRect"),__name(isScrollParent,"isScrollParent"),__name(getScrollParent2,"getScrollParent"),__name(listScrollParents,"listScrollParents"),__name(rectToClientRect,"rectToClientRect"),__name(getInnerBoundingClientRect,"getInnerBoundingClientRect"),__name(getClientRectFromMixedType,"getClientRectFromMixedType"),__name(getClippingParents,"getClippingParents"),__name(getClippingRect,"getClippingRect"),__name(getVariation,"getVariation"),__name(computeOffsets,"computeOffsets"),__name(detectOverflow,"detectOverflow"),__name(computeAutoPlacement,"computeAutoPlacement"),__name(getExpandedFallbackPlacements,"getExpandedFallbackPlacements"),__name(flip,"flip");var flip_default={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(overflow,rect,preventedOffsets){return void 0===preventedOffsets&&(preventedOffsets={x:0,y:0}),{top:overflow.top-rect.height-preventedOffsets.y,right:overflow.right-rect.width+preventedOffsets.x,bottom:overflow.bottom-rect.height+preventedOffsets.y,left:overflow.left-rect.width-preventedOffsets.x}}function isAnySideFullyClipped(overflow){return[top,right,bottom,left].some((function(side){return overflow[side]>=0}))}function hide(_ref){var state=_ref.state,name2=_ref.name,referenceRect=state.rects.reference,popperRect=state.rects.popper,preventedOffsets=state.modifiersData.preventOverflow,referenceOverflow=detectOverflow(state,{elementContext:"reference"}),popperAltOverflow=detectOverflow(state,{altBoundary:!0}),referenceClippingOffsets=getSideOffsets(referenceOverflow,referenceRect),popperEscapeOffsets=getSideOffsets(popperAltOverflow,popperRect,preventedOffsets),isReferenceHidden=isAnySideFullyClipped(referenceClippingOffsets),hasPopperEscaped=isAnySideFullyClipped(popperEscapeOffsets);state.modifiersData[name2]={referenceClippingOffsets:referenceClippingOffsets,popperEscapeOffsets:popperEscapeOffsets,isReferenceHidden:isReferenceHidden,hasPopperEscaped:hasPopperEscaped},state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-reference-hidden":isReferenceHidden,"data-popper-escaped":hasPopperEscaped})}__name(getSideOffsets,"getSideOffsets"),__name(isAnySideFullyClipped,"isAnySideFullyClipped"),__name(hide,"hide");var hide_default={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(placement,rects,offset2){var basePlacement=getBasePlacement(placement),invertDistance=[left,top].indexOf(basePlacement)>=0?-1:1,_ref="function"==typeof offset2?offset2(Object.assign({},rects,{placement:placement})):offset2,skidding=_ref[0],distance=_ref[1];return skidding=skidding||0,distance=(distance||0)*invertDistance,[left,right].indexOf(basePlacement)>=0?{x:distance,y:skidding}:{x:skidding,y:distance}}function offset(_ref2){var state=_ref2.state,options=_ref2.options,name2=_ref2.name,_options$offset=options.offset,offset2=void 0===_options$offset?[0,0]:_options$offset,data2=placements.reduce((function(acc,placement){return acc[placement]=distanceAndSkiddingToXY(placement,state.rects,offset2),acc}),{}),_data$state$placement=data2[state.placement],x=_data$state$placement.x,y=_data$state$placement.y;null!=state.modifiersData.popperOffsets&&(state.modifiersData.popperOffsets.x+=x,state.modifiersData.popperOffsets.y+=y),state.modifiersData[name2]=data2}__name(distanceAndSkiddingToXY,"distanceAndSkiddingToXY"),__name(offset,"offset");var offset_default={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(_ref){var state=_ref.state,name2=_ref.name;state.modifiersData[name2]=computeOffsets({reference:state.rects.reference,element:state.rects.popper,strategy:"absolute",placement:state.placement})}__name(popperOffsets,"popperOffsets");var popperOffsets_default={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(axis){return"x"===axis?"y":"x"}function preventOverflow(_ref){var state=_ref.state,options=_ref.options,name2=_ref.name,_options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0!==_options$altAxis&&_options$altAxis,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,padding=options.padding,_options$tether=options.tether,tether=void 0===_options$tether||_options$tether,_options$tetherOffset=options.tetherOffset,tetherOffset=void 0===_options$tetherOffset?0:_options$tetherOffset,overflow=detectOverflow(state,{boundary:boundary,rootBoundary:rootBoundary,padding:padding,altBoundary:altBoundary}),basePlacement=getBasePlacement(state.placement),variation=getVariation(state.placement),isBasePlacement=!variation,mainAxis=getMainAxisFromPlacement(basePlacement),altAxis=getAltAxis(mainAxis),popperOffsets2=state.modifiersData.popperOffsets,referenceRect=state.rects.reference,popperRect=state.rects.popper,tetherOffsetValue="function"==typeof tetherOffset?tetherOffset(Object.assign({},state.rects,{placement:state.placement})):tetherOffset,data2={x:0,y:0};if(popperOffsets2){if(checkMainAxis||checkAltAxis){var mainSide="y"===mainAxis?top:left,altSide="y"===mainAxis?bottom:right,len="y"===mainAxis?"height":"width",offset2=popperOffsets2[mainAxis],min3=popperOffsets2[mainAxis]+overflow[mainSide],max3=popperOffsets2[mainAxis]-overflow[altSide],additive=tether?-popperRect[len]/2:0,minLen="start"===variation?referenceRect[len]:popperRect[len],maxLen="start"===variation?-popperRect[len]:-referenceRect[len],arrowElement=state.elements.arrow,arrowRect=tether&&arrowElement?getLayoutRect(arrowElement):{width:0,height:0},arrowPaddingObject=state.modifiersData["arrow#persistent"]?state.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},arrowPaddingMin=arrowPaddingObject[mainSide],arrowPaddingMax=arrowPaddingObject[altSide],arrowLen=within(0,referenceRect[len],arrowRect[len]),minOffset=isBasePlacement?referenceRect[len]/2-additive-arrowLen-arrowPaddingMin-tetherOffsetValue:minLen-arrowLen-arrowPaddingMin-tetherOffsetValue,maxOffset=isBasePlacement?-referenceRect[len]/2+additive+arrowLen+arrowPaddingMax+tetherOffsetValue:maxLen+arrowLen+arrowPaddingMax+tetherOffsetValue,arrowOffsetParent=state.elements.arrow&&getOffsetParent(state.elements.arrow),clientOffset=arrowOffsetParent?"y"===mainAxis?arrowOffsetParent.clientTop||0:arrowOffsetParent.clientLeft||0:0,offsetModifierValue=state.modifiersData.offset?state.modifiersData.offset[state.placement][mainAxis]:0,tetherMin=popperOffsets2[mainAxis]+minOffset-offsetModifierValue-clientOffset,tetherMax=popperOffsets2[mainAxis]+maxOffset-offsetModifierValue;if(checkMainAxis){var preventedOffset=within(tether?min2(min3,tetherMin):min3,offset2,tether?max2(max3,tetherMax):max3);popperOffsets2[mainAxis]=preventedOffset,data2[mainAxis]=preventedOffset-offset2}if(checkAltAxis){var _mainSide="x"===mainAxis?top:left,_altSide="x"===mainAxis?bottom:right,_offset=popperOffsets2[altAxis],_min=_offset+overflow[_mainSide],_max=_offset-overflow[_altSide],_preventedOffset=within(tether?min2(_min,tetherMin):_min,_offset,tether?max2(_max,tetherMax):_max);popperOffsets2[altAxis]=_preventedOffset,data2[altAxis]=_preventedOffset-_offset}}state.modifiersData[name2]=data2}}__name(getAltAxis,"getAltAxis"),__name(preventOverflow,"preventOverflow");var preventOverflow_default={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(element){return{scrollLeft:element.scrollLeft,scrollTop:element.scrollTop}}function getNodeScroll(node){return node!==getWindow(node)&&isHTMLElement(node)?getHTMLElementScroll(node):getWindowScroll(node)}function getCompositeRect(elementOrVirtualElement,offsetParent,isFixed){void 0===isFixed&&(isFixed=!1);var documentElement=getDocumentElement(offsetParent),rect=getBoundingClientRect(elementOrVirtualElement),isOffsetParentAnElement=isHTMLElement(offsetParent),scroll={scrollLeft:0,scrollTop:0},offsets={x:0,y:0};return(isOffsetParentAnElement||!isOffsetParentAnElement&&!isFixed)&&(("body"!==getNodeName(offsetParent)||isScrollParent(documentElement))&&(scroll=getNodeScroll(offsetParent)),isHTMLElement(offsetParent)?((offsets=getBoundingClientRect(offsetParent)).x+=offsetParent.clientLeft,offsets.y+=offsetParent.clientTop):documentElement&&(offsets.x=getWindowScrollBarX(documentElement))),{x:rect.left+scroll.scrollLeft-offsets.x,y:rect.top+scroll.scrollTop-offsets.y,width:rect.width,height:rect.height}}function order(modifiers){var map=new Map,visited=new Set,result=[];function sort(modifier){visited.add(modifier.name),[].concat(modifier.requires||[],modifier.requiresIfExists||[]).forEach((function(dep){if(!visited.has(dep)){var depModifier=map.get(dep);depModifier&&sort(depModifier)}})),result.push(modifier)}return modifiers.forEach((function(modifier){map.set(modifier.name,modifier)})),__name(sort,"sort"),modifiers.forEach((function(modifier){visited.has(modifier.name)||sort(modifier)})),result}function orderModifiers(modifiers){var orderedModifiers=order(modifiers);return modifierPhases.reduce((function(acc,phase){return acc.concat(orderedModifiers.filter((function(modifier){return modifier.phase===phase})))}),[])}function debounce(fn2){var pending;return function(){return pending||(pending=new Promise((function(resolve){Promise.resolve().then((function(){pending=void 0,resolve(fn2())}))}))),pending}}function format(str){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return[].concat(args).reduce((function(p,c){return p.replace(/%s/,c)}),str)}__name(getHTMLElementScroll,"getHTMLElementScroll"),__name(getNodeScroll,"getNodeScroll"),__name(getCompositeRect,"getCompositeRect"),__name(order,"order"),__name(orderModifiers,"orderModifiers"),__name(debounce,"debounce"),__name(format,"format");var INVALID_MODIFIER_ERROR='Popper: modifier "%s" provided an invalid %s property, expected %s but got %s',VALID_PROPERTIES=["name","enabled","phase","fn","effect","requires","options"];function validateModifiers(modifiers){modifiers.forEach((function(modifier){Object.keys(modifier).forEach((function(key){switch(key){case"name":"string"!=typeof modifier.name&&console.error(format(INVALID_MODIFIER_ERROR,String(modifier.name),'"name"','"string"','"'+String(modifier.name)+'"'));break;case"enabled":"boolean"!=typeof modifier.enabled&&console.error(format(INVALID_MODIFIER_ERROR,modifier.name,'"enabled"','"boolean"','"'+String(modifier.enabled)+'"'));case"phase":modifierPhases.indexOf(modifier.phase)<0&&console.error(format(INVALID_MODIFIER_ERROR,modifier.name,'"phase"',"either "+modifierPhases.join(", "),'"'+String(modifier.phase)+'"'));break;case"fn":"function"!=typeof modifier.fn&&console.error(format(INVALID_MODIFIER_ERROR,modifier.name,'"fn"','"function"','"'+String(modifier.fn)+'"'));break;case"effect":"function"!=typeof modifier.effect&&console.error(format(INVALID_MODIFIER_ERROR,modifier.name,'"effect"','"function"','"'+String(modifier.fn)+'"'));break;case"requires":Array.isArray(modifier.requires)||console.error(format(INVALID_MODIFIER_ERROR,modifier.name,'"requires"','"array"','"'+String(modifier.requires)+'"'));break;case"requiresIfExists":Array.isArray(modifier.requiresIfExists)||console.error(format(INVALID_MODIFIER_ERROR,modifier.name,'"requiresIfExists"','"array"','"'+String(modifier.requiresIfExists)+'"'));break;case"options":case"data":break;default:console.error('PopperJS: an invalid property has been provided to the "'+modifier.name+'" modifier, valid properties are '+VALID_PROPERTIES.map((function(s){return'"'+s+'"'})).join(", ")+'; but "'+key+'" was provided.')}modifier.requires&&modifier.requires.forEach((function(requirement){null==modifiers.find((function(mod){return mod.name===requirement}))&&console.error(format('Popper: modifier "%s" requires "%s", but "%s" modifier is not available',String(modifier.name),requirement,requirement))}))}))}))}function uniqueBy(arr,fn2){var identifiers=new Set;return arr.filter((function(item){var identifier=fn2(item);if(!identifiers.has(identifier))return identifiers.add(identifier),!0}))}function mergeByName(modifiers){var merged=modifiers.reduce((function(merged2,current){var existing=merged2[current.name];return merged2[current.name]=existing?Object.assign({},existing,current,{options:Object.assign({},existing.options,current.options),data:Object.assign({},existing.data,current.data)}):current,merged2}),{});return Object.keys(merged).map((function(key){return merged[key]}))}__name(validateModifiers,"validateModifiers"),__name(uniqueBy,"uniqueBy"),__name(mergeByName,"mergeByName");var INVALID_ELEMENT_ERROR="Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.",DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return!args.some((function(element){return!(element&&"function"==typeof element.getBoundingClientRect)}))}function popperGenerator(generatorOptions){void 0===generatorOptions&&(generatorOptions={});var _generatorOptions=generatorOptions,_generatorOptions$def=_generatorOptions.defaultModifiers,defaultModifiers2=void 0===_generatorOptions$def?[]:_generatorOptions$def,_generatorOptions$def2=_generatorOptions.defaultOptions,defaultOptions=void 0===_generatorOptions$def2?DEFAULT_OPTIONS:_generatorOptions$def2;return __name((function(reference2,popper2,options){void 0===options&&(options=defaultOptions);var state={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,defaultOptions),modifiersData:{},elements:{reference:reference2,popper:popper2},attributes:{},styles:{}},effectCleanupFns=[],isDestroyed=!1,instance={state:state,setOptions:__name((function(options2){cleanupModifierEffects(),state.options=Object.assign({},defaultOptions,state.options,options2),state.scrollParents={reference:isElement(reference2)?listScrollParents(reference2):reference2.contextElement?listScrollParents(reference2.contextElement):[],popper:listScrollParents(popper2)};var orderedModifiers=orderModifiers(mergeByName([].concat(defaultModifiers2,state.options.modifiers)));state.orderedModifiers=orderedModifiers.filter((function(m){return m.enabled})),validateModifiers(uniqueBy([].concat(orderedModifiers,state.options.modifiers),(function(_ref){return _ref.name}))),"auto"===getBasePlacement(state.options.placement)&&(state.orderedModifiers.find((function(_ref2){return"flip"===_ref2.name}))||console.error(['Popper: "auto" placements require the "flip" modifier be',"present and enabled to work."].join(" ")));var _getComputedStyle=getComputedStyle2(popper2);return[_getComputedStyle.marginTop,_getComputedStyle.marginRight,_getComputedStyle.marginBottom,_getComputedStyle.marginLeft].some((function(margin){return parseFloat(margin)}))&&console.warn(['Popper: CSS "margin" styles cannot be used to apply padding',"between the popper and its reference element or boundary.","To replicate margin, use the `offset` modifier, as well as","the `padding` option in the `preventOverflow` and `flip`","modifiers."].join(" ")),runModifierEffects(),instance.update()}),"setOptions"),forceUpdate:__name((function(){if(!isDestroyed){var _state$elements=state.elements,reference3=_state$elements.reference,popper3=_state$elements.popper;if(areValidElements(reference3,popper3)){state.rects={reference:getCompositeRect(reference3,getOffsetParent(popper3),"fixed"===state.options.strategy),popper:getLayoutRect(popper3)},state.reset=!1,state.placement=state.options.placement,state.orderedModifiers.forEach((function(modifier){return state.modifiersData[modifier.name]=Object.assign({},modifier.data)}));for(var __debug_loops__=0,index=0;index<state.orderedModifiers.length;index++){if((__debug_loops__+=1)>100){console.error("Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.");break}if(!0!==state.reset){var _state$orderedModifie=state.orderedModifiers[index],fn2=_state$orderedModifie.fn,_state$orderedModifie2=_state$orderedModifie.options,_options=void 0===_state$orderedModifie2?{}:_state$orderedModifie2,name2=_state$orderedModifie.name;"function"==typeof fn2&&(state=fn2({state:state,options:_options,name:name2,instance:instance})||state)}else state.reset=!1,index=-1}}else console.error(INVALID_ELEMENT_ERROR)}}),"forceUpdate"),update:debounce((function(){return new Promise((function(resolve){instance.forceUpdate(),resolve(state)}))})),destroy:__name((function(){cleanupModifierEffects(),isDestroyed=!0}),"destroy")};if(!areValidElements(reference2,popper2))return console.error(INVALID_ELEMENT_ERROR),instance;function runModifierEffects(){state.orderedModifiers.forEach((function(_ref3){var name2=_ref3.name,_ref3$options=_ref3.options,options2=void 0===_ref3$options?{}:_ref3$options,effect4=_ref3.effect;if("function"==typeof effect4){var cleanupFn=effect4({state:state,name:name2,instance:instance,options:options2}),noopFn=__name((function(){}),"noopFn");effectCleanupFns.push(cleanupFn||noopFn)}}))}function cleanupModifierEffects(){effectCleanupFns.forEach((function(fn2){return fn2()})),effectCleanupFns=[]}return instance.setOptions(options).then((function(state2){!isDestroyed&&options.onFirstUpdate&&options.onFirstUpdate(state2)})),__name(runModifierEffects,"runModifierEffects"),__name(cleanupModifierEffects,"cleanupModifierEffects"),instance}),"createPopper")}__name(areValidElements,"areValidElements"),__name(popperGenerator,"popperGenerator");var createPopper=popperGenerator({defaultModifiers:[eventListeners_default,popperOffsets_default,computeStyles_default,applyStyles_default,offset_default,flip_default,preventOverflow_default,arrow_default,hide_default]});function setDragStartOnEvent(e,dragStartX,dragStartY){const _e=e;_e.dragStartX=dragStartX,_e.dragStartY=dragStartY}function preventDefaultAlways(e){e.preventDefault()}__name(setDragStartOnEvent,"setDragStartOnEvent"),__name(preventDefaultAlways,"preventDefaultAlways");var EditorSelection=class{constructor(currentlyDrawnRect){this.currentlyDrawnRect=currentlyDrawnRect,this.previouslySelectedElements=new Set}toggle(elem){this.previouslySelectedElements.has(elem)?this.previouslySelectedElements.delete(elem):this.previouslySelectedElements.add(elem)}finishCurrentRect(editor){let rect;if(void 0!==(rect=this.currentlyDrawnRect)){for(const comp of editor.components.all())comp.isInRect(rect)&&this.toggle(comp);for(const wire of editor.linkMgr.wires)for(const point of wire.waypoints)point.isInRect(rect)&&this.toggle(point);this.currentlyDrawnRect=void 0}}isSelected(component){const prevSelected=this.previouslySelectedElements.has(component),rect=this.currentlyDrawnRect;if(void 0===rect)return prevSelected;return component.isInRect(rect)?!prevSelected:prevSelected}};__name(EditorSelection,"EditorSelection");var UIEventManager=class{constructor(editor){this._currentComponentUnderPointer=null,this._currentTooltip=null,this._currentPointerDownData=null,this._startHoverTimeoutHandle=null,this._longPressTimeoutHandle=null,this._lastTouchEnd=void 0,this.currentSelection=void 0,this.editor=editor,this._currentAction="edit",this._currentHandlers=new EditHandlers(editor)}get currentComponentUnderPointer(){return this._currentComponentUnderPointer}get currentPointerDownData(){return this._currentPointerDownData}setHandlersFor(action){for(var _len7=arguments.length,params=new Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++)params[_key7-1]=arguments[_key7];if(action===this._currentAction)return!1;this._currentAction=action;const newHandlers=(()=>{switch(action){case"delete":return new DeleteHandlers(this.editor);case"move":return new MoveHandlers(this.editor);case"setanchor":return new SetAnchorHandlers(this.editor,...params);default:return new EditHandlers(this.editor)}})();return this._currentHandlers.unmount(),this._currentHandlers=newHandlers,setColorPointerOverIsDanger("delete"===action),!0}startLongPressTimeout(startPointerDownData,e){const _e=e;_e._savedOffsetX=_e.offsetX,_e._savedOffsetY=_e.offsetY,_e._savedTarget=_e.target,this._longPressTimeoutHandle=setTimeout(this.editor.wrapHandler((()=>{let cancelLongPressAction=!1;const endPointerDownData=this._currentPointerDownData;if(null!==endPointerDownData&&(endPointerDownData.fireClickedOnFinish=!1,endPointerDownData.triggeredContextMenu&&(cancelLongPressAction=!0)),!cancelLongPressAction)if("mouse"===e.pointerType){const[dragStartX,dragStartY]=this.editor.offsetXY(e,!0);setDragStartOnEvent(e,dragStartX,dragStartY),startPointerDownData.mainComp instanceof Drawable&&this._currentHandlers.pointerDraggedOn(startPointerDownData.mainComp,e);for(const comp of startPointerDownData.selectionComps)this._currentHandlers.pointerDraggedOn(comp,e)}else this.editor.mode>=2&&startPointerDownData.mainComp instanceof Drawable&&this._currentHandlers.contextMenuOn(startPointerDownData.mainComp,e)})),500)}clearLongPressTimeout(){null!==this._longPressTimeoutHandle&&(clearTimeout(this._longPressTimeoutHandle),this._longPressTimeoutHandle=null)}clearHoverTimeoutHandle(){null!==this._startHoverTimeoutHandle&&(clearTimeout(this._startHoverTimeoutHandle),this._startHoverTimeoutHandle=null)}setCurrentComponentUnderPointer(comp){comp!==this._currentComponentUnderPointer&&(this.clearTooltipIfNeeded(),this.clearHoverTimeoutHandle(),this._currentComponentUnderPointer=comp,null!==comp&&(this._startHoverTimeoutHandle=setTimeout((()=>{this._currentHandlers.pointerHoverOn(comp),this._startHoverTimeoutHandle=null}),1200)),this.editor.editTools.redrawMgr.requestRedraw({why:"pointerover changed"}))}currentSelectionEmpty(){return void 0===this.currentSelection||0===this.currentSelection.previouslySelectedElements.size}updateComponentUnderPointer(_ref126,pullingWire,settingAnchor,isTouch){let[x,y]=_ref126;const findComponenentUnderPointer=__name((()=>{const prevCompUnderPointer=this._currentComponentUnderPointer;if(null!==prevCompUnderPointer&&0!==prevCompUnderPointer.drawZIndex){if(!(prevCompUnderPointer instanceof Wire||prevCompUnderPointer instanceof NodeBase||settingAnchor&&!(prevCompUnderPointer instanceof ComponentBase))&&prevCompUnderPointer.isOver(x,y))return this._currentComponentUnderPointer}const root=this.editor.editorRoot;if(!pullingWire)for(const comp of root.components.withZIndex(DrawZIndex.Overlay))if(comp.isOver(x,y))return comp;for(const comp of root.components.withZIndex(DrawZIndex.Normal)){let nodeOver,bestDistanceSquared=Number.POSITIVE_INFINITY;if(!settingAnchor)for(const node of comp.allNodes()){const dist=node.distSquaredIfOver(x,y,isTouch);void 0!==dist&&dist<bestDistanceSquared&&(bestDistanceSquared=dist,nodeOver=node)}if(void 0!==nodeOver&&(!pullingWire||root.linkMgr.isValidNodeToConnect(nodeOver)))return nodeOver;if(!pullingWire&&comp.isOver(x,y))return comp}if(!pullingWire&&!settingAnchor)for(const wire of root.linkMgr.wires){for(const waypoint of wire.waypoints)if(waypoint.isOver(x,y))return waypoint;if(wire.isOver(x,y))return wire}if(!pullingWire)for(const comp of root.components.withZIndex(DrawZIndex.Background))if(comp.isOver(x,y))return comp;return null}),"findComponenentUnderPointer");this.setCurrentComponentUnderPointer(findComponenentUnderPointer())}selectAll(){const sel=new EditorSelection(void 0);this.currentSelection=sel;const root=this.editor.editorRoot;for(const comp of root.components.all())sel.previouslySelectedElements.add(comp);for(const wire of root.linkMgr.wires)for(const waypoint of wire.waypoints)sel.previouslySelectedElements.add(waypoint);this.editor.editTools.redrawMgr.requestRedraw({why:"selected all"})}toggleSelect(comp){let sel;void 0===(sel=this.currentSelection)&&(sel=new EditorSelection(void 0),this.currentSelection=sel),sel.toggle(comp),this.editor.editTools.redrawMgr.requestRedraw({why:"toggled selection"})}moveSelection(dx,dy,snapToGrid){const sel=this.currentSelection;if(void 0===sel||0===sel.previouslySelectedElements.size)return!1;for(const comp of sel.previouslySelectedElements)comp instanceof DrawableWithDraggablePosition&&comp.setPosition(comp.posX+dx,comp.posY+dy,snapToGrid);return!0}clearTooltipIfNeeded(){if(null!==this._currentTooltip){const[tooltip,removeListener]=this._currentTooltip;removeListener(),tooltip.destroy(),this._currentTooltip=null,this.editor.html.tooltipElem.style.display="none"}}makeTooltip(tooltipHtml,rect){const{tooltipContents:tooltipContents,tooltipElem:tooltipElem,mainCanvas:mainCanvas}=this.editor.html;tooltipContents.innerHTML="",tooltipHtml.applyTo(tooltipContents),tooltipElem.style.removeProperty("display");const tooltip=createPopper({getBoundingClientRect:rect,contextElement:mainCanvas},tooltipElem,{placement:"right",modifiers:[{name:"offset",options:{offset:[4,8]}}]}),scrollParent=getScrollParent(mainCanvas),scrollListener=__name((()=>tooltip.update()),"scrollListener");scrollParent.addEventListener("scroll",scrollListener);const removeListener=__name((()=>scrollParent.removeEventListener("scroll",scrollListener)),"removeListener");this._currentTooltip=[tooltip,removeListener],tooltipElem.setAttribute("data-show",""),tooltip.update()}hideContextMenuIfNeeded(e){this._currentHandlers.hideContextMenuIfNeeded(e)}registerCanvasListenersOn(canvas2){const editor=this.editor,returnFalse=__name((()=>!1),"returnFalse"),preventDefaultIfCanConnect=__name((e=>{this.editor.mode>=2&&e.preventDefault()}),"preventDefaultIfCanConnect");canvas2.ontouchstart=preventDefaultIfCanConnect,canvas2.ontouchmove=preventDefaultIfCanConnect,canvas2.ontouchend=preventDefaultAlways;const downPointers=new Map;let trackedPointerId,currentZoomSession;const cancelZoomSession=__name((()=>{if(void 0!==currentZoomSession){const translationRoundTo=GRID_STEP/2,tX=Math.round(editor.translationX/translationRoundTo)*translationRoundTo,tY=Math.round(editor.translationY/translationRoundTo)*translationRoundTo;editor.setTranslation(tX,tY),currentZoomSession=void 0}}),"cancelZoomSession"),applyZoomAndTranslation=__name(((zoom,startGestureX,startGestureY,endGestureX,endGestureY)=>{const effectiveScale=editor.setZoom(zoom,!0)/100,tX=endGestureX/effectiveScale-startGestureX,tY=endGestureY/effectiveScale-startGestureY;editor.setTranslation(tX,tY)}),"applyZoomAndTranslation"),getTwoPointersLoc=__name((skipTransform=>{if(2!==downPointers.size)throw new Error("Pointer distance called with "+downPointers.size+" pointers instead of 2");const pointerEvents=downPointers.values(),p1=pointerEvents.next().value,p2=pointerEvents.next().value,[p1X,p1Y]=editor.offsetXY(p1,skipTransform),[p2X,p2Y]=editor.offsetXY(p2,skipTransform),centerX=(p1X+p2X)/2,centerY=(p1Y+p2Y)/2,dx=p1X-p2X,dy=p1Y-p2Y;return{dist:Math.sqrt(dx*dx+dy*dy),centerX:centerX,centerY:centerY}}),"getTwoPointersLoc");canvas2.onpointerdown=editor.wrapHandler((e=>{const pointerId=e.pointerId;canvas2.setPointerCapture(pointerId),downPointers.set(pointerId,e);const numPointers=downPointers.size;if(2===numPointers){if(this.doPointerUp(e),trackedPointerId=void 0,editor.mode>=2){const initialTransform={zoom:100*this.editor.userDrawingScale,tX:this.editor.translationX,tY:this.editor.translationY};currentZoomSession={initialTransform:initialTransform,initialPointersLoc:getTwoPointersLoc(!1)}}}else cancelZoomSession();1===numPointers&&(trackedPointerId=pointerId,this.doPointerDown(e))})),canvas2.onpointermove=editor.wrapHandler((e=>{const pointerId=e.pointerId;downPointers.has(pointerId)&&downPointers.set(pointerId,e);let handle=!1;if(2===downPointers.size&&void 0!==currentZoomSession){const initLoc=currentZoomSession.initialPointersLoc,newLoc=getTwoPointersLoc(!0),factor=newLoc.dist/initLoc.dist*100/currentZoomSession.initialTransform.zoom,targetZoom=currentZoomSession.initialTransform.zoom*factor;applyZoomAndTranslation(targetZoom>95&&targetZoom<105?100:targetZoom,initLoc.centerX,initLoc.centerY,newLoc.centerX,newLoc.centerY)}else handle=pointerId===trackedPointerId;("touch"!==e.pointerType||handle)&&this.doPointerMove(e)})),canvas2.onpointerleave=this.clearTooltipIfNeeded.bind(this);const onpointerupcancel=editor.wrapHandler((e=>{const pointerId=e.pointerId;downPointers.delete(pointerId),pointerId===trackedPointerId&&(this.doPointerUp(e),trackedPointerId=void 0),cancelZoomSession()}));canvas2.onpointerup=onpointerupcancel,canvas2.onpointercancel=onpointerupcancel,canvas2.onwheel=editor.wrapHandler((e=>{if(editor.mode>=2){e.preventDefault();if(e.ctrlKey||e.metaKey){const zoomFactor=1+.005*-e.deltaY,oldZoom=100*editor.userDrawingScale,[oldCenterX,oldCenterY]=editor.offsetXY(e,!1),[newCenterX,newCenterY]=editor.offsetXY(e,!0);applyZoomAndTranslation(oldZoom*zoomFactor,oldCenterX,oldCenterY,newCenterX,newCenterY)}else{const panX=-e.deltaX,panY=-e.deltaY;editor.setTranslation(editor.translationX+panX,editor.translationY+panY)}}})),canvas2.oncontextmenu=editor.wrapHandler((e=>{e.preventDefault(),this.editor.mode>=2&&null!==this._currentComponentUnderPointer&&this._currentHandlers.contextMenuOn(this._currentComponentUnderPointer,e)})),canvas2.addEventListener("keyup",editor.wrapHandler((e=>{if(targetIsFieldOrOtherInput(e))return;switch(e.key.toLowerCase()){case"escape":{let handled;return handled=editor.eventMgr.tryDeleteComponentsWhere((comp=>0===comp.state),!1)>0,handled||(handled=editor.linkMgr.tryCancelWireOrAnchor()),!handled&&this.editor.editorRoot instanceof CustomComponent&&(handled=this.editor.tryCloseCustomComponentEditor()),handled||(handled=editor.setCurrentPointerAction("edit")),void(handled&&e.preventDefault())}case"backspace":case"delete":if(e.preventDefault(),!editor.deleteSelection()&&null!==this.currentComponentUnderPointer){const result=editor.eventMgr.tryDeleteDrawable(this.currentComponentUnderPointer);result.isChange&&editor.editTools.undoMgr.takeSnapshot(result)}return;case"e":return editor.setCurrentPointerAction("edit"),void e.preventDefault();case"d":return editor.setCurrentPointerAction("delete"),void e.preventDefault();case"m":return editor.setCurrentPointerAction("move"),void e.preventDefault();case"t":if(editor.editorRoot.testSuites.totalCases()>0)return editor.setTestsPaletteVisible(!0),editor.editTools.testsPalette.runAllTestSuites(),void e.preventDefault()}}))),canvas2.addEventListener("keydown",editor.wrapAsyncHandler((async e=>{const ctrlOrCommand=e.ctrlKey||e.metaKey,keyLower=e.key.toLowerCase(),shift=e.shiftKey||keyLower!==e.key;switch(keyLower){case"a":return void(ctrlOrCommand&&editor.mode>=2&&!targetIsFieldOrOtherInput(e)&&(e.preventDefault(),this.selectAll()));case"s":return void(ctrlOrCommand&&editor.isSingleton&&(e.preventDefault(),editor.saveCurrentStateToUrl()));case"z":return void(ctrlOrCommand&&!targetIsFieldOrOtherInput(e)&&(e.preventDefault(),shift?editor.editTools.undoMgr.redoOrRepeat():editor.editTools.undoMgr.undo()));case"y":return void(ctrlOrCommand&&!targetIsFieldOrOtherInput(e)&&(e.preventDefault(),editor.editTools.undoMgr.redoOrRepeat()));case"x":return void(ctrlOrCommand&&!targetIsFieldOrOtherInput(e)&&(e.preventDefault(),await editor.cut()));case"c":return void(ctrlOrCommand&&!targetIsFieldOrOtherInput(e)&&(e.preventDefault(),await editor.copy()));case"v":return void(ctrlOrCommand&&!targetIsFieldOrOtherInput(e)&&(e.preventDefault(),await editor.paste()));case"g":return void(ctrlOrCommand&&editor.mode>=2&&(e.preventDefault(),editor.makeGroupWithSelection()));case"arrowright":if(this.moveSelection(ctrlOrCommand?1:GRID_STEP/2,0,e.altKey))return;break;case"arrowleft":if(this.moveSelection(ctrlOrCommand?-1:-GRID_STEP/2,0,e.altKey))return;break;case"arrowdown":if(this.moveSelection(0,ctrlOrCommand?1:GRID_STEP/2,e.altKey))return;break;case"arrowup":if(this.moveSelection(0,ctrlOrCommand?-1:-GRID_STEP/2,e.altKey))return}null!==this._currentComponentUnderPointer&&this._currentComponentUnderPointer.keyDown(e)}))),canvas2.ondragenter=returnFalse,canvas2.ondragover=returnFalse,canvas2.ondragend=returnFalse,canvas2.ondrop=e=>{var _a;if(null===e.dataTransfer)return!1;e.preventDefault();const file=null==(_a=e.dataTransfer.files)?void 0:_a[0];if(void 0!==file)editor.tryLoadFrom(file);else{const dataItems=e.dataTransfer.items;if(void 0!==dataItems)for(const dataItem of dataItems)if("string"===dataItem.kind&&("application/json"===dataItem.type||"application/json5"===dataItem.type||"text/plain"===dataItem.type)){dataItem.getAsString((content=>{e.dataTransfer.dropEffect="copy",editor.loadCircuitOrLibrary(content)}));break}}return!1}}doPointerDown(e){if(this.clearHoverTimeoutHandle(),this.clearTooltipIfNeeded(),null===this._currentPointerDownData){const xy=this.editor.offsetXY(e);if(this.updateComponentUnderPointer(xy,!1,!1,"touch"===e.pointerType),null!==this._currentComponentUnderPointer){const{wantsDragEvents:wantsDragEvents}=this._currentHandlers.pointerDownOn(this._currentComponentUnderPointer,e);if(wantsDragEvents){const selectedComps=void 0===this.currentSelection?[]:[...this.currentSelection.previouslySelectedElements];for(const comp of selectedComps)comp!==this._currentComponentUnderPointer&&this._currentHandlers.pointerDownOn(comp,e);const pointerDownData={mainComp:this._currentComponentUnderPointer,selectionComps:selectedComps,firedPointerDraggedAlready:!1,fireClickedOnFinish:!0,initialXY:xy,triggeredContextMenu:!1};this._currentPointerDownData=pointerDownData,this.startLongPressTimeout(pointerDownData,e)}this.editor.editTools.redrawMgr.requestRedraw({why:"pointerdown"})}else this._currentPointerDownData={mainComp:this.editor.html.canvasContainer,selectionComps:[],firedPointerDraggedAlready:!1,fireClickedOnFinish:!0,initialXY:xy,triggeredContextMenu:!1},this._currentHandlers.pointerDownOnBackground(e);this.editor.updateCursor(e)}}doPointerMove(e){if(null!==this._currentPointerDownData)if(this._currentPointerDownData.triggeredContextMenu)this._currentPointerDownData=null;else{const initialXY=this._currentPointerDownData.initialXY;if(setDragStartOnEvent(e,initialXY[0],initialXY[1]),this._currentPointerDownData.mainComp instanceof Drawable){let fireDragEvent=this._currentPointerDownData.firedPointerDraggedAlready;if(!fireDragEvent){const d2=distSquared(...this.editor.offsetXY(e),...this._currentPointerDownData.initialXY);fireDragEvent=isNaN(d2)||d2>=25}if(fireDragEvent){this.clearLongPressTimeout(),this._currentPointerDownData.fireClickedOnFinish=!1,this._currentHandlers.pointerDraggedOn(this._currentPointerDownData.mainComp,e);for(const comp of this._currentPointerDownData.selectionComps)comp!==this._currentPointerDownData.mainComp&&this._currentHandlers.pointerDraggedOn(comp,e);this._currentPointerDownData.firedPointerDraggedAlready=!0}}else this._currentHandlers.pointerDraggedOnBackground(e)}else{const linkMgr=this.editor.editorRoot.linkMgr;this.updateComponentUnderPointer(this.editor.offsetXY(e),linkMgr.isAddingWire,linkMgr.isSettingAnchor,"touch"===e.pointerType)}this.editor.updateCursor(e)}doPointerUp(e){var _a,_b,_c,_d;const pointerUpTarget=null!=(_b=null==(_a=this._currentPointerDownData)?void 0:_a.mainComp)?_b:this._currentComponentUnderPointer;if(pointerUpTarget instanceof Drawable){this.clearLongPressTimeout();let change=this._currentHandlers.pointerUpOn(pointerUpTarget,e);for(const comp of null!=(_d=null==(_c=this._currentPointerDownData)?void 0:_c.selectionComps)?_d:[])if(comp!==pointerUpTarget){const newChange=this._currentHandlers.pointerUpOn(comp,e);change=InteractionResult.merge(change,newChange)}const pointerDownData=this._currentPointerDownData;if(null!==pointerDownData&&(pointerDownData.fireClickedOnFinish&&!pointerDownData.triggeredContextMenu)){let newChange;this.isDoubleClick(pointerUpTarget,e)?(newChange=this._currentHandlers.pointerDoubleClickedOn(pointerUpTarget,e),newChange.isChange||(newChange=this._currentHandlers.pointerClickedOn(pointerUpTarget,e))):newChange=this._currentHandlers.pointerClickedOn(pointerUpTarget,e),change=InteractionResult.merge(change,newChange)}change.isChange&&this.editor.editTools.undoMgr.takeSnapshot(change)}else this._currentHandlers.pointerUpOnBackground(e);this._currentPointerDownData=null,"touch"===e.pointerType?this.setCurrentComponentUnderPointer(null):(this.updateComponentUnderPointer(this.editor.offsetXY(e),!1,!1,!1),this.editor.updateCursor(e)),this.editor.editTools.redrawMgr.requestRedraw({why:"pointerup"}),this.editor.focus()}isDoubleClick(clickedComp,e){if("mouse"===e.pointerType)return 2===e.detail;{const oldLastTouchEnd=this._lastTouchEnd,now=(new Date).getTime();if(this._lastTouchEnd=[clickedComp,now],void 0===oldLastTouchEnd)return!1;const[lastComp,lastTime]=oldLastTouchEnd,elapsedTimeMillis=now-lastTime,isDoubleTouch=lastComp===clickedComp&&elapsedTimeMillis>0&&elapsedTimeMillis<300;return isDoubleTouch&&(this._lastTouchEnd=void 0),isDoubleTouch}}registerButtonListenersOn(componentButtons,isCustomElement){const editor=this.editor,pointermoveHandler=editor.wrapHandler((e=>{this.doPointerMove(e)})),pointerupHandler=editor.wrapHandler((e=>{this.doPointerUp(e)}));for(const compButton of componentButtons)compButton.ontouchstart=preventDefaultAlways,compButton.ontouchmove=preventDefaultAlways,compButton.ontouchend=preventDefaultAlways,compButton.onpointermove=pointermoveHandler,compButton.onpointerup=pointerupHandler,compButton.onpointerdown=editor.wrapHandler((e=>{if(2===e.button||0===e.button&&e.ctrlKey)return;this.editor.setCurrentPointerAction("edit"),e.preventDefault(),compButton.setPointerCapture(e.pointerId),this.editor.eventMgr.currentSelection=void 0;const newComponent=editor.factory.makeFromButton(editor.editorRoot,compButton);if(void 0===newComponent)return;this._currentComponentUnderPointer=newComponent;const{wantsDragEvents:wantsDragEvents}=this._currentHandlers.pointerDownOn(newComponent,e);wantsDragEvents&&(this._currentPointerDownData={mainComp:this._currentComponentUnderPointer,selectionComps:[],firedPointerDraggedAlready:!1,fireClickedOnFinish:!1,initialXY:[NaN,NaN],triggeredContextMenu:!1});const[x,y]=editor.offsetXY(e,!0);setDragStartOnEvent(e,x,y),this._currentHandlers.pointerDraggedOn(newComponent,e)})),compButton.addEventListener("contextmenu",editor.wrapHandler((e=>{e.preventDefault(),e.stopPropagation(),isCustomElement&&this.editor.mode>=3&&this._currentHandlers.contextMenuOnButton(compButton.dataset,e)})))}registerTitleDragListenersOn(title2,closeHandler){let startX,startY,startTop,startRight,isDragging=!1;if(title2.addEventListener("pointerdown",(e=>{if(isDragging)return;isDragging=!0,title2.setPointerCapture(e.pointerId),startX=e.clientX,startY=e.clientY;const parent=title2.parentElement,computedStyle=window.getComputedStyle(parent);startTop=parseInt(computedStyle.top,10),startRight=parseInt(computedStyle.right,10),title2.style.cursor="grabbing",e.preventDefault()})),title2.addEventListener("pointermove",(e=>{if(!isDragging)return;const deltaX=e.clientX-startX,deltaY=e.clientY-startY,parent=title2.parentElement;parent.style.top="".concat(startTop+deltaY,"px"),parent.style.right="".concat(startRight-deltaX,"px")})),title2.addEventListener("pointerup",(()=>{isDragging&&(isDragging=!1,title2.style.removeProperty("cursor"))})),closeHandler){const closeButton=makeIcon("close");closeButton.classList.add("close-palette"),closeButton.addEventListener("click",closeHandler),title2.appendChild(closeButton)}}tryDeleteDrawable(comp){if(comp instanceof ComponentBase){const ref=comp.ref;if(this.editor.editorRoot.testSuites.hasReferenceTo(ref)&&!window.confirm(S.Tests.ComponentUsedInTestSuite.expand({ref:ref})))return InteractionResult.NoChange;const numDeleted=this.tryDeleteComponentsWhere((c=>c===comp),!0);return InteractionResult.fromBoolean(0!==numDeleted)}return comp instanceof Wire?this.editor.editorRoot.linkMgr.deleteWire(comp):comp instanceof Waypoint?(comp.removeFromParent(),InteractionResult.SimpleChange):InteractionResult.NoChange}tryDeleteComponentsWhere(cond,onlyOne){const numDeleted=this.editor.editorRoot.components.tryDeleteWhere(cond,onlyOne).length;return numDeleted>0&&(this.clearTooltipIfNeeded(),this.editor.editTools.redrawMgr.requestRedraw({why:"component(s) deleted",invalidateMask:!0,invalidateTests:!0})),numDeleted}};__name(UIEventManager,"UIEventManager");var ToolHandlers=class{constructor(editor){this.editor=editor}pointerHoverOn(__comp){}pointerDownOn(__comp,__e2){return{wantsDragEvents:!0}}pointerDraggedOn(__comp,__e2){}pointerUpOn(__comp,__e2){return InteractionResult.NoChange}pointerClickedOn(__comp,__e2){return InteractionResult.NoChange}pointerDoubleClickedOn(__comp,__e2){return InteractionResult.NoChange}contextMenuOn(__comp,__e2){return!1}contextMenuOnButton(__props,__e2){}hideContextMenuIfNeeded(__e2){}pointerDownOnBackground(__e2){}pointerDraggedOnBackground(__e2){}pointerUpOnBackground(__e2){}unmount(){}};__name(ToolHandlers,"ToolHandlers");var EditHandlers=class extends ToolHandlers{constructor(editor){super(editor),this._openedContextMenu=null,this._currentPanningSession=void 0}pointerHoverOn(comp){const editor=this.editor;if(editor.eventMgr.clearTooltipIfNeeded(),editor.options.hideTooltips)return;if(comp instanceof ComponentBase&&2===comp.state)return;const tooltip=comp.makeTooltip();if(void 0!==tooltip){const rect=__name((()=>{const containerRect=editor.html.canvasContainer.getBoundingClientRect(),f=editor.userDrawingScale,dx=editor.translationX,dy=editor.translationY,[cx,cy,w,h]=comp instanceof DrawableWithPosition?[(comp.posX+dx)*f,(comp.posY+dy)*f,comp.width*f,comp.height*f]:[editor.pointerX,editor.pointerY,4,4];return new DOMRect(containerRect.x+cx-w/2,containerRect.y+cy-h/2,w,h)}),"rect");editor.eventMgr.makeTooltip(tooltip,rect)}}pointerDownOn(comp,e){return comp.pointerDown(e)}pointerDraggedOn(comp,e){comp.pointerDragged(e)}pointerUpOn(comp,e){const change=comp.pointerUp(e);return this.editor.editorRoot.linkMgr.tryCancelWireOrAnchor(),change}pointerClickedOn(comp,e){return comp.pointerClicked(e)}pointerDoubleClickedOn(comp,e){return comp.pointerDoubleClicked(e)}contextMenuOn(comp,e){return this.showContextMenu(comp.makeContextMenu(),e)}contextMenuOnButton(props,e){return this.showContextMenu(this.editor.factory.makeContextMenu(props.type),e)}pointerDownOnBackground(e){const editor=this.editor;if(LogicEditor.spaceDown&&editor.mode>=2){editor.setToolCursor("grabbing");const[startX,startY]=editor.offsetXY(e,!0);this._currentPanningSession={startX:startX,startY:startY,initialTranslationX:editor.translationX,initialTranslationY:editor.translationY}}else{const eventMgr=editor.eventMgr,currentSelection=eventMgr.currentSelection;if(void 0!==currentSelection){const allowSelection=editor.mode>=2;if(e.shiftKey&&allowSelection){void 0!==currentSelection.currentlyDrawnRect&&console.log("unexpected defined current rect when about to begin a new one");const[left2,top2]=editor.offsetXY(e),rect=new DOMRect(left2,top2,1,1);currentSelection.currentlyDrawnRect=rect}else eventMgr.currentSelection=void 0;editor.editTools.redrawMgr.requestRedraw({why:"selection rect changed"})}}}pointerDraggedOnBackground(e){const editor=this.editor;if(void 0!==this._currentPanningSession){const{startX:startX,startY:startY,initialTranslationX:initialTranslationX,initialTranslationY:initialTranslationY}=this._currentPanningSession,[x,y]=editor.offsetXY(e,!0),dx=x-startX,dy=y-startY,scaleFactor=editor.userDrawingScale;editor.setTranslation(initialTranslationX+dx/scaleFactor,initialTranslationY+dy/scaleFactor)}else{if(editor.mode>=2){const eventMgr=editor.eventMgr,currentSelection=eventMgr.currentSelection,[x,y]=editor.offsetXY(e);if(void 0===currentSelection){const rect=new DOMRect(x,y,1,1);eventMgr.currentSelection=new EditorSelection(rect)}else{const rect=currentSelection.currentlyDrawnRect;void 0===rect?console.log("trying to update a selection rect that is not defined"):(rect.width=x-rect.x,rect.height=y-rect.y,editor.editTools.redrawMgr.requestRedraw({why:"selection rect changed"}))}}}}pointerUpOnBackground(__e2){const editor=this.editor;editor.linkMgr.tryCancelWireOrAnchor();const currentSelection=editor.eventMgr.currentSelection;void 0!==currentSelection&&(currentSelection.finishCurrentRect(this.editor),editor.editTools.redrawMgr.requestRedraw({why:"selection rect changed"})),editor.setToolCursor(null),this._currentPanningSession=void 0}hideContextMenuIfNeeded(e){if(null!==this._openedContextMenu){void 0!==e&&this._openedContextMenu.contains(e.composedPath()[0])||(this._openedContextMenu.classList.remove("show-menu"),this._openedContextMenu.innerHTML="",this._openedContextMenu=null)}}showContextMenu(menuData,e){if(this.hideContextMenuIfNeeded(),void 0===menuData)return!1;const currentPointerDownData=this.editor.eventMgr.currentPointerDownData;null!==currentPointerDownData&&(currentPointerDownData.triggeredContextMenu=!0);let hasContentJustifyingSeparator=!1;const defToElem=__name((item=>{var _a;function mkButton(spec,shortcut,danger){return button(type("button"),cls("menu-btn".concat(danger?" danger":"")),void 0===spec.icon?spec.caption:mods(makeIcon(spec.icon),span(cls("menu-text"),spec.caption)),void 0===shortcut?emptyMod:span(cls("menu-shortcut"),shortcut))}switch(__name(mkButton,"mkButton"),hasContentJustifyingSeparator||(hasContentJustifyingSeparator="sep"!==item._tag),item._tag){case"sep":return hasContentJustifyingSeparator?(hasContentJustifyingSeparator=!1,li(cls("menu-separator")).render()):emptyMod;case"text":return li(cls("menu-item-static"),item.caption).render();case"item":{const but=mkButton(item,item.shortcut,null!=(_a=item.danger)&&_a).render();return but.addEventListener("click",this.editor.wrapAsyncHandler((async itemEvent=>{this.hideContextMenuIfNeeded();const result=await Promise.resolve(item.action(itemEvent,e));this.editor.editTools.undoMgr.takeSnapshot(result),this.editor.focus()}))),li(cls("menu-item"),but).render()}case"submenu":return li(cls("menu-item submenu"),mkButton(item,void 0,!1),ul(cls("menu"),...item.items.map(defToElem))).render()}}),"defToElem"),items=menuData.map(defToElem),mainContextMenu=this.editor.html.mainContextMenu;applyModifiersTo(mainContextMenu,items),mainContextMenu.classList.add("show-menu");let menuTop=e.pageY;mainContextMenu.style.top=menuTop+"px",mainContextMenu.style.left=e.pageX+"px";let needsScrollY=!1;const menuRect=mainContextMenu.getBoundingClientRect(),hOverflow=window.innerHeight-menuRect.bottom;return hOverflow<0&&(menuTop+=Math.min(0,hOverflow),menuTop<5&&(menuTop=5,needsScrollY=!0),mainContextMenu.style.top=menuTop+"px"),needsScrollY?(mainContextMenu.style.setProperty("max-height",window.innerHeight-10+"px"),mainContextMenu.style.setProperty("overflow-y","scroll")):(mainContextMenu.style.removeProperty("max-height"),mainContextMenu.style.removeProperty("overflow-y")),this._openedContextMenu=mainContextMenu,!0}};__name(EditHandlers,"EditHandlers");var DeleteHandlers=class extends ToolHandlers{constructor(editor){super(editor)}pointerClickedOn(comp,__){return this.editor.eventMgr.tryDeleteDrawable(comp)}};__name(DeleteHandlers,"DeleteHandlers");var SetAnchorHandlers=class extends ToolHandlers{constructor(editor,from){super(editor),this._from=from,editor.linkMgr.startSettingAnchorFrom(from)}unmount(){this.editor.linkMgr.tryCancelSetAnchor()}finish(){this.editor.setCurrentPointerAction("edit")}pointerClickedOn(comp,__){let result=InteractionResult.NoChange;return comp instanceof ComponentBase?result=this.editor.linkMgr.trySetAnchor(this._from,comp):this.editor.linkMgr.tryCancelSetAnchor(),this.finish(),result}pointerUpOnBackground(__){this.editor.linkMgr.tryCancelSetAnchor(),this.finish()}};__name(SetAnchorHandlers,"SetAnchorHandlers");var MoveHandlers=class extends ToolHandlers{constructor(editor){super(editor)}pointerDownOnBackground(e){for(const comp of this.editor.components.all())comp.pointerDown(e);for(const wire of this.editor.linkMgr.wires)for(const waypoint of wire.waypoints)waypoint.pointerDown(e)}pointerDraggedOnBackground(e){for(const comp of this.editor.components.all())comp.pointerDragged(e);for(const wire of this.editor.linkMgr.wires)for(const waypoint of wire.waypoints)waypoint.pointerDragged(e)}pointerUpOnBackground(e){for(const comp of this.editor.components.all())comp.pointerUp(e);for(const wire of this.editor.linkMgr.wires)for(const waypoint of wire.waypoints)waypoint.pointerUp(e)}};__name(MoveHandlers,"MoveHandlers");function areStatesEqual2(s1,s2){return s1.canUndo===s2.canUndo&&s1.canRedoOrRepeat===s2.canRedoOrRepeat}__name(areStatesEqual2,"areStatesEqual");var UndoManager=class{constructor(editor){this._undoSnapshots=[],this._redoSnapshots=[],this.onStateChanged=__name((__=>null),"onStateChanged"),this.editor=editor}get state(){return{canUndo:this.canUndo(),canRedoOrRepeat:this.canRedoOrRepeat()}}canUndo(){return this._undoSnapshots.length>1}canRedoOrRepeat(){return this._redoSnapshots.length>0||this._undoSnapshots.length>0&&void 0!==this._undoSnapshots[this._undoSnapshots.length-1].repeatAction}takeSnapshot(interactionResult){var _a;if(!(null==(_a=null==interactionResult?void 0:interactionResult.isChange)||_a))return;const repeatAction=void 0===interactionResult?void 0:"RepeatableChange"===interactionResult._tag?interactionResult.repeat:void 0;this.doTakeSnapshot(repeatAction)}doTakeSnapshot(repeatAction){const now=Date.now(),circuit=this.editor.save(),jsonStr=Serialization.stringifyObject(circuit,!0);for(this.editor.trySaveInBrowserStorage(circuit),this._undoSnapshots.push({time:now,circuitStr:jsonStr,repeatAction:repeatAction});this._undoSnapshots.length>100;)this._undoSnapshots.shift();this._redoSnapshots.length>0&&(this._redoSnapshots=[]),this.fireStateChangedIfNeeded()}undo(){if(!this.canUndo())return void this.editor.showMessage(S.Messages.NothingToUndo);const stateNow=this._undoSnapshots.pop(),prevState=this._undoSnapshots[this._undoSnapshots.length-1];this._redoSnapshots.push(stateNow),this.loadSnapshot(prevState),this.editor.showMessage(S.Messages.DidUndo),this.fireStateChangedIfNeeded()}redoOrRepeat(){if(!this.canRedoOrRepeat())return void this.editor.showMessage(S.Messages.NothingToRedo);const snapshot=this._redoSnapshots.pop();if(void 0!==snapshot)this._undoSnapshots.push(snapshot),this.loadSnapshot(snapshot),this.editor.showMessage(S.Messages.DidRedo);else{const repeatAction=this._undoSnapshots[this._undoSnapshots.length-1].repeatAction;if(void 0!==repeatAction){const result=repeatAction(),newRepeatAction=!1===result?void 0:!0===result?repeatAction:result;this.doTakeSnapshot(newRepeatAction),this.editor.showMessage(S.Messages.DidRepeat)}}this.fireStateChangedIfNeeded()}dump(){function printStack(name2,stack){const title2=name2+(0===stack.length?" (empty)":"");console.group(title2);for(let i2=stack.length-1;i2>=0;i2--){const snapshot=stack[i2],timeStr=new Date(snapshot.time).toISOString();console.log(timeStr+"\t"+snapshot.circuitStr)}console.groupEnd()}__name(printStack,"printStack"),printStack("Undo stack",this._undoSnapshots),printStack("Redo stack",this._redoSnapshots)}loadSnapshot(snapshot){Serialization.loadCircuitOrLibrary(this.editor,snapshot.circuitStr,!1)}fireStateChangedIfNeeded(){const newState=this.state;void 0!==this._lastSentState&&areStatesEqual2(this._lastSentState,newState)||(this.onStateChanged(newState),this._lastSentState=newState)}};__name(UndoManager,"UndoManager");var Mode3,gallery={CharacterComparator:{v:5,in:[{pos:[50,130],id:0,val:1},{pos:[50,160],id:1,val:1},{pos:[50,190],id:2,val:1},{pos:[50,220],id:3,val:0},{pos:[50,250],id:4,val:1},{pos:[50,280],id:13,val:0},{pos:[50,310],id:14,val:1},{pos:[50,360],id:15,val:1},{pos:[50,390],id:16,val:0},{pos:[50,420],id:17,val:1},{pos:[50,450],id:18,val:0},{pos:[50,480],id:19,val:1},{pos:[50,510],id:20,val:0},{pos:[50,540],id:21,val:1}],out:[{pos:[870,310],id:5},{type:"ascii",pos:[180,60],id:[6,7,8,9,10,11,12]},{type:"ascii",pos:[180,620],id:[22,23,24,25,26,27,28]}],gates:[{type:"XOR",pos:[360,140],in:[29,30],out:31},{type:"XOR",pos:[360,200],in:[32,33],out:34},{type:"XOR",pos:[360,260],in:[35,36],out:37},{type:"XOR",pos:[360,320],in:[38,39],out:40},{type:"XOR",pos:[360,380],in:[41,42],out:43},{type:"XOR",pos:[360,440],in:[44,45],out:46},{type:"XOR",pos:[360,500],in:[47,48],out:49},{type:"OR",pos:[470,170],in:[68,69],out:70},{type:"OR",pos:[500,280],in:[71,72],out:73},{type:"OR",pos:[490,410],in:[74,75],out:76},{type:"OR",pos:[630,250],in:[77,78],out:79},{type:"OR",pos:[630,410],in:[80,81],out:82},{type:"OR",pos:[730,310],in:[83,84],out:85},{type:"NOT",pos:[800,310],in:50,out:51}],wires:[[0,6],[1,7],[2,8],[3,9],[4,10],[13,11],[14,12],[15,22],[16,23],[17,24],[18,25],[19,26],[20,27],[21,28],[0,29],[15,30],[79,83],[82,84],[31,68],[34,69],[37,71],[40,72],[43,74],[46,75],[49,81],[76,80],[73,78],[70,77],[85,50],[51,5],[1,32],[16,33],[2,35],[17,36],[18,39],[3,38],[4,41],[19,42],[13,44],[20,45],[21,48],[14,47]]},Counters:{v:5,in:[{type:"clock",pos:[70,40],id:0,name:"bit 0",period:2e3,phase:1e3,showLabel:!1},{type:"clock",pos:[70,80],id:10,name:"bit 1",period:4e3,phase:2e3,showLabel:!1},{type:"clock",pos:[70,120],id:23,name:"bit 2",period:8e3,phase:4e3,showLabel:!1},{type:"clock",pos:[70,160],id:24,name:"bit 3",period:16e3,phase:8e3,showLabel:!1},{type:"clock",pos:[430,30],id:5,period:500,phase:250,showLabel:!1},{type:"clock",pos:[430,70],id:6,period:1e3,phase:500,showLabel:!1},{type:"clock",pos:[430,110],id:7,period:2e3,phase:1e3,showLabel:!1},{type:"clock",pos:[430,150],id:8,period:4e3,phase:2e3,showLabel:!1},{type:"clock",pos:[430,190],id:9,period:8e3,phase:4e3,showLabel:!1},{type:"clock",pos:[430,230],id:11,period:16e3,phase:8e3,showLabel:!1},{type:"clock",pos:[430,270],id:12,period:32e3,phase:16e3,showLabel:!1}],out:[{type:"display",bits:4,pos:[240,90],id:[1,2,3,4]},{type:"ascii",pos:[580,150],id:[13,14,15,16,17,18,19]}],wires:[[0,1],[24,4],[23,3],[10,2],[5,13],[6,14],[7,15],[8,16],[9,17],[11,18],[12,19]]},AllGates:{v:5,in:[{pos:[40,320],id:0,val:0},{pos:[40,490],id:1,val:0}],out:[{pos:[400,30],id:48},{pos:[400,80],id:49},{pos:[400,140],id:50},{pos:[400,260],id:51},{pos:[400,380],id:52},{pos:[400,200],id:53},{pos:[400,320],id:54},{pos:[400,440],id:55},{pos:[400,560],id:56},{pos:[400,680],id:57},{pos:[400,500],id:58},{pos:[400,620],id:59},{pos:[400,740],id:60},{pos:[400,860],id:61},{pos:[400,800],id:62},{pos:[400,920],id:63}],gates:[{type:"NOT",pos:[290,80],in:2,out:3},{type:"BUF",pos:[290,30],in:4,out:5},{type:"AND",pos:[290,140],in:[6,7],out:8},{type:"OR",pos:[290,260],in:[9,10],out:11},{type:"XOR",pos:[290,380],in:[12,13],out:14},{type:"NAND",pos:[290,200],in:[15,16],out:17},{type:"NOR",pos:[290,320],in:[18,19],out:20},{type:"XNOR",pos:[290,440],in:[21,22],out:23},{type:"IMPLY",pos:[290,560],in:[24,25],out:26},{type:"RIMPLY",pos:[290,680],in:[27,28],out:29},{type:"NIMPLY",pos:[290,500],in:[30,31],out:32},{type:"RNIMPLY",pos:[290,620],in:[33,34],out:35},{type:"TXA",pos:[290,740],in:[36,37],out:38},{type:"TXB",pos:[290,860],in:[39,40],out:41},{type:"TXNA",pos:[290,800],in:[42,43],out:44},{type:"TXNB",pos:[290,920],in:[45,46],out:47}],wires:[[0,4],[0,2],[0,6],[0,9],[0,12],[0,15],[0,18],[0,21],[0,24],[0,27],[0,30],[0,33],[0,36],[0,39],[0,42],[0,45],[1,7],[1,10],[1,13],[1,16],[1,19],[1,22],[1,25],[1,28],[1,31],[1,34],[1,37],[1,40],[1,43],[1,46],[5,48],[3,49],[8,50],[11,51],[14,52],[17,53],[20,54],[23,55],[26,56],[29,57],[32,58],[35,59],[38,60],[41,61],[44,62],[47,63]]},SevenSegmentDisplay:{v:5,opts:{propagationDelay:20},in:[{type:"clock",pos:[90,60],orient:"s",id:21,period:16e3,phase:8e3},{type:"clock",pos:[130,60],orient:"s",id:22,period:8e3,phase:4e3},{type:"clock",pos:[170,60],orient:"s",id:23,period:4e3,phase:2e3},{type:"clock",pos:[210,60],orient:"s",id:24,period:2e3,phase:1e3}],out:[{type:"display",bits:4,pos:[1320,140],id:[132,133,134,135],radix:16},{type:"bar",pos:[1330,310],id:117,display:"h"},{type:"bar",pos:[1270,490],id:118,display:"v"},{type:"bar",pos:[1390,370],id:119,display:"v"},{type:"bar",pos:[1270,370],id:120,display:"v"},{type:"bar",pos:[1330,430],id:121,display:"h"},{type:"bar",pos:[1390,490],id:122,display:"v"},{type:"bar",pos:[1330,550],id:123,display:"h"}],gates:[{type:"NOT",pos:[1170,310],in:103,out:104},{type:"NOT",pos:[1170,350],in:105,out:106},{type:"NOT",pos:[1170,390],in:107,out:108},{type:"NOT",pos:[1170,430],in:109,out:110},{type:"NOT",pos:[1170,550],in:111,out:112},{type:"NOT",pos:[1170,510],in:113,out:114},{type:"NOT",pos:[1170,470],in:115,out:116},{type:"XOR",pos:[210,180],in:[0,1],out:2},{type:"AND",pos:[220,340],in:[3,4],out:5},{type:"XOR",pos:[200,420],in:[6,7],out:8},{type:"XOR",pos:[330,220],in:[9,10],out:11},{type:"XOR",pos:[340,280],in:[12,13],out:14},{type:"OR",pos:[320,480],in:[15,16],out:17},{type:"NOR",pos:[440,220],in:[18,19],out:20},{type:"XOR",pos:[450,290],in:[25,26],out:27},{type:"NOR",pos:[430,450],in:[31,32],out:33},{type:"NOR",pos:[560,410],in:[34,35],out:36},{type:"NOR",pos:[600,190],in:[37,38],out:39},{type:"NOR",pos:[540,360],in:[40,41],out:42},{type:"XOR",pos:[650,320],in:[43,44],out:45},{type:"OR",pos:[670,430],in:[46,47],out:48},{type:"XOR",pos:[770,490],in:[49,50],out:51},{type:"NOR",pos:[770,540],in:[52,53],out:54},{type:"NOR",pos:[800,390],in:[55,56],out:57},{type:"OR",pos:[960,250],in:[58,59],out:60},{type:"NOR",pos:[940,310],in:[61,62],out:63},{type:"AND",pos:[1050,270],in:[64,65],out:66},{type:"AND",pos:[950,380],in:[67,68],out:69},{type:"AND",pos:[950,440],in:[70,71],out:72},{type:"OR",pos:[1030,410],in:[73,74],out:75},{type:"XOR",pos:[1030,520],in:[76,77],out:78}],wires:[[104,117],[106,119],[108,122],[110,123],[112,121],[114,120],[116,118],[21,135],[22,134],[23,133],[24,132],[21,0],[23,1],[24,3],[22,4],[24,6],[21,7],[2,9],[22,10],[23,12],[5,13],[5,15],[8,16],[11,18],[14,19],[11,25],[8,26],[5,32],[14,31],[33,34],[21,35],[20,37],[2,38],[27,40],[8,41],[42,43],[21,44],[39,46],[17,47],[48,49],[21,50],[48,52],[33,53],[36,56],[45,55],[57,103],[39,58],[24,59],[60,64],[27,65],[66,109],[39,61],[45,62],[63,113],[69,73],[72,74],[75,105],[39,67],[24,68],[45,70],[22,71],[51,115],[20,111],[78,107],[72,76],[54,77]]},SevenSegmentBCDDisplay:{v:5,in:[{bits:4,pos:[50,80],id:[0,1,2,3],val:[0,1,0,1]}],out:[{type:"bar",pos:[560,100],id:4,display:"h"},{type:"bar",pos:[620,280],id:5,display:"v"},{type:"bar",pos:[500,160],id:6,display:"v"},{type:"bar",pos:[560,220],id:7,display:"h"},{type:"bar",pos:[560,340],id:8,display:"h"},{type:"bar",pos:[500,280],id:9,display:"v"},{type:"bar",pos:[620,160],id:10,display:"v"},{type:"bar",pos:[420,160],id:50,display:"v"},{type:"bar",pos:[420,280],id:51,display:"v"},{type:"display",bits:4,pos:[170,250],id:[11,23,24,25]}],ic:[{type:"decoder-7seg",pos:[280,60],in:[12,13,14,15],out:[16,17,18,19,20,21,22]},{type:"decoder-bcd4",pos:[180,80],in:[26,27,28,29],out:[30,31,32,33,34]}],wires:[[16,4],[17,10],[18,5],[19,8],[20,9],[21,6],[22,7],[0,11],[1,23],[2,24],[3,25],[0,26],[1,27],[2,28],[3,29],[30,12],[31,13],[32,14],[33,15],[34,50],[34,51]]},SixteenVsSevenSegmentDisplays:{v:5,in:[{bits:4,pos:[50,90],id:[74,75,76,77],val:[1,0,0,1]},{bits:4,pos:[50,170],id:[78,79,80,81],val:[1,1,0,0]}],out:[{type:"16seg",pos:[440,170],id:[57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73]},{type:"ascii",pos:[230,60],id:[82,83,84,85,86,87,88],additionalReprRadix:10},{type:"7seg",pos:[440,330],id:[93,94,95,96,97,98,99,100]}],gates:[{type:"OR",pos:[330,250],in:[90,91],out:92}],ic:[{type:"decoder-16seg",pos:[230,170],in:[34,35,36,37,38,39,40],out:[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,89]},{type:"decoder-7seg",pos:[230,320],in:[101,102,103,104],out:[105,106,107,108,109,110,111]}],wires:[[74,82],[75,83],[76,84],[77,85],[78,86],[79,87],[80,88],[41,57],[42,58],[43,59],[44,60],[45,61],[46,62],[47,63],[48,64],[49,65],[50,66],[51,67],[52,68],[53,69],[54,70],[55,71],[56,72],[74,34],[75,35],[76,36],[77,37],[78,38],[79,39],[80,40],[89,90],[92,73],[81,91],[105,93],[106,94],[107,95],[108,96],[109,97],[110,98],[111,99],[74,101],[75,102],[76,103],[77,104],[81,100,{via:[[200,370]]}]]},NibbleAdder:{v:5,in:[{pos:[100,40],orient:"s",id:3,name:"A3",val:0},{pos:[200,40],orient:"s",id:0,name:"A2",val:0},{pos:[300,40],orient:"s",id:1,name:"A1",val:0},{pos:[400,40],orient:"s",id:2,name:"A0",val:0},{pos:[140,180],orient:"s",id:15,name:"B3",val:0},{pos:[240,180],orient:"s",id:14,name:"B2",val:0},{pos:[340,180],orient:"s",id:13,name:"B1",val:0},{pos:[440,180],orient:"s",id:12,name:"B0",val:0}],out:[{pos:[30,450],orient:"s",id:37,name:"S4"},{pos:[120,450],orient:"s",id:36,name:"S3"},{pos:[220,450],orient:"s",id:38,name:"S2"},{pos:[320,450],orient:"s",id:39,name:"S1"},{pos:[420,450],orient:"s",id:40,name:"S0"},{type:"display",bits:4,pos:[530,100],id:[4,5,6,7]},{type:"display",bits:4,pos:[530,240],id:[8,9,10,11]},{type:"display",bits:4,pos:[530,390],id:[41,42,43,44]}],ic:[{type:"adder",pos:[420,320],in:[16,17,18],out:[19,20]},{type:"adder",pos:[320,320],in:[21,22,23],out:[24,25]},{type:"adder",pos:[220,320],in:[26,27,28],out:[29,30]},{type:"adder",pos:[120,320],in:[31,32,33],out:[34,35]}],wires:[[12,8],[13,9],[14,10],[15,11],[2,4],[1,5],[0,6],[3,7],[20,23],[25,28],[30,33],[2,16],[12,17],[1,21],[13,22],[0,26],[14,27],[3,31],[15,32],[19,41],[24,42],[29,43],[34,44],[35,37],[34,36],[29,38],[24,39],[19,40]]},ALU:{v:5,in:[{pos:[290,60],orient:"s",id:16,name:"Op1",val:0},{pos:[330,60],orient:"s",id:17,name:"Op0",val:0},{pos:[50,140],id:18,val:0},{pos:[50,160],id:19,name:"A",val:0},{pos:[50,180],id:20,val:0},{pos:[50,200],id:21,val:0},{pos:[50,240],id:26,val:0},{pos:[50,260],id:27,name:"B",val:0},{pos:[50,280],id:28,val:0},{pos:[50,300],id:29,val:0}],out:[{pos:[420,320],id:38,name:"Zero"},{pos:[420,350],id:39,name:"oVerflow"},{type:"display",bits:4,pos:[110,60],orient:"n",id:[22,23,24,25],name:"A (non signé)"},{type:"display",bits:4,pos:[110,350],orient:"s",id:[30,31,32,33],name:"B (non signé)"},{type:"display",bits:4,pos:[420,250],id:[34,35,36,37],name:"Y (signé)",radix:-10},{type:"display",bits:4,pos:[420,150],id:[40,41,42,43],name:"Y (non signé)"},{type:"display",bits:4,pos:[210,60],orient:"n",id:[44,45,46,47],name:"A (signé)",radix:-10},{type:"display",bits:4,pos:[210,350],orient:"s",id:[48,49,50,51],name:"B (signé)",radix:-10}],ic:[{type:"alu",pos:[280,220],in:[0,1,2,3,4,5,6,7,8,9],out:[10,11,12,13,14,15]}],wires:[[16,9],[17,8],[21,3],[20,2],[19,1],[18,0],[18,22],[19,23],[20,24],[21,25],[26,4],[27,5],[28,6],[29,7],[26,30],[27,31],[28,32],[29,33],[10,34],[11,35],[12,36],[13,37],[15,38],[14,39],[10,40],[11,41],[12,42],[13,43],[18,44],[19,45],[20,46],[21,47],[26,48],[27,49],[28,50],[29,51]]},MiniAlu:{v:5,in:[{pos:[340,40],orient:"s",id:10,val:1},{pos:[470,40],orient:"s",id:11,val:1},{pos:[370,180],orient:"s",id:12,val:0},{pos:[500,180],orient:"s",id:13,val:1},{pos:[80,40],orient:"s",id:26,val:0},{pos:[210,40],orient:"s",id:27,val:0},{pos:[110,180],orient:"s",id:28,val:0},{pos:[240,180],orient:"s",id:34,val:0},{pos:[600,370],orient:"w",id:98,name:"Add/Sub",val:0}],out:[{pos:[600,690],id:49,name:"V"},{type:"display",bits:4,pos:[600,120],id:[18,19,20,21],name:"A"},{type:"display",bits:4,pos:[600,260],id:[22,23,24,25],name:"B"},{type:"display",bits:4,pos:[600,620],id:[45,46,47,48],name:"S"}],gates:[{type:"XOR",pos:[120,450],orient:"s",in:[86,87],out:88},{type:"XOR",pos:[250,450],orient:"s",in:[89,90],out:91},{type:"XOR",pos:[380,450],orient:"s",in:[92,93],out:94},{type:"XOR",pos:[510,450],orient:"s",in:[95,96],out:97}],ic:[{type:"adder",pos:[490,530],in:[0,1,2],out:[3,4]},{type:"adder",pos:[360,530],in:[5,6,7],out:[8,9]},{type:"adder",pos:[230,530],in:[35,36,37],out:[38,39]},{type:"adder",pos:[100,530],in:[40,41,42],out:[43,44]}],wires:[[4,7],[11,0],[10,5],[11,18],[10,19],[13,22],[12,23],[9,37],[39,42],[3,45],[8,46],[38,47],[43,48],[44,49,{via:[[50,690]]}],[27,35],[26,40],[28,87],[34,90],[34,24],[28,25],[27,20],[26,21],[12,93],[13,96],[97,1],[94,6],[91,36],[88,41],[98,2],[98,95],[98,92],[98,89],[98,86]]},LatchedAdder:{v:5,in:[{pos:[340,570],orient:"n",id:40,name:"Reset",val:0,isPushButton:!0},{pos:[40,220],id:41,val:0},{pos:[40,250],id:42,val:0},{pos:[40,280],id:43,val:0},{pos:[40,310],id:44,val:0},{pos:[280,570],orient:"n",id:45,name:"Horloge",val:0,isPushButton:!0},{pos:[190,400],orient:"n",id:60,name:"Add./soustr.",val:0}],out:[{pos:[550,380],id:61,name:"V"},{type:"display",bits:4,pos:[100,390],orient:"s",id:[50,51,52,53],name:"B"},{type:"display",bits:4,pos:[550,230],id:[46,47,48,49],name:"Acc."}],ic:[{type:"alu",pos:[180,210],in:[0,1,2,3,4,5,6,7,8,9],out:[10,11,12,13,14,15]},{type:"flipflop-d",pos:[390,100],in:[17,18,19,16],out:[20,21],state:0},{type:"flipflop-d",pos:[390,200],in:[23,24,25,22],out:[26,27],state:0},{type:"flipflop-d",pos:[390,300],in:[29,30,31,28],out:[32,33],state:0},{type:"flipflop-d",pos:[390,400],in:[35,36,37,34],out:[38,39],state:0},{type:"flipflop-d",pos:[390,500],in:[55,56,57,54],out:[58,59],state:0}],wires:[[10,16,{via:[[260,80]]}],[11,22,{via:[[260,180]]}],[12,28,{via:[[260,280]]}],[13,34,{via:[[260,380]]}],[40,37,{via:[[340,440]]}],[40,31,{via:[[340,340,"n"]]}],[40,25,{via:[[340,240,"n"]]}],[40,19,{via:[[340,140,"n"]]}],[20,0,{via:[[430,80],[430,50],[130,50],[130,130]]}],[26,1,{via:[[440,180],[440,40],[120,40],[120,150]]}],[32,2,{via:[[450,280],[450,30],[110,30],[110,170]]}],[38,3,{via:[[460,380,"n"],[460,20],[100,20],[100,190]]}],[41,4],[42,5],[43,6],[44,7],[45,35,{via:[[280,420]]}],[45,29,{via:[[280,320,"n"]]}],[45,23,{via:[[280,220,"n"]]}],[45,17,{via:[[280,120,"n"]]}],[41,50],[42,51],[43,52],[44,53],[20,46,{via:[[480,80]]}],[26,47,{via:[[480,180]]}],[32,48,{via:[[480,280]]}],[38,49,{via:[[480,380]]}],[60,8,{via:[[230,320,"n"],[230,110,"n"]]}],[40,57],[45,55,{via:[[280,520]]}],[14,54,{via:[[260,420,"s"],[260,480]]}],[58,61]]},LatchedCounter:{v:5,ic:[{type:"flipflop-d",pos:[170,160],in:[7,8,9,6],out:[10,11],state:0,trigger:"falling",showContent:!0},{type:"flipflop-d",pos:[300,160],in:[15,16,17,14],out:[18,19],state:0,trigger:"falling",showContent:!0},{type:"flipflop-d",pos:[440,160],in:[21,22,23,20],out:[24,25],state:0,trigger:"falling",showContent:!0},{type:"flipflop-d",pos:[580,160],in:[35,36,37,34],out:[38,39],state:0,trigger:"falling",showContent:!0}],in:[{pos:[100,180],id:12,name:"Horloge",val:0,isPushButton:!0},{pos:[100,240],id:41,name:"Reset",val:0,isPushButton:!0}],out:[{type:"display",bits:4,pos:[660,60],id:[26,27,28,29]}],wires:[[12,7],[10,15],[18,21],[19,14],[11,6],[25,20],[10,26,{via:[[400,30]]}],[18,27,{via:[[520,50]]}],[24,28],[39,34],[24,35],[38,29],[41,9],[41,17],[41,23],[41,37]]},Decoder2To4:{v:5,in:[{pos:[60,80],id:0,name:"S0",val:0},{pos:[60,220],id:1,name:"S1",val:0}],gates:[{type:"NOT",pos:[130,50],in:2,out:3},{type:"NOT",pos:[130,190],in:4,out:5},{type:"AND",pos:[280,60],in:[6,7],out:8},{type:"AND",pos:[280,120],in:[9,10],out:11},{type:"AND",pos:[280,180],in:[12,13],out:14},{type:"AND",pos:[280,240],in:[15,16],out:17},{type:"BUF",pos:[130,110],in:22,out:23},{type:"BUF",pos:[130,250],in:24,out:25}],out:[{pos:[370,60],id:18,name:"0"},{pos:[370,120],id:19,name:"1"},{pos:[370,180],id:20,name:"2"},{pos:[370,240],id:21,name:"3"}],wires:[[0,2],[1,4],[11,19],[17,21],[14,20],[8,18],[3,6],[5,7],[5,10],[3,12],[0,22],[1,24],[23,9],[23,15],[25,13],[25,16]]},Decoder3To8:{v:5,in:[{pos:[60,130],id:26,name:"S0",val:1},{pos:[60,290],id:27,name:"S1",val:1},{pos:[60,460],id:28,name:"S2",val:0}],gates:[{type:"NOT",pos:[130,90],in:30,out:31},{type:"NOT",pos:[130,250],in:32,out:33},{type:"NOT",pos:[130,420],in:34,out:35},{type:"AND",bits:3,pos:[340,120],in:[36,37,38],out:39},{type:"AND",bits:3,pos:[340,190],in:[40,41,42],out:43},{type:"AND",bits:3,pos:[340,260],in:[44,45,46],out:47},{type:"AND",bits:3,pos:[340,330],in:[48,49,50],out:51},{type:"AND",bits:3,pos:[340,400],in:[52,53,54],out:55},{type:"AND",bits:3,pos:[340,470],in:[56,57,58],out:59},{type:"AND",bits:3,pos:[340,540],in:[60,61,62],out:63},{type:"AND",bits:3,pos:[340,50],in:[64,65,66],out:67},{type:"BUF",pos:[130,170],in:76,out:77},{type:"BUF",pos:[130,330],in:78,out:79},{type:"BUF",pos:[130,500],in:80,out:81}],out:[{pos:[420,50],id:68,name:"0"},{pos:[420,120],id:69,name:"1"},{pos:[420,190],id:70,name:"2"},{pos:[420,260],id:71,name:"3"},{pos:[420,330],id:72,name:"4"},{pos:[420,400],id:73,name:"5"},{pos:[420,470],id:74,name:"6"},{pos:[420,540],id:75,name:"7"}],wires:[[26,30],[27,32],[28,34],[67,68],[39,69],[43,70],[47,71],[51,72],[55,73],[59,74],[63,75],[31,64],[33,65],[35,66],[26,76],[27,78],[28,80],[77,36],[33,37],[35,38],[31,40],[79,41],[35,42],[35,46],[79,45],[77,44],[31,48],[77,52],[31,56],[77,60],[33,49],[33,53],[79,57],[79,61],[81,50],[81,54],[81,58],[81,62]]},ParityGenerator:{v:5,in:[{pos:[70,180],id:0,name:"D1",val:0},{pos:[70,300],id:1,name:"D2",val:0},{pos:[70,360],id:2,name:"D3",val:0},{pos:[70,420],id:3,name:"D4",val:0}],out:[{pos:[530,60],id:4,name:"P1"},{pos:[530,120],id:5,name:"P2"},{pos:[530,180],id:6,name:"D1"},{pos:[530,240],id:7,name:"P3"},{pos:[530,300],id:8,name:"D2"},{pos:[530,360],id:9,name:"D3"},{pos:[530,420],id:10,name:"D4"}],gates:[{type:"XOR",pos:[460,240],in:[11,12],out:13},{type:"XOR",pos:[380,230],in:[14,15],out:16},{type:"XOR",pos:[340,120],in:[17,18],out:19},{type:"XOR",pos:[260,110],in:[20,21],out:22},{type:"XOR",pos:[300,60],in:[23,24],out:25},{type:"XOR",pos:[220,40],in:[26,27],out:28}],wires:[[3,10],[2,9],[1,8],[0,6],[22,17],[16,11],[28,23],[25,4],[19,5],[13,7],[3,18,{via:[[280,420],[280,130]]}],[3,12,{via:[[420,420]]}],[2,15,{via:[[340,360]]}],[1,14,{via:[[310,300],[310,220]]}],[2,21,{via:[[220,360]]}],[0,20,{via:[[190,180],[190,100]]}],[3,24,{via:[[150,420],[150,70]]}],[1,27,{via:[[120,300],[120,50]]}],[0,26,{via:[[100,30]]}]]},ShiftRegister:{v:5,in:[{pos:[110,130],id:0,name:"D",val:1},{pos:[100,210],id:1,name:"Horloge",val:0,isPushButton:!0},{pos:[100,260],id:38,name:"Reset",val:0,isPushButton:!0}],out:[{type:"display",bits:4,pos:[650,60],id:[39,40,41,42]}],ic:[{type:"flipflop-d",pos:[560,150],in:[21,22,23,20],out:[24,25],state:1,showContent:!0},{type:"flipflop-d",pos:[450,150],in:[15,16,17,14],out:[18,19],state:0,showContent:!0},{type:"flipflop-d",pos:[340,150],in:[9,10,11,8],out:[12,13],state:1,showContent:!0},{type:"flipflop-d",pos:[230,150],in:[3,4,5,2],out:[6,7],state:1,showContent:!0}],wires:[[6,8],[12,14],[18,20],[38,5,{via:[[230,260]]}],[38,11,{via:[[340,260]]}],[38,17,{via:[[450,260]]}],[38,23,{via:[[560,260]]}],[1,21,{via:[[490,210]]}],[1,15,{via:[[380,210]]}],[1,9,{via:[[270,210]]}],[1,3,{via:[[160,210]]}],[0,2],[24,39],[18,40,{via:[[530,50]]}],[12,41,{via:[[410,70]]}],[6,42,{via:[[300,90]]}]]},Muxes:{v:5,in:[{pos:[160,70],orient:"s",id:59,name:"S0",val:0},{pos:[160,340],orient:"s",id:64,name:"S0",val:0},{pos:[450,360],orient:"s",id:69,name:"S0",val:0},{bits:4,pos:[270,60],orient:"s",id:[0,1,2,3],val:[1,1,0,0]},{bits:4,pos:[460,70],orient:"s",id:[60,61,62,63],val:[0,0,0,0]},{bits:4,pos:[270,300],orient:"s",id:[65,66,67,68],val:[0,0,0,0]},{bits:4,pos:[110,180],id:[86,87,88,89],val:[0,0,0,0]},{bits:4,pos:[230,180],id:[90,91,92,93],val:[0,0,0,0]},{bits:4,pos:[400,170],id:[94,95,96,97],val:[0,0,0,0]},{bits:4,pos:[400,250],id:[98,99,100,101],val:[0,0,0,0]},{bits:4,pos:[110,420],id:[102,103,104,105],val:[0,0,0,0]},{bits:4,pos:[110,520],id:[106,107,108,109],val:[0,0,0,0]},{bits:4,pos:[400,540],id:[110,111,112,113],val:[0,0,0,0]},{bits:4,pos:[400,440],id:[114,115,116,117],val:[0,0,0,0]},{bits:4,pos:[230,400],id:[118,119,120,121],val:[0,0,0,0]},{bits:4,pos:[230,460],id:[122,123,124,125],val:[0,0,0,0]},{bits:4,pos:[230,520],id:[126,127,128,129],val:[0,0,0,0]},{bits:4,pos:[230,580],id:[130,131,132,133],val:[0,0,0,0]}],ic:[{type:"mux",from:2,to:1,pos:[160,160],in:[5,6,7],out:8},{type:"mux",from:4,to:1,pos:[290,180],in:[4,9,10,11,12,13],out:14},{type:"mux",from:8,to:1,pos:[470,210],in:[15,16,17,18,19,20,21,22,23,24,25],out:26},{type:"mux",from:4,to:2,pos:[160,470],in:[27,28,29,30,31],out:[32,33]},{type:"mux",from:8,to:2,pos:[290,490],in:[34,35,36,37,38,39,40,41,42,43],out:[44,45]},{type:"mux",from:8,to:4,pos:[450,490],in:[46,47,48,49,50,51,52,53,54],out:[55,56,57,58]},{type:"alu",pos:[630,450],in:[70,71,72,73,74,75,76,77,78,79],out:[80,81,82,83,84,85]}],wires:[[59,7],[0,12],[1,13],[60,23],[61,24],[62,25],[64,31],[65,42],[66,43],[69,54],[86,5],[87,6],[90,4],[91,9],[92,10],[93,11],[94,15],[95,16],[96,17],[97,18],[98,19],[99,20],[100,21],[101,22],[104,27],[105,28],[106,29],[107,30],[110,50],[111,51],[112,52],[113,53],[114,46],[115,47],[116,48],[117,49],[119,34],[120,35],[123,36],[124,37],[127,38],[128,39],[131,40],[132,41]]}},Mode2=((Mode3=Mode2||{})[Mode3.STATIC=0]="STATIC",Mode3[Mode3.TRYOUT=1]="TRYOUT",Mode3[Mode3.CONNECT=2]="CONNECT",Mode3[Mode3.DESIGN=3]="DESIGN",Mode3[Mode3.FULL=4]="FULL",Mode3),ATTRIBUTE_NAMES_lang="lang",ATTRIBUTE_NAMES_singleton="singleton",ATTRIBUTE_NAMES_mode="mode",ATTRIBUTE_NAMES_id="id",ATTRIBUTE_NAMES_autosave="autosave",ATTRIBUTE_NAMES_hidereset="hidereset",ATTRIBUTE_NAMES_exportformat="exportformat",ATTRIBUTE_NAMES_showonly="showonly",ATTRIBUTE_NAMES_showgatetypes="showgatetypes",ATTRIBUTE_NAMES_showdisconnectedpins="showdisconnectedpins",ATTRIBUTE_NAMES_showtooltips="tooltips",ATTRIBUTE_NAMES_src="src",ATTRIBUTE_NAMES_data="data",ATTRIBUTE_NAMES_modes="modes",ATTRIBUTE_NAMES_nomodes="nomodes",DEFAULT_EDITOR_OPTIONS={name:void 0,showOnly:void 0,initParams:void 0,showGateTypes:!1,showDisconnectedPins:!1,wireStyle:WireStyles.auto,animateWires:!1,hideWireColors:!1,hideInputColors:!1,hideOutputColors:!1,hideMemoryContent:!1,hideTooltips:!1,groupParallelWires:!1,showHiddenWires:!1,showAnchors:!1,showIDs:!1,propagationDelay:100,allowPausePropagation:!1,zoom:100},PointerActions={edit:{cursor:null,paramTypes:[]},move:{cursor:"move",paramTypes:[]},delete:{cursor:"not-allowed",paramTypes:[]},setanchor:{cursor:"alias",paramTypes:void 0}},_LogicEditor=class extends HTMLElement{constructor(){super(),this.factory=new ComponentFactory(this),this.eventMgr=new UIEventManager(this),this.timeline=new Timeline(this),this.editTools={moveMgr:new MoveManager(this),undoMgr:new UndoManager(this),redrawMgr:new RedrawManager,testsPalette:new TestsPalette(this),setDirty:this.setDirty.bind(this),setToolCursor:this.setToolCursor.bind(this)},this.components=new ComponentList,this.nodeMgr=new NodeManager,this.testSuites=new TestSuites(this),this.linkMgr=new LinkManager(this),this.recalcMgr=new RecalcManager,this._ifEditing=this.editTools,this._isEmbedded=!1,this._isSingleton=!1,this._instanceId=void 0,this._idWhenExporting=void 0,this._autosave=!1,this._maxInstanceMode=3,this._isDirty=!1,this._isRunningOrCreatingTests=!1,this._dontHogFocus=!1,this._mode=3,this._initialData=void 0,this._options={...DEFAULT_EDITOR_OPTIONS},this._hideResetButton=!1,this._exportformat=void 0,this._menu=void 0,this._topBar=void 0,this._messageBar=void 0,this._toolCursor=null,this._highlightedItems=void 0,this._nextAnimationFrameHandle=null,this._propagationPromise=Promise.resolve(),this._propagationResolve=void 0,this._editorRoot=this,this.optionsHtml=void 0,this.userdata=void 0,this._baseUIDrawingScale=1,this._userDrawingScale=1,this._translationX=0,this._translationY=0,this.pointerX=-1e3,this.pointerY=-1e3,this.root=this.attachShadow({mode:"open"}),this.root.appendChild(window.Logic.template.content.cloneNode(!0));const html={rootDiv:this.elemWithId("logicEditorRoot"),centerCol:this.elemWithId("centerCol"),canvasContainer:this.elemWithId("canvas-sim"),mainCanvas:this.elemWithId("mainCanvas"),leftToolbar:this.elemWithId("leftToolbar"),rightToolbarContainer:this.elemWithId("rightToolbarContainer"),rightResetButton:this.elemWithId("rightResetButton"),tooltipElem:this.elemWithId("tooltip"),tooltipContents:this.elemWithId("tooltipContents"),mainContextMenu:this.elemWithId("mainContextMenu"),settingsPalette:this.elemWithId("settingsPalette"),fileChooser:this.elemWithId("fileChooser"),embedDialog:this.elemWithId("embedDialog"),embedUrl:this.elemWithId("embedUrl"),embedIframe:this.elemWithId("embedIframe"),embedWebcomp:this.elemWithId("embedWebcomp"),embedMarkdown:this.elemWithId("embedMarkdown")};this.html=html,dialog_polyfill_esm_default.registerDialog(html.embedDialog)}static get spaceDown(){return _LogicEditor._spaceDown}static get allConnectedEditors(){return _LogicEditor._allConnectedEditors}isMainEditor(){return!0}get editor(){return this}get ifEditing(){return this._ifEditing}stopEditingThis(){this._ifEditing=void 0}startEditingThis(tools){this._ifEditing=tools}get isSingleton(){return this._isSingleton}get instanceId(){return this._instanceId}get persistenceKey(){return void 0===this._instanceId?void 0:"logic/"+this._instanceId}get idWhenExporting(){return void 0===this._idWhenExporting&&(this._idWhenExporting=randomString(6)),this._idWhenExporting}get autosave(){return this._autosave}get mode(){return this._mode}get editorRoot(){return this._editorRoot}get userDrawingScale(){return this._userDrawingScale}get translationX(){return this._translationX}get translationY(){return this._translationY}elemWithId(id){let elem=this.root.querySelector("#".concat(id));if(null===elem&&(elem=document.querySelector("#".concat(id)),null!==elem&&console.log("WARNING found elem with id ".concat(id," in document rather than in shadow root"))),null===elem)throw console.log("root",this.root),new Error("Could not find element with id '".concat(id,"'"));return elem}static get observedAttributes(){return[]}get options(){return this._options}get documentDisplayName(){var _a;return null!=(_a=this._options.name)?_a:S.Settings.DefaultFileName}setPartialOptions(opts){var _a,_b;const newOptions={...DEFAULT_EDITOR_OPTIONS,...opts};let optionsHtml;this._isSingleton&&(newOptions.showOnly=this._options.showOnly),this._options=newOptions,void 0!==(optionsHtml=this.optionsHtml)&&(optionsHtml.animateWiresCheckbox.checked=newOptions.animateWires,optionsHtml.hideWireColorsCheckbox.checked=newOptions.hideWireColors,optionsHtml.hideInputColorsCheckbox.checked=newOptions.hideInputColors,optionsHtml.hideOutputColorsCheckbox.checked=newOptions.hideOutputColors,optionsHtml.hideMemoryContentCheckbox.checked=newOptions.hideMemoryContent,optionsHtml.showGateTypesCheckbox.checked=newOptions.showGateTypes,optionsHtml.wireStylePopup.value=newOptions.wireStyle,optionsHtml.showDisconnectedPinsCheckbox.checked=newOptions.showDisconnectedPins,optionsHtml.hideTooltipsCheckbox.checked=newOptions.hideTooltips,optionsHtml.groupParallelWiresCheckbox.checked=newOptions.groupParallelWires,optionsHtml.showHiddenWiresCheckbox.checked=newOptions.showHiddenWires,optionsHtml.showAnchorsCheckbox.checked=newOptions.showAnchors,optionsHtml.showIdsCheckbox.checked=newOptions.showIDs,optionsHtml.propagationDelayField.valueAsNumber=newOptions.propagationDelay,this.setWindowTitleFrom(newOptions.name),null==(_a=this._topBar)||_a.setCircuitName(this.editor.options.name),null==(_b=this._topBar)||_b.setZoom(newOptions.zoom),optionsHtml.showUserDataLinkContainer.style.display=void 0!==this.userdata?"initial":"none"),this._userDrawingScale=newOptions.zoom/100,this.editTools.redrawMgr.requestRedraw({why:"options changed",invalidateMask:!0,invalidateTests:!0})}setWindowTitleFrom(docName){if(!this._isSingleton)return;document.title=void 0===docName?"Logic":"".concat(docName," – ").concat("Logic")}nonDefaultOptions(){const nonDefaultOpts={};let set=!1;for(const[_k,v]of Object.entries(this._options)){const k=_k;v!==DEFAULT_EDITOR_OPTIONS[k]&&(nonDefaultOpts[k]=v,set=!0)}return set?nonDefaultOpts:void 0}runFileChooser(accept,callback){const chooser=this.html.fileChooser;chooser.setAttribute("accept",accept),chooser.addEventListener("change",(()=>{const files=this.html.fileChooser.files;null!==files&&files.length>0&&callback(files[0])}),{once:!0}),chooser.click()}setToolCursor(cursor){this._toolCursor=cursor}setCanvasSize(){var _a;const{canvasContainer:canvasContainer,mainCanvas:mainCanvas}=this.html;mainCanvas.style.setProperty("width","0"),mainCanvas.style.setProperty("height","0");const w=canvasContainer.clientWidth,h=canvasContainer.clientHeight,f=null!=(_a=window.devicePixelRatio)?_a:1;mainCanvas.setAttribute("width",String(w*f)),mainCanvas.setAttribute("height",String(h*f)),mainCanvas.style.setProperty("width",w+"px"),mainCanvas.style.setProperty("height",h+"px"),this._baseUIDrawingScale=f}connectedCallback(){0===_LogicEditor._allConnectedEditors.length&&this.setupLang(),_LogicEditor._allConnectedEditors.push(this),this.setup()}disconnectedCallback(){const insts=_LogicEditor._allConnectedEditors;insts.splice(insts.indexOf(this),1)}setupLang(){var _a,_b,_c,_d;const getNavigatorLanguage=__name((()=>{var _a2,_b2;const lang2=null!=(_b2=null==(_a2=navigator.languages)?void 0:_a2[0])?_b2:navigator.language;return lang2.length>2?lang2.substring(0,2):2===lang2.length?lang2:void 0}),"getNavigatorLanguage"),getSavedLang=__name((()=>localStorage.getItem(ATTRIBUTE_NAMES_lang)),"getSavedLang"),langStr=(null!=(_d=null!=(_c=null!=(_b=null!=(_a=getURLParameter(ATTRIBUTE_NAMES_lang))?_a:this.getAttribute(ATTRIBUTE_NAMES_lang))?_b:getSavedLang())?_c:getNavigatorLanguage())?_d:"en").toLowerCase();setLang(isLang(langStr)?langStr:"en")}setup(){var _a,_this2=this;const rootDiv=this.html.rootDiv,parentStyles=this.getAttribute("style");null!==parentStyles&&rootDiv.setAttribute("style",rootDiv.getAttribute("style")+parentStyles),this._isEmbedded=isEmbeddedInIframe();const singletonAttr=this.getAttribute(ATTRIBUTE_NAMES_singleton);if(this._isSingleton=!this._isEmbedded&&null!==singletonAttr&&!isFalsyString(singletonAttr),this._maxInstanceMode=this._isSingleton&&!this._isEmbedded?4:3,this._exportformat=null!=(_a=this.getAttribute(ATTRIBUTE_NAMES_exportformat))?_a:void 0,this._isSingleton||this._isEmbedded){const transferUrlParamToAttribute=__name((name2=>{const value=getURLParameter(name2);void 0!==value&&this.setAttribute(name2,value)}),"transferUrlParamToAttribute");for(const attr2 of[ATTRIBUTE_NAMES_mode,ATTRIBUTE_NAMES_id,ATTRIBUTE_NAMES_showonly,ATTRIBUTE_NAMES_showgatetypes,ATTRIBUTE_NAMES_showdisconnectedpins,ATTRIBUTE_NAMES_showtooltips,ATTRIBUTE_NAMES_data,ATTRIBUTE_NAMES_src,ATTRIBUTE_NAMES_hidereset])transferUrlParamToAttribute(attr2);const userParamPrefix="user";new URL(window.location.href).searchParams.forEach(((value,key)=>{if(key.startsWith(userParamPrefix))if((key=key.substring(userParamPrefix.length)).startsWith(".")&&(key=key.substring(1)),0===key.length)this.userdata=value;else if(key=key[0].toLowerCase()+key.substring(1),"object"!=typeof this.userdata&&(this.userdata={}),key in this.userdata){const oldValue=this.userdata[key];isArray(oldValue)?oldValue.push(value):this.userdata[key]=[oldValue,value]}else this.userdata[key]=value})),void 0!==this.userdata&&console.log("Custom user data: ",this.userdata)}if(this._isSingleton){const darkModeQuery=window.matchMedia("(prefers-color-scheme: dark)");darkModeQuery.onchange=()=>{setDarkMode(darkModeQuery.matches,!1)},setDarkMode(darkModeQuery.matches,!0),window.JSON5=import_json57.default,window.Logic.singleton=this,window.load=this.loadCircuitOrLibrary.bind(this),window.save=this.save.bind(this),window.highlight=this.highlight.bind(this),window.logicalTime=()=>this.timeline.logicalTime();const madeBy=div(cls("noselect"),style("position: absolute; bottom: 0; right: 0; padding: 5px 3px 2px 5px; color: rgba(128,128,128,0.2); border-radius: 10px 0 0 0; font-size: 69%; font-style: italic;"),S.Messages.DevelopedBy+" ",a(style("color: inherit"),href("https://github.com/jppellet/Logic-Circuit-Simulator"),target("_blank"),"Jean-Philippe Pellet"),", ",a(style("color: inherit"),href("https://www.hepl.ch/accueil/formation/unites-enseignement-et-recherche/medias-usages-numeriques-et-didactique-de-linformatique.html"),target("_blank"),"HEP Vaud")).render();this.html.canvasContainer.insertAdjacentElement("afterbegin",madeBy),window.onbeforeunload=e=>{this._isSingleton&&this._isDirty&&this.mode>=2&&(e.preventDefault(),e.returnValue=S.Messages.ReallyCloseWindow)},this.addEventListener("focusout",(()=>{this._dontHogFocus||this.focus()})),this.focus()}let modeAttr=this.getAttribute(ATTRIBUTE_NAMES_mode);null!==modeAttr&&(modeAttr=modeAttr.toUpperCase())in Mode2&&(this._maxInstanceMode=Mode2[modeAttr]);const autosaveAttr=this.getAttribute(ATTRIBUTE_NAMES_autosave);null===autosaveAttr||isFalsyString(autosaveAttr)||(this._autosave=!0);const idAttr=this.getAttribute(ATTRIBUTE_NAMES_id);if(null!==idAttr||this._isSingleton)null!==idAttr?(this._instanceId=idAttr,"_main"!==idAttr&&(this._idWhenExporting=idAttr)):this._instanceId="_main";else{const fct=this._autosave?"error":"warn";console[fct]("No id attribute on logic-editor, undownloaded state will be lost",this),this._autosave=!1}const showonlyAttr=this.getAttribute(ATTRIBUTE_NAMES_showonly);null!==showonlyAttr&&(this._options.showOnly=showonlyAttr.toLowerCase().split(/[, +]+/).filter((x=>x.trim())));const showgatetypesAttr=this.getAttribute(ATTRIBUTE_NAMES_showgatetypes);null!==showgatetypesAttr&&(this._options.showGateTypes=isTruthyString(showgatetypesAttr));const showdisconnectedpinsAttr=this.getAttribute(ATTRIBUTE_NAMES_showdisconnectedpins);null!==showdisconnectedpinsAttr&&(this._options.showDisconnectedPins=isTruthyString(showdisconnectedpinsAttr));const showtooltipsAttr=this.getAttribute(ATTRIBUTE_NAMES_showtooltips);let dataOrSrcRef;if(null!==showtooltipsAttr&&(this._options.hideTooltips=!isFalsyString(showtooltipsAttr)),this._hideResetButton=null!==this.getAttribute(ATTRIBUTE_NAMES_hidereset)&&!isFalsyString(this.getAttribute(ATTRIBUTE_NAMES_hidereset)),null!==(dataOrSrcRef=this.getAttribute(ATTRIBUTE_NAMES_data)))this._initialData={_type:"compressed",str:dataOrSrcRef};else if(null!==(dataOrSrcRef=this.getAttribute(ATTRIBUTE_NAMES_src)))this._initialData={_type:"url",url:dataOrSrcRef};else{const tryLoadFromLightDOM=__name((()=>{const innerScriptElem=this.findLightDOMChild("script");return null!==innerScriptElem&&(this._initialData={_type:"json",json:innerScriptElem.innerHTML},innerScriptElem.remove(),this.tryLoadCircuitFromData(!0,!1),this.doRedraw(!0),!0)}),"tryLoadFromLightDOM");setTimeout((()=>{tryLoadFromLightDOM()||setTimeout((()=>{tryLoadFromLightDOM()}),100)}))}const setCaption=__name(((buttonId,strings)=>{const elem=this.elemWithId(buttonId),[name2,tooltip]=isString(strings)?[strings,void 0]:strings;elem.insertAdjacentText("beforeend",name2),void 0!==tooltip&&elem.setAttribute("title",tooltip)}),"setCaption"),s=S.Dialogs.Share;setCaption("shareDialogTitle",s.title),setCaption("shareDialogUrl",s.URL),setCaption("shareDialogIframe",s.EmbedInIframe),setCaption("shareDialogWebComp",s.EmbedWithWebComp),setCaption("shareDialogMarkdown",s.EmbedInMarkdown),setCaption("shareDialogClose",S.Dialogs.Generic.Close),this._topBar=new TopBar(this),this._menu=new ComponentMenu(this,this.html.leftToolbar),this._messageBar=new MessageBar(this);const testResultsPalette=this.elemWithId("testResultsPalette");testResultsPalette.parentElement.replaceChild(this.editTools.testsPalette.rootElem,testResultsPalette);const groupButton=this.html.leftToolbar.querySelector("button.sim-component-button[data-type=rect]");null===groupButton?void 0===this._options.showOnly&&console.log("ERROR: Could not find group button"):groupButton.addEventListener("pointerdown",this.wrapHandler((e=>{this.makeGroupWithSelection()&&(e.preventDefault(),e.stopImmediatePropagation())}))),this.eventMgr.registerCanvasListenersOn(this.html.mainCanvas),this.eventMgr.registerButtonListenersOn(this._menu.allFixedButtons(),!1),this.html.rightResetButton.addEventListener("click",this.wrapHandler(this.resetCircuit.bind(this)));if(this._maxInstanceMode>=4){const modeChangeMenu=this.elemWithId("modeChangeMenu"),titleElem=div(cls("toolbar-title"),"Mode").render();this.eventMgr.registerTitleDragListenersOn(titleElem),mods(titleElem,div(cls("btn-group-vertical"),...[4,3,2,1,0].map((buttonMode=>{const[[modeTitle,expl],addElem]=(()=>{switch(buttonMode){case 4:{const optionsDiv=div(cls("sim-mode-link"),title(S.Settings.Settings),makeIcon("settings")).render();return optionsDiv.addEventListener("click",(()=>{toggleVisible(this.html.settingsPalette)})),[S.Modes.FULL,optionsDiv]}case 3:return[S.Modes.DESIGN,emptyMod];case 2:return[S.Modes.CONNECT,emptyMod];case 1:return[S.Modes.TRYOUT,emptyMod];case 0:return[S.Modes.STATIC,emptyMod]}})(),copyLinkDiv=div(cls("sim-mode-link"),title("Copie un lien vers ce contenu dans ce mode"),makeIcon("link")).render();copyLinkDiv.addEventListener("click",(__=>{this.shareSheetForMode(buttonMode)}));const switchToModeDiv=div(cls("btn btn-sm btn-outline-light sim-toolbar-button-right sim-mode-tool"),style("display: flex; justify-content: space-between; align-items: center"),attrBuilder("mode")(Mode2[buttonMode].toLowerCase()),title(expl),modeTitle,addElem,copyLinkDiv).render();return switchToModeDiv.addEventListener("click",(()=>this.setMode(buttonMode,!0))),switchToModeDiv})))).applyTo(modeChangeMenu),setVisible(modeChangeMenu,!0)}const selectAllListener=__name((e=>{const textArea=e.target;textArea.focus(),textArea.select(),e.preventDefault()}),"selectAllListener");for(const textArea of[this.html.embedUrl,this.html.embedIframe,this.html.embedWebcomp,this.html.embedMarkdown])textArea.addEventListener("pointerdown",selectAllListener),textArea.addEventListener("focus",selectAllListener);this.setCurrentPointerAction("edit",!0),this.timeline.reset();const settingsPalette=this.html.settingsPalette,settingsTitleElem=div(cls("toolbar-title with-border"),S.Settings.Settings).render();this.eventMgr.registerTitleDragListenersOn(settingsTitleElem,(()=>{setVisible(settingsPalette,!1)})),settingsPalette.insertAdjacentElement("afterbegin",settingsTitleElem);const makeCheckbox=__name((function(optionName,_ref127){let[title2,mouseover]=_ref127,hide2=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const checkbox=input(type("checkbox")).render();!0===_this2.options[optionName]&&(checkbox.checked=!0),checkbox.addEventListener("change",_this2.wrapHandler((()=>{_this2._options[optionName]=checkbox.checked,_this2.editTools.redrawMgr.requestRedraw({why:"option changed: "+optionName,invalidateMask:!0,invalidateTests:!0}),_this2.focus()})));const section=div(style("height: 20px"),label(checkbox,span(style("margin-left: 4px"),attr("title",mouseover),title2))).render();return settingsPalette.appendChild(section),hide2&&setVisible(section,!1),checkbox}),"makeCheckbox"),animateWiresCheckbox=makeCheckbox("animateWires",S.Settings.animateWires),hideWireColorsCheckbox=makeCheckbox("hideWireColors",S.Settings.hideWireColors),hideInputColorsCheckbox=makeCheckbox("hideInputColors",S.Settings.hideInputColors),hideOutputColorsCheckbox=makeCheckbox("hideOutputColors",S.Settings.hideOutputColors),hideMemoryContentCheckbox=makeCheckbox("hideMemoryContent",S.Settings.hideMemoryContent),showGateTypesCheckbox=makeCheckbox("showGateTypes",S.Settings.showGateTypes),showDisconnectedPinsCheckbox=makeCheckbox("showDisconnectedPins",S.Settings.showDisconnectedPins),hideTooltipsCheckbox=makeCheckbox("hideTooltips",S.Settings.hideTooltips),groupParallelWiresCheckbox=makeCheckbox("groupParallelWires",S.Settings.groupParallelWires,!0),showHiddenWiresCheckbox=makeCheckbox("showHiddenWires",S.Settings.showHiddenWires),showAnchorsCheckbox=makeCheckbox("showAnchors",S.Settings.showAnchors),showIdsCheckbox=makeCheckbox("showIDs",S.Settings.showIds),sw=S.Components.Wire.contextMenu,wireStylePopup=select(option(attr("value",WireStyles.auto),sw.WireStyleAuto),option(attr("value",WireStyles.straight),sw.WireStyleStraight),option(attr("value",WireStyles.hv),sw.WireStyleSquareHV),option(attr("value",WireStyles.vh),sw.WireStyleSquareVH),option(attr("value",WireStyles.bezier),sw.WireStyleCurved)).render();wireStylePopup.addEventListener("change",this.wrapHandler((()=>{this._options.wireStyle=wireStylePopup.value,this.linkMgr.invalidateAllWirePaths(),this.editTools.redrawMgr.requestRedraw({why:"wire style changed",invalidateMask:!0})}))),settingsPalette.appendChild(div(style("height: 20px"),S.Settings.wireStyle+" ",wireStylePopup).render());const propagationDelayField=input(type("number"),style("margin: 0 4px; width: 4em"),attr("min","0"),attr("step","50"),attr("value",String(this.options.propagationDelay)),attr("title",S.Settings.propagationDelay)).render();propagationDelayField.addEventListener("change",(()=>{this._options.propagationDelay=propagationDelayField.valueAsNumber})),settingsPalette.appendChild(div(style("height: 20px"),S.Settings.propagationDelayField[0],propagationDelayField,S.Settings.propagationDelayField[1]).render());const showUserdataLink=a(S.Settings.showUserDataLink[1],style("text-decoration: underline; cursor: pointer")).render();showUserdataLink.addEventListener("click",(()=>{alert(S.Settings.userDataHeader+"\n\n"+import_json57.default.stringify(this.userdata,void 0,4))}));const showUserDataLinkContainer=div(style("margin-top: 5px; display: none"),S.Settings.showUserDataLink[0],showUserdataLink).render();settingsPalette.appendChild(showUserDataLinkContainer),this.optionsHtml={animateWiresCheckbox:animateWiresCheckbox,hideWireColorsCheckbox:hideWireColorsCheckbox,hideInputColorsCheckbox:hideInputColorsCheckbox,hideOutputColorsCheckbox:hideOutputColorsCheckbox,hideMemoryContentCheckbox:hideMemoryContentCheckbox,wireStylePopup:wireStylePopup,showGateTypesCheckbox:showGateTypesCheckbox,showDisconnectedPinsCheckbox:showDisconnectedPinsCheckbox,hideTooltipsCheckbox:hideTooltipsCheckbox,groupParallelWiresCheckbox:groupParallelWiresCheckbox,showHiddenWiresCheckbox:showHiddenWiresCheckbox,showAnchorsCheckbox:showAnchorsCheckbox,showIdsCheckbox:showIdsCheckbox,propagationDelayField:propagationDelayField,showUserDataLinkContainer:showUserDataLinkContainer},this.setCanvasSize(),onVisible(this.html.canvasContainer,(()=>{this.redraw()})),this.tryLoadCircuitFromData(!0,!1),this.setModeFromString(this.getAttribute(ATTRIBUTE_NAMES_mode)),this.setCanvasSize(),_LogicEditor.installGlobalListeners(),this.doRedraw(!0)}findLightDOMChild(tagName){const TAGNAME=tagName.toUpperCase();for(const child of this.children)if(child.tagName===TAGNAME)return child;return null}static installGlobalListeners(){if(_LogicEditor._globalListenersInstalled)return;window.decompress=LZString.decompressFromEncodedURIComponent,window.decodeOld=_LogicEditor.decodeFromURLOld,window.formatString=formatString,window.gallery=gallery;const makeUpdatePointerPositionHandler=__name((closingContextMenus=>e=>{for(const editor of _LogicEditor._allConnectedEditors){const canvasContainer=editor.html.canvasContainer;if(void 0!==canvasContainer){const canvasPos=canvasContainer.getBoundingClientRect(),x=e.clientX-canvasPos.left,y=e.clientY-canvasPos.top;editor.pointerX=x/editor._userDrawingScale-editor._translationX,editor.pointerY=y/editor._userDrawingScale-editor._translationY}closingContextMenus&&editor.eventMgr.hideContextMenuIfNeeded(e)}}),"makeUpdatePointerPositionHandler");window.addEventListener("pointerdown",makeUpdatePointerPositionHandler(!0),!0),window.addEventListener("pointermove",makeUpdatePointerPositionHandler(!1),!0);const updateCursors=__name((()=>{for(const editor of _LogicEditor._allConnectedEditors)editor.updateCursor()}),"updateCursors");let pixelRatioMediaQuery;window.addEventListener("keydown",(e=>{" "===e.key&&(_LogicEditor._spaceDown=!0,updateCursors())})),window.addEventListener("keyup",(e=>{" "===e.key&&(_LogicEditor._spaceDown=!1,updateCursors())})),window.addEventListener("resize",(()=>{var _a;for(const editor of _LogicEditor._allConnectedEditors){void 0!==editor.html.canvasContainer&&editor.wrapHandler((()=>{editor.setCanvasSize(),editor.editTools.redrawMgr.requestRedraw({why:"window resized",invalidateMask:!0})}))(),null==(_a=editor._topBar)||_a.updateCompactMode()}registerPixelRatioListener()}));const registerPixelRatioListener=__name((()=>{void 0!==pixelRatioMediaQuery&&(pixelRatioMediaQuery.onchange=null);const queryString="(resolution: ".concat(window.devicePixelRatio,"dppx)");pixelRatioMediaQuery=window.matchMedia(queryString),pixelRatioMediaQuery.onchange=()=>{for(const editor of _LogicEditor._allConnectedEditors)editor.wrapHandler((()=>{editor.setCanvasSize(),editor.editTools.redrawMgr.requestRedraw({why:"devicePixelRatio changed",invalidateMask:!0})}))();registerPixelRatioListener()}}),"registerPixelRatioListener");registerPixelRatioListener(),document.body.addEventListener("themechanged",(e=>{var _a;setDarkMode(Boolean(null==(_a=e.detail)?void 0:_a.is_dark_theme),!1)}));new MutationObserver((function(mutations){mutations.forEach((function(mutation){if("attributes"===mutation.type&&"data-md-color-switching"===mutation.attributeName&&null===document.body.getAttribute("data-md-color-switching")){const newBackgroundColor=getComputedStyle(document.body).backgroundColor;console.log("Logic: looks like new background color is "+newBackgroundColor),window.Logic.setDarkMode(newBackgroundColor)}}))})).observe(document.body,{attributes:!0}),_LogicEditor._globalListenersInstalled=!0}setMode(mode,doSetFocus){this.wrapHandler((()=>{var _a;let modeStr=Mode2[mode].toLowerCase();mode>this._maxInstanceMode&&(mode=this._maxInstanceMode,console.log("Cannot switch to mode ".concat(modeStr," because we are capped by ").concat(Mode2[this._maxInstanceMode])),modeStr=Mode2[mode].toLowerCase()),this._mode=mode;const modes=[];for(let i2=0;i2<=mode;i2++)modes.push(Mode2[i2].toLowerCase());this.html.rootDiv.setAttribute(ATTRIBUTE_NAMES_modes,modes.join(" "));const nomodes=[];for(let i2=mode+1;i2<=4;i2++)nomodes.push(Mode2[i2].toLowerCase());this.html.rootDiv.setAttribute(ATTRIBUTE_NAMES_nomodes,nomodes.join(" ")),this.editTools.redrawMgr.requestRedraw({why:"mode changed",invalidateMask:!0}),this.root.querySelectorAll(".sim-mode-tool").forEach((elem=>{elem.getAttribute("mode")===modeStr?elem.classList.add("active"):elem.classList.remove("active")})),mode<2&&this.setCurrentPointerAction("edit");const showComponentsAndEditControls=mode>=3?"show":this._maxInstanceMode>=3?"inactive":"hide",showEditControls="show"===showComponentsAndEditControls,showReset=mode>=1&&!this._hideResetButton,showOnlyReset=showReset&&!showEditControls,hideSettings=mode<4;null==(_a=this._topBar)||_a.setButtonStateFromMode({showComponentsAndEditControls:showComponentsAndEditControls,showReset:showReset},mode),setVisible(this.html.rightToolbarContainer,showOnlyReset),hideSettings&&setVisible(this.html.settingsPalette,!1),setDisplay(this.html.leftToolbar,showComponentsAndEditControls),mode<2?this.setTestsPaletteVisible(!1):this.didLoadTests(this.testSuites),doSetFocus&&this.focus()}))()}setModeFromString(modeStr){let mode=this._maxInstanceMode;null!==modeStr&&(modeStr=modeStr.toUpperCase())in Mode2&&(mode=Mode2[modeStr]),this.setMode(mode,!1)}setCircuitName(name2){var _a;this._options.name=void 0===name2||0===name2.length?void 0:name2,null==(_a=this._topBar)||_a.setCircuitName(name2),this.setWindowTitleFrom(this._options.name)}setZoom(zoom,updateTopBar){var _a;zoom=Math.max(10,Math.min(1e3,zoom));const roundedZoomForUI=Math.round(zoom);return this._options.zoom=roundedZoomForUI,this._userDrawingScale=zoom/100,updateTopBar&&(null==(_a=this._topBar)||_a.setZoom(roundedZoomForUI)),this.editTools.redrawMgr.requestRedraw({why:"zoom level changed",invalidateMask:!0}),zoom}setTranslation(tX,tY){this._translationX=tX,this._translationY=tY,this.editTools.redrawMgr.requestRedraw({why:"translation changed",invalidateMask:!0})}updateCustomComponentButtons(){var _a;void 0!==this._menu&&(this._menu.updateCustomComponentButtons(this.factory.customDefs()),this.eventMgr.registerButtonListenersOn(this._menu.allCustomButtons(),!0)),null==(_a=this._topBar)||_a.updateCustomComponentCaption()}allowGateType(type7){var _a,_b;return null==(_b=null==(_a=this._menu)?void 0:_a.allowGateType(type7))||_b}focus(){this.html.mainCanvas.focus()}trySaveInBrowserStorage(circuit){const key=this.persistenceKey;if(void 0===key)return;const saveStr=Date.now()+";"+Serialization.stringifyObject(circuit,!0);try{sessionStorage.setItem(key,saveStr),this._autosave&&localStorage.setItem(key,saveStr)}catch(e){console.error("Failed to save circuit to browser storage",e)}}tryLoadFromSessionStorage(){const savedTime=this.tryLoadFromStorage(sessionStorage,!1);return void 0!==savedTime&&(isString(savedTime)?(console.error("Failed to load circuit from session storage",savedTime),!1):(this.showLoadedMessage(savedTime,!0),!0))}tryLoadFromLocalStorage(){const savedTime=this.tryLoadFromStorage(localStorage,!0);return void 0===savedTime?(window.alert(S.Messages.NoSavedData),!1):isString(savedTime)?(window.alert(S.Messages.FailedToLoadCircuitFromStorage.expand({error:savedTime})),console.error("Failed to load circuit from session storage",savedTime),!1):(this.showLoadedMessage(savedTime,!1),!0)}showLoadedMessage(savedTime,keepOpen){const day=savedTime.toLocaleDateString(void 0,{year:"2-digit",month:"2-digit",day:"2-digit"}),time=savedTime.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:void 0});this.showMessage(S.Messages.LoadedCircuitFromSessionStorage.expand({day:day,time:time}),keepOpen?0:2e3,keepOpen)}tryLoadFromStorage(storage,takeSnapshot){const key=this.persistenceKey;if(void 0===key)return;const savedStr=storage.getItem(key);if(null===savedStr||0===savedStr.length)return;let semicolIndex=-1;if(-1===(semicolIndex=savedStr.indexOf(";")))return"unparseable saved string";const circuitStr=savedStr.substring(semicolIndex+1),error=Serialization.loadCircuitOrLibrary(this,circuitStr,takeSnapshot);if(void 0!==error)return error;try{return new Date(Number(savedStr.substring(0,semicolIndex)))}catch(e){return new Date}}tryClearBrowserStorage(){const key=this.persistenceKey;if(void 0!==key){try{localStorage.removeItem(key)}catch(e){}try{sessionStorage.removeItem(key)}catch(e){}}}tryLoadFrom(file){if("application/json"===file.type||"application/json5"===file.type||"text/plain"===file.type){const reader=new FileReader;reader.onload=()=>{var _a;const content=null==(_a=reader.result)?void 0:_a.toString();void 0!==content&&this.loadCircuitOrLibrary(content)},reader.readAsText(file,"utf-8")}else if("image/png"===file.type){const reader=new FileReader;reader.onload=()=>{var _a;const content=reader.result;if(content instanceof ArrayBuffer){const uintArray2=new Uint8Array(content),compressedJSON=null==(_a=pngMeta.readMetadata(uintArray2).tEXt)?void 0:_a.Description;isString(compressedJSON)&&(this._initialData={_type:"compressed",str:compressedJSON},this.wrapHandler((()=>{this.tryLoadCircuitFromData(!1,!0)}))())}},reader.readAsArrayBuffer(file)}else if("image/svg+xml"===file.type){const reader=new FileReader;reader.onload=e=>{var _a,_b;const content=null==(_b=null==(_a=e.target)?void 0:_a.result)?void 0:_b.toString();if(void 0!==content){const temp=document.createElement("div");temp.innerHTML=content;const metadata=temp.querySelector("svg metadata"),json=null==metadata?void 0:metadata.textContent;temp.remove(),null!=json&&this.loadCircuitOrLibrary(json)}},reader.readAsText(file,"utf-8")}else this.showMessage(S.Messages.UnsupportedFileType.expand({type:file.type}))}tryLoadCircuitFromData(tryLoadStorage,takeSnapshot){var _a;if(void 0!==this._initialData){if("url"===this._initialData._type){const url=this._initialData.url;return void fetch(url,{mode:"cors"}).then((response=>response.text())).then((json=>{console.log("Loaded initial data from URL '".concat(url,"'")),this._initialData={_type:"json",json:json},this.tryLoadCircuitFromData(tryLoadStorage,takeSnapshot)}))}let error;if("json"===this._initialData._type)try{error=Serialization.loadCircuitOrLibrary(this,this._initialData.json,takeSnapshot)}catch(e){error=String(e)+" (JSON)"}else{let decodedData;try{if(decodedData=LZString.decompressFromEncodedURIComponent(this._initialData.str),0!==this._initialData.str.length&&0===(null!=(_a=null==decodedData?void 0:decodedData.length)?_a:0))throw new Error("zero decoded length")}catch(err){error=String(err)+" (LZString)";try{decodedData=_LogicEditor.decodeFromURLOld(this._initialData.str),error=void 0}catch(e){}}void 0===error&&isString(decodedData)&&(error=Serialization.loadCircuitOrLibrary(this,decodedData,takeSnapshot),void 0===error&&(this._initialData={_type:"json",json:decodedData}))}void 0!==error&&console.log("ERROR could not not load initial data: "+error)}let isConsideredDirty=!1;tryLoadStorage&&this.tryLoadFromSessionStorage()&&(isConsideredDirty=!0),isConsideredDirty||this.clearDirty()}resetCircuit(){this.tryClearBrowserStorage(),this.editor.tryLoadCircuitFromData(!1,!1)}tryCloseCustomComponentEditor(){const editorRoot=this.editor.editorRoot;if(!(editorRoot instanceof CustomComponent))return!1;const def=editorRoot.customDef,error=this.editor.factory.tryModifyCustomComponent(def,editorRoot);if(void 0!==error)return 0!==error.length&&window.alert(error),!0;for(const type7 of this.factory.getCustomComponentTypesWhichUse(def.type))this.components.updateCustomComponents(type7);return this.setEditorRoot(this.editor),this.editTools.undoMgr.takeSnapshot(),!0}loadCircuitOrLibrary(jsonStringOrObject){this.wrapHandler((jsonStringOrObject2=>Serialization.loadCircuitOrLibrary(this,jsonStringOrObject2,!0)))(jsonStringOrObject)}makeGroupWithSelection(){var _a;const selectedComps=(null==(_a=this.eventMgr.currentSelection)?void 0:_a.previouslySelectedElements)||new Set;if(0===selectedComps.size)return!1;const newGroup=RectangleDef.make(this);if(newGroup.setSpawned(),newGroup instanceof Rectangle){newGroup.wrapContents(selectedComps);for(const comp of selectedComps)comp instanceof DrawableWithDraggablePosition&&void 0===comp.anchor&&(comp.anchor=newGroup)}else console.log("ERROR: created component is not a Rectangle");return!0}setDirty(__reason){var _a;this.mode>=2&&(this._isDirty=!0,null==(_a=this._topBar)||_a.setDirty(!0))}clearDirty(){var _a;this._isDirty=!1,null==(_a=this._topBar)||_a.setDirty(!1)}setDark(dark){this.html.rootDiv.classList.toggle("dark",dark)}setEditorRoot(newRoot){var _a,_b;if(newRoot===this._editorRoot)return;void 0!==this._editorRoot&&this._editorRoot.stopEditingThis(),this._editorRoot=newRoot,newRoot.startEditingThis(this.editTools);const[customComp,typesToHide]=newRoot instanceof CustomComponent?[newRoot,this.factory.getCustomComponentTypesWhichUse(newRoot.customDef.type)]:[void 0,[]];null==(_a=this._menu)||_a.setCustomComponentsHidden(typesToHide),null==(_b=this._topBar)||_b.setEditingCustomComponent(null==customComp?void 0:customComp.customDef),this._highlightedItems=void 0,this.eventMgr.currentSelection=void 0,this.eventMgr.clearTooltipIfNeeded(),this.eventMgr.updateComponentUnderPointer([this.pointerX,this.pointerY],!1,!1,!1),this.editTools.testsPalette.update(),this.editTools.moveMgr.clear(),this.editTools.redrawMgr.requestRedraw({why:"editor root changed",invalidateMask:!0,invalidateTests:!0}),this.focus()}setCurrentPointerAction(action){let forceUpdate=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var _a,_len8=arguments.length,params=new Array(_len8>2?_len8-2:0),_key8=2;_key8<_len8;_key8++)params[_key8-2]=arguments[_key8];const changed=this.eventMgr.setHandlersFor(action,...params);return(forceUpdate||changed)&&(this.setToolCursor(PointerActions[action].cursor),null==(_a=this._topBar)||_a.updateActiveTool(action),this.editTools.redrawMgr.requestRedraw({why:"mouse action changed"}),this.editor.focus()),changed}updateCursor(e){var _a,_b,_c;const cursor=this.editTools.moveMgr.areDrawablesMoving()?"grabbing":null!=(_c=null!=(_b=this._toolCursor)?_b:null==(_a=this.eventMgr.currentComponentUnderPointer)?void 0:_a.cursorWhenMouseover(e))?_c:_LogicEditor._spaceDown&&this._mode>=2?"grab":"default";this.html.canvasContainer.style.cursor=cursor}showMessage(msg){let duration=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,withCloseButton=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var _a,_b;return null!=(_b=null==(_a=this._messageBar)?void 0:_a.showMessage(msg,duration,withCloseButton))?_b:()=>{}}offsetXYForContextMenu(e){let snapToGrid=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const mainCanvas=this.html.mainCanvas;let x,y;if("offsetX"in e&&0===e.offsetX&&0===e.offsetY&&e.target===mainCanvas){const canvasRect=mainCanvas.getBoundingClientRect();x=e.clientX-canvasRect.x,y=e.clientY-canvasRect.y}else{if("dragStartX"in e)return[e.dragStartX,e.dragStartY];[x,y]=this.offsetXY(e)}return snapToGrid&&(x=Math.round(x/GRID_STEP)*GRID_STEP,y=Math.round(y/GRID_STEP)*GRID_STEP),[x,y]}offsetXY(e){let skipTransform=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[unscaledX,unscaledY]=(()=>{const mainCanvas=this.html.mainCanvas;let target2=e.target;if("offsetX"in e){const canvasRect=mainCanvas.getBoundingClientRect();let offsetX=e.offsetX,offsetY=e.offsetY;if(0===offsetX&&0===offsetY){const _e=e;"_savedOffsetX"in _e?(offsetX=_e._savedOffsetX,offsetY=_e._savedOffsetY,target2=_e._savedTarget):"layerX"in e&&(offsetX=_e.layerX+canvasRect.x,offsetY=_e.layerY+canvasRect.y)}if(target2===mainCanvas)return[offsetX,offsetY];{const elemRect=target2.getBoundingClientRect();return[Math.max(2*GRID_STEP,offsetX+elemRect.x-canvasRect.x),Math.max(2*GRID_STEP,offsetY+elemRect.y-canvasRect.y)]}}throw console.error("calling offsetXY with TouchEvent"),new Error("not implemented")})(),[f,tX,tY]=skipTransform?[1,0,0]:[this._userDrawingScale,this._translationX,this._translationY];return[unscaledX/f-tX,unscaledY/f-tY]}offsetXYForComponent(e,comp){const offset2=this.offsetXY(e);if(comp.orient===Orientation.default)return offset2;const[x,y]=offset2,dx=x-comp.posX,dy=y-comp.posY;switch(comp.orient){case"e":return offset2;case"w":return[comp.posX-dx,comp.posY-dy];case"s":return[comp.posX-dy,comp.posY-dx];case"n":return[comp.posX+dy,comp.posY+dx]}}guessAdequateCanvasSize(applyZoom){let rightmostX=Number.NEGATIVE_INFINITY,leftmostX=Number.POSITIVE_INFINITY,lowestY=Number.NEGATIVE_INFINITY,highestY=Number.POSITIVE_INFINITY;const drawables=[...this.editorRoot.components.all()];for(const wire of this.linkMgr.wires)drawables.push(...wire.waypoints);for(const comp of drawables){const cx=comp.posX,width=comp.width,left2=cx-width/2,right2=left2+width;right2>rightmostX&&(rightmostX=right2),left2<leftmostX&&(leftmostX=left2);const cy=comp.posY,height=comp.height,top2=cy-height/2,bottom2=top2+height;bottom2>lowestY&&(lowestY=bottom2),top2<highestY&&(highestY=top2)}leftmostX=Math.max(0,leftmostX);let w=rightmostX+leftmostX;isNaN(w)&&(w=300),highestY=Math.max(0,highestY);let h=highestY+lowestY;isNaN(h)&&(h=150);const f=applyZoom?this._userDrawingScale:1;return[f*w,f*h]}async shareSheetForMode(mode){this._mode>3&&(this._mode=3);const modeStr=Mode2[mode].toLowerCase(),idWhenExporting=this.idWhenExporting,{fullJson:fullJson,compressedJsonForUri:compressedJsonForUri,showOnlyArr:showOnlyArr}=this.fullJsonStateAndCompressedForUri(!0);console.log("JSON:\n"+fullJson);const fullUrl=this.fullUrlForMode(mode,compressedJsonForUri,showOnlyArr,idWhenExporting);this.html.embedUrl.value=fullUrl;const modeParam=3===mode?"":":mode: ".concat(modeStr),embedHeight=this.guessAdequateCanvasSize(!0)[1],showOnlySpaceDelim=void 0===showOnlyArr?void 0:showOnlyArr.join(" "),markdownBlock="superfence"===this._exportformat?"```{.logic id=".concat(idWhenExporting," height=").concat(embedHeight," mode=").concat(modeStr).concat(void 0===showOnlySpaceDelim?"":"showonly=".concat(showOnlySpaceDelim),"}\n").concat(fullJson,"\n```"):"```{logic}\n:id: ".concat(idWhenExporting,"\n:height: ").concat(embedHeight,"\n").concat(modeParam,"\n").concat(void 0===showOnlySpaceDelim?"":":showonly: ".concat(showOnlySpaceDelim,"\n"),"\n").concat(fullJson,"\n```");this.html.embedMarkdown.value=markdownBlock;const showOnlyHtmlAttr=void 0===showOnlySpaceDelim?"":' showonly="'.concat(showOnlySpaceDelim,'"'),iframeEmbed='<iframe style="width: 100%; height: '.concat(embedHeight,'px; border: 0"').concat(showOnlyHtmlAttr,' src="').concat(fullUrl,'"></iframe>');this.html.embedIframe.value=iframeEmbed;const webcompEmbed='<div style="width: 100%; height: '.concat(embedHeight,'px">\n  <logic-editor id="').concat(idWhenExporting,'" mode="').concat(Mode2[mode].toLowerCase(),'"').concat(showOnlyHtmlAttr,'>\n    <script type="application/json5">\n      ').concat(fullJson.replace(/\n/g,"\n      "),"\n    <\/script>\n  </logic-editor>\n</div>");this.html.embedWebcomp.value=webcompEmbed,this.saveToUrl(compressedJsonForUri,showOnlyArr),showModal(this.html.embedDialog)||(await copyToClipboard(fullUrl)?console.log("  -> Copied!"):console.log("  -> Could not copy!"))}saveCurrentStateToUrl(){const{fullJson:fullJson,compressedJsonForUri:compressedJsonForUri,showOnlyArr:showOnlyArr}=this.fullJsonStateAndCompressedForUri(!0);console.log("Saved to URL compressed version of:\n"+fullJson),this.saveToUrl(compressedJsonForUri,showOnlyArr)}save(){return Serialization.buildCircuitObject(this)}saveToUrl(compressedUriSafeJson,showOnly){this._isSingleton&&(history.pushState(null,"",this.fullUrlForMode(4,compressedUriSafeJson,showOnly,this.instanceId)),this.clearDirty(),this.showMessage(S.Messages.SavedToUrl))}fullJsonStateAndCompressedForUri(removeShowOnly){let showOnlyArr;const jsonObj=Serialization.buildCircuitObject(this);removeShowOnly&&(showOnlyArr=Serialization.removeShowOnlyFrom(jsonObj));const fullJson=Serialization.stringifyObject(jsonObj,!1);removeShowOnly||(showOnlyArr=Serialization.removeShowOnlyFrom(jsonObj));const jsonForUri=Serialization.stringifyObject(jsonObj,!0);return{fullJson:fullJson,compressedJsonForUri:LZString.compressToEncodedURIComponent(jsonForUri),showOnlyArr:showOnlyArr}}fullUrlForMode(mode,compressedUriSafeJson,showOnlyArr,id){const loc=window.location,showOnlyParam=void 0===showOnlyArr?"":"&".concat(ATTRIBUTE_NAMES_showonly,"=").concat(showOnlyArr.join(",")),currentLang=getLang(),langParam=new URL(loc.href).searchParams.get(ATTRIBUTE_NAMES_lang)===currentLang?"&".concat(ATTRIBUTE_NAMES_lang,"=").concat(currentLang):"";"_main"===id&&(id=void 0);const idParam=void 0===id?"":"id=".concat(id,"&");return"".concat(loc.protocol,"//").concat(loc.host).concat(loc.pathname,"?").concat(idParam).concat(ATTRIBUTE_NAMES_mode,"=").concat(Mode2[mode].toLowerCase()).concat(langParam).concat(showOnlyParam,"&").concat(ATTRIBUTE_NAMES_data,"=").concat(compressedUriSafeJson)}toBase64(blob){return new Promise(((resolve,__)=>{if(null==blob)return void resolve(void 0);const reader=new FileReader;reader.onloadend=()=>{const dataURL=reader.result,asBase64=dataURL.substring(dataURL.indexOf(",")+1);resolve(asBase64)},reader.readAsDataURL(blob)}))}async toPNG(withMetadata,heightHint){const pngBareBlob=await new Promise((resolve=>{let[width,height]=this.guessAdequateCanvasSize(!1);void 0!==heightHint&&(height=heightHint),width*=3,height*=3;const transform=(new DOMMatrix).scale(3),tmpCanvas=document.createElement("canvas");tmpCanvas.width=width,tmpCanvas.height=height;const g=_LogicEditor.getGraphics(tmpCanvas),wasDark=isDarkMode();wasDark&&setDarkMode(!1,!1),this.doDrawWithContext(g,width,height,transform,transform,!0,!0,!1),wasDark&&setDarkMode(!0,!1),tmpCanvas.toBlob(resolve,"image/png"),tmpCanvas.remove()}));if(null===pngBareBlob)return;if(!withMetadata)return pngBareBlob;const{compressedJsonForUri:compressedJsonForUri}=this.fullJsonStateAndCompressedForUri(!1),pngBareData=new Uint8Array(await pngBareBlob.arrayBuffer()),pngChunks=pngMeta.extractChunks(pngBareData);return pngMeta.insertMetadata(pngChunks,{tEXt:{Description:compressedJsonForUri}}),new Blob([pngMeta.encodeChunks(pngChunks)],{type:"image/png"})}async toSVG(withMetadata){const metadata=withMetadata?Serialization.stringifyObject(Serialization.buildCircuitObject(this),!1):void 0,[width,height]=this.guessAdequateCanvasSize(!1),id=new DOMMatrix,svgCtx=new SVGRenderingContext({width:width,height:height,metadata:metadata});this.doDrawWithContext(svgCtx,width,height,id,id,!0,!0,!1);const serializedSVG=svgCtx.getSerializedSvg();return Promise.resolve(new Blob([serializedSVG],{type:"image/svg+xml"}))}async download(data2,extension){const blob=await data2;if(void 0===blob)return;const filename=this.documentDisplayName+extension;(0,import_file_saver3.saveAs)(blob,filename)}setTestsPaletteVisible(visible){var _a;this.editTools.testsPalette.setVisible(visible),null==(_a=this._topBar)||_a.updateTestPaletteVisible(visible)}didLoadTests(testSuites){var _a;const numTests=testSuites.totalCases();null==(_a=this._topBar)||_a.setTestPaletteButtonVisible(numTests),this.setTestsPaletteVisible(numTests>0)}addTestCases(result){var _a,_b,_c;let testSuite;this.testSuites.suites.length>0?testSuite=this.testSuites.suites[0]:(testSuite=new TestSuite,this.testSuites.push(testSuite)),Array.isArray(result)?testSuite.testCases.push(...result):testSuite.testCases.push(result),null==(_a=this.ifEditing)||_a.setDirty("added test case"),null==(_b=this.ifEditing)||_b.undoMgr.takeSnapshot(),null==(_c=this.ifEditing)||_c.testsPalette.update()}removeTestCase(testCase){var _a,_b,_c;for(const testSuite of this.testSuites.suites){const idx=testSuite.testCases.indexOf(testCase);if(idx>=0)return testSuite.testCases.splice(idx,1),null==(_a=this.ifEditing)||_a.setDirty("removed test case"),null==(_b=this.ifEditing)||_b.undoMgr.takeSnapshot(),void(null==(_c=this.ifEditing)||_c.testsPalette.update())}}async disableUIWhile(message,action){if(this._isRunningOrCreatingTests)return;this._isRunningOrCreatingTests=!0;const oldMode=this.mode,restoreAfter=new Map,hideMsg=this.showMessage(message,0);try{this.setMode(0,!1);return await action(restoreAfter)}finally{hideMsg(),this.setMode(oldMode,!0);for(const[input2,value]of restoreAfter)input2.setValue(value);this.recalcPropagateAndDrawIfNeeded(),await this.waitForPropagation(),this._isRunningOrCreatingTests=!1}}async runTestSuite(testSuite,options){var _a,_b,_c;const palette=this.editTools.testsPalette;if(void 0===palette)return;const noUI=null!=(_a=null==options?void 0:options.noUI)&&_a,fast=noUI||null!=(_b=null==options?void 0:options.fast)&&_b,doLog=null!=(_c=null==options?void 0:options.doLog)&&_c;if(!(testSuite instanceof TestSuite)){const testSuiteRepr=validateJson(testSuite,TestSuite.Repr,"test suite");if(void 0===testSuiteRepr)return;testSuite=new TestSuite([testSuiteRepr,this.editor.components])}return this.disableUIWhile(S.Messages.RunningTests,(async restoreAfter=>{this.setTestsPaletteVisible(!0);const results=new TestSuiteResults(testSuite),ui=noUI?void 0:palette.getOrMakeUIFor(testSuite);let isFirst=!0,skip=!1;for(let i2=0;i2<testSuite.testCases.length;i2++){const testCase=testSuite.testCases[i2];let testCaseResult;if(null==ui||ui.setRunning(i2),isFirst?isFirst=!1:skip||fast||await new Promise((resolve=>setTimeout(resolve,2e3))),skip)testCaseResult=TestCaseResult.Skip;else{const[oldInValues,result]=await this.runTestCase(testCase,testSuite,doLog);testCaseResult=result;for(const[input2,value]of oldInValues)restoreAfter.has(input2)||restoreAfter.set(input2,value)}results.addTestCaseResult(testCase,testCaseResult),null==ui||ui.setResult(i2,testCaseResult),testCase.stopOnFail&&"fail"===testCaseResult._tag&&(skip=!0)}return results}))}trySetInputsAndRecalc(inputs){for(const[input2,valueRepr]of inputs)isString(input2)?console.error("Input component ".concat(input2," not found")):input2.setValue(valuesFromReprForInput(valueRepr,input2.numBits));this.recalcPropagateAndDrawIfNeeded(!1)}async runTestCase(testCase,sourceSuite,doLog){if(doLog){const fullTestNameParts=[sourceSuite.name,testCase.name].filter(Boolean),fullTestName=0===fullTestNameParts.length?S.Tests.DefaultTestCaseName:fullTestNameParts.join("/");console.group("Running test case "+fullTestName)}testCase.tryFixReferences(this.editorRoot.components);const oldInValues=new Map;try{for(const[input2,valueRepr]of testCase.in){if(isString(input2))return[oldInValues,TestCaseResult.Error("Input component ".concat(input2," not found"))];oldInValues.set(input2,input2.value),input2.setValue(valuesFromReprForInput(valueRepr,input2.numBits))}this.recalcPropagateAndDrawIfNeeded(!0),await this.waitForPropagation();const mismatches=[];for(const[output,expectedRepr]of testCase.out){if(isString(output))return[oldInValues,TestCaseResult.Error("Output component ".concat(output," not found"))];const actual=output.value,expected=valuesFromReprForInput(expectedRepr,output.numBits);if(deepArrayEquals(actual,expected)){if(doLog){const passMsg="".concat(output.ref," is ").concat(expected);console.log("%cPASS:%c ".concat(passMsg),"color: green; font-weight: bold;","")}}else if(mismatches.push({output:output,expected:expected,actual:actual}),doLog){const failMsg="".concat(output.ref," is ").concat(actual," instead of ").concat(expected);console.log("%cFAIL:%c ".concat(failMsg),"color: red; font-weight: bold;","")}}return[oldInValues,0===mismatches.length?TestCaseResult.Pass:TestCaseResult.Fail(mismatches)]}finally{doLog&&console.groupEnd()}}waitForPropagation(){return this._propagationPromise}recalcPropagateAndDrawIfNeeded(){let forceNow=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var _a,_b;if(null!==this._nextAnimationFrameHandle){if(!forceNow)return;cancelAnimationFrame(this._nextAnimationFrameHandle),this._nextAnimationFrameHandle=null}this.recalcMgr.recalcAndPropagateIfNeeded();const redrawMgr=this.editTools.redrawMgr,linkMgr=this._editorRoot.linkMgr;(linkMgr.isAddingWire||linkMgr.isSettingAnchor)&&redrawMgr.requestRedraw({why:"adding a wire/setting anchor"});const animateWires=this._options.animateWires,redrawInfo=redrawMgr.getReasonsAndClear();if(void 0===redrawInfo&&!animateWires)return;void 0!==redrawInfo&&void 0===this._propagationResolve&&(this._propagationPromise=new Promise((resolve=>{this._propagationResolve=resolve})));const redrawMask=null!=(_a=null==redrawInfo?void 0:redrawInfo.redrawMask)&&_a;this.doRedraw(redrawMask);null!=(_b=null==redrawInfo?void 0:redrawInfo.invalidateTests)&&_b&&!this._isRunningOrCreatingTests&&this.editTools.testsPalette.clearDisplayedResults(),redrawMgr.isAnyValuePropagating()||void 0!==this._propagationResolve&&(this.timeline.hasPendingCallbacksNow()||(this._propagationResolve(),this._propagationResolve=void 0)),(animateWires||redrawMgr.hasReasons())&&(this._nextAnimationFrameHandle=requestAnimationFrame((()=>{this._nextAnimationFrameHandle=null,this.recalcPropagateAndDrawIfNeeded()})))}highlight(refs){if(void 0===refs)return void(this._highlightedItems=void 0);isString(refs)&&(refs=[refs]);const highlightComps=[],highlightWires=[];if(isArray(refs)){for(const comp of this.components.all())void 0!==comp.ref&&refs.includes(comp.ref)&&highlightComps.push(comp);for(const wire of this.linkMgr.wires)void 0!==wire.ref&&refs.includes(wire.ref)&&highlightWires.push(wire);if(0===highlightComps.length&&0===highlightWires.length)return console.log("Nothing to highlight for ref '".concat(refs,"'")),void(this._highlightedItems=void 0)}else highlightComps.push(refs);const start2=this.timeline.unadjustedTime();this._highlightedItems={comps:highlightComps,wires:highlightWires,start:start2},this.editTools.redrawMgr.requestRedraw({why:"highlighting component"}),this.recalcPropagateAndDrawIfNeeded()}redraw(){this.setCanvasSize(),this.editTools.redrawMgr.requestRedraw({why:"explicit redraw call",invalidateMask:!0}),this.recalcPropagateAndDrawIfNeeded()}doRedraw(redrawMask){var _a;null==(_a=this._topBar)||_a.updateTimeLabelIfNeeded();const g=_LogicEditor.getGraphics(this.html.mainCanvas),mainCanvas=this.html.mainCanvas,baseDrawingScale=this._baseUIDrawingScale,width=mainCanvas.width/baseDrawingScale,height=mainCanvas.height/baseDrawingScale,baseTransform=(new DOMMatrix).scale(this._baseUIDrawingScale),contentTransform=baseTransform.scale(this._userDrawingScale).translate(this._translationX,this._translationY);this.doDrawWithContext(g,width,height,baseTransform,contentTransform,!1,!1,redrawMask)}doDrawWithContext(g,width,height,baseTransform,contentTransform,skipBorder,transparentBackground,__redrawMask){var _a,_b;g.setTransform(baseTransform),g.lineCap="square",g.textBaseline="alphabetic",g.fillStyle=COLOR_BACKGROUND,transparentBackground?g.clearRect(0,0,width,height):g.fillRect(0,0,width,height),g.setTransform(contentTransform);const highlightRectFor=__name((comp=>{let w=comp.unrotatedWidth+15+15,h=comp.unrotatedHeight+15+15;if(Orientation.isVertical(comp.orient)){const t38=w;w=h,h=t38}return new DOMRect(comp.posX-w/2,comp.posY-h/2,w,h)}),"highlightRectFor"),highlightedItems=this._highlightedItems;let highlightColor;if(void 0!==highlightedItems){const HOLD_TIME=2e3,FADE_OUT_TIME=200,START_ALPHA=.4,elapsed=this.timeline.unadjustedTime()-highlightedItems.start,highlightAlpha=elapsed<HOLD_TIME?START_ALPHA:START_ALPHA*(1-(elapsed-HOLD_TIME)/FADE_OUT_TIME);if(highlightAlpha<=0)this._highlightedItems=void 0;else{g.beginPath();for(const comp of highlightedItems.comps){const highlightRect=highlightRectFor(comp);g.moveTo(highlightRect.x,highlightRect.y),g.lineTo(highlightRect.right,highlightRect.y),g.lineTo(highlightRect.right,highlightRect.bottom),g.lineTo(highlightRect.x,highlightRect.bottom),g.closePath()}highlightColor="rgba(238,241,0,".concat(highlightAlpha,")"),g.shadowColor=highlightColor,g.shadowBlur=20,g.shadowOffsetX=0,g.shadowOffsetY=0,g.fillStyle=highlightColor,g.fill(),g.shadowBlur=0,this.editTools.redrawMgr.requestRedraw({why:"highlight animation"})}}const moveMgr=this.editTools.moveMgr;if(moveMgr.areDrawablesMoving()){g.setTransform(baseTransform),g.scale(this._userDrawingScale,this._userDrawingScale),g.beginGroup("grid");const widthAdjusted=width/this._userDrawingScale,heightAdjusted=height/this._userDrawingScale,step=GRID_STEP;g.strokeStyle=COLOR_GRID_LINES,g.lineWidth=1,g.beginPath();for(let x=step;x<widthAdjusted;x+=step)g.moveTo(x,0),g.lineTo(x,heightAdjusted);for(let y=step;y<heightAdjusted;y+=step)g.moveTo(0,y),g.lineTo(widthAdjusted,y);g.stroke(),g.endGroup(),g.setTransform(contentTransform)}const singleMovingWayoint=moveMgr.getSingleMovingWaypoint();if(void 0!==singleMovingWayoint){g.beginGroup("guides");const guides=singleMovingWayoint.getPrevAndNextAnchors();g.strokeStyle=COLOR_GRID_LINES_GUIDES,g.lineWidth=1.5,g.beginPath();for(const guide of guides)g.moveTo(guide.posX,0),g.lineTo(guide.posX,height),g.moveTo(0,guide.posY),g.lineTo(width,guide.posY);g.stroke(),g.endGroup()}if(!skipBorder&&(this._mode>=2||4===this._maxInstanceMode)){if(g.beginGroup("border"),g.setTransform(baseTransform),g.strokeStyle=COLOR_BORDER,g.lineWidth=2,4===this._maxInstanceMode&&this._mode<this._maxInstanceMode){g.strokeRect(0,0,width,height);const h=this.guessAdequateCanvasSize(!0)[1];strokeSingleLine(g,0,h,width,h),g.fillStyle=COLOR_BACKGROUND_UNUSED_REGION,g.fillRect(0,h,width,height-h)}else{const myX=this.html.mainCanvas.getBoundingClientRect().x,[x1,x2]=null!=(_b=null==(_a=this._topBar)?void 0:_a.getActiveTabCoords())?_b:[0,0];g.beginPath(),g.moveTo(x1-myX,0),g.lineTo(0,0),g.lineTo(0,height),g.lineTo(width,height),g.lineTo(width,0),g.lineTo(x2-myX,0),g.stroke()}g.setTransform(contentTransform),g.endGroup()}const drawTime=this.timeline.logicalTime(),drawTimeAnimationFraction=this._options.animateWires?drawTime/1e3%1:void 0;g.strokeStyle=COLOR_COMPONENT_BORDER;const drawParams={drawTime:drawTime,drawTimeAnimationFraction:drawTimeAnimationFraction,currentCompUnderPointer:this.eventMgr.currentComponentUnderPointer,highlightedItems:highlightedItems,highlightColor:highlightColor,currentSelection:void 0,anythingMoving:moveMgr.areDrawablesMoving()},currentSelection=this.eventMgr.currentSelection;drawParams.currentSelection=currentSelection;const drawComp=__name((comp=>{g.beginGroup(comp.constructor.name);try{comp.draw(g,drawParams);for(const node of comp.allNodes())node.draw(g,drawParams)}finally{g.endGroup()}}),"drawComp"),root=this._editorRoot;g.beginGroup("background");for(const comp of root.components.withZIndex(DrawZIndex.Background))drawComp(comp);g.endGroup(),g.beginGroup("wires"),root.linkMgr.draw(g,drawParams),g.endGroup(),g.beginGroup("components");for(const comp of root.components.withZIndex(DrawZIndex.Normal))drawComp(comp);g.endGroup();const movingCompWithAnchor=moveMgr.getSingleMovingComponentWithAnchors();if(void 0!==movingCompWithAnchor)g.beginGroup("anchors"),drawAnchorsAroundComponent(g,movingCompWithAnchor,!0),g.endGroup();else if(this._options.showAnchors){g.beginGroup("anchors");for(const comp of root.components.all())drawAnchorsAroundComponent(g,comp,!1);g.endGroup()}g.beginGroup("overlays");for(const comp of root.components.withZIndex(DrawZIndex.Overlay))drawComp(comp);if(g.endGroup(),this._options.showIDs){g.beginGroup("refs"),g.font="bold 14px sans-serif",g.strokeStyle="white",g.lineWidth=3,g.fillStyle=COLOR_COMPONENT_ID,g.textAlign="center";for(const comp of root.components.all())void 0!==comp.ref&&(strokeTextVAlign(g,TextVAlign_middle,comp.ref,comp.posX,comp.posY),fillTextVAlign(g,TextVAlign_middle,comp.ref,comp.posX,comp.posY));g.endGroup()}let selRect;void 0!==currentSelection&&void 0!==(selRect=currentSelection.currentlyDrawnRect)&&(g.beginGroup("selection"),g.lineWidth=1.5,g.strokeStyle="rgb(100,100,255)",g.fillStyle="rgba(100,100,255,0.2)",g.beginPath(),g.rect(selRect.x,selRect.y,selRect.width,selRect.height),g.stroke(),g.fill(),g.endGroup())}drawDebugInfo(g){drawPoint(0,0);for(const d of[100,200])for(const[x,y]of[[-d,-d],[-d,0],[-d,d],[0,-d],[0,d],[d,d],[d,0],[d,-d]])drawPoint(x,y);function drawPoint(x,y){g.lineWidth=2,g.strokeStyle="red",g.beginPath(),g.moveTo(x-10,y),g.lineTo(x+10,y),g.moveTo(x,y-10),g.lineTo(x,y+10),g.stroke(),g.fillStyle="black",g.font="bold 10px sans-serif",g.textAlign="left",fillTextVAlign(g,TextVAlign_top,"".concat(x,",").concat(y),x+4,y+4)}__name(drawPoint,"drawPoint")}deleteSelection(){var _a,_b;if(this.eventMgr.currentSelectionEmpty())return!1;let anyDeleted=!1;for(const elem of null!=(_b=null==(_a=this.eventMgr.currentSelection)?void 0:_a.previouslySelectedElements)?_b:[])anyDeleted=this.eventMgr.tryDeleteDrawable(elem).isChange||anyDeleted;return!!anyDeleted&&(this.editTools.undoMgr.takeSnapshot(),!0)}async cut(){await this.copy()&&await this.deleteSelection()}async copy(){var _a,_b;if(this.eventMgr.currentSelectionEmpty())return!1;const componentsToInclude=[];for(const elem of null!=(_b=null==(_a=this.eventMgr.currentSelection)?void 0:_a.previouslySelectedElements)?_b:[])elem instanceof ComponentBase&&componentsToInclude.push(elem);const reprs=Serialization.buildComponentsAndWireObject(componentsToInclude,[],[this.pointerX,this.pointerY]);if(void 0===reprs.components&&void 0===reprs.wires)return!1;const jsonStr=Serialization.stringifyObject(reprs,!1),copied=await copyToClipboard(jsonStr);return copied?console.log("Copied:\n"+jsonStr):console.log("Could not copy"),this.focus(),copied}async paste(){const oldDontHogFocus=this._dontHogFocus;let jsonStr;this._dontHogFocus=!0;try{jsonStr=await pasteFromClipboard()}finally{this._dontHogFocus=oldDontHogFocus}if(void 0===jsonStr||""===jsonStr)return;const errorOrComps=Serialization.pasteComponents(this,jsonStr);if(isString(errorOrComps))console.log(errorOrComps);else{const selection=new EditorSelection(void 0);for(const comp of errorOrComps)selection.toggle(comp);this.eventMgr.currentSelection=selection}this.focus()}wrapHandler(f){var _this3=this;return function(){const result=f(...arguments);return _this3.recalcPropagateAndDrawIfNeeded(),result}}wrapAsyncHandler(f){var _this4=this;return async function(){const result=await f(...arguments);return _this4.recalcPropagateAndDrawIfNeeded(),result}}static decodeFromURLOld(str){return decodeURIComponent(atob(str.replace(/-/g,"+").replace(/_/g,"/").replace(/%3D/g,"=")))}static getGraphics(canvas2){const g=canvas2.getContext("2d");return g.createPath=path=>new Path2D(path),g.beginGroup=()=>{},g.endGroup=()=>{},g}},LogicEditor=_LogicEditor;__name(LogicEditor,"LogicEditor"),LogicEditor._globalListenersInstalled=!1,LogicEditor._spaceDown=!1,LogicEditor._allConnectedEditors=[];var LogicStatic=class{constructor(template2){this.template=template2,this.tests=new Tests,this.Serialization=Serialization}highlight(diagramRefs,componentRefs){var _a;isString(diagramRefs)&&(diagramRefs=[diagramRefs]);for(const diagramRef of diagramRefs){const diagram=null!=(_a=document.getElementById("logic_"+diagramRef))?_a:document.getElementById(diagramRef);if(null===diagram)return void console.log("Cannot find logic diagram with reference '".concat(diagramRef,"'"));if(!(diagram instanceof LogicEditor))return void console.log("Element with id '".concat(diagramRef,"' is not a logic editor"));diagram.highlight(componentRefs)}}runSampleTestSuite(options){const f=__name((async()=>{if(this.singleton){const testSuite=new TestSuite([{name:"Simple XOR gate test suite",cases:[{name:"false false -> false",in:{in0:0,in1:0},out:{out0:0},stopOnFail:!0},{name:"false true -> true",in:{in0:1,in1:0},out:{out0:1}},{name:"true false -> true",in:{in0:0,in1:1},out:{out0:1}},{name:"true true -> false",in:{in0:1,in1:1},out:{out0:0}}]},this.singleton.editorRoot.components]),_opts=isRecord(options)?options:{},results=await this.singleton.runTestSuite(testSuite,_opts);void 0===results?console.error("Could not run test suite"):results.dump()}}),"f");setTimeout(f,0)}printUndoStack(){var _a;null==(_a=this.singleton)||_a.editTools.undoMgr.dump()}setDarkMode(mode){if("auto"===mode)mode=window.matchMedia("(prefers-color-scheme: dark)").matches;else if("false"===mode)mode=!1;else if(isString(mode)){const col=parseColorToRGBA(mode);if(void 0!==col){const rgbaString=255===col[3]?"rgb(".concat(col[0],", ").concat(col[1],", ").concat(col[2],")"):"rgba(".concat(col[0],", ").concat(col[1],", ").concat(col[2],", ").concat(col[3]/255,")");USER_COLORS.COLOR_BACKGROUND=rgbaString;const looksDark=col[0]+col[1]+col[2]<384;console.log("Will use '".concat(rgbaString,"' as background color, interpreted as a ").concat(looksDark?"dark":"light"," theme")),mode=looksDark}}setDarkMode(Boolean(mode),!0)}};if(__name(LogicStatic,"LogicStatic"),InBrowser){const template2=(()=>{const template3=document.createElement("template");template3.innerHTML='<div id="logicEditorRoot" style="width: 100%; height: 100%; display: flex; align-items: stretch;">\n\n    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">\n    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"><\/script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"><\/script>\n\n    \x3c!-- Has to appear *after* the other bootstrap styles --\x3e\n    <style id="inlineStyle"></style>\n\n    <div id="leftToolbar" style="flex:none; min-width: 50px; max-width: 60px;overflow-y: scroll;display: none;">\n    </div>\n\n    <div id="centerCol" style="flex: auto; display: flex; flex-direction: column; justify-content: stretch;">\n\n        <div id="canvas-sim" style="flex: auto; position: relative; display: flex; align-items: stretch; min-width: 0; max-width: 100%; overflow: hidden;">\n\n            <canvas id="mainCanvas" tabindex="0" style="flex:auto"></canvas>\n\n            <div style="padding: 5px;\n            position: absolute; top: 10px; right: 10px;display:flex; flex-direction: column; align-items: flex-end;">\n                <div class="sim-toolbar-right" style="margin-bottom: 15px; display: none;" id="modeChangeMenu">\n                </div>\n\n                <div id="rightToolbarContainer" class="sim-toolbar-right" style="display: none;">\n                    <div class="btn-group-vertical">\n                        <button type="button" class="btn btn-sm btn-outline-light sim-toolbar-button-right" tool="reset" id="rightResetButton">\n                            <i class="svgicon" data-icon="reset"></i>\n                            <span style="margin-left: -20px">&nbsp;</span>\n                        </button>\n                    </div>\n                </div>\n\n                <div id="testResultsPalette">\n                </div>\n\n                <div id="settingsPalette" class="sim-toolbar-right" style="display: none; flex-direction:column; align-items: stretch; font-size: 75%; padding: 0 5px 5px" data-prev-display="flex">\n                </div>\n\n\n            </div>\n        </div>\n\n    </div>\n\n\n    <dialog id="embedDialog" style="display: none; border: 1px solid gray; border-radius: 10px; box-shadow: 0px 0px 16px 5px rgba(0,0,0,0.2); padding: 5px 10px; width: 100%; max-width: 600px;">\n        <div style="display: flex; flex-direction: column; font-size: 80%">\n            <div style="flex:none; font-weight: bold; text-align: center; width: 100%;padding: 10px 0; border-bottom: 1px solid lightgrey; margin-bottom: 10px; font-size: 120%" id="shareDialogTitle"></div>\n            <div style="flex: auto; display: flex; flex-direction: row;">\n                <div style="flex:auto; flex-direction: column;">\n                    <div>\n                        <span style="font-weight: bolder" id="shareDialogUrl"></span><br>\n                        <textarea id="embedUrl" readonly rows="2" style="width:100%; resize: none"></textarea>\n                    </div>\n                    <div style="margin-top: 10px; flex:auto">\n                        <span style="font-weight: bolder" id="shareDialogIframe"></span><br>\n                        <textarea id="embedIframe" readonly rows="4" style="width:100%; font-family: monospace;"></textarea>\n                    </div>\n                    <div style="margin-top: 10px; flex:auto">\n                        <span style="font-weight: bolder" id="shareDialogWebComp"></span><br>\n                        <textarea id="embedWebcomp" readonly rows="4" style="width:100%; font-family: monospace;"></textarea>\n                    </div>\n                    <div style="margin-top: 10px; flex:auto">\n                        <span style="font-weight: bolder;" id="shareDialogMarkdown"></span><br>\n                        <textarea id="embedMarkdown" readonly rows="7" style="width:100%; font-family: monospace"></textarea>\n                    </div>\n                </div>\n                \x3c!-- <div style="flex:none; margin-top: 10px">\n                    <img id="embedUrlQRCode" style="margin-left: 10px">\n                </div> --\x3e\n            </div>\n            <div style="flex: none; margin-top: 15px; text-align: center;">\n                <form method="dialog">\n                    <button value="close" id="shareDialogClose"></button>\n                </form>\n            </div>\n        </div>\n    </dialog>\n\n    <input id="fileChooser" type="file" style="display:none"></input>\n\n    <div id="tooltip" role="tooltip" style="display:none">\n        <div id="tooltipContents"></div>\n        <div id="arrow" data-popper-arrow></div>\n    </div>\n\n    <ul class="menu" id="mainContextMenu"></ul>\n\n</div>';const styles=["* {\n  box-sizing: border-box;\n}\n\ncanvas:focus {\n  outline: none;\n}\n\n#logicEditorRoot {\n  font-family: 'Roboto', sans-serif;\n  background-color: #EEEEEE;\n}\n\n#logicEditorRoot.dark {\n  background-color: #373737;\n}\n\n/* TODO would that go in some global CSS?\nlogic-editor:not(:defined) {\n  opacity: 0;\n  width: 100%;\n  height: 20px;\n}\n*/\n\n/* btn btn-sm  */\n\n\n.navGroupTools {\n  padding-left: 2px;\n  padding-right: 2px;\n  border-right-style: dotted;\n  border-color: gray;\n}\n\n.nav-item {\n  display: inline-flex;\n}\n\n#leftToolbar {\n  display: flex;\n  flex-direction: column;\n  color: black;\n  border-top: 1px solid rgba(0, 0, 0, 0.125);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.125);\n}\n\n.leftToolbarHeader {\n  font-size: 80%;\n  font-weight: bold;\n  padding: 1px;\n  /* word-break: break-all; */\n  text-align: center;\n  background-color: lightgray;\n}\n\n.leftToolbarMore {\n  text-align: center;\n  font-style: italic;\n  font-size: 75%;\n  padding: 3px 0;\n  cursor: pointer;\n  opacity: 0.6;\n  color: rgb(33, 33, 33);\n}\n\n.dark a {\n  color: #8e81ff;\n}\n\n.dark .leftToolbarHeader {\n  background-color: rgb(56, 56, 56);\n}\n\n.dark #leftToolbar {\n  background-color: #5e5e5e;\n  color: rgb(181, 181, 181);\n}\n\n.dark .leftToolbarMore {\n  color: rgb(204, 204, 204);\n}\n\n.dark #leftToolbar .list-group-item {\n  background-color: #5e5e5e;\n}\n\n.sim-toolbar-right {\n  background: rgba(136, 136, 136, 0.5);\n  box-shadow: 0px 0px 10px 1px rgb(201, 201, 201);\n  border-radius: 5px;\n  position: relative;\n  right: 0px;\n  top: 0px;\n}\n\n.sim-toolbar-right .toolbar-title {\n  text-align: center;\n  width: 100%;\n  font-weight: bold;\n  font-size: 12px;\n  color: #444;\n  padding: 2px;\n  cursor: grab;\n}\n\n.dark .sim-toolbar-right .toolbar-title {\n  color: rgb(181, 181, 181);\n}\n\n.dark .sim-toolbar-right {\n  color: rgb(204, 204, 204);\n}\n\n.sim-toolbar-right .toolbar-title.with-border {\n  border-bottom: 1px solid rgba(255, 255, 255, 0.4);\n  margin-bottom: 5px;\n}\n\n.sim-toolbar-right .close-palette {\n  position: absolute;\n  top: 2px;\n  right: 2px;\n  cursor: pointer;\n  margin-left: 5px;\n  color: rgb(112, 112, 112)\n}\n\n.dark .sim-toolbar-right .close-palette {\n  color: rgb(204, 204, 204);\n}\n\n#settingsPalette label span,\n.noselect {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n\n.sim-component-button {\n  padding: 8px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.sim-component-button-extra {\n  background-color: #ededed;\n}\n\n.sim-toolbar-button-right {\n  text-align: left;\n  cursor: pointer;\n  height: 30px;\n}\n\n.sim-toolbar-button-right>i {\n  width: 16px;\n}\n\n.sim-mode-link {\n  margin: -8px 0 -8px 5px;\n  border: 1px solid rgba(0, 0, 0, 0);\n  border-radius: 3px;\n  padding: 5px;\n  cursor: pointer;\n}\n\n.sim-toolbar-button-right:not(.active) .sim-mode-link {\n  opacity: 0.0;\n}\n\n.sim-mode-link:hover {\n  border-color: grey;\n}\n\n#leftToolbar .barLabel {\n  font-size: 52%;\n  font-weight: bold;\n  text-align: center;\n  word-break: break-all;\n}\n\n.truth-table {\n  color: white;\n  font-weight: normal;\n  font-size: 90%;\n  text-align: center;\n  border: 1px solid gray;\n  margin: 5px 0;\n}\n\n.truth-table th {\n  padding: 3px 8px;\n  margin: 0 0 2px 0;\n  border-bottom: 1px solid grey;\n}\n\n.truth-table tr.current {\n  background: grey;\n  color: rgb(255, 192, 8);\n}\n\n.truth-table th:last-child,\n.truth-table td:last-child {\n  border-left: 1px solid grey;\n}\n\n/* Tooltips by Popper */\n\n#tooltip {\n  background: #333;\n  color: white;\n  padding: 6px;\n  font-size: 13px;\n  line-height: 1.2em;\n  border-radius: 4px;\n  display: none;\n  opacity: 0.95;\n}\n\n#tooltip div+div {\n  margin-top: 5px;\n}\n\n#tooltip[data-show] {\n  display: block;\n}\n\n#arrow,\n#arrow::before {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  background: inherit;\n}\n\n#arrow {\n  visibility: hidden;\n}\n\n#arrow::before {\n  visibility: visible;\n  content: '';\n  transform: rotate(45deg);\n}\n\n#tooltip[data-popper-placement^='top']>#arrow {\n  bottom: -4px;\n}\n\n#tooltip[data-popper-placement^='bottom']>#arrow {\n  top: -4px;\n}\n\n#tooltip[data-popper-placement^='left']>#arrow {\n  right: -4px;\n}\n\n#tooltip[data-popper-placement^='right']>#arrow {\n  left: -4px;\n}\n\n/* Menus */\n\n.menu {\n  position: absolute;\n  min-width: 200px;\n  padding: 2px;\n  margin: 0;\n  border: 1px solid #bbb;\n  background: #EAEAEA;\n  background: -webkit-linear-gradient(to bottom, #F2F2F2 0%, #EAEAEA 100px, #EAEAEA 100%);\n  background: linear-gradient(to bottom, #F2F2F2 0%, #EAEAEA 100px, #EAEAEA 100%);\n  z-index: 100;\n  border-radius: 3px;\n  box-shadow: 1px 1px 4px rgba(0, 0, 0, .2);\n  opacity: 0;\n  -webkit-transform: translate(0, 15px) scale(.95);\n  transform: translate(0, 15px) scale(.95);\n  transition: transform 0.1s ease-out, opacity 0.1s ease-out;\n  pointer-events: none;\n}\n\n.menu-item {\n  display: block;\n  position: relative;\n  margin: 0;\n  padding: 0;\n  white-space: nowrap;\n}\n\n.menu-btn {\n  background: none;\n  line-height: normal;\n  overflow: visible;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  display: block;\n  width: 100%;\n  color: #444;\n  font-family: 'Roboto', sans-serif;\n  font-size: 13px;\n  text-align: left;\n  cursor: pointer;\n  border: 1px solid transparent;\n  white-space: nowrap;\n  padding: 6px 8px;\n  border-radius: 3px;\n}\n\n.menu-btn::-moz-focus-inner,\n.menu-btn::-moz-focus-inner {\n  border: 0;\n  padding: 0;\n}\n\n.menu-text {\n  margin-left: 10px;\n  margin-right: 22px;\n}\n\n.menu-item-static {\n  display: block;\n  padding: 0 5px;\n  color: rgb(150, 150, 150);\n  font-size: 70%;\n  font-style: italic;\n  width: 100%;\n  white-space: normal;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  cursor: default;\n}\n\n.menu-btn .fa {\n  position: absolute;\n  left: 8px;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n  transform: translateY(-50%);\n}\n\n.menu-shortcut {\n  position: absolute;\n  right: 8px;\n  font-size: 85%;\n}\n\n.menu-item:hover>.menu-btn {\n  color: #fff;\n  outline: none;\n  background-color: #2865E1;\n  background: -webkit-linear-gradient(to bottom, #2A6BED, #2865E1);\n  background: linear-gradient(to bottom, #2A6BED, #2865E1);\n  border: 1px solid #2865E1;\n}\n\n.menu-item:hover>.menu-btn.danger {\n  color: #fff;\n  background-color: #C1210E;\n  background: -webkit-linear-gradient(to bottom, #DE2610, #C1210E);\n  background: linear-gradient(to bottom, #DE2610, #C1210E);\n  border: 1px solid #C1210E;\n}\n\n.menu-item.disabled {\n  opacity: .5;\n  pointer-events: none;\n}\n\n.menu-item.disabled .menu-btn {\n  cursor: default;\n}\n\n.menu-separator {\n  display: block;\n  margin: 3px 5px;\n  height: 1px;\n  border-bottom: 1px solid #D0CFD0;\n  background-color: #aaa;\n}\n\n.menu-item.submenu::after {\n  content: \"\";\n  position: absolute;\n  right: 6px;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n  transform: translateY(-50%);\n  border: 5px solid transparent;\n  border-left-color: #808080;\n}\n\n.menu-item.submenu:hover::after {\n  border-left-color: #fff;\n}\n\n.menu .menu {\n  top: 4px;\n  left: 99%;\n}\n\n.show-menu,\n.menu-item:hover>.menu {\n  opacity: 1;\n  -webkit-transform: translate(0, 0) scale(1);\n  transform: translate(0, 0) scale(1);\n  pointer-events: auto;\n}\n\n.menu-item:hover>.menu {\n  -webkit-transition-delay: 100ms;\n  transition-delay: 300ms;\n}\n\ni.svgicon {\n  display: inline-block;\n  width: 16px;\n}\n\ni.svgicon svg {\n  width: 100%;\n}\n\ni.svgicon path {\n  fill: currentColor;\n}\n\n\n\ni.svgimg svg {\n  width: 100%;\n  font-family: Arial, Helvetica, sans-serif;\n  font-style: normal;\n}\n\ni.svgimg {\n  color: black;\n}\n\n.dark i.svgimg {\n  color: rgb(230, 230, 230);\n}\n\n.dark .barLabel {\n  color: rgb(220, 220, 220);\n}\n\nsvg text {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  pointer-events: none;\n}\n\n\n/* Top bar */\n\n.topBar {\n  background-color: rgb(239, 239, 239);\n  border-left: 1px solid lightgray;\n  border-right: 1px solid lightgray;\n  border-top: 1px solid lightgray;\n}\n\n.dark .topBar {\n  background-color: rgb(94, 94, 94);\n  border-left-color: #525252;\n}\n\n.topBar * {\n  font: 10pt 'Roboto', sans-serif;\n}\n\n.dark .topBar * {\n  color: rgb(220, 220, 220);\n}\n\n.topBar button {\n  border: none;\n  background: none;\n  box-shadow: none;\n  border-radius: 5px;\n  display: inline-flex;\n  align-items: center;\n  gap: 3px;\n}\n\n.dark .topBar button:disabled * {\n  color: #808080;\n}\n\n.topBar button:not(:disabled, .active):hover {\n  background: #d5d5d5;\n}\n\n.topBar button:not(:disabled, .active):active {\n  background: #b2b2b2;\n  transform: translate(1px, 1px);\n}\n\n.topBar button.active {\n  background: #ffffff;\n  font-weight: bolder;\n  cursor: unset;\n}\n\n\n.dark .topBar button:not(:disabled, .active):hover {\n  background: #404040;\n}\n\n.dark .topBar button:not(:disabled, .active):active {\n  background: #313131;\n}\n\n.dark .topBar button.active {\n  background: #1E1E1E;\n}\n\n.topBar .sep {\n  border-left: 1px solid #d5d5d5;\n  margin: 0 4px;\n}\n\n.topBar .sep.fat {\n  border-left-width: 5px;\n}\n\n.dark .topBar .sep {\n  border-left-color: #525252;\n}\n\n.topBar .barLabel {\n  display: inline-flex;\n  align-items: center;\n  white-space: pre;\n  margin: 0 5px;\n  cursor: default;\n}\n\n.topBar.compact .btnLabel {\n  display: none;\n}\n\n.topBar a.barLabel {\n  color: inherit;\n  cursor: pointer;\n}\n\n.topBar .barTab {\n  flex: none;\n  display: inline-flex;\n  margin: 0 0 -3px;\n  padding: 3px;\n}\n\n.topBar .barTab.active {\n  background-color: white;\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n  border: 1px solid rgb(200, 200, 200);\n  border-bottom: none;\n}\n\n.dark .topBar .barTab.active {\n  background-color: rgb(30, 30, 30);\n  border-color: #555555;\n}\n\n\n.msgZone {\n  position: absolute;\n  top: -40px;\n  width: 100%;\n  display: flex;\n  visibility: hidden;\n  justify-content: center;\n  align-items: center;\n  transition: all 0.15s ease-in-out;\n  pointer-events: none;\n}\n\n.msgZone.visible {\n  top: 10px;\n  visibility: visible;\n}\n\n.msgZone .msgBar {\n  padding: 5px 10px;\n  border-radius: 20px;\n  text-align: center;\n  max-width: 80%;\n  box-shadow: 0px 0px 5px 0px rgba(128, 128, 128, 0.5);\n  font-size: 10pt;\n  background-color: rgb(190, 190, 190, 0.2);\n  pointer-events: auto;\n}\n\n.dark .msgZone .msgBar {\n  color: rgb(220, 220, 220);\n}\n\n.test-disclosable {\n  cursor: pointer;\n  border: none;\n}\n\n.test-disclosable::before {\n  content: '\\25B6';\n  /* Right-pointing triangle */\n  display: inline-block;\n  margin-right: 5px;\n  transition: transform 0.1s;\n}\n\n.testcase-button {\n  background: none;\n  width: 100%;\n  text-align: left;\n  display: flex;\n}\n\n.testcase-button.test-disclosable::before {\n  font-size: 80%;\n}\n\n.test-disclosable.expanded::before {\n  transform: rotate(90deg);\n  /* Down-pointing triangle */\n}\n\n.test-suite {\n  background-color: #ccc;\n  color: #444;\n  font-weight: bold;\n  padding: 5px;\n  width: 100%;\n}\n\n.dark .test-suite {\n  background-color: #333;\n  color: #ccc;\n}\n\n.test-cases {\n  padding: 0;\n  display: none;\n  overflow: hidden;\n  background-color: #f1f1f1;\n}\n\n.dark .test-cases {\n  background-color: #444;\n}\n\n.testcase {\n  padding: 2px 5px;\n  border-top: 1px solid #ccc;\n}\n\n.testcase.wait {\n  background: #f1f1f1;\n}\n\n.dark .testcase.wait {\n  background: #444;\n}\n\n.testcase.pass {\n  background: #d3f3d3;\n}\n\n.dark .testcase.pass {\n  background: rgb(25, 48, 25);\n}\n\n.testcase.fail {\n  background: #f3d3d3;\n}\n\n.dark .testcase.fail {\n  background: #412626;\n}\n\n.testcase.error {\n  background: #f3f3d3;\n}\n\n.dark .testcase.error {\n  background: #363616;\n}\n\n.testcase.skip {\n  background: #d3d3f3;\n}\n\n.dark .testcase.skip {\n  background: #666;\n}\n\n.testcase.running {\n  background: repeating-linear-gradient(135deg,\n      #e2e2e2,\n      #e2e2e2 10px,\n      #f7f6f6 10px,\n      #f7f6f6 20px);\n  background-size: 200% 100%;\n  animation: barberpole 5s linear infinite;\n}\n\n.dark .testcase.running {\n  background: repeating-linear-gradient(135deg,\n      #555,\n      #555 10px,\n      #444 10px,\n      #444 20px);\n}\n\n@keyframes barberpole {\n  0% {\n    background-position: 0% 0%;\n  }\n\n  100% {\n    background-position: -100% 0%;\n  }\n}\n\n.testcase-details {\n  padding: 5px 5px 10px 20px;\n}\n\n#logicEditorRoot[nomodes~=full] .testcase-change-button {\n  display: none;\n}\n\n.testcase-table {\n  width: 100%;\n  font-size: 90%;\n  border-collapse: collapse;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.6);\n  border-left: 2px solid rgba(255, 255, 255, 0.6);\n  opacity: 0.8;\n}\n\n.testcase-table th {\n  padding-left: 5px;\n}\n\n.testcase-table td {\n  padding-left: 10px;\n}\n\n.testcase-table :is(td, th) {\n  white-space: nowrap;\n}\n\n.testcase-table :is(td, th):first-child {\n  width: 50%;\n}\n\n.testcase-table :is(td, th):nth-child(2) {\n  border-left: 1px solid rgba(255, 255, 255, 0.6);\n}\n\n.testcase-wrongvalue {\n  color: #8f2626;\n  font-weight: bold;\n}\n\n.dark .testcase-wrongvalue {\n  color: #ff9898;\n}","dialog {\n  position: absolute;\n  left: 0; right: 0;\n  width: -moz-fit-content;\n  width: -webkit-fit-content;\n  width: fit-content;\n  height: -moz-fit-content;\n  height: -webkit-fit-content;\n  height: fit-content;\n  margin: auto;\n  border: solid;\n  padding: 1em;\n  background: white;\n  color: black;\n  display: block;\n}\n\ndialog:not([open]) {\n  display: none;\n}\n\ndialog + .backdrop {\n  position: fixed;\n  top: 0; right: 0; bottom: 0; left: 0;\n  background: rgba(0,0,0,0.1);\n}\n\n._dialog_overlay {\n  position: fixed;\n  top: 0; right: 0; bottom: 0; left: 0;\n}\n\ndialog.fixed {\n  position: fixed;\n  top: 50%;\n  transform: translate(0, -50%);\n}"];return template3.content.querySelector("#inlineStyle").innerHTML=styles.join("\n\n\n"),template3.content.querySelectorAll("i.svgicon").forEach(setupSvgIcon),template3})();window.Logic=new LogicStatic(template2),window.customElements.define("logic-editor",LogicEditor),document.addEventListener("toggle",(e=>{e.target instanceof HTMLDetailsElement&&e.target.open&&e.target.querySelectorAll("logic-editor").forEach((el=>{el instanceof LogicEditor&&el.redraw()}))}),!0)}else console.log("cli")})();

//# sourceMappingURL=logic-editor.min.js.map